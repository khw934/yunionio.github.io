<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Cloudpods –
免密登录公有云</title><link>https://www.cloudpods.org//v3.8/zh/docs/multicloud/cloudaccounts/tutorial/cloudsso/</link><description>Recent content in 免密登录公有云 on Cloudpods</description><generator>Hugo -- gohugo.io</generator><atom:link href="https://www.cloudpods.org//v3.8/zh/docs/multicloud/cloudaccounts/tutorial/cloudsso/index.xml" rel="self" type="application/rss+xml"/><item><title>Docs: 开启免密登录</title><link>https://www.cloudpods.org//v3.8/zh/docs/multicloud/cloudaccounts/tutorial/cloudsso/cloudsso/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://www.cloudpods.org//v3.8/zh/docs/multicloud/cloudaccounts/tutorial/cloudsso/cloudsso/</guid><description>
&lt;p>该功能用于开启云账号的免密登录功能，将系统的SAML信息同步到云账号上，并成为云上登录的&lt;a href="#%E8%BA%AB%E4%BB%BD%E6%8F%90%E4%BE%9B%E5%95%86">身份提供商&lt;/a>。开启后,在云账号详情-免密登录页面添加的免密用户可以免密登录公有云平台。目前暂不支持关闭该功能。&lt;/p>
&lt;p>目前支持免密登录的平台有：阿里云、腾讯云、华为云、AWS、Azure、HCSO。&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>平台&lt;/th>
&lt;th>启用方式&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>阿里云&lt;/td>
&lt;td>在Cloudpods平台开启免密登录&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>腾讯云&lt;/td>
&lt;td>在Cloudpods平台开启免密登录&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>华为云&lt;/td>
&lt;td>在Cloudpods平台开启免密登录&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>AWS&lt;/td>
&lt;td>在Cloudpods平台开启免密登录&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Azure&lt;/td>
&lt;td>在Cloudpods平台开启免密登录&lt;/br> &lt;a href="../azurecloudsso/#azure%E9%85%8D%E7%BD%AEexternal-identies">在Azure平台配置External Identity providers&lt;/a>&lt;/br> &lt;a href="../azurecloudsso/#%E8%AE%BE%E7%BD%AEchrome%E6%B5%8F%E8%A7%88%E5%99%A8">设置Chrome浏览器&lt;/a>&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>HCSO&lt;/td>
&lt;td>在Cloudpods平台开启免密登录&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h3 id="新建云账号开启免密登录">新建云账号开启免密登录&lt;/h3>
&lt;ol>
&lt;li>在左侧导航栏，选择 &lt;strong>&lt;em>&amp;ldquo;多云管理/云账号/云账号&amp;rdquo;&lt;/em>&lt;/strong> 菜单项，进入云账号页面。&lt;/li>
&lt;li>单击列表上方 &lt;strong>&lt;em>&amp;ldquo;新建&amp;rdquo;&lt;/em>&lt;/strong> 按钮，进入新建云账号页面。&lt;/li>
&lt;li>选择平台后，在配置云账号信息中开启免密登录。&lt;/li>
&lt;li>配置完成后，单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮，完成操作。&lt;/li>
&lt;/ol>
&lt;h3 id="云账号创建完成后开启免密登录">云账号创建完成后开启免密登录&lt;/h3>
&lt;ol>
&lt;li>在左侧导航栏，选择 &lt;strong>&lt;em>&amp;ldquo;多云管理/云账号/云账号&amp;rdquo;&lt;/em>&lt;/strong> 菜单项，进入云账号页面。&lt;/li>
&lt;li>单击云账号右侧操作列 &lt;strong>&lt;em>&amp;ldquo;更多&amp;rdquo;&lt;/em>&lt;/strong> 按钮，选择下拉菜单 &lt;strong>&lt;em>&amp;ldquo;开启免密登录&amp;rdquo;&lt;/em>&lt;/strong> 菜单项，弹出操作确认对话框。&lt;/li>
&lt;li>单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮，完成操作。&lt;/li>
&lt;/ol>
&lt;h3 id="身份提供商">身份提供商&lt;/h3>
&lt;p>身份提供商（Identity Provider，简称IdP）用于提供身份验证，外部用户通过已知的身份提供商身份验证后，将使用角色登录公有云平台。外部用户将在角色的有限权限范围内进行资源访问。因外部身份用户登录腾讯云所用的是角色，而角色使用的是临时密钥，您可避免因长期使用密钥（例如云 API 密钥），导致难以轮换密钥以及被截取后泄露导致的安全问题。&lt;/p></description></item><item><title>Docs: 新建免密登录用户</title><link>https://www.cloudpods.org//v3.8/zh/docs/multicloud/cloudaccounts/tutorial/cloudsso/create/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://www.cloudpods.org//v3.8/zh/docs/multicloud/cloudaccounts/tutorial/cloudsso/create/</guid><description>
&lt;p>该功能用于将系统内的本地用户设置为公有云平台的免密登录用户。&lt;/p>
&lt;ol>
&lt;li>在左侧导航栏，选择 &lt;strong>&lt;em>&amp;ldquo;多云管理/云账号/云账号&amp;rdquo;&lt;/em>&lt;/strong> 菜单项，进入云账号页面。&lt;/li>
&lt;li>单击公有云平台云账号名称项，进入云账号详情页面。&lt;/li>
&lt;li>单击“免密登录用户”页签，进入免密登录用户页面。&lt;/li>
&lt;li>单击 &lt;strong>&lt;em>&amp;ldquo;新建&amp;rdquo;&lt;/em>&lt;/strong> 按钮，弹出新建免密登录用户。&lt;/li>
&lt;li>关联本地用户，并选择对应云用户组。&lt;/li>
&lt;li>单击&amp;lt;确定&amp;gt;按钮，完成操作。&lt;/li>
&lt;/ol></description></item><item><title>Docs: 删除免密登录用户</title><link>https://www.cloudpods.org//v3.8/zh/docs/multicloud/cloudaccounts/tutorial/cloudsso/delete/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://www.cloudpods.org//v3.8/zh/docs/multicloud/cloudaccounts/tutorial/cloudsso/delete/</guid><description>
&lt;p>该功能用于删除免密登录用户，删除后，系统内用户将无法再免密登录到公有云。&lt;/p>
&lt;h3 id="删除免密登录用户">删除免密登录用户&lt;/h3>
&lt;ol>
&lt;li>在左侧导航栏，选择 &lt;strong>&lt;em>&amp;ldquo;多云管理/云账号/云账号&amp;rdquo;&lt;/em>&lt;/strong> 菜单项，进入云账号页面。&lt;/li>
&lt;li>单击公有云平台云账号名称项，进入云账号详情页面。&lt;/li>
&lt;li>单击“免密登录用户”页签，进入免密登录用户页面。&lt;/li>
&lt;li>单击用户右侧操作列 &lt;strong>&lt;em>&amp;ldquo;删除&amp;rdquo;&lt;/em>&lt;/strong> 按钮，弹出操作确认对话框。&lt;/li>
&lt;li>单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮，完成操作。&lt;/li>
&lt;/ol>
&lt;h3 id="批量删除免密登录用户">批量删除免密登录用户&lt;/h3>
&lt;ol>
&lt;li>在左侧导航栏，选择 &lt;strong>&lt;em>&amp;ldquo;多云管理/云账号/云账号&amp;rdquo;&lt;/em>&lt;/strong> 菜单项，进入云账号页面。&lt;/li>
&lt;li>单击公有云平台云账号名称项，进入云账号详情页面。&lt;/li>
&lt;li>单击“免密登录用户”页签，进入免密登录用户页面。&lt;/li>
&lt;li>在列表中选择一个或多个用户，单击 &lt;strong>&lt;em>&amp;ldquo;删除&amp;rdquo;&lt;/em>&lt;/strong> 按钮，弹出操作确认对话框。&lt;/li>
&lt;li>单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮，完成操作。&lt;/li>
&lt;/ol></description></item><item><title>Docs: 免密登录Azure平台</title><link>https://www.cloudpods.org//v3.8/zh/docs/multicloud/cloudaccounts/tutorial/cloudsso/azurecloudsso/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://www.cloudpods.org//v3.8/zh/docs/multicloud/cloudaccounts/tutorial/cloudsso/azurecloudsso/</guid><description>
&lt;p>下面举例介绍如何从Cloudpods平台免密登录Azure平台。目前仅Azure全球区支持免密登录。&lt;/p>
&lt;h3 id="开启免密登录">开启免密登录&lt;/h3>
&lt;div class="alert alert-primary" role="alert">
&lt;h4 class="alert-heading">说明&lt;/h4>
将Cloudpods平台设置为域名访问，并在全局设置-控制台地址中设置访问域名。非域名访问的平台否则无法作为Azure的External Identies。
&lt;/div>
&lt;ol>
&lt;li>
&lt;p>在Cloudpods平台上添加Azure云账号配置参数时，账号类型选择“全球区”，并勾选“开启免密登录”。&lt;/p>
&lt;p>&lt;img src="../../../images/azuresso.png" alt="">&lt;/p>
&lt;/li>
&lt;li>
&lt;p>云账号创建成功后，获取云账号的ID。&lt;/p>
&lt;p>&lt;img src="../../../images/azureaccountid.png" alt="">&lt;/p>
&lt;/li>
&lt;li>
&lt;p>在浏览器中输入“https://&amp;lt;域名&amp;gt;/api/saml/idp/metadata/&amp;lt;账号ID&amp;gt;”，将显示的XML文件内容保存。例如：“&lt;a href="#azure%E9%85%8D%E7%BD%AEexternal-identies">https://saml.test.cn/api/saml/idp/metadata/7c6c10d5-953a-444c-8685-d0b8f53984b2&lt;/a>”，并保存该文件。&lt;/p>
&lt;p>&lt;img src="../../../images/azurexml.png" alt="">&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h3 id="azure配置external-identies">Azure配置External Identies&lt;/h3>
&lt;ol>
&lt;li>
&lt;p>在&lt;a href="https://portal.azure.com/">Azure&lt;/a>控制台，搜索“external identies”并进入该页面。&lt;/p>
&lt;p>&lt;img src="../../../images/externalidenties.png" alt="">&lt;/p>
&lt;/li>
&lt;li>
&lt;p>单击左侧菜单项“All identity providers”，进入“All identity providers”页面.&lt;/p>
&lt;p>&lt;img src="../../../images/createexternalidenties.png" alt="">&lt;/p>
&lt;/li>
&lt;li>
&lt;p>单击“New SAML/WS-Fed Idp”，在弹出的对话框中配置以下参数。&lt;/p>
&lt;ul>
&lt;li>Identity provider protocol：选择SAML。&lt;/li>
&lt;li>Domain name of federating IdP：设置为平台的域名，例如saml.test.cn。&lt;/li>
&lt;li>Select a method for populating metadata：建议选择“Parse metadata file”，并上传上面步骤保存的xml文件，并单击“Parse”，自动填充下面参数。如选择“Input metadata manually”，需要安装上面的截图对应项，分别填入，注意，直接复制的Certificate项有空格，需要将空格完全删除。&lt;/li>
&lt;/ul>
&lt;p>&lt;img src="../../../images/newsaml.png" alt="">&lt;/p>
&lt;/li>
&lt;li>
&lt;p>除此之外，还需要为Azure的应用程序添加用户权限，Azure应用程序具体可参考&lt;a href="#%E8%8E%B7%E5%8F%96tenant-id-client-id%E5%92%8Cclient-secret">获取Tenant ID、Client ID和Client Secret&lt;/a>。&lt;/p>
&lt;/li>
&lt;li>
&lt;p>在应用程序详情页面，单击“API permission”，进入API permission页面，确保应用程序有Microsoft Graph下的“User.Invite.ALL”和“User.ReadWrite.All”的权限，若没有该权限，需要单击“add a permission”，添加对应权限。&lt;/p>
&lt;p>&lt;img src="../../../images/permission.png" alt="">
&lt;img src="../../../images/addpermission.png" alt="">
&lt;img src="../../../images/adduserpermission.png" alt="">&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h3 id="设置chrome浏览器">设置Chrome浏览器&lt;/h3>
&lt;p>当在Cloudpods平台免密登录Azure平台时，在登录Azure过程中需要携带Cookie回调Cloudpods平台，Chrome浏览器默认不允许跨网站携带Cookie，所以需要进行以下配置：&lt;/p>
&lt;ol>
&lt;li>
&lt;p>在Chrome浏览器地址栏输入“chrome://flags/”，并搜索“SameSite by default cookies”。&lt;/p>
&lt;/li>
&lt;li>
&lt;p>禁用“SameSite by default cookies”和“Cookies without SameSite must be secure”。
&lt;img src="../../../images/disablesamesite.png" alt="">&lt;/p>
&lt;/li>
&lt;li>
&lt;p>重启浏览器使配置生效。&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h3 id="添加免密登录用户">添加免密登录用户&lt;/h3>
&lt;ol>
&lt;li>
&lt;p>在Cloudpods平台上的 &lt;strong>&lt;em>&amp;ldquo;云账号列表-Azure账号-详情-免密登录用户&amp;rdquo;&lt;/em>&lt;/strong> 页面，添加平台上的用户作为免密登录用户。&lt;/p>
&lt;p>&lt;img src="../../../images/azuresamluser.png" alt="">&lt;/p>
&lt;/li>
&lt;li>
&lt;p>单击 &lt;strong>&lt;em>&amp;ldquo;新建&amp;rdquo;&lt;/em>&lt;/strong> 按钮，在弹出的新建对话框中选择平台上的用户以及对应的云用户组，单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮。&lt;/p>
&lt;p>&lt;img src="../../../images/createazuresamluser.png" alt="">&lt;/p>
&lt;/li>
&lt;li>
&lt;p>免密登录用户可以在右上角 &lt;strong>&lt;em>&amp;ldquo;用户信息-多云统一登录-免密登录&amp;rdquo;&lt;/em>&lt;/strong> 页面，单击**_&amp;ldquo;免密登录&amp;rdquo;_** 按钮。&lt;/p>
&lt;p>&lt;img src="../../../images/azuressologin1.png" alt="">&lt;/p>
&lt;/li>
&lt;li>
&lt;p>在弹出的提示信息对话框中，单击 &lt;strong>&lt;em>&amp;ldquo;复制且登录&amp;rdquo;&lt;/em>&lt;/strong> 按钮，跳转到Azure平台，输入复制的账户，免密登录Azure平台。&lt;/p>
&lt;/li>
&lt;/ol></description></item></channel></rss>