"use strict";(self.webpackChunkdocs_new=self.webpackChunkdocs_new||[]).push([[9018],{6351:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>i,contentTitle:()=>t,default:()=>p,frontMatter:()=>r,metadata:()=>d,toc:()=>l});var s=o(85893),c=o(11151);const r={title:"Cloudpods + Rook + Ceph \u8f7b\u677e\u5b9e\u73b0\u4e91\u539f\u751f\u7684\u8d85\u878d\u5408\u79c1\u6709\u4e91",date:new Date("2021-10-09T00:00:00.000Z"),slug:"rook-ceph-with-cloudpods",authors:[{name:"Zexi Li",url:"https://github.com/zexi",image_url:"https://github.com/zexi.png"},{name:"Jian Qiu",url:"https://github.com/swordqiu",image_url:"https://github.com/swordqiu.png",title:"Cloudpods maintainer"}]},t=void 0,d={permalink:"/v3.10/en/blog/rook-ceph-with-cloudpods",editUrl:"https://github.com/yunionio/website/tree/master/blog/2021-10-09-rook-ceph-with-cloudpods/index.md",source:"@site/blog/2021-10-09-rook-ceph-with-cloudpods/index.md",title:"Cloudpods + Rook + Ceph \u8f7b\u677e\u5b9e\u73b0\u4e91\u539f\u751f\u7684\u8d85\u878d\u5408\u79c1\u6709\u4e91",description:"\u80cc\u666f\u4ecb\u7ecd",date:"2021-10-09T00:00:00.000Z",formattedDate:"October 9, 2021",tags:[],readingTime:15.52,hasTruncateMarker:!0,authors:[{name:"Zexi Li",url:"https://github.com/zexi",image_url:"https://github.com/zexi.png",imageURL:"https://github.com/zexi.png"},{name:"Jian Qiu",url:"https://github.com/swordqiu",image_url:"https://github.com/swordqiu.png",title:"Cloudpods maintainer",imageURL:"https://github.com/swordqiu.png"}],frontMatter:{title:"Cloudpods + Rook + Ceph \u8f7b\u677e\u5b9e\u73b0\u4e91\u539f\u751f\u7684\u8d85\u878d\u5408\u79c1\u6709\u4e91",date:"2021-10-09T00:00:00.000Z",slug:"rook-ceph-with-cloudpods",authors:[{name:"Zexi Li",url:"https://github.com/zexi",image_url:"https://github.com/zexi.png",imageURL:"https://github.com/zexi.png"},{name:"Jian Qiu",url:"https://github.com/swordqiu",image_url:"https://github.com/swordqiu.png",title:"Cloudpods maintainer",imageURL:"https://github.com/swordqiu.png"}]},unlisted:!1,prevItem:{title:"\u5929\u7a7a\u8ba1\u7b97\u2014\u2014\u4e91\u8ba1\u7b97\u7684\u4e0b\u4e00\u4e2a\u65f6\u4ee3?",permalink:"/v3.10/en/blog/skycomputing"},nextItem:{title:"\u7528Calico\u7f51\u7edc\u7b56\u7565\u8bbe\u7f6e\u4e3b\u673anode\u9632\u706b\u5899\u89c4\u5219",permalink:"/v3.10/en/blog/calico-customized-node-firewall"}},i={authorsImageUrls:[void 0,void 0]},l=[{value:"\u80cc\u666f\u4ecb\u7ecd",id:"\u80cc\u666f\u4ecb\u7ecd",level:2},{value:"\u73af\u5883\u51c6\u5907",id:"\u73af\u5883\u51c6\u5907",level:2},{value:"\u4f7f\u7528 Rook \u90e8\u7f72 Ceph",id:"\u4f7f\u7528-rook-\u90e8\u7f72-ceph",level:2},{value:"\u8282\u70b9\u4fe1\u606f",id:"\u8282\u70b9\u4fe1\u606f",level:3},{value:"\u90e8\u7f72 Rook \u7ec4\u4ef6",id:"\u90e8\u7f72-rook-\u7ec4\u4ef6",level:3},{value:"\u521b\u5efa ceph \u96c6\u7fa4",id:"\u521b\u5efa-ceph-\u96c6\u7fa4",level:3},{value:"Cloudpods \u865a\u62df\u673a\u4f7f\u7528 Rook \u90e8\u7f72\u7684 Ceph",id:"cloudpods-\u865a\u62df\u673a\u4f7f\u7528-rook-\u90e8\u7f72\u7684-ceph",level:2},{value:"\u5176\u5b83\u64cd\u4f5c",id:"\u5176\u5b83\u64cd\u4f5c",level:2},{value:"\u4f7f\u7528 Pacific (v16) Ceph",id:"\u4f7f\u7528-pacific-v16-ceph",level:2}];function a(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,c.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h2,{id:"\u80cc\u666f\u4ecb\u7ecd",children:"\u80cc\u666f\u4ecb\u7ecd"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://www.cloudpods.org",children:"Cloudpods"}),": \u662f\u6211\u4eec\u5f00\u6e90\u7684\u591a\u4e91\u7ba1\u7406\u5e73\u53f0\uff0c\u8fd0\u884c\u5728 Kubernetes \u4e4b\u4e0a\uff0c\u91cc\u9762\u5305\u542b\u4e00\u4e2a\u5b8c\u6574\u7684\u79c1\u6709\u4e91\u5b9e\u73b0\u3002"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://rook.io/docs/rook/v1.7",children:"Rook"}),": \u662f\u4e00\u4e2a\u5206\u5e03\u5f0f\u5b58\u50a8\u7f16\u6392\u7cfb\u7edf\uff0c\u76ee\u7684\u662f\u5728 Kubernetes \u4e0a\u63d0\u4f9b\u5b58\u50a8\u89e3\u51b3\u65b9\u6848\uff0c\u672c\u8eab\u4e0d\u63d0\u4f9b\u5b58\u50a8\uff0c\u800c\u662f\u5728 Kubernetes \u548c\u5b58\u50a8\u7cfb\u7edf\u4e4b\u95f4\u63d0\u4f9b\u9002\u914d\u5c42\uff0c\u7b80\u5316\u5b58\u50a8\u7cfb\u7edf\u7684\u90e8\u7f72\u548c\u7ef4\u62a4\u5de5\u4f5c\u3002\u5176\u652f\u6301\u7684 Ceph \u5b58\u50a8\u4e3a Stable \u751f\u4ea7\u53ef\u7528\u7684\u72b6\u6001\u3002"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://docs.ceph.com/",children:"Ceph"}),": \u662f\u5f00\u6e90\u7684\u5206\u5e03\u5f0f\u5b58\u50a8\u7cfb\u7edf\uff0c\u4e3b\u8981\u529f\u80fd\u5305\u542b RBD \u5757\u5b58\u50a8\u4ee5\u53ca CephFS \u5206\u5e03\u5f0f\u6587\u4ef6\u7cfb\u7edf\u5b58\u50a8\u3002"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["Cloudpods \u670d\u52a1\u4ee5\u5bb9\u5668\u5316\u7684\u65b9\u5f0f\u8fd0\u884c\u5728 Kubernetes \u96c6\u7fa4\u4e4b\u4e0a\uff0c\u6309\u7167 ",(0,s.jsx)(n.a,{href:"/docs/getting-started/",children:"\u5b89\u88c5\u90e8\u7f72"})," \u6587\u6863\u90e8\u7f72\u5b8c Cloudpods \u4e4b\u540e\uff0c\u73af\u5883\u5c31\u6709\u4e86\u4e00\u4e2a\u5b8c\u6574\u7684 Kubernetes \u96c6\u7fa4\u3002"]}),"\n",(0,s.jsx)(n.p,{children:"\u4f46 Cloudpods \u5185\u7f6e\u79c1\u6709\u4e91\u865a\u62df\u673a\u4f7f\u7528\u7684\u662f\u672c\u5730\u5b58\u50a8\uff0c\u672c\u6587\u4e3b\u8981\u4ecb\u7ecd\u4f7f\u7528 Rook \u5728 Cloudpods Kubernetes \u96c6\u7fa4\u91cc\u9762\u7684\u8ba1\u7b97\u8282\u70b9\u4e0a\u90e8\u7f72 Ceph \u96c6\u7fa4\uff0c\u7136\u540e\u628a Rook \u7ba1\u7406\u7684 Ceph \u96c6\u7fa4\u66b4\u9732\u51fa\u6765\u5bf9\u63a5 Cloudpods \u7684\u79c1\u6709\u4e91\u865a\u62df\u673a\u3002"}),"\n",(0,s.jsx)(n.p,{children:"Cloudpods \u5185\u7f6e\u79c1\u6709\u4e91\u63d0\u4f9b\u865a\u62df\u5316\u529f\u80fd\uff0c Rook \u7ba1\u7406\u7684 Ceph \u63d0\u4f9b\u5206\u5e03\u5f0f\u5b58\u50a8\uff0c\u5e76\u4e14\u8fd9\u4e9b\u670d\u52a1\u90fd\u662f\u5bb9\u5668\u5316\uff0c\u57fa\u4e8e Kubernetes \u8fd0\u884c\u7684\u3002Cloudpods \u8fd0\u884c\u865a\u62df\u673a\u7684\u8282\u70b9\u4e5f\u53eb\u8ba1\u7b97\u8282\u70b9\uff0c\u8ba1\u7b97\u8282\u70b9\u4e5f\u662f Kubernetes \u7684 Node\uff0c\u53ea\u8981\u8ba1\u7b97\u8282\u70b9\u4e0a\u6709\u72ec\u7acb\u7684\u88f8\u76d8\uff0c\u5c31\u53ef\u4ee5\u4f7f\u7528 Rook \u628a Ceph \u90e8\u7f72\u5230\u8ba1\u7b97\u8282\u70b9\u4e0a\uff0c\u628a\u8fd9\u4e9b\u6280\u672f\u7ed3\u5408\u8d77\u6765\u53ef\u4ee5\u8f7b\u677e\u5b9e\u73b0\u4e00\u4e2a\u4e91\u539f\u751f\u7684\u8d85\u878d\u5408\u79c1\u6709\u4e91\u3002"}),"\n",(0,s.jsx)(n.h2,{id:"\u73af\u5883\u51c6\u5907",children:"\u73af\u5883\u51c6\u5907"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Cloudpods\uff1av3.6 \u4ee5\u4e0a\u7684\u591a\u8282\u70b9\u90e8\u7f72\u7248\u672c","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"3 \u53f0\u8ba1\u7b97\u8282\u70b9\uff0c\u6709\u5355\u72ec\u7684\u88f8\u76d8\u7ed9 Ceph \u4f7f\u7528(\u540c\u65f6\u4f5c\u4e3a\u5b58\u50a8\u8282\u70b9\u4f7f\u7528)"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"Kubernetes\uff1av1.15.9 \u7248\u672c(Cloudpods \u9ed8\u8ba4\u7684\u96c6\u7fa4)"}),"\n",(0,s.jsx)(n.li,{children:"Rook: v1.7 \u7248\u672c"}),"\n",(0,s.jsx)(n.li,{children:"\u64cd\u4f5c\u7cfb\u7edf\uff1aCentOS 7"}),"\n",(0,s.jsxs)(n.li,{children:["\u5185\u6838\u7248\u672c\uff1a3.10.0-1062.4.3.el7.yn20191203.x86_64","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\u5982\u679c\u4f7f\u7528 CephFS \u5efa\u8bae\u7684\u5185\u6838\u7248\u672c\u662f 4.17 \u4ee5\u4e0a\u7684\u7248\u672c\uff0c\u53ef\u4ee5\u5347\u7ea7\u6211\u4eec\u5b98\u65b9\u63d0\u4f9b\u7684 5.4 \u7248\u672c\u5185\u6838"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["\u5176\u4e2d Ceph \u76f8\u5173\u7684\u73af\u5883\u51c6\u5907\u5de5\u4f5c\u548c\u9650\u5236\u53ef\u4ee5\u53c2\u8003 Rook \u63d0\u4f9b\u7684\u6587\u6863\uff1a",(0,s.jsx)(n.a,{href:"https://rook.io/docs/rook/v1.7/pre-reqs.html",children:"https://rook.io/docs/rook/v1.7/pre-reqs.html"})," \u3002"]}),"\n",(0,s.jsx)(n.h2,{id:"\u4f7f\u7528-rook-\u90e8\u7f72-ceph",children:"\u4f7f\u7528 Rook \u90e8\u7f72 Ceph"}),"\n",(0,s.jsxs)(n.p,{children:["\u63a5\u4e0b\u6765\u4ecb\u7ecd\u4f7f\u7528 Rook \u5728\u5df2\u6709\u7684 Cloudpods Kubernetes \u96c6\u7fa4\u4e0a\u90e8\u7f72 Ceph \u96c6\u7fa4\uff0c\u8fd9\u91cc\u6709\u4e2a\u524d\u63d0\u662f\u5df2\u7ecf\u6309\u7167 ",(0,s.jsx)(n.a,{href:"/docs/getting-started/onpremise/host",children:"\u5b89\u88c5\u90e8\u7f72/\u6dfb\u52a0\u8282\u70b9"})," \u6587\u6863\uff0c\u90e8\u7f72\u4e86\u4e00\u4e2a\u591a\u8282\u70b9\u7684 Cloudpods \u96c6\u7fa4\u3002"]}),"\n",(0,s.jsx)(n.h3,{id:"\u8282\u70b9\u4fe1\u606f",children:"\u8282\u70b9\u4fe1\u606f"}),"\n",(0,s.jsx)(n.p,{children:"\u5047\u8bbe\u5df2\u6709\u7684 3 \u4e2a\u8282\u70b9\u4e3a node-{0,1,2}\uff0c\u6bcf\u4e2a\u8282\u70b9\u7684\u78c1\u76d8\u4fe1\u606f\u5982\u4e0b\uff0csd{b,c,d} \u90fd\u662f\u6ca1\u6709\u5206\u533a\u7684\u88f8\u76d8\uff0c\u7559\u7ed9 Ceph \u4f7f\u7528\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"$ lsblk\nNAME   MAJ:MIN RM   SIZE RO TYPE MOUNTPOINT\nsda      8:0    0 931.5G  0 disk\n\u251c\u2500sda1   8:1    0     1M  0 part\n\u251c\u2500sda2   8:2    0   512M  0 part /boot\n\u2514\u2500sda3   8:3    0   931G  0 part /\nsdb      8:16   0 931.5G  0 disk\nsdc      8:32   0   3.7T  0 disk\nsdd      8:48   0   3.7T  0 disk\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"kubectl get nodes"})," \u53ef\u4ee5\u770b\u5230\u5df2\u7ecf\u5728 Kubernetes \u96c6\u7fa4\u4e2d\u7684\u8282\u70b9\uff1a"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"$ kubectl get nodes\nNAME      STATUS   ROLES    AGE   VERSION\ncloudbox  Ready    master   34d   v1.15.9-beta.0\nnode-0    Ready    <none>   12d   v1.15.9-beta.0\nnode-1    Ready    <none>   11d   v1.15.9-beta.0\nnode-2    Ready    <none>   11d   v1.15.9-beta.0\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u7136\u540e\u7ed9\u5bf9\u5e94\u7684\u8282\u70b9\u6253\u4e0a role=storage-node \u7684\u6807\u7b7e\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# \u6253\u6807\u7b7e\n$ kubectl label node node-0 role=storage-node\n$ kubectl label node node-1 role=storage-node\n$ kubectl label node node-2 role=storage-node\n\n# \u67e5\u770b\u6807\u7b7e\u5bf9\u5e94\u7684\u8282\u70b9\n$ kubectl get nodes -L role\nNAME       STATUS   ROLES    AGE   VERSION          ROLE\ncloudbox   Ready    master   34d   v1.15.9-beta.0\nnode-0     Ready    <none>   12d   v1.15.9-beta.0   storage-node\nnode-1     Ready    <none>   11d   v1.15.9-beta.0   storage-node\nnode-2     Ready    <none>   11d   v1.15.9-beta.0   storage-node\n"})}),"\n",(0,s.jsxs)(n.p,{children:["\u53e6\u5916\u6267\u884c ",(0,s.jsx)(n.code,{children:"climc host-list"})," \u547d\u4ee4(climc \u662f\u4e91\u5e73\u53f0\u7684\u547d\u4ee4\u884c\u5de5\u5177)\uff0c\u4e5f\u53ef\u4ee5\u770b\u5230\u8fd9 3 \u4e2a\u8282\u70b9\u4f5c\u4e3a Cloudpods \u7684\u8ba1\u7b97\u8282\u70b9\u52a0\u5165\u5230\u4e86\u4e91\u5e73\u53f0:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"$ climc host-list\n+--------------------------------------+----------+-------------------+----------------+--------------+-----------------------------+---------+---------+-------------+----------+-----------+------------+------------+--------------+------------+\n|                  ID                  |   Name   |    Access_mac     |   Access_ip    |   Ipmi_Ip    |         Manager_URI         | Status  | enabled | host_status | mem_size | cpu_count | node_count |     sn     | storage_type | host_type  |\n+--------------------------------------+----------+-------------------+----------------+--------------+-----------------------------+---------+---------+-------------+----------+-----------+------------+------------+--------------+------------+\n| 0d8023ad-ebf9-4a3c-8294-fd170f4ce5c6 | node-0   | 38:ea:a7:8d:94:78 | 172.16.254.127 | 172.16.254.2 | https://172.16.254.127:8885 | running | true    | online      | 128695   | 32        | 2          | 6CU3505M2G | rotate       | hypervisor |\n| c02470b3-9666-46f7-852e-9bda8074a72e | node-1   | ec:f4:bb:d7:c4:e0 | 172.16.254.124 | 172.16.254.5 | https://172.16.254.124:8885 | running | true    | online      | 96432    | 48        | 2          | 62CNF52    | rotate       | hypervisor |\n| 5811c2d9-2b45-47e4-8c08-a5d479d03009 | node-2   | d4:ae:52:7e:90:9c | 172.16.254.126 | 172.16.254.3 | https://172.16.254.126:8885 | running | true    | online      | 128723   | 24        | 2          | 8Q1PB3X    | rotate       | hypervisor |\n+--------------------------------------+----------+-------------------+----------------+--------------+-----------------------------+---------+---------+-------------+----------+-----------+------------+------------+--------------+------------+\n"})}),"\n",(0,s.jsx)(n.h3,{id:"\u90e8\u7f72-rook-\u7ec4\u4ef6",children:"\u90e8\u7f72 Rook \u7ec4\u4ef6"}),"\n",(0,s.jsx)(n.p,{children:"\u4e0b\u8f7d Rook \u76f8\u5173\u4ee3\u7801\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# clone rook \u6e90\u7801\n$ git clone --single-branch --branch release-1.7 https://github.com/rook/rook.git\n$ cd rook\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u90e8\u7f72 rook operator \u670d\u52a1\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# apply rook \u76f8\u5173 CRD\n$ cd cluster/examples/kubernetes/ceph/pre-k8s-1.16/\n$ kubectl apply -f crds.yaml\n\n# apply rook operator \u670d\u52a1\n$ cd ..\n$ kubectl apply -f common.yaml -f operator.yaml\n\n# \u67e5\u770b operator \u670d\u52a1\u7684\u72b6\u6001\uff0c\u7b49\u5f85 rook-ceph-operator pod \u53d8\u4e3a Running\n$ kubectl -n rook-ceph get pods\nNAME                                  READY   STATUS    RESTARTS   AGE\nrook-ceph-operator-68964f4b87-pc87m   1/1     Running   0          7m38s\n"})}),"\n",(0,s.jsx)(n.h3,{id:"\u521b\u5efa-ceph-\u96c6\u7fa4",children:"\u521b\u5efa ceph \u96c6\u7fa4"}),"\n",(0,s.jsxs)(n.p,{children:["\u9996\u5148\u6839\u636e\u81ea\u5df1\u7684\u73af\u5883\uff0c\u4fee\u6539 rook \u63d0\u4f9b\u7684 ",(0,s.jsx)(n.code,{children:"cluster.yaml"})," \u91cc\u9762\u7684\u5185\u5bb9\uff1a"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"$ cp cluster.yaml cluster-env.yaml\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u4e0b\u9762\u662f\u4fee\u6539\u540e\u7684 cluster.yaml \u548c cluster-env.yaml \u7684 diff \u5185\u5bb9\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"$ diff -u cluster.yaml cluster-env.yaml\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u8bf7\u6839\u636e\u81ea\u5df1\u7684\u8282\u70b9\u73af\u5883\u914d\u7f6e\uff0c\u53c2\u8003 diff \u4fee\u6539\uff0c\u9700\u8981\u6ce8\u610f\u7684\u5730\u65b9\u5982\u4e0b\uff1a"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["spec.image: \u6539\u4e3a registry.cn-beijing.aliyuncs.com/yunionio/ceph",":v14",".2.22 \uff0c\u8fd9\u91cc\u9700\u8981\u7528 v14 \u7248\u672c\u7684\u955c\u50cf\uff0c\u5bf9\u5e94\u7684 ceph \u7248\u672c\u4e3a nautilus\u3002\u5982\u679c\u8981\u4f7f\u7528\u66f4\u9ad8\u7248\u672c v16 \u7248\u672cceph\uff0c\u8bf7\u53c2\u8003\u4e0b\u6587 [\u4f7f\u7528 Pacific (v16) Ceph]\u3002"]}),"\n",(0,s.jsx)(n.li,{children:"spec.network.provider: \u6539\u4e3a host \uff0c\u8868\u793a ceph \u76f8\u5173\u5bb9\u5668\u4f7f\u7528 hostNetwork \uff0c\u8fd9\u6837\u624d\u80fd\u7ed9 Kubernetes \u96c6\u7fa4\u4e4b\u5916\u7684\u670d\u52a1\u4f7f\u7528"}),"\n",(0,s.jsx)(n.li,{children:"spec.placement: \u4fee\u6539\u4e86\u91cc\u9762\u7684 Kubernetes \u8c03\u5ea6\u7b56\u7565\uff0c\u8868\u793a\u628a ceph pod \u8c03\u5ea6\u5230 role=storage-node \u7684\u8282\u70b9\u4e0a"}),"\n",(0,s.jsxs)(n.li,{children:["spec.storage: \u8868\u793a\u5b58\u50a8\u7684\u914d\u7f6e","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"useAllNodes: \u6211\u4eec\u6307\u5b9a\u4e86role=storage-node \u7684\u8282\u70b9\u8fd0\u884c ceph\uff0c\u8be5\u503c\u5fc5\u987b\u8bbe\u7f6e\u4e3afalse"}),"\n",(0,s.jsx)(n.li,{children:"nodes: \u5206\u522b\u8bbe\u7f6e\u5404\u4e2a\u8282\u70b9\u7684\u5b58\u50a8\u8def\u5f84\uff0c\u53ef\u4ee5\u662f\u78c1\u76d8\u6216\u8005\u76ee\u5f55"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-diff",children:'--- cluster.yaml    2021-10-09 10:49:53.731596210 +0800\n+++ cluster-env.yaml    2021-10-09 17:50:01.859112585 +0800\n@@ -21,7 +21,7 @@\n     # versions running within the cluster. See tags available at https://hub.docker.com/r/ceph/ceph/tags/.\n     # If you want to be more precise, you can always use a timestamp tag such quay.io/ceph/ceph:v16.2.6-20210918\n     # This tag might not contain a new Ceph version, just security fixes from the underlying operating system, which will reduce vulnerabilities\n-    image: quay.io/ceph/ceph:v16.2.6\n+    image: registry.cn-beijing.aliyuncs.com/yunionio/ceph:v14.2.22\n     # Whether to allow unsupported versions of Ceph. Currently `nautilus`, `octopus`, and `pacific` are supported.\n     # Future versions such as `pacific` would require this to be set to `true`.\n     # Do not set to true in production.\n@@ -81,7 +81,7 @@\n     rulesNamespace: rook-ceph\n   network:\n     # enable host networking\n-    #provider: host\n+    provider: host\n     # enable the Multus network provider\n     #provider: multus\n     #selectors:\n@@ -135,22 +135,22 @@\n   # To control where various services will be scheduled by kubernetes, use the placement configuration sections below.\n   # The example under \'all\' would have all services scheduled on kubernetes nodes labeled with \'role=storage-node\' and\n   # tolerate taints with a key of \'storage-node\'.\n-#  placement:\n-#    all:\n-#      nodeAffinity:\n-#        requiredDuringSchedulingIgnoredDuringExecution:\n-#          nodeSelectorTerms:\n-#          - matchExpressions:\n-#            - key: role\n-#              operator: In\n-#              values:\n-#              - storage-node\n-#      podAffinity:\n-#      podAntiAffinity:\n-#      topologySpreadConstraints:\n-#      tolerations:\n-#      - key: storage-node\n-#        operator: Exists\n+  placement:\n+    all:\n+      nodeAffinity:\n+        requiredDuringSchedulingIgnoredDuringExecution:\n+          nodeSelectorTerms:\n+          - matchExpressions:\n+            - key: role\n+              operator: In\n+              values:\n+              - storage-node\n+      podAffinity:\n+      podAntiAffinity:\n+      topologySpreadConstraints:\n+      tolerations:\n+      - key: storage-node\n+        operator: Exists\n # The above placement information can also be specified for mon, osd, and mgr components\n #    mon:\n # Monitor deployments may contain an anti-affinity rule for avoiding monitor\n@@ -207,8 +207,8 @@\n #    osd: rook-ceph-osd-priority-class\n #    mgr: rook-ceph-mgr-priority-class\n   storage: # cluster level storage configuration and selection\n-    useAllNodes: true\n-    useAllDevices: true\n+    useAllNodes: false\n+    useAllDevices: false\n     #deviceFilter:\n     config:\n       # crushRoot: "custom-root" # specify a non-default root label for the CRUSH map\n@@ -219,17 +219,22 @@\n       # encryptedDevice: "true" # the default value for this option is "false"\n # Individual nodes and their config can be specified as well, but \'useAllNodes\' above must be set to false. Then, only the named\n # nodes below will be used as storage resources.  Each node\'s \'name\' field should match their \'kubernetes.io/hostname\' label.\n-    # nodes:\n-    #   - name: "172.17.4.201"\n-    #     devices: # specific devices to use for storage can be specified for each node\n-    #       - name: "sdb"\n-    #       - name: "nvme01" # multiple osds can be created on high performance devices\n-    #         config:\n-    #           osdsPerDevice: "5"\n-    #       - name: "/dev/disk/by-id/ata-ST4000DM004-XXXX" # devices can be specified using full udev paths\n-    #     config: # configuration can be specified at the node level which overrides the cluster level config\n-    #   - name: "172.17.4.301"\n-    #     deviceFilter: "^sd."\n+    nodes:\n+      - name: "node-0"\n+        devices: # specific devices to use for storage can be specified for each node\n+          - name: "sdb"\n+          - name: "sdc"\n+          - name: "sdd"\n+      - name: "node-1"\n+        devices:\n+          - name: "sdb"\n+          - name: "sdc"\n+          - name: "sdd"\n+      - name: "node-2"\n+        devices:\n+          - name: "sdb"\n+          - name: "sdc"\n+          - name: "sdd"\n     # when onlyApplyOSDPlacement is false, will merge both placement.All() and placement.osd\n     onlyApplyOSDPlacement: false\n   # The section for configuring management of daemon disruptions during upgrade or fencing.\n'})}),"\n",(0,s.jsxs)(n.p,{children:["\u7f16\u8f91\u597d ",(0,s.jsx)(n.code,{children:"cluster-env.yaml"})," \u540e\uff0c\u4f7f\u7528\u4e0b\u9762\u7684\u547d\u4ee4\u521b\u5efa ceph \u96c6\u7fa4\uff1a"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"$ kubectl apply -f cluster-env.yaml\ncephcluster.ceph.rook.io/rook-ceph created\n\n# \u67e5\u770b rook-ceph namespace \u91cc\u9762\u7684 pod \u5065\u5eb7\u72b6\u51b5\n$ kubectl -n rook-ceph get pods\nNAME                                                 READY   STATUS      RESTARTS   AGE\nrook-ceph-crashcollector-dl380p-55f6cc56c9-b8ghc     1/1     Running     0          3m3s\nrook-ceph-crashcollector-r710-7d8659858-mrqgq        1/1     Running     0          2m20s\nrook-ceph-crashcollector-r720xd-1-5b686487c5-hvzdb   1/1     Running     0          3m10s\nrook-ceph-csi-detect-version-ffdsf                   0/1     Completed   0          26m\nrook-ceph-mgr-a-759465b6c7-cslkp                     1/1     Running     0          3m13s\nrook-ceph-mon-a-657c4c6769-ljtr9                     1/1     Running     0          18m\nrook-ceph-mon-b-7db98b99d4-99pft                     1/1     Running     0          18m\nrook-ceph-mon-c-7f84fc475d-5v599                     1/1     Running     0          10m\nrook-ceph-operator-68964f4b87-pc87m                  1/1     Running     0          68m\nrook-ceph-osd-0-7cc5cb94cb-dxznm                     1/1     Running     0          2m32s\nrook-ceph-osd-1-f4d47ddf9-7vgh7                      1/1     Running     0          2m35s\nrook-ceph-osd-2-5d7667b8d8-d5tnp                     1/1     Running     0          2m20s\nrook-ceph-osd-3-c9c56cd77-8sbzj                      1/1     Running     0          2m32s\nrook-ceph-osd-4-88565589c-rnpmg                      1/1     Running     0          2m35s\nrook-ceph-osd-5-7d7c554b6c-pvsfx                     1/1     Running     0          2m35s\nrook-ceph-osd-6-6c7596c844-jg9qt                     1/1     Running     0          2m20s\nrook-ceph-osd-7-55f9987ddf-pjthz                     1/1     Running     0          2m32s\nrook-ceph-osd-8-6949b69dd6-685wp                     1/1     Running     0          2m20s\nrook-ceph-osd-prepare-dl380p-c6nc8                   0/1     Completed   0          3m3s\nrook-ceph-osd-prepare-r710-zkmjz                     0/1     Completed   0          3m3s\nrook-ceph-osd-prepare-r720xd-1-fswnf                 0/1     Completed   0          3m2s\n\n# \u67e5\u770b ceph \u96c6\u7fa4\u7684\u5065\u5eb7\u72b6\u51b5\n$ kubectl -n rook-ceph get cephcluster\nNAME        DATADIRHOSTPATH   MONCOUNT   AGE   PHASE   MESSAGE                        HEALTH\nrook-ceph   /var/lib/rook     3          29m   Ready   Cluster created successfully   HEALTH_OK\n"})}),"\n",(0,s.jsxs)(n.p,{children:["ceph \u96c6\u7fa4\u90e8\u7f72\u5b8c\u540e\uff0c\u6211\u4eec\u9700\u8981\u90e8\u7f72 ",(0,s.jsx)(n.code,{children:"toolbox.yaml"})," pod \u83b7\u53d6\u96c6\u7fa4\u8fde\u63a5\u4fe1\u606f\uff1a"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"$ kubectl apply -f toolbox.yaml\ndeployment.apps/rook-ceph-tools created\n\n$ kubectl -n rook-ceph get pods | grep tools\nrook-ceph-tools-885579f55-qpnhh                      1/1     Running     0          3m44s\n\n# \u8fdb\u5165 toolbox pod\n$ kubectl -n rook-ceph exec -it $(kubectl -n rook-ceph get pod -l \"app=rook-ceph-tools\" -o jsonpath='{.items[0].metadata.name}') -- bash\n# \u67e5\u770b mon_host \u4e3a: 172.16.254.126:6789,172.16.254.124:6789,172.16.254.127:6789\n[root@rook-ceph-tools-885579f55-qpnhh /]$ cat /etc/ceph/ceph.conf\n[global]\nmon_host = 172.16.254.126:6789,172.16.254.124:6789,172.16.254.127:6789\n\n[client.admin]\nkeyring = /etc/ceph/keyring\n\n# \u67e5\u770b keyring \u4e3a: AQBHTWFhFQzrORAALLIngo/OOTDdnUf4vNPRoA==\n[root@rook-ceph-tools-885579f55-qpnhh /]$ cat /etc/ceph/keyring\n[client.admin]\nkey = AQBHTWFhFQzrORAALLIngo/OOTDdnUf4vNPRoA==\n\n# \u67e5\u770b\u96c6\u7fa4\u5065\u5eb7\u72b6\u6001\n[root@rook-ceph-tools-885579f55-qpnhh /]$ ceph status\n  cluster:\n    id:     233cf123-7a1a-4a7b-b6db-1cee79ec752b\n    health: HEALTH_OK\n\n  services:\n    mon: 3 daemons, quorum a,b,c (age 38m)\n    mgr: a(active, since 33m)\n    osd: 9 osds: 9 up (since 33m), 9 in (since 34m); 30 remapped pgs\n\n  data:\n    pools:   1 pools, 256 pgs\n    objects: 0 objects, 0 B\n    usage:   57 MiB used, 20 TiB / 20 TiB avail\n    pgs:     226 active+clean\n             30  active+clean+remapped\n\n# \u67e5\u770b osd \u72b6\u6001\uff0c\u53ef\u4ee5\u53d1\u73b0\u5bf9\u5e94\u8282\u70b9\u7684\u8bbe\u5907\u90fd\u6dfb\u52a0\u4e86\u8fdb\u6765\n[root@rook-ceph-tools-885579f55-qpnhh /]$ ceph osd status\nID  HOST    USED  AVAIL  WR OPS  WR DATA  RD OPS  RD DATA  STATE\n 0  node-0  6172k  3725G      0        0       0        0   exists,up\n 1  node-1  7836k   279G      0        0       0        0   exists,up\n 2  node-2  5596k   931G      0        0       0        0   exists,up\n 3  node-0  6044k  3725G      0        0       0        0   exists,up\n 4  node-1  5980k   279G      0        0       0        0   exists,up\n 5  node-1  5980k   279G      0        0       0        0   exists,up\n 6  node-2  6236k  3726G      0        0       0        0   exists,up\n 7  node-0  7772k  3725G      0        0       0        0   exists,up\n 8  node-2  7836k  3726G      0        0       0        0   exists,up\n\n# \u521b\u5efa\u4e00\u4e2a cloudpods-test \u7684 pool \u7528\u4e8e\u540e\u9762\u7684\u865a\u62df\u673a\u6d4b\u8bd5\n[root@rook-ceph-tools-885579f55-qpnhh /]$ ceph osd pool create cloudpods-test 64 64\npool 'cloudpods-test' created\n\n# \u521d\u59cb\u5316\u8fd9\u4e2apool \u4e3a RBD\n[root@rook-ceph-tools-885579f55-qpnhh /]$ rbd pool init cloudpods-test\n\n[root@rook-ceph-tools-885579f55-qpnhh /]$ ceph osd lspools\n1 cloudpods-test\n"})}),"\n",(0,s.jsx)(n.h2,{id:"cloudpods-\u865a\u62df\u673a\u4f7f\u7528-rook-\u90e8\u7f72\u7684-ceph",children:"Cloudpods \u865a\u62df\u673a\u4f7f\u7528 Rook \u90e8\u7f72\u7684 Ceph"}),"\n",(0,s.jsx)(n.p,{children:"\u901a\u8fc7\u4e4b\u524d\u7684\u6b65\u9aa4\uff0c\u5df2\u7ecf\u4f7f\u7528 Rook \u5728 Kubernetes \u96c6\u7fa4\u91cc\u9762\u90e8\u7f72\u4e86 Ceph \u96c6\u7fa4\uff0c\u63a5\u4e0b\u6765\u5c06 Ceph \u96c6\u7fa4\u7684\u8fde\u63a5\u4fe1\u606f\u5bfc\u5165\u5230 Cloudpods \u79c1\u6709\u4e91\u5e73\u53f0\uff0c\u5c31\u53ef\u4ee5\u7ed9\u865a\u62df\u673a\u4f7f\u7528\u4e86\u3002"}),"\n",(0,s.jsx)(n.p,{children:"\u4ece\u4e4b\u524d\u7684\u6b65\u9aa4\u5f97\u5230 ceph \u7684\u8fde\u63a5\u4fe1\u606f\u5982\u4e0b\uff1a"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"mon_host: 172.16.254.126:6789,172.16.254.124:6789,172.16.254.127:6789"}),"\n",(0,s.jsx)(n.li,{children:"keyring: AQBHTWFhFQzrORAALLIngo/OOTDdnUf4vNPRoA=="}),"\n",(0,s.jsx)(n.li,{children:"rbd pool: cloudpods-test"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"\u7136\u540e\u767b\u5f55 cloudpods \u524d\u7aef\u521b\u5efa ceph rbd \u5b58\u50a8\u5e76\u4e14\u5173\u8054\u5bbf\u4e3b\u673a\uff0c\u64cd\u4f5c\u5982\u4e0b\uff1a"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"\u521b\u5efa\u540d\u4e3a rook-ceph \u7684\u5757\u5b58\u50a8\uff0c\u586b\u5165\u4e0a\u9762\u7684\u4fe1\u606f\uff1a"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:o(78354).Z+"",width:"1990",height:"1223"})}),"\n",(0,s.jsxs)(n.ol,{start:"2",children:["\n",(0,s.jsx)(n.li,{children:"\u9ed8\u8ba4\u521b\u5efa\u597d\u7684 rook-ceph \u5757\u5b58\u50a8\u4e3a\u79bb\u7ebf\u72b6\u6001\uff0c\u9700\u8981\u5173\u8054\u5e73\u53f0\u7684\u79c1\u6709\u4e91\u5bbf\u4e3b\u673a\uff0c\u5bbf\u4e3b\u673a\u4f1a\u63a2\u6d4b ceph \u96c6\u7fa4\u7684\u8fde\u901a\u6027\uff0c\u5e76\u4e14\u83b7\u53d6\u5bf9\u5e94\u7684 pool \u5bb9\u91cf\u4fe1\u606f\uff1a"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:o(58832).Z+"",width:"2264",height:"1045"})}),"\n",(0,s.jsxs)(n.ol,{start:"3",children:["\n",(0,s.jsx)(n.li,{children:"rook-ceph \u5757\u5b58\u50a8\u5173\u8054\u597d\u5bbf\u4e3b\u673a\u540e\uff0c\u72b6\u6001\u5c31\u4f1a\u53d8\u4e3a\u201c\u5728\u7ebf\u201d\uff0c\u5e76\u4e14\u83b7\u53d6\u5230\u4e86 20T \u7684\u5bb9\u91cf\uff1a"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:o(36251).Z+"",width:"2280",height:"834"})}),"\n",(0,s.jsxs)(n.ol,{start:"4",children:["\n",(0,s.jsxs)(n.li,{children:["\u521b\u5efa\u865a\u62df\u673a\u4f7f\u7528 ",(0,s.jsx)(n.code,{children:"rook-ceph"})," \u5b58\u50a8\uff0c\u8fd9\u91cc\u4e3b\u8981\u662f\u5728\u865a\u62df\u673a\u521b\u5efa\u9875\u9762\u6dfb\u52a0\u78c1\u76d8\uff0c\u9009\u62e9\u5b58\u50a8\u7c7b\u578b\u4e3a ",(0,s.jsx)(n.strong,{children:"Ceph RBD"}),"\uff1a"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:o(58947).Z+"",width:"2251",height:"799"})}),"\n",(0,s.jsxs)(n.ol,{start:"5",children:["\n",(0,s.jsx)(n.li,{children:"\u7b49\u5f85\u865a\u62df\u673a\u521b\u5efa\u5b8c\u6210\uff0c\u901a\u8fc7 vnc \u6216\u8005 ssh \u767b\u5f55\u865a\u62df\u673a\uff1a"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:o(84884).Z+"",width:"1580",height:"538"})}),"\n",(0,s.jsx)(n.p,{children:"\u53ef\u4ee5\u53d1\u73b0\u865a\u62df\u673a\u91cc\u9762\u6302\u8f7d\u4e86 /dev/sda(\u7cfb\u7edf\u76d8) \u548c /dev/sdb(\u6570\u636e\u76d8)\uff0c\u5e95\u5c42\u90fd\u4e3a ceph \u7684 RBD \u5757\u8bbe\u5907\uff0c\u56e0\u4e3a ceph \u5e95\u5c42\u5757\u8bbe\u5907\u7528\u7684\u673a\u68b0\u76d8\uff0c\u7528 dd \u7b80\u5355\u6d4b\u8bd5\u901f\u5ea6\u5728 99 MB/s \uff0c\u7b26\u5408\u9884\u671f\u3002"}),"\n",(0,s.jsxs)(n.ol,{start:"6",children:["\n",(0,s.jsx)(n.li,{children:"\u7136\u540e\u4f7f\u7528\u5e73\u53f0\u7684 climc \u547d\u4ee4\u67e5\u770b\u865a\u62df\u673a\u6240\u5728\u7684\u5bbf\u4e3b\u673a\uff0c\u53d1\u73b0\u865a\u62df\u673a ceph-test-vm \u8fd0\u884c\u5728 node-1 \u8ba1\u7b97\u8282\u70b9\u4e0a\uff0c\u540c\u65f6\u6539\u8282\u70b9\u4e5f\u662f Ceph \u96c6\u7fa4\u7684\u5b58\u50a8\u8282\u70b9\uff0c\u5b9e\u73b0\u4e86\u8d85\u878d\u5408\u7684\u67b6\u6784\uff1a"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"$ climc server-list --details --search ceph-test-vm\n+--------------------------------------+--------------+--------+---------------+--------+---------+------------+-----------+------------+---------+\n|                  ID                  |     Name     |  Host  |     IPs       |  Disk  | Status  | vcpu_count | vmem_size | Hypervisor | os_type |\n+--------------------------------------+--------------+--------+---------------+--------+---------+------------+-----------+------------+---------+\n| ffd8ec7c-1e2d-4427-89e0-81b6ce184185 | ceph-test-vm | node-1 | 172.16.254.252| 235520 | running | 2          | 2048      | kvm        | Linux   |\n+--------------------------------------+--------------+--------+---------------+--------+---------+------------+-----------+------------+---------+\n"})}),"\n",(0,s.jsx)(n.h2,{id:"\u5176\u5b83\u64cd\u4f5c",children:"\u5176\u5b83\u64cd\u4f5c"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\u5220\u9664 Rook \u90e8\u7f72\u7684 Ceph \u96c6\u7fa4\u8bf7\u53c2\u8003\uff1a",(0,s.jsx)(n.a,{href:"https://rook.io/docs/rook/v1.7/ceph-teardown.html",children:"Cleaning up a Cluster"})]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"\u4f7f\u7528-pacific-v16-ceph",children:"\u4f7f\u7528 Pacific (v16) Ceph"}),"\n",(0,s.jsx)(n.p,{children:"\u4e0a\u6587\u4ecb\u7ecd\u7684\u6d41\u7a0b\u9002\u5408\u90e8\u7f72 v14 \u7248\u672c\u7684ceph\uff0c\u4e3a\u4e86\u90e8\u7f72 v16 \u7248\u672c\u7684ceph\uff0c\u9996\u5148\u9700\u8981\u628a\u5f85\u90e8\u7f72\u7684 ceph \u955c\u50cf\u6539\u4e3a\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"registry.cn-beijing.aliyuncs.com/yunionio/ceph:v16.2.14\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u53e6\u5916\uff0c\u6bcf\u4e2a\u8ba1\u7b97\u8282\u70b9\u9ed8\u8ba4\u90e8\u7f72\u7684\u662fCentOS 7\u81ea\u5e26\u7684ceph-common\uff0c\u7248\u672c\u4e3a v10.2.5\u3002\u8be5\u7248\u672c\u7684 ceph-common \u5df2\u7ecf\u65e0\u6cd5\u8bbf\u95ee v16 ceph\u3002\u4e3a\u6b64\uff0c\u8fd8\u9700\u8981\u5347\u7ea7\u6bcf\u4e2a\u8ba1\u7b97\u8282\u70b9\u7684 ceph-common \u7248\u672c\u3002\u5177\u4f53\u65b9\u6cd5\u5982\u4e0b\uff1a"}),"\n",(0,s.jsx)(n.p,{children:"\u914d\u7f6e ceph rpm repo \u6587\u4ef6 /etc/yum.repos.d/ceph.repo, \u5185\u5bb9\u4e3a\uff1a"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"[ceph]\nname=Ceph packages for $basearch\nbaseurl=https://download.ceph.com/rpm-15.2.17/el7/$basearch\nenabled=1\npriority=2\ngpgcheck=1\ngpgkey=https://download.ceph.com/keys/release.asc\n\n[ceph-noarch]\nname=Ceph noarch packages\nbaseurl=https://download.ceph.com/rpm-15.2.17/el7/noarch\nenabled=1\npriority=2\ngpgcheck=1\ngpgkey=https://download.ceph.com/keys/release.asc\n\n[ceph-source]\nname=Ceph source packages\nbaseurl=https://download.ceph.com/rpm-15.2.17/el7/SRPMS\nenabled=0\npriority=2\ngpgcheck=1\ngpgkey=https://download.ceph.com/keys/release.asc\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u4fdd\u5b58 ceph.repo \u540e\uff0c\u6267\u884c\u5982\u4e0b\u547d\u4ee4\u5b89\u88c5 v15.2.17 \u7684 ceph-common:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"yum install -y ceph-common\n"})}),"\n",(0,s.jsx)(n.p,{children:"\u6ce8\uff1a\u56e0\u4e3aceph\u5b98\u65b9rpm\u672a\u63d0\u4f9bv16\u7684CentOS 7 rpms\uff0c\u56e0\u6b64\u5b89\u88c5v15\u7684rpms\uff0c\u8be5\u7248\u672c\u517c\u5bb9v16\u7684ceph-common\u3002"})]})}function p(e={}){const{wrapper:n}={...(0,c.a)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}},58832:(e,n,o)=>{o.d(n,{Z:()=>s});const s=o.p+"assets/images/attach-storage-host-e6fb10e6755e1f9ef19046834338de65.png"},78354:(e,n,o)=>{o.d(n,{Z:()=>s});const s=o.p+"assets/images/create-ceph-storage-ddc0f4174ac0860d59194f45f89a7397.png"},36251:(e,n,o)=>{o.d(n,{Z:()=>s});const s=o.p+"assets/images/rook-ceph-status-69a1e71545f0eef5414feb3ba6861e29.png"},84884:(e,n,o)=>{o.d(n,{Z:()=>s});const s=o.p+"assets/images/vm-running-2f5b9b9830c49e367f73421674747c96.png"},58947:(e,n,o)=>{o.d(n,{Z:()=>s});const s=o.p+"assets/images/vm-with-ceph-ec90c2558b448214e4de3b07c941cb74.png"},11151:(e,n,o)=>{o.d(n,{Z:()=>d,a:()=>t});var s=o(67294);const c={},r=s.createContext(c);function t(e){const n=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:t(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);