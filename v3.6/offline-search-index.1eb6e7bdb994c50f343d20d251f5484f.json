[{"body":"发布时间 2021-05-08 11:06:00\n ocadm 仓库地址: https://github.com/yunionio/ocadm\n1 commits to ocadm - v3.6.15 since this release.\nBug Fixes (1)  keepalived: 解决 高可用架构部署的默认网卡传递参数问题 (a0ce5d6, Zhang Dongliang)  ","excerpt":"发布时间 2021-05-08 11:06:00\n ocadm 仓库地址: …","ref":"/v3.6/zh/docs/changelog/release-3.6/3-6-15/","title":"v3.6.15"},{"body":"发布时间 2021-05-06 15:31:56\n onecloud 仓库地址: https://github.com/yunionio/onecloud\n35 commits to onecloud - v3.6.14 since this release.\nAnsibleserver (1)  wait zombie subprocesses (42ec59e81, Yousong Zhou)  Bug Fixes (30)  require password for imported user (c3d0b0fe1, Qiu Jian) avoid host worker is locked when image cache is deleted (adff20026, Qu Xuan) add options for pre allow ip add (170b37374, Qu Xuan) avoid panic (d43e645ed, Qu Xuan) add region id params (951e9218c, Qu Xuan) add rbdcli commond for debug (2ca8d0f7e, Qu Xuan) baremetal: baremetal ipmi probe reset link up state (906a591f0, Qiu Jian) baremetal,esxiagent: no cloudroot user initialized (da585a7b3, Qiu Jian) common: add debug info for lock (91141d643, Qu Xuan) esxi: prevent fake template and real template from duplication (ed676427d, rainzm) keystone: tag list for keystone service (8504d364f, Qu Xuan) region: account arrears (9dfb23c28, Qu Xuan) region: avoid panic when sync resources (7c90d219b, Qu Xuan) region: Refuse to recommend the corresponding network for the ip that crosses the limit (b595f59ef, rainzm) region: add egress_mbps params for lb (df79388de, Qu Xuan) region: add all.servers.any_pool/all.hosts.any_pool metrics (da0a7c7b6, Qiu Jian) region: make cloudprovider sync worker configurable (46517ebd1, rainzm) region: allow owner to operate snapshotpolicy cache (b95b553b9, rainzm) region: avoid using LocalTaskworker in time-consuming synchronization of cloudaccount (c0ba43e5f, rainzm) region: optimized vm account name code (824fc247a, Qu Xuan) region: avoid panic when sync aliyun networks (e1c1c0b84, Qu Xuan) region: fetch cached image from glance by default (3adae60e2, Zexi Li) region: vm list order by disk size (09f44d79a, Qu Xuan) region: avoid assign vm ip addr not effect (e82392107, Qu Xuan) region: make SScheduledTaskLabel implement IJointModelManager (75a007ea1, rainzm) region: qcloud redis sync fix (9464fbe6b, tangbin) region: use special localtask to run time-consuming provider synchronization task (aa539bff9, rainzm) region: tag list key case insensitive (1dc421a6d, Qu Xuan) region: download cached image from source host before migrating (243953ba6, Zexi Li) region: avoid network create failed when vpc is ok but wire not sync (cfef1fe2a, Qu Xuan)  Features (4)  arm64,build: arm 编译时,不编译 rbdcli (aebe35a85, Zhang Dongliang) region: support to specify zone for the created wire (f3ae127f2, rainzm) region: support creating a network with a native vmware network name (07292089f, rainzm) region: increase the log for debugging when syncing cloudimage (e13885e22, rainzm)   kubecomps 仓库地址: https://github.com/yunionio/kubecomps\n1 commits to kubecomps - v3.6.14 since this release.\nBug Fixes (1)  kubeserver: cluster ca and key field nullable deleted (db982b7, Zexi Li)   ocadm 仓库地址: https://github.com/yunionio/ocadm\n1 commits to ocadm - v3.6.14 since this release.\nFeatures (1)  keepalived,ha: 新增 keepalived_interface 变量支持,以便在安装高可用多网卡情况下支持非默认网卡绑定 vip (2027909, Zhang Dongliang)  ","excerpt":"发布时间 2021-05-06 15:31:56\n onecloud 仓库地址: …","ref":"/v3.6/zh/docs/changelog/release-3.6/3-6-14/","title":"v3.6.14"},{"body":"发布时间 2021-04-16 12:00:57\n onecloud 仓库地址: https://github.com/yunionio/onecloud\n24 commits to onecloud - v3.6.13 since this release.\nBug Fixes (21)  private cloud sku attached disk count (38d23b073, Qu Xuan) aliyun lb charge type (59e153422, Qu Xuan) actions domain filter by project doamin id (85f6e95c1, Qu Xuan) baremetal: use command timeout context replace timeout command (b55c2f7d2, Zexi Li) baremetal-agent: baremetal will probe status in status unknown (8a71e73af, Qiu Jian) cloudcommon: unify OS_ARCH constants (85f85e394, Zexi Li) cloudcommon: use rbac authentication dedicated to the list interface in GetModelProperty (2bf31dbd3, rainzm) esxi: correctly set the imagePath outside the if block (5fdde01be, rainzm) host: detect ovs version (ab0c6f128, Zexi Li) host: update host metric tags when server or host changeowner (95a03ad58, zhaoxiangchun) host-deployer: mkfs.ext4 add ‘-T largefile’ option (35d8cba97, Zexi Li) keystone: role_assignment effective list ignore groups without user (2ee1af186, Qiu Jian) readme: rename OneCloud to YunionCloud (b4f5f1a99, Zexi Li) region: purge instancesnapshot when purging guest (a14ab9820, rainzm) region: avoid refreshing when checking the image (be065e872, rainzm) region: allow ipmi probe in status unknown (4c27add0b, Qiu Jian) region: guest sync eip fix (d238540dc, tangbin) region: guest associate eip checking fix (fdd0bf77e, tangbin) region: sync baremetal desc before do ipmi probing (bd69dc44d, Qiu Jian) region: decouple region and etcd service (aa7c5f1b1, Zexi Li) region: remove i18n lock and logs (14e537fc6, Qiu Jian)  Features (2)  fetcherfs: make rpm and deb package (adaa7fa2c, Zexi Li) region: allow to update account with provider vmware (62a4bce19, rainzm)  Vpcagent (1)  ovn: fix port match condition formation (94d2bc456, Yousong Zhou)   kubecomps 仓库地址: https://github.com/yunionio/kubecomps\n1 commits to kubecomps - v3.6.13 since this release.\nBug Fixes (1)  kubeserver: import cluster input data unmarshal error (d033e53, Zexi Li)  ","excerpt":"发布时间 2021-04-16 12:00:57\n onecloud 仓库地址: …","ref":"/v3.6/zh/docs/changelog/release-3.6/3-6-13/","title":"v3.6.13"},{"body":"发布时间 2021-04-06 08:18:55\n onecloud 仓库地址: https://github.com/yunionio/onecloud\n11 commits to onecloud - v3.6.12 since this release.\nBug Fixes (9)  adjust primary key length when sqlchemy utf8 default to utf8mb4 (d090d76f9, Qiu Jian) new aws region (d6a0764b2, Qu Xuan) time sync duration (e841a4214, Qu Xuan) baremetal: sas2iru parse line (aa9ad9fe0, Zexi Li) esxi: determine whether the disk is a root disk more reasonably (4cf674992, rainzm) esxi: add ListPath for storage and use it to check iso (aede49450, rainzm) hostman: recycle local disk file when rebuilding root (1333d39c6, Qiu Jian) region: add usage cache, speedup response (d7ff1314e, Qiu Jian) region: allow ipmi probe when probe fail (615cb1e33, Qiu Jian)  Features (1)  esxi: change parameters for NewDiskDev and avoid unnecessary deploy (5565bb306, rainzm)  Others (1)  response scope-specific metrics (dcb8898c0, Qiu Jian)  ","excerpt":"发布时间 2021-04-06 08:18:55\n onecloud 仓库地址: …","ref":"/v3.6/zh/docs/changelog/release-3.6/3-6-12/","title":"v3.6.12"},{"body":"发布时间 2021-04-02 12:52:44\n onecloud 仓库地址: https://github.com/yunionio/onecloud\n22 commits to onecloud - v3.6.11 since this release.\nBug Fixes (17)  vendor update (73cda1d90, Qu Xuan) avoid listener worker leak (0c904591c, Qu Xuan) sku zone (2f7ee9fc7, Qu Xuan) cloudaccount auto sync (1c1fab0ef, Qu Xuan) account auto sync time (71171ed0d, Qu Xuan) remove qcloud region and zone prefix (0ee42cffe, Qu Xuan) baremetal: megactl driver fail to find device by key (be71185b1, Qiu Jian) build: build telegraf-raid-plugin (14bd5def5, Zexi Li) esxi: be compatible with disconnected host (5e8549b30, rainzm) host: arm vm virtio-net-pci without addr (4c83b1af4, Zexi Li) host: modification of netio collection field of local virtual machine (288927928, zhaoxiangchun) image: update min_disk of iso image (65748b374, Qiu Jian) monitor: filter alertquery result according to onecloud resources (2df45f0a3, zhaoxiangchun) monitor: modify onecloud replacement code (04f4d036c, zhaoxiangchun) monitor: alertQuery fix (d7380f3ec, zhaoxiangchun) region: add more usage metrics, e.g. ports.eip, servers.last_week, pending_delete_servers.last_week (5261b52b8, Qiu Jian) region: show storage capacity to project users (45d219ac5, Qiu Jian)  Features (2)  region: disks and eip delete with server (44ed68493, Qu Xuan) region: add server delete options (1b1cccab9, Qu Xuan)  Others (2)  fix(monitor):修复监控总览图标钻取后返回数据异常的问题 (88d1f93e3, zhaoxiangchun) (fix) region: qcloud elb https listener create fix (08b74642f, tangbin)  Vpcagent (1)  ovn: fix qos for eip upload (5b2195858, Yousong Zhou)   kubecomps 仓库地址: https://github.com/yunionio/kubecomps\n1 commits to kubecomps - v3.6.11 since this release.\nBug Fixes (1)  kubeserver: make system cluster resource getable (be80724, Zexi Li)   ocadm 仓库地址: https://github.com/yunionio/ocadm\n1 commits to ocadm - v3.6.11 since this release.\nBug Fixes (1)  set operator imagePullPolicy IfNotPresent (7258d95, Zexi Li)   onecloud-operator 仓库地址: https://github.com/yunionio/onecloud-operator\n1 commits to onecloud-operator - v3.6.11 since this release.\nBug Fixes (1)  access_url of common service config (49c0768, Zexi Li)  ","excerpt":"发布时间 2021-04-02 12:52:44\n onecloud 仓库地址: …","ref":"/v3.6/zh/docs/changelog/release-3.6/3-6-11/","title":"v3.6.11"},{"body":"Release time: 2021-03-23 14:17:23\n onecloud Repository: https://github.com/yunionio/onecloud\n43 commits to onecloud - v3.6.10 since this release.\nBug Fixes (29)  sync cloud tags when set tags (9d1c0dbd9, Qu Xuan) optimized bucket tag (5910ac16c, Qu Xuan) add index for image_type (c5c00f38b, Qu Xuan) change rds config skip zone check (0285e7735, Qu Xuan) avoid panic when use idc vpc (be2e979c9, Qu Xuan) skip zone check when rds change config (32623f7c7, Qu Xuan) sync new project for azure resource group (d7a738843, Qu Xuan) tag sync (0b2945131, Qu Xuan) avoid stop or start vm failed (a7b3b1cf4, Qu Xuan) qcloud bucket refer (cdd209b59, Qu Xuan) build: build arm64 image (4032ae669, Zexi Li) build: DOCKER_CLI_EXPERIMENTAL=enabled (2d53b542d, Zexi Li) host: ignore parted resize disk unknown partition table error (546f2fcfa, Zexi Li) hostdeployer: windows rootfs umount leak (cc1b6a2d6, Zexi Li) keystone: update default role associated policy name (845d9a1dc, Qiu Jian) keystone: allow joint projects across domains by default (7de3adac3, Qiu Jian) keystone: adjust default system policy names (141196103, Qiu Jian) log: add filters to baremetal event logs (b9e0c22b2, Qiu Jian) monitor: fix monitor export err (b46f95ae7, zhaoxiangchun) notify: enable filter of contact type ‘email’ and ‘mobile’ (a2faac769, rainzm) region: Compatible with messages that have no recipient and contact information (10f0e0c8b, rainzm) region: cloud provider filter by domain_id ignore private case (0f9f2f6ee, Qiu Jian) region: network eip stats not correct (d44327998, Qiu Jian) region: fail to update network gateway (112e7aac8, Qiu Jian) region: cloud provider filter by domain (22486c31b, Qiu Jian) region: check whether guest is nil (024c14d96, rainzm) region: including domain info in project-role results (538097ef7, Qiu Jian) region: scoped policy filter by project id (6afe83e47, Qiu Jian) telegraf: megactl raid add rebuild status (9da39105f, zhaoxiangchun)  Etcd (1)  fix “fatal error: concurrent map writes” (bc50f0948, Yousong Zhou)  Features (6)  build: make multi arch manifest docker image (55431b87b, Zexi Li) esxi: update guest os info (bfb01f563, rainzm) host: adjust qemu args to support aarch64 (ab00f0140, Zexi Li) region: send webhook message when changing ipaddr (33cb189cb, rainzm) region: filter schedtags from cloudprovider_id (9d3c44fe9, rainzm) region: increase the network number and host number limit when recommending the network (4f462d614, rainzm)  Others (5)  fix(region) qcloud multi zone instance sync account fix (5145f1250, tangbin) feat(region) qcloud redis support multi zones (acd7765b3, tangbin) host 编译跨平台兼容 (ec3909af5, Zhang Dongliang) copyright update brand_cn\u0026brand_en fix (31fce9fb7, tangbin) infos copyright add brand_en\u0026brand_cn (695139c04, tangbin)  Region (2)  fix setting nic index (b4a4cd61d, Yousong Zhou) attachnetwork: allow attach by network name (02022c4c2, Yousong Zhou)   kubecomps Repository: https://github.com/yunionio/kubecomps\n1 commits to kubecomps - v3.6.10 since this release.\nFeatures (1)  build: support arm64 build (e095428, Zexi Li)   notify-plugins Repository: https://github.com/yunionio/notify-plugins\n1 commits to notify-plugins - v3.6.10 since this release.\nBug Fixes (1)  build: build arm64 image (3a1f881, Zexi Li)   ocadm Repository: https://github.com/yunionio/ocadm\n3 commits to ocadm - v3.6.10 since this release.\nBug Fixes (2)  cluster: set OS_PROJECT_DOMAIN of cluster auth info (37c8b46, Zexi Li) preflight: more accurate of mysql grant error (2f006f3, Zexi Li)  Features (1)  build: 增加arm 下编译 ocadm deb 的步骤(make deb)； 统一跨平台metrics-server 的 tag 名称；升级 k8s-sidecar 到 0.1.275 (ddf0777, Zhang Dongliang)   onecloud-operator Repository: https://github.com/yunionio/onecloud-operator\n5 commits to onecloud-operator - v3.6.10 since this release.\nBug Fixes (4)  update vendor (334e0bc, Qiu Jian) default policy name should be separated by dash (9e50165, Qiu Jian) monitor: raid卡监控规则status过滤参数调整 (69eac28, zhaoxiangchun) ovn: change ovn image to support arm (7d29d32, Zexi Li)  Features (1)  build: support multi arch docker image (76aab36, Zexi Li)   onecloud-service-operator Repository: https://github.com/yunionio/onecloud-service-operator\n1 commits to onecloud-service-operator - v3.6.10 since this release.\nFeatures (1)  build: support arm64 build (3f41fdf, Zexi Li)   sdnagent Repository: https://github.com/yunionio/sdnagent\n4 commits to sdnagent - v3.6.10 since this release.\nBuild (2)  note on deploying ovs, ovn components (ba1147a, Yousong Zhou) reword README.md for deploying eipgw (fb516c4, Yousong Zhou)  Features (1)  build: make multi arch manifest docker image (fb7799d, Zexi Li)  Ovn (1)  mapped: fix possible traffic loop across different vpcs (2a45ce1, Yousong Zhou)  ","excerpt":"Release time: 2021-03-23 14:17:23\n onecloud Repository: …","ref":"/v3.6/en/docs/changelog/release-3.6/3-6-10/","title":"v3.6.10"},{"body":"发布时间 2021-03-23 14:17:23\n onecloud 仓库地址: https://github.com/yunionio/onecloud\n43 commits to onecloud - v3.6.10 since this release.\nBug Fixes (29)  sync cloud tags when set tags (9d1c0dbd9, Qu Xuan) optimized bucket tag (5910ac16c, Qu Xuan) add index for image_type (c5c00f38b, Qu Xuan) change rds config skip zone check (0285e7735, Qu Xuan) avoid panic when use idc vpc (be2e979c9, Qu Xuan) skip zone check when rds change config (32623f7c7, Qu Xuan) sync new project for azure resource group (d7a738843, Qu Xuan) tag sync (0b2945131, Qu Xuan) avoid stop or start vm failed (a7b3b1cf4, Qu Xuan) qcloud bucket refer (cdd209b59, Qu Xuan) build: build arm64 image (4032ae669, Zexi Li) build: DOCKER_CLI_EXPERIMENTAL=enabled (2d53b542d, Zexi Li) host: ignore parted resize disk unknown partition table error (546f2fcfa, Zexi Li) hostdeployer: windows rootfs umount leak (cc1b6a2d6, Zexi Li) keystone: update default role associated policy name (845d9a1dc, Qiu Jian) keystone: allow joint projects across domains by default (7de3adac3, Qiu Jian) keystone: adjust default system policy names (141196103, Qiu Jian) log: add filters to baremetal event logs (b9e0c22b2, Qiu Jian) monitor: fix monitor export err (b46f95ae7, zhaoxiangchun) notify: enable filter of contact type ‘email’ and ‘mobile’ (a2faac769, rainzm) region: Compatible with messages that have no recipient and contact information (10f0e0c8b, rainzm) region: cloud provider filter by domain_id ignore private case (0f9f2f6ee, Qiu Jian) region: network eip stats not correct (d44327998, Qiu Jian) region: fail to update network gateway (112e7aac8, Qiu Jian) region: cloud provider filter by domain (22486c31b, Qiu Jian) region: check whether guest is nil (024c14d96, rainzm) region: including domain info in project-role results (538097ef7, Qiu Jian) region: scoped policy filter by project id (6afe83e47, Qiu Jian) telegraf: megactl raid add rebuild status (9da39105f, zhaoxiangchun)  Etcd (1)  fix “fatal error: concurrent map writes” (bc50f0948, Yousong Zhou)  Features (6)  build: make multi arch manifest docker image (55431b87b, Zexi Li) esxi: update guest os info (bfb01f563, rainzm) host: adjust qemu args to support aarch64 (ab00f0140, Zexi Li) region: send webhook message when changing ipaddr (33cb189cb, rainzm) region: filter schedtags from cloudprovider_id (9d3c44fe9, rainzm) region: increase the network number and host number limit when recommending the network (4f462d614, rainzm)  Others (5)  fix(region) qcloud multi zone instance sync account fix (5145f1250, tangbin) feat(region) qcloud redis support multi zones (acd7765b3, tangbin) host 编译跨平台兼容 (ec3909af5, Zhang Dongliang) copyright update brand_cn\u0026brand_en fix (31fce9fb7, tangbin) infos copyright add brand_en\u0026brand_cn (695139c04, tangbin)  Region (2)  fix setting nic index (b4a4cd61d, Yousong Zhou) attachnetwork: allow attach by network name (02022c4c2, Yousong Zhou)   kubecomps 仓库地址: https://github.com/yunionio/kubecomps\n1 commits to kubecomps - v3.6.10 since this release.\nFeatures (1)  build: support arm64 build (e095428, Zexi Li)   notify-plugins 仓库地址: https://github.com/yunionio/notify-plugins\n1 commits to notify-plugins - v3.6.10 since this release.\nBug Fixes (1)  build: build arm64 image (3a1f881, Zexi Li)   ocadm 仓库地址: https://github.com/yunionio/ocadm\n3 commits to ocadm - v3.6.10 since this release.\nBug Fixes (2)  cluster: set OS_PROJECT_DOMAIN of cluster auth info (37c8b46, Zexi Li) preflight: more accurate of mysql grant error (2f006f3, Zexi Li)  Features (1)  build: 增加arm 下编译 ocadm deb 的步骤(make deb)； 统一跨平台metrics-server 的 tag 名称；升级 k8s-sidecar 到 0.1.275 (ddf0777, Zhang Dongliang)   onecloud-operator 仓库地址: https://github.com/yunionio/onecloud-operator\n5 commits to onecloud-operator - v3.6.10 since this release.\nBug Fixes (4)  update vendor (334e0bc, Qiu Jian) default policy name should be separated by dash (9e50165, Qiu Jian) monitor: raid卡监控规则status过滤参数调整 (69eac28, zhaoxiangchun) ovn: change ovn image to support arm (7d29d32, Zexi Li)  Features (1)  build: support multi arch docker image (76aab36, Zexi Li)   onecloud-service-operator 仓库地址: https://github.com/yunionio/onecloud-service-operator\n1 commits to onecloud-service-operator - v3.6.10 since this release.\nFeatures (1)  build: support arm64 build (3f41fdf, Zexi Li)   sdnagent 仓库地址: https://github.com/yunionio/sdnagent\n4 commits to sdnagent - v3.6.10 since this release.\nBuild (2)  note on deploying ovs, ovn components (ba1147a, Yousong Zhou) reword README.md for deploying eipgw (fb516c4, Yousong Zhou)  Features (1)  build: make multi arch manifest docker image (fb7799d, Zexi Li)  Ovn (1)  mapped: fix possible traffic loop across different vpcs (2a45ce1, Yousong Zhou)  ","excerpt":"发布时间 2021-03-23 14:17:23\n onecloud 仓库地址: …","ref":"/v3.6/zh/docs/changelog/release-3.6/3-6-10/","title":"v3.6.10"},{"body":"Release time: 2021-02-25 12:59:00\n onecloud Repository: https://github.com/yunionio/onecloud\n9 commits to onecloud - v3.4.16 since this release.\nBug Fixes (9)  apigateway: add enable_quota_check and return-domain-list attributes to fe params (833a8058d, Qiu Jian) cloudevent: optimized cloudevent sql (7453b5a4a, Qu Xuan) host-deployer: remove escape character on windows passwd (97167be07, wanyaoqi) region: avoid not sync dns zone (105157dd2, Qu Xuan) region: secgroup clone set status (e5e9d5465, Qu Xuan) region: add option auto reconcile backup servers (709daa66d, wanyaoqi) region: delete virtual nics with network (2cbb4f978, Qu Xuan) region: add azure new region (7815cb0a0, Qu Xuan) region: secgroup priority fix (0722788a5, Qu Xuan)  ","excerpt":"Release time: 2021-02-25 12:59:00\n onecloud Repository: …","ref":"/v3.6/en/docs/changelog/release-3.4/3-4-16/","title":"v3.4.16"},{"body":"发布时间 2021-02-25 12:59:00\n onecloud 仓库地址: https://github.com/yunionio/onecloud\n9 commits to onecloud - v3.4.16 since this release.\nBug Fixes (9)  apigateway: add enable_quota_check and return-domain-list attributes to fe params (833a8058d, Qiu Jian) cloudevent: optimized cloudevent sql (7453b5a4a, Qu Xuan) host-deployer: remove escape character on windows passwd (97167be07, wanyaoqi) region: avoid not sync dns zone (105157dd2, Qu Xuan) region: secgroup clone set status (e5e9d5465, Qu Xuan) region: add option auto reconcile backup servers (709daa66d, wanyaoqi) region: delete virtual nics with network (2cbb4f978, Qu Xuan) region: add azure new region (7815cb0a0, Qu Xuan) region: secgroup priority fix (0722788a5, Qu Xuan)  ","excerpt":"发布时间 2021-02-25 12:59:00\n onecloud 仓库地址: …","ref":"/v3.6/zh/docs/changelog/release-3.4/3-4-16/","title":"v3.4.16"},{"body":"Release time: 2021-01-27 16:24:13\n onecloud Repository: https://github.com/yunionio/onecloud\n9 commits to onecloud - v3.4.15 since this release.\nBug Fixes (8)  cloudcommon: missing set_meta opslog (#9918) (ce630362f, Jian Qiu) host: fix wait time after mount fuse fs (44a135bba, wanyaoqi) keystone: user create without password can login with any password (ec9631f99, Qiu Jian) notify: add a time limit for resending notifications (ecb169d9f, rainzm) region: avoid clean all rules when sync secgroups (60dad1582, Qu Xuan) region: cloudaccount: allow only one sync func in flight (571d2d297, Yousong Zhou) region: aws elb backendgroup sync bugfix (7b47c9bb8, tangbin) region: optimized secgroup rule sync (08d969baf, Qu Xuan)  Others (1)  loadbalancer add lb purge validate (f05a913cb, tangbin)   notify-plugins Repository: https://github.com/yunionio/notify-plugins\n1 commits to notify-plugins - v3.4.15 since this release.\nFeatures (1)  robot: support mutli WebhookPrefix (e3ce515, rainzm)  ","excerpt":"Release time: 2021-01-27 16:24:13\n onecloud Repository: …","ref":"/v3.6/en/docs/changelog/release-3.4/3-4-15/","title":"v3.4.15"},{"body":"发布时间 2021-01-27 16:24:13\n onecloud 仓库地址: https://github.com/yunionio/onecloud\n9 commits to onecloud - v3.4.15 since this release.\nBug Fixes (8)  cloudcommon: missing set_meta opslog (#9918) (ce630362f, Jian Qiu) host: fix wait time after mount fuse fs (44a135bba, wanyaoqi) keystone: user create without password can login with any password (ec9631f99, Qiu Jian) notify: add a time limit for resending notifications (ecb169d9f, rainzm) region: avoid clean all rules when sync secgroups (60dad1582, Qu Xuan) region: cloudaccount: allow only one sync func in flight (571d2d297, Yousong Zhou) region: aws elb backendgroup sync bugfix (7b47c9bb8, tangbin) region: optimized secgroup rule sync (08d969baf, Qu Xuan)  Others (1)  loadbalancer add lb purge validate (f05a913cb, tangbin)   notify-plugins 仓库地址: https://github.com/yunionio/notify-plugins\n1 commits to notify-plugins - v3.4.15 since this release.\nFeatures (1)  robot: support mutli WebhookPrefix (e3ce515, rainzm)  ","excerpt":"发布时间 2021-01-27 16:24:13\n onecloud 仓库地址: …","ref":"/v3.6/zh/docs/changelog/release-3.4/3-4-15/","title":"v3.4.15"},{"body":"Release time: 2021-01-15 10:42:54\n onecloud Repository: https://github.com/yunionio/onecloud\n1 commits to onecloud - v3.4.14 since this release.\nBug Fixes (1)  region: AWS buckets in us-east-1 have null location (0b7a4f08e, Qiu Jian)  ","excerpt":"Release time: 2021-01-15 10:42:54\n onecloud Repository: …","ref":"/v3.6/en/docs/changelog/release-3.4/3-4-14/","title":"v3.4.14"},{"body":"发布时间 2021-01-15 10:42:54\n onecloud 仓库地址: https://github.com/yunionio/onecloud\n1 commits to onecloud - v3.4.14 since this release.\nBug Fixes (1)  region: AWS buckets in us-east-1 have null location (0b7a4f08e, Qiu Jian)  ","excerpt":"发布时间 2021-01-15 10:42:54\n onecloud 仓库地址: …","ref":"/v3.6/zh/docs/changelog/release-3.4/3-4-14/","title":"v3.4.14"},{"body":"Release time: 2021-01-13 17:02:33\n onecloud Repository: https://github.com/yunionio/onecloud\n10 commits to onecloud - v3.4.13 since this release.\nBug Fixes (7)  climc: host add netif add params bridge/interface (c5dd4389d, wanyaoqi) esxiagent: nicIndex should be incremented (a4dcc91d0, rainzm) host-deployer: add log line on blkid failed (a66c1aa1b, wanyaoqi) notify: inject domain info in ReceiverManager.FetchOwnerId (9b993f1a9, rainzm) region: server start check host memory is enough (18a751548, wanyaoqi) region: omit vpc quota check if vpc created by owner (d3ad4967a, Qiu Jian) region,host: sync status check block jobs (edba3c3df, wanyaoqi)  Features (2)  db: progressive inspection when determining the required scope (0e4ea782e, rainzm) region: stop guest before freeze (b3285aebc, wanyaoqi)  Guest_deploy_task (1)  log other deploy details with i18n (559d30afa, Yousong Zhou)  ","excerpt":"Release time: 2021-01-13 17:02:33\n onecloud Repository: …","ref":"/v3.6/en/docs/changelog/release-3.4/3-4-13/","title":"v3.4.13"},{"body":"发布时间 2021-01-13 17:02:33\n onecloud 仓库地址: https://github.com/yunionio/onecloud\n10 commits to onecloud - v3.4.13 since this release.\nBug Fixes (7)  climc: host add netif add params bridge/interface (c5dd4389d, wanyaoqi) esxiagent: nicIndex should be incremented (a4dcc91d0, rainzm) host-deployer: add log line on blkid failed (a66c1aa1b, wanyaoqi) notify: inject domain info in ReceiverManager.FetchOwnerId (9b993f1a9, rainzm) region: server start check host memory is enough (18a751548, wanyaoqi) region: omit vpc quota check if vpc created by owner (d3ad4967a, Qiu Jian) region,host: sync status check block jobs (edba3c3df, wanyaoqi)  Features (2)  db: progressive inspection when determining the required scope (0e4ea782e, rainzm) region: stop guest before freeze (b3285aebc, wanyaoqi)  Guest_deploy_task (1)  log other deploy details with i18n (559d30afa, Yousong Zhou)  ","excerpt":"发布时间 2021-01-13 17:02:33\n onecloud 仓库地址: …","ref":"/v3.6/zh/docs/changelog/release-3.4/3-4-13/","title":"v3.4.13"},{"body":"Release time: 2020-12-29 03:01:23\n onecloud Repository: https://github.com/yunionio/onecloud\n34 commits to onecloud - v3.4.12 since this release.\nBug Fixes (23)  baremetal: clear jbod disks do PDMakeGood (ec5995da4, Zexi Li) cloudevent,devtool: missing metadata table (df7d68e40, Qiu Jian) host: telegraf listen on local ipv4 address explicitly (c3fd4937d, Qiu Jian) host: add print migrate progress info (cf8b54839, wanyaoqi) keystone: always upload\u0026refresh service config whenever service restart (9561c0c8d, Qiu Jian) mcclient: options: webconsole: fix passing ssh port (2add6fc1f, Yousong Zhou) monitor: other servier create alert add used_by param as a agreement (b01a477cb, –global) region: do not change disk status on migrating (a898d7609, wanyaoqi) region: eip_allocate_task: set eip status allocate_fail on task failure (5b0247a35, Yousong Zhou) region: add huawei gpssd desc (1ec3d6ddf, Qu Xuan) region: fix openstack instance os type (db60e37c4, Qu Xuan) region: lbbackend: better error reporting for finding influxdb info (4ac56f7fc, Yousong Zhou) region: guest to create input keep billing info (35c0e52de, wanyaoqi) region: openstack network is regional (869744d1b, Qu Xuan) region: sync servers (c069179ad, Qu Xuan) region: optimized disk allocate sched failed log (cd9b632d0, Qu Xuan) region: guestnetworks: use net calculated mtu (995b24c31, Yousong Zhou) region,baremetal: pxe net reuse converted server access ip (014170e74, Zexi Li) region,baremetal: choose candidate network not according by types (3da4dd195, Zexi Li) region,climc: eips: rename arg name for requested eip addr (62c39c62c, Yousong Zhou) scheduler: storage predicate add actualCapacity filter (5bce2bd95, Zexi Li) scheduler: remove unused k8s extender (da66f2650, Zexi Li) taskman: use admin token if task userCred token expired (70d2e5c84, Qiu Jian)  Code Refactoring (6)  climc: webconsole: use helper methods of response struct (45eda7c70, Yousong Zhou) host: startvm: for compat (f2e3766be, Yousong Zhou) host: startvm: nic_speed: use raw string (2154e7c18, Yousong Zhou) host: startvm: add QEMU_CMD_KVM_ARG (27dc7b629, Yousong Zhou) webconsole: api: add helper methods for response struct (85008a7b0, Yousong Zhou) webconsole: use structured response (2f9cfae37, Yousong Zhou)  Feature (1)  climc: policy save data into file (9cdd7dd2d, Qiu Jian)  Features (4)  apis: add const VPC_OVN_ENCAP_COST (208a49e3d, Yousong Zhou) host: startvm: set vpc nic mtu (c8388cab1, Yousong Zhou) host: startvm: add nic_mtu shell func (45b538bd2, Yousong Zhou) region: networks: add getMtu method (82e1234ed, Yousong Zhou)  ","excerpt":"Release time: 2020-12-29 03:01:23\n onecloud Repository: …","ref":"/v3.6/en/docs/changelog/release-3.4/3-4-12/","title":"v3.4.12"},{"body":"发布时间 2020-12-29 03:01:23\n onecloud 仓库地址: https://github.com/yunionio/onecloud\n34 commits to onecloud - v3.4.12 since this release.\nBug Fixes (23)  baremetal: clear jbod disks do PDMakeGood (ec5995da4, Zexi Li) cloudevent,devtool: missing metadata table (df7d68e40, Qiu Jian) host: telegraf listen on local ipv4 address explicitly (c3fd4937d, Qiu Jian) host: add print migrate progress info (cf8b54839, wanyaoqi) keystone: always upload\u0026refresh service config whenever service restart (9561c0c8d, Qiu Jian) mcclient: options: webconsole: fix passing ssh port (2add6fc1f, Yousong Zhou) monitor: other servier create alert add used_by param as a agreement (b01a477cb, –global) region: do not change disk status on migrating (a898d7609, wanyaoqi) region: eip_allocate_task: set eip status allocate_fail on task failure (5b0247a35, Yousong Zhou) region: add huawei gpssd desc (1ec3d6ddf, Qu Xuan) region: fix openstack instance os type (db60e37c4, Qu Xuan) region: lbbackend: better error reporting for finding influxdb info (4ac56f7fc, Yousong Zhou) region: guest to create input keep billing info (35c0e52de, wanyaoqi) region: openstack network is regional (869744d1b, Qu Xuan) region: sync servers (c069179ad, Qu Xuan) region: optimized disk allocate sched failed log (cd9b632d0, Qu Xuan) region: guestnetworks: use net calculated mtu (995b24c31, Yousong Zhou) region,baremetal: pxe net reuse converted server access ip (014170e74, Zexi Li) region,baremetal: choose candidate network not according by types (3da4dd195, Zexi Li) region,climc: eips: rename arg name for requested eip addr (62c39c62c, Yousong Zhou) scheduler: storage predicate add actualCapacity filter (5bce2bd95, Zexi Li) scheduler: remove unused k8s extender (da66f2650, Zexi Li) taskman: use admin token if task userCred token expired (70d2e5c84, Qiu Jian)  Code Refactoring (6)  climc: webconsole: use helper methods of response struct (45eda7c70, Yousong Zhou) host: startvm: for compat (f2e3766be, Yousong Zhou) host: startvm: nic_speed: use raw string (2154e7c18, Yousong Zhou) host: startvm: add QEMU_CMD_KVM_ARG (27dc7b629, Yousong Zhou) webconsole: api: add helper methods for response struct (85008a7b0, Yousong Zhou) webconsole: use structured response (2f9cfae37, Yousong Zhou)  Feature (1)  climc: policy save data into file (9cdd7dd2d, Qiu Jian)  Features (4)  apis: add const VPC_OVN_ENCAP_COST (208a49e3d, Yousong Zhou) host: startvm: set vpc nic mtu (c8388cab1, Yousong Zhou) host: startvm: add nic_mtu shell func (45b538bd2, Yousong Zhou) region: networks: add getMtu method (82e1234ed, Yousong Zhou)  ","excerpt":"发布时间 2020-12-29 03:01:23\n onecloud 仓库地址: …","ref":"/v3.6/zh/docs/changelog/release-3.4/3-4-12/","title":"v3.4.12"},{"body":"Release time: 2020-12-17 13:20:29\n onecloud Repository: https://github.com/yunionio/onecloud\n42 commits to onecloud - v3.4.11 since this release.\nBug Fixes (37)  climc vpc-create missing cloudregion_id (07bcf6a7a, Qiu Jian) baremetal: convert to host failed (c5655ed2b, Zexi Li) climc: fix marshal perform params (3e3d356ff, wanyaoqi) climc: server-create –desc not work (433807432, Zexi Li) cloudcommon: disable quota check by default (2d248612e, Qiu Jian) cloudcommon: perform public should check the sharing scope of resource (c55309958, Qiu Jian) cloudcommon: quota checkout turnd on by default at release/3.4 (8d842b0d2, Qiu Jian) git,make: 更新获取 git branch 的规则 (f82e51af6, Zhang Dongliang) git,make: 修正 gitbranch 变量的获取方式，允许外部传入，解决自动升级版本 tag 不统一的问题 (c3be52698, Zhang Dongliang) git,make: git branch 获取方式优化 (5920af6ae, Zhang Dongliang) host: fix check hugepage enabled (0ee2cbcf6, wanyaoqi) host: fix set windows password with escape charater (e6206944d, wanyaoqi) host: check lease living on restart etcd session (31436641c, wanyaoqi) host-deployer: cancel rename centos vgname (8471421b8, wanyaoqi) keystone: ignore service config update without changes (ee391ed98, Qiu Jian) notify: check for changes before updating config (d357f0375, rainzm) notify: avoid deadlock (9122c7e10, rainzm) notify: repull subcontact after changing config (3d99fe914, rainzm) region: openstack available zones (ab6d57afe, Qu Xuan) region: openstack hosts sync (5863e4a73, Qu Xuan) region: inspect invalid guest template (e762b2e2e, rainzm) region: server login info\u0026 keypair import input parameter trimspace (2ff318a5b, TangBin) region: goimports check fix (3817b9e6a, TangBin) region: attach network on register baremetal server (5d69ae9a0, wanyaoqi) region: network reserved ip count not consider expiration of reserved ips (47fdfc78c, Qiu Jian) region: sanitize eip charge type on all callsites (475842e81, Yousong Zhou) region: support openstack subnet allocation pools (d1d62de88, Qu Xuan) region: validate isolated devices on migrate (c74b89332, wanyaoqi) region: baremetal post update related server (36a931442, Zexi Li) region,host: fix hot remove nic (2864b15ec, wanyaoqi) scheduler: get candidates error more info (1c86c0d73, Zexi Li) scheduler: select resource unordered (986fa9881, Zexi Li) scheduler: fetch input network when specified (b1bec7337, Zexi Li) scheduler: sku filter check zone if only prefer region specified (532ada4bf, Zexi Li) scheduler: sku by region and fill onecloud vpc networks (aad036a82, Zexi Li) vpcagent: ovn: stable dns A record value (0f973234b, Yousong Zhou) webconsole: trim api_server url if end with slashes (5364ba564, Zexi Li)  Code Refactoring (2)  apis: compute: remove EIP_CHARGE_TYPE_DEFAULT (5e3861b28, Yousong Zhou) notify: add StartSubcontactPullTask for receiver (28e5b39ff, rainzm)  Features (3)  region: support sync skus by cloudregion (96d199724, TangBin) region: support sync skus by cloudregion (e4c07c030, TangBin) region: regiondriver: add methods on eip charge type (f3fee1171, Yousong Zhou)   sdnagent Repository: https://github.com/yunionio/sdnagent\n7 commits to sdnagent - v3.4.11 since this release.\nTc (6)  QdiscTree: add Root() method (2353968, Yousong Zhou) NewQdiscTree: special case mq (f71d4e0, Yousong Zhou) NewQdiscTree: fix children key (d8c06dc, Yousong Zhou) NewQdiscTree: use qbase for BaseQdisc() return (c3726a1, Yousong Zhou) NewQdiscTree: rename vars (707229b, Yousong Zhou) NewQdiscTree: use current tree instead of the root (119e1d0, Yousong Zhou)  Tcman (1)  skip devices with mq qdisc (537d80d, Yousong Zhou)  ","excerpt":"Release time: 2020-12-17 13:20:29\n onecloud Repository: …","ref":"/v3.6/en/docs/changelog/release-3.4/3-4-11/","title":"v3.4.11"},{"body":"发布时间 2020-12-17 13:20:29\n onecloud 仓库地址: https://github.com/yunionio/onecloud\n42 commits to onecloud - v3.4.11 since this release.\nBug Fixes (37)  climc vpc-create missing cloudregion_id (07bcf6a7a, Qiu Jian) baremetal: convert to host failed (c5655ed2b, Zexi Li) climc: fix marshal perform params (3e3d356ff, wanyaoqi) climc: server-create –desc not work (433807432, Zexi Li) cloudcommon: disable quota check by default (2d248612e, Qiu Jian) cloudcommon: perform public should check the sharing scope of resource (c55309958, Qiu Jian) cloudcommon: quota checkout turnd on by default at release/3.4 (8d842b0d2, Qiu Jian) git,make: 更新获取 git branch 的规则 (f82e51af6, Zhang Dongliang) git,make: 修正 gitbranch 变量的获取方式，允许外部传入，解决自动升级版本 tag 不统一的问题 (c3be52698, Zhang Dongliang) git,make: git branch 获取方式优化 (5920af6ae, Zhang Dongliang) host: fix check hugepage enabled (0ee2cbcf6, wanyaoqi) host: fix set windows password with escape charater (e6206944d, wanyaoqi) host: check lease living on restart etcd session (31436641c, wanyaoqi) host-deployer: cancel rename centos vgname (8471421b8, wanyaoqi) keystone: ignore service config update without changes (ee391ed98, Qiu Jian) notify: check for changes before updating config (d357f0375, rainzm) notify: avoid deadlock (9122c7e10, rainzm) notify: repull subcontact after changing config (3d99fe914, rainzm) region: openstack available zones (ab6d57afe, Qu Xuan) region: openstack hosts sync (5863e4a73, Qu Xuan) region: inspect invalid guest template (e762b2e2e, rainzm) region: server login info\u0026 keypair import input parameter trimspace (2ff318a5b, TangBin) region: goimports check fix (3817b9e6a, TangBin) region: attach network on register baremetal server (5d69ae9a0, wanyaoqi) region: network reserved ip count not consider expiration of reserved ips (47fdfc78c, Qiu Jian) region: sanitize eip charge type on all callsites (475842e81, Yousong Zhou) region: support openstack subnet allocation pools (d1d62de88, Qu Xuan) region: validate isolated devices on migrate (c74b89332, wanyaoqi) region: baremetal post update related server (36a931442, Zexi Li) region,host: fix hot remove nic (2864b15ec, wanyaoqi) scheduler: get candidates error more info (1c86c0d73, Zexi Li) scheduler: select resource unordered (986fa9881, Zexi Li) scheduler: fetch input network when specified (b1bec7337, Zexi Li) scheduler: sku filter check zone if only prefer region specified (532ada4bf, Zexi Li) scheduler: sku by region and fill onecloud vpc networks (aad036a82, Zexi Li) vpcagent: ovn: stable dns A record value (0f973234b, Yousong Zhou) webconsole: trim api_server url if end with slashes (5364ba564, Zexi Li)  Code Refactoring (2)  apis: compute: remove EIP_CHARGE_TYPE_DEFAULT (5e3861b28, Yousong Zhou) notify: add StartSubcontactPullTask for receiver (28e5b39ff, rainzm)  Features (3)  region: support sync skus by cloudregion (96d199724, TangBin) region: support sync skus by cloudregion (e4c07c030, TangBin) region: regiondriver: add methods on eip charge type (f3fee1171, Yousong Zhou)   sdnagent 仓库地址: https://github.com/yunionio/sdnagent\n7 commits to sdnagent - v3.4.11 since this release.\nTc (6)  QdiscTree: add Root() method (2353968, Yousong Zhou) NewQdiscTree: special case mq (f71d4e0, Yousong Zhou) NewQdiscTree: fix children key (d8c06dc, Yousong Zhou) NewQdiscTree: use qbase for BaseQdisc() return (c3726a1, Yousong Zhou) NewQdiscTree: rename vars (707229b, Yousong Zhou) NewQdiscTree: use current tree instead of the root (119e1d0, Yousong Zhou)  Tcman (1)  skip devices with mq qdisc (537d80d, Yousong Zhou)  ","excerpt":"发布时间 2020-12-17 13:20:29\n onecloud 仓库地址: …","ref":"/v3.6/zh/docs/changelog/release-3.4/3-4-11/","title":"v3.4.11"},{"body":"Release time: 2020-12-03 16:20:08\n onecloud Repository: https://github.com/yunionio/onecloud\n19 commits to onecloud - v3.4.10 since this release.\nBug Fixes (13)  cloudid: avoid new public account sync system policy delay 1 day (b9d08c74a, Qu Xuan) host: make sure it won’t match vpc guests by accident (b54ebf45f, Yousong Zhou) keystone: not allow to disable sql driver (e77ca8487, Qiu Jian) monitor: modify influxdbSuggestDriver query err (fd7fe6293, zhaoxiangchun) notify: return the result of the second attempt to execute the rpc call (e2ab5190c, rainzm) region: auto sync cloudaccount resources (43f5c8495, Qu Xuan) region: delete guest without ‘purge’ in GuestDetachScalingGroupTask (af006498f, rainzm) region: secgrouprule: set model manager (ec47e4773, Yousong Zhou) region: sort excludedNets correctly (220fb5bca, rainzm) region: pass up error from InitializeData (f80c6a214, Yousong Zhou) region: avoid qcloud sync local disk error (c2765f5fd, Qu Xuan) region,scheduler: fix netwrok predicate (43407d3d7, wanyaoqi) taskman: SSubTask: set model manager (1c68b97c8, Yousong Zhou)  Bugfix (1)  region: fix list by srever type normal (eba5bd84d, wanyaoqi)  Features (5)  host: add option OvnEncapIpDetectionMethod can-reach:xx (1615426f2, Yousong Zhou) netutils2: add MyIPTo (3df0be2fd, Yousong Zhou) region: add list filter server type (ee9e59df8, wanyaoqi) region: options: allow setting default vpc external access mode (0ea12ffcc, Yousong Zhou) region: search server by substr of ip or mac (9e5018b14, Yousong Zhou)   ocadm Repository: https://github.com/yunionio/ocadm\n2 commits to ocadm - v3.4.10 since this release.\nBug Fixes (1)  update: cluster update operator parse image digest (50c3663, Zexi Li)  Chore (1)  vendor: resolve onecloud-operator preceding tag not found (bf6f45a, Zexi Li)   onecloud-operator Repository: https://github.com/yunionio/onecloud-operator\n2 commits to onecloud-operator - v3.4.10 since this release.\nFeatures (1)  host: allow setting ovnEncapIpDetectionMethod (176999a, Yousong Zhou)  Vendor (1)  update yunion.io/x/master to current release/3.4 (05ccca2, Yousong Zhou)   sdnagent Repository: https://github.com/yunionio/sdnagent\n3 commits to sdnagent - v3.4.10 since this release.\nBuild (1)  eipgw: track to ensure stop state as well (71e82fb, Yousong Zhou)  Others (1)  .circleci: bump go to 1.14 (d5a7f19, Yousong Zhou)  Vendor (1)  bump yunion.io/x/onecloud to current tip of release/3.3 (cd98fe2, Yousong Zhou)  ","excerpt":"Release time: 2020-12-03 16:20:08\n onecloud Repository: …","ref":"/v3.6/en/docs/changelog/release-3.4/3-4-10/","title":"v3.4.10"},{"body":"发布时间 2020-12-03 16:20:08\n onecloud 仓库地址: https://github.com/yunionio/onecloud\n19 commits to onecloud - v3.4.10 since this release.\nBug Fixes (13)  cloudid: avoid new public account sync system policy delay 1 day (b9d08c74a, Qu Xuan) host: make sure it won’t match vpc guests by accident (b54ebf45f, Yousong Zhou) keystone: not allow to disable sql driver (e77ca8487, Qiu Jian) monitor: modify influxdbSuggestDriver query err (fd7fe6293, zhaoxiangchun) notify: return the result of the second attempt to execute the rpc call (e2ab5190c, rainzm) region: auto sync cloudaccount resources (43f5c8495, Qu Xuan) region: delete guest without ‘purge’ in GuestDetachScalingGroupTask (af006498f, rainzm) region: secgrouprule: set model manager (ec47e4773, Yousong Zhou) region: sort excludedNets correctly (220fb5bca, rainzm) region: pass up error from InitializeData (f80c6a214, Yousong Zhou) region: avoid qcloud sync local disk error (c2765f5fd, Qu Xuan) region,scheduler: fix netwrok predicate (43407d3d7, wanyaoqi) taskman: SSubTask: set model manager (1c68b97c8, Yousong Zhou)  Bugfix (1)  region: fix list by srever type normal (eba5bd84d, wanyaoqi)  Features (5)  host: add option OvnEncapIpDetectionMethod can-reach:xx (1615426f2, Yousong Zhou) netutils2: add MyIPTo (3df0be2fd, Yousong Zhou) region: add list filter server type (ee9e59df8, wanyaoqi) region: options: allow setting default vpc external access mode (0ea12ffcc, Yousong Zhou) region: search server by substr of ip or mac (9e5018b14, Yousong Zhou)   ocadm 仓库地址: https://github.com/yunionio/ocadm\n2 commits to ocadm - v3.4.10 since this release.\nBug Fixes (1)  update: cluster update operator parse image digest (50c3663, Zexi Li)  Chore (1)  vendor: resolve onecloud-operator preceding tag not found (bf6f45a, Zexi Li)   onecloud-operator 仓库地址: https://github.com/yunionio/onecloud-operator\n2 commits to onecloud-operator - v3.4.10 since this release.\nFeatures (1)  host: allow setting ovnEncapIpDetectionMethod (176999a, Yousong Zhou)  Vendor (1)  update yunion.io/x/master to current release/3.4 (05ccca2, Yousong Zhou)   sdnagent 仓库地址: https://github.com/yunionio/sdnagent\n3 commits to sdnagent - v3.4.10 since this release.\nBuild (1)  eipgw: track to ensure stop state as well (71e82fb, Yousong Zhou)  Others (1)  .circleci: bump go to 1.14 (d5a7f19, Yousong Zhou)  Vendor (1)  bump yunion.io/x/onecloud to current tip of release/3.3 (cd98fe2, Yousong Zhou)  ","excerpt":"发布时间 2020-12-03 16:20:08\n onecloud 仓库地址: …","ref":"/v3.6/zh/docs/changelog/release-3.4/3-4-10/","title":"v3.4.10"},{"body":"Release time: 2021-03-01 10:58:40\n onecloud Repository: https://github.com/yunionio/onecloud\n1 commits to onecloud - v3.6.9 since this release.\nBug Fixes (1)  baremetal-agent: baremetal fail to stop due to power off soft failed (a3621b470, Qiu Jian)   kubecomps Repository: https://github.com/yunionio/kubecomps\n2 commits to kubecomps - v3.6.9 since this release.\nBug Fixes (1)  kubeserver: sync cluster not fatal (1247793, Zexi Li)  Features (1)  kubeserver: add cluster precheck api (93b34c2, Zexi Li)  ","excerpt":"Release time: 2021-03-01 10:58:40\n onecloud Repository: …","ref":"/v3.6/en/docs/changelog/release-3.6/3-6-9/","title":"v3.6.9"},{"body":"发布时间 2021-03-01 10:58:40\n onecloud 仓库地址: https://github.com/yunionio/onecloud\n1 commits to onecloud - v3.6.9 since this release.\nBug Fixes (1)  baremetal-agent: baremetal fail to stop due to power off soft failed (a3621b470, Qiu Jian)   kubecomps 仓库地址: https://github.com/yunionio/kubecomps\n2 commits to kubecomps - v3.6.9 since this release.\nBug Fixes (1)  kubeserver: sync cluster not fatal (1247793, Zexi Li)  Features (1)  kubeserver: add cluster precheck api (93b34c2, Zexi Li)  ","excerpt":"发布时间 2021-03-01 10:58:40\n onecloud 仓库地址: …","ref":"/v3.6/zh/docs/changelog/release-3.6/3-6-9/","title":"v3.6.9"},{"body":"Release time: 2021-02-25 17:21:03\n onecloud Repository: https://github.com/yunionio/onecloud\n25 commits to onecloud - v3.6.8 since this release.\nBug Fixes (21)  apigateway: add enable_quota_check and return-domain-list attributes to fe params (4ee32ef45, Qiu Jian) baremetal: try channel 8 for default profile (cdb97511c, Qiu Jian) cloudevent: optimized cloudevent sql (14dcb9175, Qu Xuan) cloudid: sync role policy (a11e5d14d, Qu Xuan) host-deployer: mount may fail to lock /etc/mtab, add retrier (c22c4f8ef, Qiu Jian) hostman: fix kvm create disk failed error (e76abe883, Qu Xuan) keystone: hide system scope policies in domain scope view (#10196) (f7e8c20f4, Jian Qiu) keystone: ensure comparing id with non-utf8 string (73c0f0350, Qiu Jian) keystone: cas sso may create new project whenever user login (50473268f, Qiu Jian) keystone: policy name duplication (#10201) (d7dc89ccb, Jian Qiu) monitor,host: replace space to ‘+’ when write to influxdb and replace ‘+’ to space when query (861209545, zhaoxiangchun) region: set redis reboot timeout to 30 mins (bd64be4d8, tangbin) region: delete not exist disk failed (4acb2757a, Qu Xuan) region: redis change spec bugfix (e39015fa4, tangbin) region: support peer secgroup (5584e9af1, Qu Xuan) region: qcloud quota sync (57eef5ede, Qu Xuan) region: avoid not sync dns zone (8dd1a897f, Qu Xuan) region: add azure new region (4332008c3, Qu Xuan) region: bucket size stats should not count invalid sizes of -1 (bbb538b93, Qiu Jian) region: host search by any ip (8610731af, Qiu Jian) scheduler: storage medium type should not exact match (#10192) (dbf8fde45, Jian Qiu)  Chore (1)  utils: add deb build script (a1eed47e6, wanyaoqi)  Climc (1)  add k8s monitor component (2fc04497b, Zexi Li)  Feature (1)  compute: allow live migration with checking Host CPU modes (3cc72fac6, Qiu Jian)  Features (1)  baremetal: support H3C oem baremetal (50fe044cf, Zexi Li)   ocadm Repository: https://github.com/yunionio/ocadm\n1 commits to ocadm - v3.6.8 since this release.\nBug Fixes (1)  build: sync with onecloud-operator v3.6 vendor (eb1a5e5, Zexi Li)   onecloud-operator Repository: https://github.com/yunionio/onecloud-operator\n1 commits to onecloud-operator - v3.6.8 since this release.\nFeatures (1)  k8s: enable kubeserver (ec082d1, Zexi Li)  ","excerpt":"Release time: 2021-02-25 17:21:03\n onecloud Repository: …","ref":"/v3.6/en/docs/changelog/release-3.6/3-6-8/","title":"v3.6.8"},{"body":"发布时间 2021-02-25 17:21:03\n onecloud 仓库地址: https://github.com/yunionio/onecloud\n25 commits to onecloud - v3.6.8 since this release.\nBug Fixes (21)  apigateway: add enable_quota_check and return-domain-list attributes to fe params (4ee32ef45, Qiu Jian) baremetal: try channel 8 for default profile (cdb97511c, Qiu Jian) cloudevent: optimized cloudevent sql (14dcb9175, Qu Xuan) cloudid: sync role policy (a11e5d14d, Qu Xuan) host-deployer: mount may fail to lock /etc/mtab, add retrier (c22c4f8ef, Qiu Jian) hostman: fix kvm create disk failed error (e76abe883, Qu Xuan) keystone: hide system scope policies in domain scope view (#10196) (f7e8c20f4, Jian Qiu) keystone: ensure comparing id with non-utf8 string (73c0f0350, Qiu Jian) keystone: cas sso may create new project whenever user login (50473268f, Qiu Jian) keystone: policy name duplication (#10201) (d7dc89ccb, Jian Qiu) monitor,host: replace space to ‘+’ when write to influxdb and replace ‘+’ to space when query (861209545, zhaoxiangchun) region: set redis reboot timeout to 30 mins (bd64be4d8, tangbin) region: delete not exist disk failed (4acb2757a, Qu Xuan) region: redis change spec bugfix (e39015fa4, tangbin) region: support peer secgroup (5584e9af1, Qu Xuan) region: qcloud quota sync (57eef5ede, Qu Xuan) region: avoid not sync dns zone (8dd1a897f, Qu Xuan) region: add azure new region (4332008c3, Qu Xuan) region: bucket size stats should not count invalid sizes of -1 (bbb538b93, Qiu Jian) region: host search by any ip (8610731af, Qiu Jian) scheduler: storage medium type should not exact match (#10192) (dbf8fde45, Jian Qiu)  Chore (1)  utils: add deb build script (a1eed47e6, wanyaoqi)  Climc (1)  add k8s monitor component (2fc04497b, Zexi Li)  Feature (1)  compute: allow live migration with checking Host CPU modes (3cc72fac6, Qiu Jian)  Features (1)  baremetal: support H3C oem baremetal (50fe044cf, Zexi Li)   ocadm 仓库地址: https://github.com/yunionio/ocadm\n1 commits to ocadm - v3.6.8 since this release.\nBug Fixes (1)  build: sync with onecloud-operator v3.6 vendor (eb1a5e5, Zexi Li)   onecloud-operator 仓库地址: https://github.com/yunionio/onecloud-operator\n1 commits to onecloud-operator - v3.6.8 since this release.\nFeatures (1)  k8s: enable kubeserver (ec082d1, Zexi Li)  ","excerpt":"发布时间 2021-02-25 17:21:03\n onecloud 仓库地址: …","ref":"/v3.6/zh/docs/changelog/release-3.6/3-6-8/","title":"v3.6.8"},{"body":"Release time: 2021-02-03 18:10:04\n onecloud Repository: https://github.com/yunionio/onecloud\n19 commits to onecloud - v3.6.7 since this release.\nBug Fixes (15)  host-deployer: remove escape character on windows passwd (754d046d3, wanyaoqi) hostman: avoid panic when disk is nil (650ccdd7c, Qu Xuan) keystone: SSO created user name may be duplicated (20380ae9e, Qiu Jian) monitor: fix alert notify info do not contain resourceName (c17fe2df2, zhaoxiangchun) notify: be compatible with member’s permission changes (4e199b84e, rainzm) region: check the global network situation when expanding the network (ea4505ae5, rainzm) region: avoid update tags task loop (3aa83bb86, Qu Xuan) region: filter resource by classic vpc (57efd8a86, Qu Xuan) region: delete virtual nics with network (ebe79b12d, Qu Xuan) region: avoid sync huawei unusable account (7ee2026b2, Qu Xuan) region: add option auto reconcile backup servers (3bcb337a4, wanyaoqi) region: avoid stuck at http request (9975543dd, Qu Xuan) region: add huawei credit amount check (0c658ec53, Qu Xuan) region: add aliyun credit amount check (58fb3fc9e, Qu Xuan) region: secgroup priority fix (f4972c22b, Qu Xuan)  Features (4)  apigateway: differentiate error messages when logging in (e3d3c1f02, rainzm) keystone: more specific error return during authentication (2fd40396c, rainzm) keystone,apigateway: return a readable message when the user is locked or disabled (cb7956f1f, rainzm) locale: update (6f2bdfa22, rainzm)   onecloud-operator Repository: https://github.com/yunionio/onecloud-operator\n2 commits to onecloud-operator - v3.6.7 since this release.\nApigateway (2)  cors: rename spec field name to corsHosts (431376c, Yousong Zhou) allow setting cors_hosts (1ef6de1, Yousong Zhou)  ","excerpt":"Release time: 2021-02-03 18:10:04\n onecloud Repository: …","ref":"/v3.6/en/docs/changelog/release-3.6/3-6-7/","title":"v3.6.7"},{"body":"发布时间 2021-02-03 18:10:04\n onecloud 仓库地址: https://github.com/yunionio/onecloud\n19 commits to onecloud - v3.6.7 since this release.\nBug Fixes (15)  host-deployer: remove escape character on windows passwd (754d046d3, wanyaoqi) hostman: avoid panic when disk is nil (650ccdd7c, Qu Xuan) keystone: SSO created user name may be duplicated (20380ae9e, Qiu Jian) monitor: fix alert notify info do not contain resourceName (c17fe2df2, zhaoxiangchun) notify: be compatible with member’s permission changes (4e199b84e, rainzm) region: check the global network situation when expanding the network (ea4505ae5, rainzm) region: avoid update tags task loop (3aa83bb86, Qu Xuan) region: filter resource by classic vpc (57efd8a86, Qu Xuan) region: delete virtual nics with network (ebe79b12d, Qu Xuan) region: avoid sync huawei unusable account (7ee2026b2, Qu Xuan) region: add option auto reconcile backup servers (3bcb337a4, wanyaoqi) region: avoid stuck at http request (9975543dd, Qu Xuan) region: add huawei credit amount check (0c658ec53, Qu Xuan) region: add aliyun credit amount check (58fb3fc9e, Qu Xuan) region: secgroup priority fix (f4972c22b, Qu Xuan)  Features (4)  apigateway: differentiate error messages when logging in (e3d3c1f02, rainzm) keystone: more specific error return during authentication (2fd40396c, rainzm) keystone,apigateway: return a readable message when the user is locked or disabled (cb7956f1f, rainzm) locale: update (6f2bdfa22, rainzm)   onecloud-operator 仓库地址: https://github.com/yunionio/onecloud-operator\n2 commits to onecloud-operator - v3.6.7 since this release.\nApigateway (2)  cors: rename spec field name to corsHosts (431376c, Yousong Zhou) allow setting cors_hosts (1ef6de1, Yousong Zhou)  ","excerpt":"发布时间 2021-02-03 18:10:04\n onecloud 仓库地址: …","ref":"/v3.6/zh/docs/changelog/release-3.6/3-6-7/","title":"v3.6.7"},{"body":"Release time: 2021-01-27 21:03:27\n onecloud Repository: https://github.com/yunionio/onecloud\n23 commits to onecloud - v3.6.6 since this release.\nBug Fixes (18)  cloudcommon: missing set_meta opslog (#9916) (040a45aa4, Jian Qiu) cloudevent: update aliyun lookupevent api (178a7071f, Qu Xuan) host: fix wait time after mount fuse fs (5ccece54a, wanyaoqi) keystone: user create without password can login with any password (2af9104d9, Qiu Jian) monitor: domain view can list scope is domain or project alertrecords; fix nodata alert return info (5dc1486e7, zhaoxiangchun) notify: remote ‘lang’ filter when contact type is ‘mobile’ (488502561, rainzm) notify: add a time limit for resending notifications (de1553770, rainzm) notify: add index fro receiver_notification (7c87d73d9, rainzm) notify: send websocket messages according to language preference (8a9f3e09e, rainzm) region: purge snapshot with not status check (67082f32d, Qu Xuan) region: cloudaccount: allow only one sync func in flight (606b241b0, Yousong Zhou) region: fix zstack delete server with local disks (fed639513, Qu Xuan) region: avoid clean all rules when sync secgroups (c6893892d, Qu Xuan) region: azure default subscription id (f3a567f63, Qu Xuan) region: aws not support create server with public ip (180b12216, Qu Xuan) region: exported number of vpcs less than listed (a8d550d4d, Qiu Jian) region: optimized secgroup rule sync (b96b2f0b5, Qu Xuan) region: avoid azure detach disk failed (299d3bed6, Qu Xuan)  Features (5)  climc: wires: allow filter by bandwidth (e467ef6ec, Yousong Zhou) monitor: query reduce percentile (88bcb8219, zhaoxiangchun) notify: clean data for receiver_notifications (516066955, rainzm) notify: delete the notification 1 month ago and remove the data migration (928c0602d, rainzm) region: wire: allow filter by bandwidth (861cd47e6, Yousong Zhou)   kubecomps Repository: https://github.com/yunionio/kubecomps\n15 commits to kubecomps - v3.6.6 since this release.\nBug Fixes (2)  build: embed heml pkgs remove it (417dafd, Zexi Li) kubeserver: create bucket for monitor component (b310baa, Zexi Li)  Chore (2)  build: use helm docker image to build (b4155a8, Zexi Li) git config: add git commit msg template (9a14d89, Zexi Li)  Features (8)  build: go generate use vendor (add2ddb, Zexi Li) calico-node-agent: support enable all network interface proxy_arp (4d7a88e, Zexi Li) drivers: add kvm provider (5fc2b98, Zexi Li) kubeserver: add kubeserver service (6575705, Zexi Li) kubeserver: integrate ansible and kubespray (16bc1b7, Zexi Li) kubeserver: support create cluster inside onecloud vpc (7a793ff, Zexi Li) prom-receiver: add simple prometheus receiver component (fd5e3a3, Zexi Li) repo: repo url allow updated (870d29d, Zexi Li)  Others (3)  build calico-node-agent (e4e0506, Zexi Li) add metasvc demo code (8ee0335, Zexi Li) calico-node-agent added (2071d5f, Zexi Li)  ","excerpt":"Release time: 2021-01-27 21:03:27\n onecloud Repository: …","ref":"/v3.6/en/docs/changelog/release-3.6/3-6-6/","title":"v3.6.6"},{"body":"发布时间 2021-01-27 21:03:27\n onecloud 仓库地址: https://github.com/yunionio/onecloud\n23 commits to onecloud - v3.6.6 since this release.\nBug Fixes (18)  cloudcommon: missing set_meta opslog (#9916) (040a45aa4, Jian Qiu) cloudevent: update aliyun lookupevent api (178a7071f, Qu Xuan) host: fix wait time after mount fuse fs (5ccece54a, wanyaoqi) keystone: user create without password can login with any password (2af9104d9, Qiu Jian) monitor: domain view can list scope is domain or project alertrecords; fix nodata alert return info (5dc1486e7, zhaoxiangchun) notify: remote ‘lang’ filter when contact type is ‘mobile’ (488502561, rainzm) notify: add a time limit for resending notifications (de1553770, rainzm) notify: add index fro receiver_notification (7c87d73d9, rainzm) notify: send websocket messages according to language preference (8a9f3e09e, rainzm) region: purge snapshot with not status check (67082f32d, Qu Xuan) region: cloudaccount: allow only one sync func in flight (606b241b0, Yousong Zhou) region: fix zstack delete server with local disks (fed639513, Qu Xuan) region: avoid clean all rules when sync secgroups (c6893892d, Qu Xuan) region: azure default subscription id (f3a567f63, Qu Xuan) region: aws not support create server with public ip (180b12216, Qu Xuan) region: exported number of vpcs less than listed (a8d550d4d, Qiu Jian) region: optimized secgroup rule sync (b96b2f0b5, Qu Xuan) region: avoid azure detach disk failed (299d3bed6, Qu Xuan)  Features (5)  climc: wires: allow filter by bandwidth (e467ef6ec, Yousong Zhou) monitor: query reduce percentile (88bcb8219, zhaoxiangchun) notify: clean data for receiver_notifications (516066955, rainzm) notify: delete the notification 1 month ago and remove the data migration (928c0602d, rainzm) region: wire: allow filter by bandwidth (861cd47e6, Yousong Zhou)   kubecomps 仓库地址: https://github.com/yunionio/kubecomps\n15 commits to kubecomps - v3.6.6 since this release.\nBug Fixes (2)  build: embed heml pkgs remove it (417dafd, Zexi Li) kubeserver: create bucket for monitor component (b310baa, Zexi Li)  Chore (2)  build: use helm docker image to build (b4155a8, Zexi Li) git config: add git commit msg template (9a14d89, Zexi Li)  Features (8)  build: go generate use vendor (add2ddb, Zexi Li) calico-node-agent: support enable all network interface proxy_arp (4d7a88e, Zexi Li) drivers: add kvm provider (5fc2b98, Zexi Li) kubeserver: add kubeserver service (6575705, Zexi Li) kubeserver: integrate ansible and kubespray (16bc1b7, Zexi Li) kubeserver: support create cluster inside onecloud vpc (7a793ff, Zexi Li) prom-receiver: add simple prometheus receiver component (fd5e3a3, Zexi Li) repo: repo url allow updated (870d29d, Zexi Li)  Others (3)  build calico-node-agent (e4e0506, Zexi Li) add metasvc demo code (8ee0335, Zexi Li) calico-node-agent added (2071d5f, Zexi Li)  ","excerpt":"发布时间 2021-01-27 21:03:27\n onecloud 仓库地址: …","ref":"/v3.6/zh/docs/changelog/release-3.6/3-6-6/","title":"v3.6.6"},{"body":"Release time: 2021-01-15 11:58:08\n onecloud Repository: https://github.com/yunionio/onecloud\n2 commits to onecloud - v3.6.5 since this release.\nBug Fixes (2)  cloudid: optimized saml sso (8858e7913, Qu Xuan) region: update google latitude and langtitude (863a28f29, Qu Xuan)  ","excerpt":"Release time: 2021-01-15 11:58:08\n onecloud Repository: …","ref":"/v3.6/en/docs/changelog/release-3.6/3-6-5/","title":"v3.6.5"},{"body":"发布时间 2021-01-15 11:58:08\n onecloud 仓库地址: https://github.com/yunionio/onecloud\n2 commits to onecloud - v3.6.5 since this release.\nBug Fixes (2)  cloudid: optimized saml sso (8858e7913, Qu Xuan) region: update google latitude and langtitude (863a28f29, Qu Xuan)  ","excerpt":"发布时间 2021-01-15 11:58:08\n onecloud 仓库地址: …","ref":"/v3.6/zh/docs/changelog/release-3.6/3-6-5/","title":"v3.6.5"},{"body":"Release time: 2021-01-14 18:20:41\n onecloud Repository: https://github.com/yunionio/onecloud\n7 commits to onecloud - v3.6.4 since this release.\nBug Fixes (4)  notify: update receiver’s lang when update event occurs (a2613e6bc, rainzm) notify: panic for err (a8b14bb73, rainzm) region: optimized azure reset linux pasword (36bd1baaf, Qu Xuan) region: AWS buckets in us-east-1 have null location (fb3456c42, Qiu Jian)  Features (3)  monitor: influxQuery add P95 reduce (64dec4254, zhaoxiangchun) monitor: support monitor overview influxdb query pass through (1fc01ebe9, zhaoxiangchun) notify: change default verify expire interval 5m =\u003e 2m (98ca80e63, rainzm)  ","excerpt":"Release time: 2021-01-14 18:20:41\n onecloud Repository: …","ref":"/v3.6/en/docs/changelog/release-3.6/3-6-4/","title":"v3.6.4"},{"body":"发布时间 2021-01-14 18:20:41\n onecloud 仓库地址: https://github.com/yunionio/onecloud\n7 commits to onecloud - v3.6.4 since this release.\nBug Fixes (4)  notify: update receiver’s lang when update event occurs (a2613e6bc, rainzm) notify: panic for err (a8b14bb73, rainzm) region: optimized azure reset linux pasword (36bd1baaf, Qu Xuan) region: AWS buckets in us-east-1 have null location (fb3456c42, Qiu Jian)  Features (3)  monitor: influxQuery add P95 reduce (64dec4254, zhaoxiangchun) monitor: support monitor overview influxdb query pass through (1fc01ebe9, zhaoxiangchun) notify: change default verify expire interval 5m =\u003e 2m (98ca80e63, rainzm)  ","excerpt":"发布时间 2021-01-14 18:20:41\n onecloud 仓库地址: …","ref":"/v3.6/zh/docs/changelog/release-3.6/3-6-4/","title":"v3.6.4"},{"body":"Release time: 2021-01-13 18:58:04\n onecloud Repository: https://github.com/yunionio/onecloud\n28 commits to onecloud - v3.6.3 since this release.\nApigateway (2)  try return httperrors (157bfb696, Yousong Zhou) reword error messages (83adeaae4, Yousong Zhou)  Bug Fixes (16)  cloudevent: default policy (c4db4bc43, Qu Xuan) cloudid: multi cloudaccount with saml user (53c8c1605, Qu Xuan) host-deployer: add retry on check is vgactived (3f4b2163f, wanyaoqi) keystone: add suggestion previliges to meter admin (86fda0f7d, Qiu Jian) monitor: monitor overview throw err (e5b637906, zhaoxiangchun) monitor: fix monitoroverview and meter send alerting info to notify (af0813cd0, zhaoxiangchun) monitor,suggestion: order commonalert metric and modify alertresoruce type value and add suggestion models climc (3124113e2, zhaoxiangchun) notify: set status after sending (83dd53424, rainzm) notify: loose phone number rules in updating receiver (287f98ac8, rainzm) notify: loose mobile phone number matching rules (644ab6f92, rainzm) notify: avoid duplication of notification names (bc0106902, rainzm) notify: set ModelManager in Receiver() (88fa743e4, rainzm) region: optimized for qcloud prepaid instance delete (e775e798a, Qu Xuan) region: avoid auzre request timeout (f64c6c54d, Qu Xuan) region: aws elb backendgroup sync bugfix (4fa95bf60, tangbin) region: avoid panic when register service not work (1afe6ef41, Qu Xuan)  Features (2)  notify: send notifications of different templates according to language (dd7d34402, rainzm) region: server sku os_arch \u0026 cpu_arch checking (331d9d2a6, tangbin)  Guest_deploy_task (1)  log other deploy details with i18n (78b6f8566, Yousong Zhou)  Keystone (1)  reword error messages (d7f05e983, Yousong Zhou)  Locales (4)  generate (464e0450f, Yousong Zhou) zh-CN: add some translations (a4b5562bd, Yousong Zhou) generate (f0354d0c9, Yousong Zhou) zh-CN: extract current (c3c3c0075, Yousong Zhou)  Others (2)  server skus filter by mem size fix (5d075bbaa, tangbin) loadbalancer add lb purge validate (f31216be0, tangbin)   ocadm Repository: https://github.com/yunionio/ocadm\n1 commits to ocadm - v3.6.3 since this release.\nFeatures (1)  longhorn: support migrate to source pvc from longhorn pvc (ed1b494, wanyaoqi)   onecloud-operator Repository: https://github.com/yunionio/onecloud-operator\n3 commits to onecloud-operator - v3.6.3 since this release.\nBug Fixes (2)  cloudmon: crond commond fmt err (0af8216, zhaoxiangchun) operator: modify crontab default interval (500efb8, zhaoxiangchun)  Features (1)  cloudmon: add cloudmon alertrecord crontab (0533944, zhaoxiangchun)  ","excerpt":"Release time: 2021-01-13 18:58:04\n onecloud Repository: …","ref":"/v3.6/en/docs/changelog/release-3.6/3-6-3/","title":"v3.6.3"},{"body":"发布时间 2021-01-13 18:58:04\n onecloud 仓库地址: https://github.com/yunionio/onecloud\n28 commits to onecloud - v3.6.3 since this release.\nApigateway (2)  try return httperrors (157bfb696, Yousong Zhou) reword error messages (83adeaae4, Yousong Zhou)  Bug Fixes (16)  cloudevent: default policy (c4db4bc43, Qu Xuan) cloudid: multi cloudaccount with saml user (53c8c1605, Qu Xuan) host-deployer: add retry on check is vgactived (3f4b2163f, wanyaoqi) keystone: add suggestion previliges to meter admin (86fda0f7d, Qiu Jian) monitor: monitor overview throw err (e5b637906, zhaoxiangchun) monitor: fix monitoroverview and meter send alerting info to notify (af0813cd0, zhaoxiangchun) monitor,suggestion: order commonalert metric and modify alertresoruce type value and add suggestion models climc (3124113e2, zhaoxiangchun) notify: set status after sending (83dd53424, rainzm) notify: loose phone number rules in updating receiver (287f98ac8, rainzm) notify: loose mobile phone number matching rules (644ab6f92, rainzm) notify: avoid duplication of notification names (bc0106902, rainzm) notify: set ModelManager in Receiver() (88fa743e4, rainzm) region: optimized for qcloud prepaid instance delete (e775e798a, Qu Xuan) region: avoid auzre request timeout (f64c6c54d, Qu Xuan) region: aws elb backendgroup sync bugfix (4fa95bf60, tangbin) region: avoid panic when register service not work (1afe6ef41, Qu Xuan)  Features (2)  notify: send notifications of different templates according to language (dd7d34402, rainzm) region: server sku os_arch \u0026 cpu_arch checking (331d9d2a6, tangbin)  Guest_deploy_task (1)  log other deploy details with i18n (78b6f8566, Yousong Zhou)  Keystone (1)  reword error messages (d7f05e983, Yousong Zhou)  Locales (4)  generate (464e0450f, Yousong Zhou) zh-CN: add some translations (a4b5562bd, Yousong Zhou) generate (f0354d0c9, Yousong Zhou) zh-CN: extract current (c3c3c0075, Yousong Zhou)  Others (2)  server skus filter by mem size fix (5d075bbaa, tangbin) loadbalancer add lb purge validate (f31216be0, tangbin)   ocadm 仓库地址: https://github.com/yunionio/ocadm\n1 commits to ocadm - v3.6.3 since this release.\nFeatures (1)  longhorn: support migrate to source pvc from longhorn pvc (ed1b494, wanyaoqi)   onecloud-operator 仓库地址: https://github.com/yunionio/onecloud-operator\n3 commits to onecloud-operator - v3.6.3 since this release.\nBug Fixes (2)  cloudmon: crond commond fmt err (0af8216, zhaoxiangchun) operator: modify crontab default interval (500efb8, zhaoxiangchun)  Features (1)  cloudmon: add cloudmon alertrecord crontab (0533944, zhaoxiangchun)  ","excerpt":"发布时间 2021-01-13 18:58:04\n onecloud 仓库地址: …","ref":"/v3.6/zh/docs/changelog/release-3.6/3-6-3/","title":"v3.6.3"},{"body":"Release time: 2021-01-06 15:28:01\n onecloud Repository: https://github.com/yunionio/onecloud\n10 commits to onecloud - v3.6.2 since this release.\nBug Fixes (6)  cloudevent: cloudevent is domain level resource (7d07b4aa5, Qu Xuan) esxiagent: nicIndex should be incremented (77e56db09, rainzm) monitor: modify totalrecord query (562aefda8, zhaoxiangchun) monitor: modify rds,redis,oss field descriptions (589daf506, zhaoxiangchun) region: server start check host memory is enough (a066301ae, wanyaoqi) region: rds list with secgorups info (b96f22527, Qu Xuan)  Features (4)  monitor: get today alerting resource info (de2b95cab, zhaoxiangchun) region: stop guest before freeze (38914b967, wanyaoqi) region: be compatible with changes in monitor api in scaling group (987b641bd, rainzm) suggestion,apigateway: add analysispredict climc (40c8b54cb, zhaoxiangchun)  ","excerpt":"Release time: 2021-01-06 15:28:01\n onecloud Repository: …","ref":"/v3.6/en/docs/changelog/release-3.6/3-6-2/","title":"v3.6.2"},{"body":"发布时间 2021-01-06 15:28:01\n onecloud 仓库地址: https://github.com/yunionio/onecloud\n10 commits to onecloud - v3.6.2 since this release.\nBug Fixes (6)  cloudevent: cloudevent is domain level resource (7d07b4aa5, Qu Xuan) esxiagent: nicIndex should be incremented (77e56db09, rainzm) monitor: modify totalrecord query (562aefda8, zhaoxiangchun) monitor: modify rds,redis,oss field descriptions (589daf506, zhaoxiangchun) region: server start check host memory is enough (a066301ae, wanyaoqi) region: rds list with secgorups info (b96f22527, Qu Xuan)  Features (4)  monitor: get today alerting resource info (de2b95cab, zhaoxiangchun) region: stop guest before freeze (38914b967, wanyaoqi) region: be compatible with changes in monitor api in scaling group (987b641bd, rainzm) suggestion,apigateway: add analysispredict climc (40c8b54cb, zhaoxiangchun)  ","excerpt":"发布时间 2021-01-06 15:28:01\n onecloud 仓库地址: …","ref":"/v3.6/zh/docs/changelog/release-3.6/3-6-2/","title":"v3.6.2"},{"body":"Release time: 2020-12-29 21:30:18\n onecloud Repository: https://github.com/yunionio/onecloud\n7 commits to onecloud - v3.6.1 since this release.\nBug Fixes (5)  climc: host add netif add params bridge/interface (7335875ef, wanyaoqi) cloudcommon: splitable may not initialize underlying table (732159137, Qiu Jian) host-deployer: add log line on blkid failed (a4323eab4, wanyaoqi) notify: inject domain info in ReceiverManager.FetchOwnerId (25baa6f50, rainzm) region,host: sync status check block jobs (d2ec564cc, wanyaoqi)  Features (2)  db: progressive inspection when determining the required scope (af274d7ad, rainzm) region: multilingual timer description (8d98218f0, rainzm)  ","excerpt":"Release time: 2020-12-29 21:30:18\n onecloud Repository: …","ref":"/v3.6/en/docs/changelog/release-3.6/3-6-1/","title":"v3.6.1"},{"body":"发布时间 2020-12-29 21:30:18\n onecloud 仓库地址: https://github.com/yunionio/onecloud\n7 commits to onecloud - v3.6.1 since this release.\nBug Fixes (5)  climc: host add netif add params bridge/interface (7335875ef, wanyaoqi) cloudcommon: splitable may not initialize underlying table (732159137, Qiu Jian) host-deployer: add log line on blkid failed (a4323eab4, wanyaoqi) notify: inject domain info in ReceiverManager.FetchOwnerId (25baa6f50, rainzm) region,host: sync status check block jobs (d2ec564cc, wanyaoqi)  Features (2)  db: progressive inspection when determining the required scope (af274d7ad, rainzm) region: multilingual timer description (8d98218f0, rainzm)  ","excerpt":"发布时间 2020-12-29 21:30:18\n onecloud 仓库地址: …","ref":"/v3.6/zh/docs/changelog/release-3.6/3-6-1/","title":"v3.6.1"},{"body":"Release time: 2020-12-29 14:17:58\n onecloud Repository: https://github.com/yunionio/onecloud\n1029 commits to onecloud - v3.6.0 since this release.\nAdd (2)  DisableDelete for lb (73e8080d4, Qu Xuan) vpc peering connection (bd22eb0b1, lvyangyang)  Apigateway (1)  disable influxdb service query proxy (81da6c577, Zexi Li)  Baremetal (1)  fix pxe filter network by guest_dhcp (129001dfb, Zexi Li)  Bug Fixes (516)  自动生成华为云rds密码 (a08fb0044, Qu Xuan) add keystone sync user debug info (#7633) (585ba0ff5, Jian Qiu) turn off some default project policies (#7636) (cb573d340, Jian Qiu) aovid truncated data (#7643) (21342005e, 屈轩) cleanup logic for nics of pending_deleted guests (#7668) (7336ff732, Jian Qiu) 不限制openstack系统盘类型 (#7674) (a5c3a34b7, 屈轩) server purge may fail (#7696) (3ccf78ae7, Jian Qiu) http error limit request body length (#7699) (d0842c62c, Jian Qiu) apigateway user info add is_local attribtue (#7694) (8ba3f86b5, Jian Qiu) vmware esxi host detects vnic portgroup info (#7649) (2ea855a42, Jian Qiu) avoid delete aws iam user failed (#7664) (8cf594785, 屈轩) add details for account delete (#7702) (416afb686, 屈轩) climc params (5eaece551, Qu Xuan) avoid policy value not save (0cc0a1991, Qu Xuan) avoid nil panic (5b3bfd1b3, Qu Xuan) compatiblity fixes with lenovo RD620 and huawei 2288 (f6eb9fc19, Qiu Jian) valid update name and update dns recordset (80c75b19a, Qu Xuan) search by chs projectname or domainname (64f5bc748, Qiu Jian) optimized cloudid (fd318a9cd, Qu Xuan) optimzed sync (ce032ecf1, Qu Xuan) find correct esxi host access ip (053507c3e, Qiu Jian) remove redundant auth cookie in sso login (ef138c05d, Qiu Jian) support VirtualDiskRawDiskMappingVer1BackingInfo (a672c6b33, Qiu Jian) scheduler aware policy (b8238d205, Qiu Jian) cloudid optimized (7232695df, Qu Xuan) network address list respect privilige of user (09944bc1b, Qiu Jian) skup syncing lb, rds, redis instances in tasks (9de29d9af, Qiu Jian) user idps attributes includes template name (383bdef22, Qiu Jian) aliyun wulanchabu region (46e6d37c2, Qu Xuan) sync groups for user (491efe579, Qu Xuan) check assign-host previliges (4d5aadb64, Qiu Jian) prevent users in disabled idp from login (9e1ff8819, Qiu Jian) ignore 409 error when doing redfish power on (65141a277, Qiu Jian) wire usage stats incorrect (d7e330f9e, Qiu Jian) uniform cachedimage active status (f09bb6682, Qu Xuan) optimzed clouduser password (a00447022, Qu Xuan) recode project-role rpc handle to support group role assignment results by user or project (332ba04bd, Qiu Jian) avoid create public zone failed (d9626e310, Qu Xuan) optimzed clouduser (7361da408, Qu Xuan) optimized qcloud keypair (f4ecde37c, Qu Xuan) 腾讯云不支持同时设置秘钥和密码,若设置秘钥，则将密码置空 (a2b9a7906, Qu Xuan) 平滑迁移数据 (8284f7b29, Qu Xuan) add dns recordset dns value check (fc8fb8af5, Qu Xuan) avoid sync natgateway eip panic (dab5b6e43, Qu Xuan) 默认不自动合并安全组 (8e39b7ccb, Qu Xuan) disable webkms for esxi older than 6.5 (239797e33, Qiu Jian) check host sharing status when considering whether a host is assignable (04f036ce2, Qiu Jian) cos use proxy (bb7ad07c2, Qu Xuan) add doc for qcloud (3c29402c1, Qu Xuan) 支持自动根据云上项目修改本地项目名称 (e86509a88, Qu Xuan) lock/unlock cleanup (41f932e38, Qiu Jian) bucket object cnt fix (cbd08138b, Qu Xuan) 避免名称重复 (1b3d3310d, Qu Xuan) enable generate name caused compability issue (1a3acbd05, Qiu Jian) omit empty fail reason (5a91ae886, Qiu Jian) keystone initialize data skip nil extra fields (b80fa64b6, Qiu Jian) disable qcloud verifyAppId temporarily (01fe002dd, Qiu Jian) feature: vpc peering connection support (466d96135, Qu Xuan) add esxicli vmrc/webmks command (5a8ee9d91, Qiu Jian) get jnlp xml from dell idrac6,7,9 (eea88ffbe, Qiu Jian) reset user password without check (b5f01171d, Qiu Jian) scheduler token not support policy (c516525db, Qiu Jian) avoid not reture cloudprovider.ErrNotFound error (37b87d1a5, Qu Xuan) 优化提取显示主账号名 (924053685, ioito) 避免添加新账号后长时间未同步iam用户 (fadb52044, ioito) dns 错误信息补全 (8f7a59894, lvyangyang) apigateway userinfo includes project metadata (06c1de7c1, Qiu Jian) 避免腾讯云同步虚拟机ip异常 (146683059, ioito) role assignment filter by users not working for effective users in groups (6cbd81181, Qiu Jian) error 值重叠 (9b54d58a3, lvyangyang) avoid account delete failed (8be3cfd22, ioito) use i18n.Table to handle Chinese-English conversion (c5a78a902, rainzm) scope resource filter by owner (4a27d4912, Qiu Jian) 仅在可用区故障时可强制挂载磁盘 (0a4bd281d, ioito) avoid serial vm creation (f7010a6d7, ioito) avoid compare err with cloudprovider.ErrNotFound direct (cb919f288, ioito) sql err (1b9106032, ioito) avoid account delete failed (8c0776c2a, ioito) allow cross doamin resource sync (eaef5a757, ioito) openstack zone not emulated (a31339f68, ioito) avoid purge storages (a8996ec9d, Qu Xuan) add climc support vpc/schedtag user metadata (bd122a01f, Qiu Jian) allow create disk prefer manager (74cb19cd8, Qu Xuan) dns zone cache owner info (a14b4e590, Qu Xuan) 支持公有云域过滤操作日志 (ef3d74f4e, Qu Xuan) filter cloudprovider/network by host-schedtag-id (23a18a81f, Qiu Jian) suffix template cache key (5f10a9a39, rainzm) filter storages by host schedtag (69561b40f, Qiu Jian) avoid sync dns zone cache status is init (9d76c3e02, Qu Xuan) allow domain admin view shared dns zone records (d45d48806, Qu Xuan) revert filter-by-owner changes of scoped resource (4e4ea5e6b, Qiu Jian) oidc response user’s info (be4a76b25, Qiu Jian) emulated wire not sync vpc shared info (c5cfceeb9, Qiu Jian) 允许域管理员可以看到共享的dns zone cache列表 (24fcccf5f, Qu Xuan) error code of external bucket not found error should be 404 (6a5fdc5d0, Qiu Jian) avoid qcloud secgroup cache name not sync (35e57a833, Qu Xuan) server name auto index should start from 1 (a08a779ed, Qiu Jian) filter cached images with host schedtag (1c0c66fd4, Qiu Jian) qcloud set hostname for instance (aa7495c9a, Qu Xuan) avoid slice out of bounds (e010c5c1f, rainzm) validate secgroup purge condition (6f2359329, Qu Xuan) not clean pending domain usage (624c4db06, Qiu Jian) format errors that block make test (5e5b0613f, Qiu Jian) ldap sync not update user’s phone and email (13fa3c299, Qiu Jian) project_id in resource details not correct (187dee690, Qiu Jian) vpc peering http error params (db7d32cd1, lvyangyang) qcloud instance with max bandwidth (bb62c0392, Qu Xuan) qcloud eip with bandwidth attr (b32c54f7c, Qu Xuan) trans google new region name (17ff08282, Qu Xuan) 支持带宽包用户 (f3c819299, Qu Xuan) support public ip create (02ec88ccc, Qu Xuan) sync huawei bucket project info (4b1d914b8, Qu Xuan) 优化安全组规则同步 (efa5978cf, Qu Xuan) support fake tempalte when searching template vm (281d1c45d, Rain) use new api (db6846aab, Qu Xuan) filter role assignments by project domains id or name (b2add97a0, Qiu Jian) filter project role with system=true (e2e186a75, Qiu Jian) support filter rds sku by provider (0dc485d58, Qu Xuan) allwo filter resource by with-meta and with-user-meta filter (c4d30371e, Qiu Jian) 避免并发同步安全组导致规则混乱 (0e3f78100, Qu Xuan) resolve with_meta filter conflict (cc7423d55, Qiu Jian) sync dns records after sync vpcs (914b76069, Qu Xuan) get images distinct field (f14ec60a7, Zexi Li) hostname for instance (65582cab9, Qu Xuan) huawei clirc region not correct (3d7021322, Qu Xuan) add rds cpu and memory usage (d7ae0eaa8, Qu Xuan) use correct worker (dc8086b3c, Qu Xuan) do not lock guest after lock eip, to prevent possible dead lock (0466b2c80, Qiu Jian) remote update metadata may cause metadata update loop (20f3feaab, Qiu Jian) reduce change config logs (d681a148d, Qiu Jian) missing authenticate action log for user web login (adbf51316, Qiu Jian) 新增google存储类型 (f7b16c592, Qu Xuan) cancel pending-delete should increase resource quota usages (2486aa307, Qiu Jian) monitor commonalert not detach alert resource (06a30edcf, Zexi Li) add lb quota check (5e4cc3314, Qu Xuan) add rds quota check (f74e345b0, Qu Xuan) secgroup quota support (adcce7538, Qu Xuan) add aliyun new region (80b0ed3cc, Qu Xuan) 避免冲掉设置的到期释放时间 (98bd229b3, Qu Xuan) don’t update NextSyncTime when snapshots that should be added has not (213d495a3, rainzm) sync rds account host info (fb7d22f67, Qu Xuan) add duration match (f159c7318, Qu Xuan) qcloud 5.5 single zone (cdd652c1e, Qu Xuan) 支持批量创建rds (9a03bf17c, Qu Xuan) 支持多安全组 (5cd26b297, Qu Xuan) 避免参数异常 (9821f7fe9, Qu Xuan) climc vpc-create missing cloudregion_id (588fff60f, Qiu Jian) server usage status not correct (ce06e078f, Qiu Jian) avoid delete public ip when sync eip list (d60dee6a9, Qu Xuan) qcloud server create (0e5835ffa, Qu Xuan) optimized cloudaccount climc (64740ff0f, Qu Xuan) avoid sync project panic (6ee94ab41, Qu Xuan) set secgroup status (b6016939c, Qu Xuan) avoid sync part of rds (a01cd0a81, Qu Xuan) use option manager for scheduler (8f2c51469, Qiu Jian) allow set customized private prefixes (dcc689cc1, Qiu Jian) fail to delete public_ip eip (554ec8873, Qiu Jian) make test go vet error (08bb11db6, Qiu Jian) scopedpolicies and scopedpolicybindings swagger resource name (46fe31cbd, Qiu Jian) compatible with qcloud zonal bucket (3f568a63d, Qiu Jian) classic vpc for rds (0f4114449, Qu Xuan) sync rds class vpc (d9e72f78e, 屈轩) enforce response charset (9073461f9, Qiu Jian) secgroup cache tenant_id (373166c50, Qu Xuan) filter scopedpolicybindings with multiple categories (56e5b177d, Qiu Jian) save service config changes may send invalid action log (354bcd9f0, Qiu Jian) scopedpolicybinding filter by category sql error (10a4d86d2, Qiu Jian) avoid not found cdbro- mysql instance (dc59a0872, Qu Xuan) add qcloud hssd (5b4efddec, Qu Xuan) scopedpolicybindings filter by scope project (32fe10b00, Qiu Jian) elasticcache quota not take effect (9f122f745, Qiu Jian) add rds status and expired time (f47f2c51e, Qu Xuan) auth permission result incorrect (4349cc7f9, Qiu Jian) save sso login status in cookie (ae327021d, Qiu Jian)   server generate name should be historically unique 2. ipaddr of a batch of server is in the same order as generated name (4431acde8, Qiu Jian)   missing column error when order by extra fields (03d17e6fb, Qiu Jian) 支持多内存过滤套餐 (25aed0a7e, Qu Xuan) aliyun eip api (cdead1c47, Qu Xuan) change owner should update quota usages (1bd4b85bf, Qiu Jian) add panic log for worker task (e97cd02b5, Qu Xuan) sync remove dirty rds accounts (008fd554c, Qu Xuan) search by name and order by scopedpolicy for scopedpolicybindings (73e117c6e, Qiu Jian) change level of scopedpolicy to system (79ad3c188, Qiu Jian) support rds set auto renew (a7e832488, Qu Xuan) aws secgroup out rule is deny any (bc28c8bdf, Qu Xuan) rds task fix (0272c7695, Qu Xuan) qcloud rds set renew flag (c56ebfd04, 屈轩) role-set-policies support update only operation (d66ee1fd4, Qiu Jian) avoid lock reentry (cfebba255, Qu Xuan) avoid check region log every time when account status is unknown (c2c9edd9c, Qu Xuan) renew rds (98d20725a, Qu Xuan) support create 512mb server sku (c7a6ec8e9, Qu Xuan) public ip and duration for create params (d7ab5fdd1, Qu Xuan) avoid panic (7a6022561, Qu Xuan) creating esxi guest from instance snapshot (781870953, rainzm) support resize qcloud hssd disk (b8410be11, Qu Xuan) keystone init empty catalogy cause panic (b84f23796, Qiu Jian) host memory usage status not correct (157fb1e48, Qiu Jian) mcclient panic when keystone init empty service catalog (2a1b5f8a7, Qiu Jian) baremetal usage should exclude converted hypervisor (8fcc85745, Qiu Jian) set isp’s status as ‘instance_snapshot_reset’ when reseting guest from isp (8ef1af0db, rainzm) adjust default identity quota (4d04059bc, Qiu Jian) qcloud create bucket without appId (38018080c, Qiu Jian) add error cause (83f5ce431, Qu Xuan) support import rules for secgroups (cece2852a, Qu Xuan) add err handler for notifyRobot (36dec7baa, rainzm) 支持关机不收费 (11c3f6a6e, Qu Xuan) add host-joint resources into domain level resources (7fbe72ce5, Qiu Jian) add host.memoty.total and host.cpu.total usage stats (bc5c74b1b, Qiu Jian) cloudid api addr (4592299ff, Qu Xuan) 优化azure资源同步 (0d85df52b, Qu Xuan) optimized jsonRequest (06581ad1a, Qu Xuan) allow disk attach to multiple guests (0718da3d7, Qiu Jian) avoid openstack image-list failed (#7640) (2716d4527, 屈轩) apigateway: allow logout by get method (ff24d4a3e, Qiu Jian) awscli: instance-rebuild-root fix (eee13a549, TangBin) baremetal: convert to host failed (eb857594f, Zexi Li) baremetal: clear jbod disks do PDMakeGood (f6bf3050f, Zexi Li) climc: replace ' -\u003e \" (cb594298d, Qu Xuan) climc: server-create –desc not work (df45ced78, Zexi Li) cloudcommon: add rbac_policy_refresh_internval_seconds option (6caec234a, Qiu Jian) cloudcommon: adjust policy refresh to default 30 seconds (b9d30c08a, Qiu Jian) cloudcommon: disable quota check by default (6f7a3cf8a, Qiu Jian) cloudcommon: panic when query an empty splitable model manager (ba8754687, Qiu Jian) cloudcommon: query filter ineffective for splitable (41b694ad3, Qiu Jian) cloudcommon: perform public should check the sharing scope of resource (de47e4a69, Qiu Jian) cloudcommon: supplement i18n translations (83a5f95b0, Qiu Jian) cloudevent: adjust cloudevents resource scope (540af1a3a, Qiu Jian) cloudevent,devtool: missing metadata table (5d298e71b, Qiu Jian) cloudid: add for notify templete (2faead462, Qu Xuan) cloudid: avoid new public account sync system policy delay 1 day (f05fc1894, Qu Xuan) cloudid: avoid empty auth url (869740775, Qu Xuan) cloudid: sync qcloud collaborators user (82dc17907, Qu Xuan) cloudid: optimized system policy sync (8a5e682b0, Qu Xuan) cloudid: auto update saml provider metadata (61d21d2b4, Qu Xuan) cloudid: huawei saml provider create issue (b460a73b0, Qu Xuan) cloudid: avoid use invalid character for role name (fd948b8cc, Qu Xuan) cloudmon: deal cannot get azure metric (d2459a5cc, –global) compute: filter cachedimage with health storage (625bf2356, rainzm) compute: return InputParameterError while ValidateCreateData (f11a1df3a, rainzm) esxi: check whether some fields of vm are nil (3c59d7fec, rainzm) esxi: filter linkLocalAddress (e4217074c, rainzm) esxi: return when host.Vm is empty (08041d55d, rainzm) esxi: fetch templatevm from datacenter before clone vm (5c209fe3d, rainzm) esxi: check nil value when NewVirtualMachine (01ba4b952, rainzm) esxi: don’t specify spec.Identity when osName is empty (be0e8d73b, rainzm) esxi: Guarantee the uniqueness of the schedtag for esxi host (370e7723b, rainzm) esxi: resize root disk after creating vm (9daef7d97, rainzm) esxi: resize root disk after cloning vm (bd014a6ad, rainzm) esxi: use correct device index (6afa80305, rainzm) esxi: add device after cloning vm (7aa5b28b3, rainzm) esxi: no callback in uploadHandler (d616b4004, rainzm) esxi: use system disk of template only when cloning vm (bffa601dc, rainzm) esxi: search template from whole vCenter (d4c9e6e56, rainzm) esxi: filter vmdk item in lease.info (26b1050b3, rainzm) esxi: return sumsize of disks fo template (d01b6e150, rainzm) esxiagent: add HostDelayTaskWorkerCount (a0c34a044, rainzm) esxiagent: check whether regexp is nil (e43c86586, rainzm) esxiagent: return image extid not id (5789c6ded, rainzm) esxiagent: add humanized tips when searching vm failed (eb3da9369, rainzm) git,make: 更新获取 git branch 的规则 (e8376f998, Zhang Dongliang) git,make: git branch 获取方式优化 (d7d4e6bf6, Zhang Dongliang) git,make: 修正 gitbranch 变量的获取方式，允许外部传入，解决自动升级版本 tag 不统一的问题 (b0a95cbbe, Zhang Dongliang) glance: list image by os arch use startwith (f3404f678, wanyaoqi) glance: allow public and private operations of guestimage (5824b7add, rainzm) go.mod: remove k8s.io/kubernetes dependency (734be7c14, Zexi Li) host: add print migrate progress info (6c96e6d1f, wanyaoqi) host: make sure it won’t match vpc guests by accident (428e3ab1f, Yousong Zhou) host: update telegraf conf adapter to container environment (cbc285924, wanyaoqi) host: check lease living on restart etcd session (1611ddfcd, wanyaoqi) host: fix check hugepage enabled (fbd53b493, wanyaoqi) host: fix set windows password with escape charater (539baf7ba, wanyaoqi) host: wait put host offline success (83c1073f6, wanyaoqi) host: telegraf listen on local ipv4 address explicitly (460645871, Qiu Jian) host-deployer: cancel rename centos vgname (41631ec09, wanyaoqi) host-deployer: probe image info umount rootfs first (7ed96af33, wanyaoqi) hostdeployer: umount rootfs before resize partition (27378f2c8, rainzm) keystone: ignore service config update without changes (e817076c6, Qiu Jian) keystone: panic if request with an invalid token (5a7193198, Qiu Jian) keystone: oidc driver turn on debug mode if log-level is debug (e826239ab, Qiu Jian) keystone: update user attributes whenever user login (a4b4a1d16, Qiu Jian) keystone: rolepolicies list panic if filter by domain scope (695075a85, Qiu Jian) keystone: always upload\u0026refresh service config whenever service restart (97eb6e7bc, Qiu Jian) keystone: add i18n description for policy and role (334b347eb, Qiu Jian) keystone: ignore deleted policies when matching policies (86476c22a, Qiu Jian) keystone: allow unlink a domain from an IDP (253fba47f, Qiu Jian) keystone: not allow to disable sql driver (695aa81f7, Qiu Jian) keystone: allow refresh scope resource (3e7d3c829, Qu Xuan) keystone: service config ignore deploy server socket path (8287f3767, wanyaoqi) keystone: oidc data may be encapuslated in data field (95db19f10, Qiu Jian) locales: fix translation text (65571cc5e, Yousong Zhou) log: fail to submit action log (1a2a40a81, Qiu Jian) mcclient: options: webconsole: fix passing ssh port (8a4c1a0bb, Yousong Zhou) monitor: fix nodata alertresource list (cdcfc7923, –global) monitor: add resType filter (ccf065358, –global) monitor: suggestalert ignore throw err (81e4463ab, zhaoxiangchun) monitor: modify suggestrule process influxdb data (ed13fe9e1, zhaoxiangchun) monitor: other servier create alert add used_by param as a agreement (2ba98e7ce, –global) monitor: modify monitor serviceType in StartService() (db565fe0c, zhaoxiangchun) monitor: monitor notify international and 3.6 bugfix (ab14706ff, –global) monitor: sore reture info：resourceType,measurement (ba2233438, –global) monitor: delete suggestConfig auto init data (815e16eca, zhaoxiangchun) monitor: modify influxdbSuggestDriver query err (96d0f0e63, zhaoxiangchun) monitor: modify notify alertInfo and alertOk detach resource (68dfa8a8c, zhaoxiangchun) monitor: modify monitor nodata alert matching onecloud host func (2564f3c06, zhaoxiangchun) notify: check for changes before updating config (6591ccedc, rainzm) notify: return the result of the second attempt to execute the rpc call (b1ef8865b, rainzm) notify: pull contact for workwx, dingtalk and feishu (1517ed79f, rainzm) notify: allow normal user create their receiver (5bfc3128c, rainzm) notify: break down permissions of notifyconfigs (a9fafc451, rainzm) notify: customize the title of the verification email based on the copyright (d3aae0009, rainzm) notify: clean verifyNote when mark verified (e47f8a896, rainzm) notify: add AllOkContactTypes in where permanently enabled and verified ContactType (fbc951330, rainzm) notify: repull subcontact after changing config (c5acc1b48, rainzm) notify: Set default priority ‘normal’ when creating notification (9af0fe1fe, rainzm) notify: fit correctly when send notification via contact (cdf782537, rainzm) notify: return correct value when sortContactType (c522b4524, rainzm) notify: be compatible with keystone’s UsersV3.GetById (7ed99506a, rainzm) notify: modify name of notification to avoid duplication (087927871, rainzm) notify: Mark verified not enabled in MarkContactTypeVerified (9029e98c2, rainzm) notify: use AfterSend for contact with succuessful sending (9978f1954, rainzm) notify: Allow user list receivers (2ea4138f3, rainzm) notify: avoid deadlock (b1abb353a, rainzm) notify: Replace String() with GetString() (6509ed6e9, rainzm) region: fix backup server start task (735f10a50, wanyaoqi) region: fix modify tags log (de67ee5a2, lvyangyang) region: remove default value of diskConfig.Medium (216e11f29, rainzm) region: roll back the optimization of cachedimage list (eef90b58e, rainzm) region: allow member user get saml auth addr (dea1f29aa, Qu Xuan) region: optimized qcloud secgroup sync, only redis need secgroup be in same project (a84ed01f2, Qu Xuan) region: server skus add cloud_env (d39b3e820, TangBin) region: dbinstance skus sync log level fix (7be898fbc, TangBin) region: change dbinstance sku sync info log to warn (133ba01e9, TangBin) region: validate invalid character for password (35544a7c2, Qu Xuan) region: region qcloud secgroup project id (45a3ce82d, Qu Xuan) region: inspect invalid guest template (5602db8f5, rainzm) region: huawei vnc protocal fix (8db56d90f, TangBin) region: elb cached acl sync (69fa370b0, TangBin) region: optimized azure rebuild root (0252c00ef, Qu Xuan) region: avoid resize azure disk error (0bfa488ac, Qu Xuan) region: sync automatically snapshot for external disk (f13c12d0c, rainzm) region: init NextSyncTimeiwhen create snapshotpolicydisks (a2d221685, rainzm) region: add suffix ‘display’ for time_points and repeat_weekdays (92d862b17, rainzm) region: elastic cache name is empty fix (8bdcc83a8, TangBin) region: redis master zone empty fix (76eb12489, TangBin) region: lb listener filter by acl_id (08dda723b, TangBin) region: lbcert\u0026lbacl releated listener count bugfix (7b96d2593, TangBin) region: avoid timeout for waiting azure async task (f22fe4fe3, Qu Xuan) region: azure win os defualt user (a82327388, Qu Xuan) region: azure reset windows os password (81b31b2fe, Qu Xuan) region: compute binded disk count when deleting snapshotpolicy (2f6678f9a, rainzm) region: avoid qcloud sync local disk error (0c7adedaa, Qu Xuan) region: prevent dirty data when syncing snapshot (c6864e4ae, rainzm) region: detach all snapshotpolicy when realdeleting disk (e660946d2, rainzm) region: temp url sign wrong (c6a7a8701, Qu Xuan) region: omit vpc quota check if vpc created by owner (e38ea05c2, Qiu Jian) region: azure instance data disk storage type (3633baaa2, Qu Xuan) region: clear dirty data of snapshotpolicydisks when start up (7582ead4c, rainzm) region: attach network on register baremetal server (dcd893692, wanyaoqi) region: compute NextSyncTime for snapshotpolicydisk (97f93e6a1, Rain Zheng) region: allow delete resource which status is unknown (f35be9756, Qu Xuan) region: openstack available zones (7abd40c54, Qu Xuan) region: validate isolated devices on migrate (78e8d2f35, wanyaoqi) region: restore password validate condition (acedb4a4f, Qu Xuan) region: sync account id (e540e6561, Qu Xuan) region: allow resize system disk of esxi (46e42724b, rainzm) region: allow update rds account and database desc (e483d1901, Qu Xuan) region: support openstack subnet allocation pools (edcff8045, Qu Xuan) region: optimized qcloud prepaid instance delete (b5b7e89c6, Qu Xuan) region: optimized openstack change config (0d32c5d8e, Qu Xuan) region: sanitize eip charge type on all callsites (14d6c9d6e, Yousong Zhou) region: add SDnsZoneCache to DnsZoneCacheDetails (6efb3fc12, rainzm) region: delete guest without ‘purge’ in GuestDetachScalingGroupTask (0edec40b2, rainzm) region: code gen api error (b6ace002d, Qu Xuan) region: secgrouprule: set model manager (73f434e03, Yousong Zhou) region: aws default account (97eab67f0, Qu Xuan) region: openstack hosts sync (8692498cb, Qu Xuan) region: optimized rds backup create (2a6421258, Qu Xuan) region: reserved name checking while create redis account (a924c9552, TangBin) region: sort excludedNets correctly (c1d95bc31, rainzm) region: pass up error from InitializeData (d2e304bae, Yousong Zhou) region: import rule error hint (a8116b525, Qu Xuan) region: support rds secgroup operation (c5a974e74, Qu Xuan) region: gpu server change config use reserved resources (b07387b57, wanyaoqi) region: apsara is private cloud (21d9edcfa, Qu Xuan) region: aws lb create tags param (4cb9c936c, lvyangyang) region: sku enabled (92fee001e, Qu Xuan) region: allow reset huawei system disk (3ed59afae, TangBin) region: bucket get referer fix (0174e686d, lvyangyang) region: server login info\u0026 keypair import input parameter trimspace (f20ca8b9c, TangBin) region: cloudregion\u0026zone add namei18n (2a4a762f2, TangBin) region: get provider name via GetProviderName (843534c29, rainzm) region: get provider name via GetProviderName (1c475b091, rainzm) region: optimized server stop code (0a8348a36, Qu Xuan) region: network reserved ip count not consider expiration of reserved ips (d8684ea5a, Qiu Jian) region: fix set bucket referer (6f3cabda6, lvyangyang) region: auto sync cloudaccount resources (e056bb102, Qu Xuan) region: apsara optimized (38a0b76a5, Qu Xuan) region: purge private cloud sku (a2b15c596, Qu Xuan) region: sku.meta use global proxy (14bdbea3e, Qu Xuan) region: huawei sync storages bugfix (d5973135d, TangBin) region: prevent infinite recursion (d2ed19175, rainzm) region: optimized disk allocate sched failed log (27a2d36ff, Qu Xuan) region: baremetal post update related server (d001e0ec8, Zexi Li) region: qcloud request retry (e52fb3260, Qu Xuan) region: avolid aliyun fin bucket list objects error (061c5d6dd, Qu Xuan) region: wire get vpc releated hosts is empty (bcfb05019, Zexi Li) region: network clean schedule cache after real deleted (3c85ed11b, Zexi Li) region: vpc list usable fix (b30a40d70, TangBin) region: aws detach igw before delete vpc (da8232807, TangBin) region: vpc create validate cidr mask length (b46d51d1e, TangBin) region: set ownerId as userCred when can’t FetchOwnerId (dbb1d8072, rainzm) region: chooseHostStorage (cfc58a356, rainzm) region: aws create root device name fix (68a2111bf, TangBin) region: aws create storage type fix (9218c9e0b, TangBin) region: sku list query print missing error info (72153ecf5, TangBin) region: aws vpc delete related route table \u0026 internet gateway (9f52afdf9, TangBin) region: aws vpc delete skip delete default secgroup (5ff27734b, TangBin) region: aws delete vpc skipped delete main route table (ac8939494, TangBin) region: fetch correct ownerId in PerformPrepareNets (60490c75d, rainzm) region: aws create vpc with igw add defaultroute (efb436871, TangBin) region: vpc usable fix (596b376d8, TangBin) region: vpc sync external access mode fix (cef3d52f0, TangBin) region: aws sync vpc access mode bugfix (834f5a97d, TangBin) region: split brand as ‘YunionCloud’ and ‘云联壹云’ when notify server event (43d45a1b4, rainzm) region: climc add base projects options (4d4c84801, TangBin) region: allow delete storagecachedimage with ‘cache_failed’ status (ed2a86774, rainzm) region: add GetSlaveFieldName for ScalingGroupGuest (36f43fba9, rainzm) region: start vm when ‘auto_start’ is true (a14b556f2, rainzm) region: exclude network recommended for host when suggesting network for guest (930c64315, rainzm) region: skus add cloudenv (f17593d3f, TangBin) region: apsara metrics fix (a67b09668, Qu Xuan) region: remove i18n fix \u0026 zone \u0026region name support i18n (e28955301, TangBin) region: guestnetworks: use net calculated mtu (6e449c123, Yousong Zhou) region: ignore params.Disks when cloning vm from snapshot (4d13956bc, rainzm) region: add size and storageType for VMware InstanceSnapshot (6ea550d01, rainzm) region: make project of instance snapshot be consistent with the instance (727b89db5, rainzm) region: save when canceling pendingUsage (6d2e91439, rainzm) region: eip_allocate_task: set eip status allocate_fail on task failure (bb0568d18, Yousong Zhou) region: purge all instance snapshots when purging guest (1561d6539, rainzm) region: fix change config forecast (52f0afda0, wanyaoqi) region: update translations (25eb67b37, TangBin) region: create vm with eip task fix (2e401b566, TangBin) region: ctyun delete server bugfix (bc3fdb890, TangBin) region: vpc create data cird validate (ad39e790d, TangBin) region: network create mask length validate (755f4a93a, TangBin) region: remove unnecessary vpc validate create date error wrap (e4f372ba5, TangBin) region: set qcloud instance del timeout to 20m (2d7cdad8f, Qu Xuan) region: guest to create input keep billing info (f8c4c008f, wanyaoqi) region: do not change disk status on migrating (e26fb5cc1, wanyaoqi) region: qcloud bucket set cors (f1b428be0, lvyangyang) region: valid qcloud hssd for system disk (828141168, Qu Xuan) region: sync servers (d2d96b122, Qu Xuan) region: get qcloud bucket cdn-domain (b5d50fdfc, lvyangyang) region: ignore classic vpc checkout while add lb backend (4e811240e, TangBin) region: azure secgroup rule not allow with same priority and direction (2b0e8afe0, Qu Xuan) region: redis create account add name validate (0bbba6d3f, TangBin) region: private cloud sku create (1aec7ab25, Qu Xuan) region: delete aliyun account bugfix (e5289f8a4, TangBin) region: compatible aliyun fin oss (0feddb13a, Qu Xuan) region: avolid panic when list role’s policies (059cd7527, Qu Xuan) region: create redis validate network and sku zone match (c18d1f0e7, TangBin) region: checking cloudenv while create/update aliyun cloud account (767e06a1d, TangBin) region: purge account bugfix (96d2e2403, TangBin) region: create/update aliyun account bugfix (6391ef84d, TangBin) region: add RequestSyncstatusOnHost for SESXiGuestDriver (3fb175ba7, rainzm) region: elasticcache_instances: fix error fmt (ab7ba8322, Yousong Zhou) region: lbbackend: better error reporting for finding influxdb info (48f1cf12a, Yousong Zhou) region: cert\u0026acl cache delete condition check (c4eda6b5a, TangBin) region: aliyun elb listener\u0026lbbg sync project (1a4faf410, TangBin) region: elb acl validate create data fix (0c3a1986f, TangBin) region: lbacl \u0026lbcert default share scope (5a10db10c, TangBin) region: fix openstack instance os type (9c0ce58a0, Qu Xuan) region: add instance capability info(default account) (cfd7c5bd9, Qu Xuan) region: azure host with storage (8207a9c99, Qu Xuan) region: avoid openstack change config error (b60d18c06, Qu Xuan) region: apsara account fix (ab58f0335, Qu Xuan) region: add saml auth for capability (90709ab70, Qu Xuan) region: set classic vpc name to “-” (db00c8355, Qu Xuan) region: 避免从云上同步下来的主机，创建相同配置时network_id为空 (f150da6d9, Qu Xuan) region: add huawei gpssd desc (a9c6579b6, Qu Xuan) region: aliyun sync region fix (8682c71d9, TangBin) region: aliyun region name (bb091a3cb, TangBin) region: aliyun zone name fix (85324cadf, TangBin) region: openstack network is regional (ea41bb4f1, Qu Xuan) region: avoid public ip bandwidth is zero (5dea11952, Qu Xuan) region: change_ipaddr: retain eip_id on detach and attach (f33b9c716, Yousong Zhou) region: 避免OneCloud密码校验通过，公有云厂商密码校验不通过 (782372c35, Qu Xuan) region: azure async task (09adc5f60, Qu Xuan) region: azure metric request path (a79a61c41, Qu Xuan) region: validate cloudaccount saml auth params (a9ef8a1e3, Qu Xuan) region,baremetal: choose candidate network not according by types (9f2b137f0, Zexi Li) region,baremetal: pxe net reuse converted server access ip (829faa1ab, Zexi Li) region,climc: eips: rename arg name for requested eip addr (baff00483, Yousong Zhou) region,esxiagent: allow host behind a nat (197049dcb, Qiu Jian) region,glance: list by os arch adapt to empty strings (027a9439c, wanyaoqi) region,host: fix hot remove nic (7c1923abf, wanyaoqi) region,scheduler: fix netwrok predicate (c8ca855cb, wanyaoqi) region,yunionapi,glance: using global proxy (c1ecb6330, Qu Xuan) scheduler: select resource unordered (5b170650f, Zexi Li) scheduler: more standardized testing (81feadc13, rainzm) scheduler: filter InstanceGroup whose enabled is false (ca58fb8d2, Rain) scheduler: sku filter check zone if only prefer region specified (019c03413, Zexi Li) scheduler: clean expire cache before schedule (a16899c9b, Zexi Li) scheduler: fetch input network when specified (5cfd7f040, Zexi Li) scheduler: get candidates error more info (01124b312, Zexi Li) scheduler: sku by region and fill onecloud vpc networks (24fdb6e84, Zexi Li) scheduler: check candidate tag resource is nil (66eee7f72, Zexi Li) scheduler: storage predicate add actualCapacity filter (e7dd6bba0, Zexi Li) scheduler: fix array out of bounds when sorting hosts (de1b5bc96, rainzm) taskman: use admin token if task userCred token expired (b3c90a804, Qiu Jian) taskman: SSubTask: set model manager (a51a0845b, Yousong Zhou) treewide: fix task error recording (d86834777, Yousong Zhou) vpcagent: ovn: stable dns A record value (b3e196950, Yousong Zhou) vpcagent: models: guestnetworks: accomodate change_ipaddr (d1f1eda98, Yousong Zhou) webconsole: trim api_server url if end with slashes (1236a0326, Zexi Li)  Bugfix (5)  commonalert (444ff1901, zhaoxiangchun) qcloud pull metric (26965521f, zhaoxiangchun) collect esxi metric timout (ec3b5c09b, zhaoxiangchun) region: server change config rebase to sched task (5314ce98b, wanyaoqi) region: fix list by srever type normal (3756993c9, wanyaoqi)  Chore (2)  monitor: delete suggestion files (83e899d9a, zhaoxiangchun) util: update centos build version to 1.1-3 (d98060492, wanyaoqi)  Climc (12)  helper: add BatchCreate helper (91fab1217, Yousong Zhou) helper: create call as a standalone method (f6f4fc125, Yousong Zhou) s/Keyworkd/Keyword/ (9228b1792, Yousong Zhou) network-list with multiple –bgp-type args (6464597c9, Yousong Zhou) k8s machine show resource_id (0f2521487, Zexi Li) servers: create with eip bgp type (4d895d658, Yousong Zhou) add k8s federated resource update subcommand (ddf483bc0, Zexi Li) eip ops by bgp type (bc898e9e3, Yousong Zhou) add k8s fed resource sync action (037fa814f, Zexi Li) refactor k8s sub command (e2604d531, Zexi Li) add k8s federated resource cmd (742e45571, Zexi Li) k8s cluster grafana componet support subpath (930a72667, Zexi Li)  Cloudcommon (5)  db: GET: i18n for result of get property calls (c1468105f, Yousong Zhou) db: add man.GetI18N (d639b0a84, Yousong Zhou) db: modelbase: distinct-field: readability change (d6243fbc6, Yousong Zhou) get joint model should aware fieldname (1af48dc73, Zexi Li) joint model list should add field_name into query (a47553a7a, Zexi Li)  Cloudprovider (2)  add ErrAddressCountExceed (444e66647, Yousong Zhou) ICloudNic: add methods for secondary addresses (9840d7cf7, Yousong Zhou)  Code Refactoring (24)  find the most suitable storage (267929452, rainzm) apis: compute: remove EIP_CHARGE_TYPE_DEFAULT (a28fa3cf4, Yousong Zhou) climc: webconsole: use helper methods of response struct (ce00a1761, Yousong Zhou) esxi: fetchVms and fetchHardwareInfo (4d74a9778, rainzm) esxi: replace GetTemplateVMById with FetchTemplateVMById (dcb6db044, rainzm) host: startvm: for compat (c2d173ae1, Yousong Zhou) host: startvm: nic_speed: use raw string (38492014b, Yousong Zhou) host: startvm: add QEMU_CMD_KVM_ARG (4cf3565b2, Yousong Zhou) host: metadata: eliminate ref of guestNic (0f1fc0fa5, Yousong Zhou) hostman: metadata: eliminate import of guestman (6a2136f6c, Yousong Zhou) hostman: use metadata.DescGetterFunc (de7eb162f, Yousong Zhou) notify: add StartSubcontactPullTask for receiver (8d6defe22, rainzm) notify: hide SSunContact webconsole (8a80f96d6, rainzm) region: faster sync CapacityUsed for Storage (42309b8a7, rainzm) region: remove return value of NotifyWebhook (0d36b3b74, rainzm) region: faster list for cachedimage (de4f1579d, rainzm) region: faster list for cachedimage (bd4851c9f, rainzm) region: faster GetIImageById (936ea0040, rainzm) region: replace ‘ActualCapacity’ with ‘ActualCapacityUsed’ (56d24dfa9, rainzm) region: optimize preparenet of cloudaccount (ed484f4e2, rainzm) scheduler: make forcast result clearer (9d18b94ad, rainzm) scheduler: remove unused k8s predicates code (2a2867daa, Zexi Li) webconsole: use structured response (5959a204f, Yousong Zhou) webconsole: api: add helper methods for response struct (8e9b4aed2, Yousong Zhou)  Db (8)  interface: manager: add HasName() method (ed1999efa, Yousong Zhou) standalone_anon: empty result for name query (c8ad51174, Yousong Zhou) add standalone_anon (c45550ef6, Yousong Zhou) add manager methods appliers (d8ab874ef, Yousong Zhou) virtualjoint: add FilterById on RowId (79120f3de, Yousong Zhou) modelbase: BatchCreateValidateCreateData: return orig data (0e0a39490, Yousong Zhou) check funcs required by dispatcher (3b32ce56c, Yousong Zhou) IModel: add GetI18N() method (9fd0f3088, Yousong Zhou)  Db_dispatcher (3)  allow batch create for models without name (c389aaaeb, Yousong Zhou) delay compute to where needed (f62dddda5, Yousong Zhou) remove unused GetExtraDetails call (0c8ab90f7, Yousong Zhou)  Disk (1)  check disk is need renew on guest set renew (3ac63f537, wanyaoqi)  Dns (1)  isMyDomain: match only strict subdomain of dns_domain (a67026dec, Yousong Zhou)  Eip (3)  create by BgpType (59dd8a0e2, Yousong Zhou) NewEipForVMOnHost: add opslog (b44ac491c, Yousong Zhou) construct a pointer type (83f5a38c2, Yousong Zhou)  Elasticips (6)  NewEipForVMOnHost: make args a struct (f51495048, Yousong Zhou) charge_type: make it varchar column (4537cc3db, Yousong Zhou) bgp_type: make the db column nullable (e61a85b7c, Yousong Zhou) error when we have no usable eip network (63c4818b8, Yousong Zhou) fix calling FilterByOwner (382f62828, Yousong Zhou) filter by owner when doing auto allocation (5afbe831d, Yousong Zhou)  Feature (19)  emualated ssd support (#7701) (0cbad8aea, Jian Qiu) add dns interface (f251559c3, Qu Xuan) allow session level yunion_auth cookie (2a6445c31, Qiu Jian) add apsara support (b195f95bd, Qu Xuan) saml for cloudid (d4edbbb61, Qu Xuan) allow join project across domain (f10267b0f, Qiu Jian) allow specify offset in name pattern (0beee87db, Qiu Jian) auto create domain for sso idp (178e1ab8f, Qiu Jian) support cloudprovider, cloudregion and zone schedtag (cc32bb39e, Zexi Li) support scoped policy that manage ui policies for domains\u0026projects (01d4c2a1c, Qiu Jian) policy group support (2d39cb4cb, Qiu Jian) add qcloud rds support (f77605418, Qu Xuan) remote update qcloud instance metadata and name (e967dd7d6, Qiu Jian) qcloud create VM with tags (38abe9b45, Qiu Jian) filter storages by image (6abd9b0e9, Qiu Jian) qcloud create VM with tags (ddefc2ab3, Qiu Jian) climc: policy save data into file (94dd5c577, Qiu Jian) cloudcommon: split opslog table (ec14f9a6b, Qiu Jian) keystone: user add language attribute (768c88d28, Qiu Jian)  Features (132)  use details data to cover obj data in FetchCustomizeColumns (f6844e3c6, rainzm) change templateid as / in esxi (335c8eecc, rainzm) Add IResultHelper (4b4875cd7, rainzm) update locales (1e297dca1, rainzm) Add method ‘Sku’ to CandidatePropertyGetter (0bd84dd4b, rainzm) download the role to tmpdir not system role dir (deb3758bf, rainzm) add keep_tmpdir options (1eaf2eaff, rainzm) support creating vm from instance snapshot (6f6ea9e38, rainzm) creat, delete, revert and sync operator for esxi instance snapshots (2ed4534f4, rainzm) add WithCtx version to notifyclient function (4b49bcec8, rainzm) add NotifyError in notifyclient (54c7069d9, rainzm) notify user when failing to change config (acf1f1279, rainzm) add ICloudInstanceSnapshot \u0026 modify ICloudVM (e11011ddb, rainzm) log err when sending notification via notifyclient (8eb420e42, rainzm) support snapshot of esxi (7bdcf9552, rainzm) respect params.Disks when cloning vm (a174c32ea, rainzm) add SubImages in Image (564c6cf45, rainzm) add GetSchedtags for ICloudHost (c9039f947, rainzm) add a retry mechanism to AutoSyncExtDiskSnapshot (5e82a7e50, rainzm) add GetCapacityUsedMB for ICloudStorage (fd14e7b6c, rainzm) add ‘ip-list’ for esxicli (4b860cb43, rainzm) filter esxi ip by CIDR (e0aa67357, rainzm) add valid filter for cachedimage list (18fdfad79, rainzm) add NotifyWebhook in notifyclient (264b9ef39, rainzm) add vlanId for suggested network (a4527aec5, rainzm) support lock storage from selected cachedimage (10f0f07bd, rainzm) add ‘vlan_id’ param when creating network (7ab4decab, rainzm) inherit lang from ctx fro Task (e45ddaeb9, rainzm) rds recovery new instance from backup supported (fd4b544fb, Qu Xuan) apis: add const VPC_OVN_ENCAP_COST (aaec97470, Yousong Zhou) appsrv: Application: add Stop method for shutdown behaviour (7d0828410, Yousong Zhou) build: add .dockerignore (2b5014b84, rainzm) build: add DOCKER_BUILDKIT in docker_push.sh (5ab362d05, rainzm) climc: add cloud-account-preparenets-vmware command (67788b179, rainzm) cloudcommon: db: jointbase: add list:“user” for RowId (53125e6ed, Yousong Zhou) cloudcommon: determine the notification template based on the user’s language preference (7d75620d6, rainzm) cloudcommon: allways send webconsole notification via contacts (cff5b8b65, rainzm) cloudcommon: add NotifyWithContact (474bd1440, rainzm) cloudid: notify clouduser created (618d07f45, Qu Xuan) cloudid: support aliyun saml auth (592ae29d7, Qu Xuan) esxi: use more specific storage types (bb6af1e22, rainzm) esxi: support fake template vm via regex filter (48940c77a, rainzm) esxi: add GetSchedtags implementation for esxi.SHost (1cb286080, rainzm) esxi: expand disk config from subimages when creating vm (5251304a4, rainzm) esxi: correctly judge whether inet is nil (3793387b6, rainzm) esxi: copy disk from image when creating vm (937bf4513, rainzm) esxi: support fetchVM form datacenter (0aa9dc6fb, rainzm) esxi: do not specify portkey in NewVNIC (8553f9024, rainzm) esxiagent: keep data disks when cloning vm (d618f61c1, rainzm) esxiagent: try to customize vm if deployfs failed (93df31a97, rainzm) esxiagent: try to resize partition after resizing disk (a1bc77a40, rainzm) esxicli: better vm operator (14c5e18c2, rainzm) host: add option OvnEncapIpDetectionMethod can-reach:xx (8db93257d, Yousong Zhou) host: metadata: make vpc aware metadata handler (8f1f1f55c, Yousong Zhou) host: startvm: set vpc nic mtu (206ae7f9e, Yousong Zhou) host: startvm: add nic_mtu shell func (005fad402, Yousong Zhou) host-deployer: add deploy driver libguestfs (cfa1a4ee4, wanyaoqi) hostdeployer: support resizefs for esxi disk (22cec0964, rainzm) keystone: filter domain/user by idp_entity_id (b27b086cc, Qiu Jian) monitor: add nodata alert policy (766118937, zhaoxiangchun) monitor: add global alertrecord (e2ca41a5f, –global) monitor: add alert slience time and modify scoperesource FetchUniqValues func (1a1df0f07, –global) monitor: add metric description (09660da0a, zhaoxiangchun) monitor: support create nodata alert from web (c2b8f6a83, zhaoxiangchun) netutils2: add MyIPTo (e53bdd5f9, Yousong Zhou) notify: support webhook contact type (012d9b158, rainzm) notify: Support trigger-verify for feishu, dingtalk and workwx (e179191dd, rainzm) notify: replace VerifiedContactTypes with VerifiedInfos in ReceiverDetails (89ec96567, rainzm) notify: enable watching user in keystone (a4dc42e69, rainzm) notify: sort the returned contact type array (77bbb2cfd, rainzm) notify: break down error from UseridByMobile (bf12f5b57, rainzm) notify: user cmdline helpler for climc notify-receiver-xxx (e17768fbc, rainzm) notify: add intellij-get for receiver (75b0889c3, rainzm) notify: Allow use topic to filter notification (0a9a73587, rainzm) notify: Add VerifiedNote for SSubContact (3e982ab79, rainzm) notify: permit admin sending notification via contact (cb663f460, rainzm) notify: Add TNotifyChannel const of robot (f57a199cb, rainzm) notify: allow empty receivers for robot or webhook contact type (2e094a310, rainzm) notify: add webconsole in enabled contact types (bce332272, rainzm) notify: add IntelliNotify (c12b276ea, rainzm) region: larger suggest network and more complete vlanid (cc2675269, rainzm) region: add CloudCaches in DnsZoneDetails with GET (fd360b071, rainzm) region: call NotifyWebhook in when sonme tasks complete (ce0c88d79, rainzm) region: huawei recovery new rds (551aa2f91, Qu Xuan) region: 多云 bucket website.cors,referer 配置 (c9185a43c, lvyangyang) region: use NotifyWebhook when operating dnszone (5a07858e1, rainzm) region: add wire level for preparing network (5a186dbb3, rainzm) region: filter network via storage (f03d5af31, rainzm) region: allow prepare nets for existed cloudaccounts (aad9aba48, rainzm) region: make DeleteSnapshotExpiredRelease applies to postpaid vm (be042a075, rainzm) region: add bucket cloud tags support (66412faf9, lvyangyang) region: call NotifyWebhook in the life cycle of guests (541128d37, rainzm) region: add option NoCheckOsTypeForCachedImage (dfc246ca5, rainzm) region: add list filter server type (6c4ba1737, wanyaoqi) region: networkaddresses: filter by guest ids (b46d50ae3, Yousong Zhou) region: options: allow setting default vpc external access mode (05c95295b, Yousong Zhou) region: regiondriver: add methods on eip charge type (8d7d240b3, Yousong Zhou) region: search server by substr of ip or mac (ca21bcf56, Yousong Zhou) region: set qcloud bucket policy (9872a05be, lvyangyang) region: add SExternalizedResourceBase, SManagedResourceBase to SInstanceSnapshot (bb109953d, rainzm) region: support automatic start vm after reseting isp (f077f0602, rainzm) region: support sync skus by cloudregion (86838db6d, TangBin) region: support sync skus by cloudregion (d86f9a200, TangBin) region: add options DeleteSnapshotExpiredRelease (e4efbdc33, rainzm) region: make address recommendations more precise (fc6a30b20, rainzm) region: add test for CloudaccountManger.PerformPrepareNets (ae94914a7, rainzm) region: sync capacityUsed for storage after deploying or deleting guest (390cc11e7, rainzm) region: sync schedtags when syncing host (0bd75b7bc, rainzm) region: sync CapacityUsed for Storage (0bda9e751, rainzm) region: export user tags support virtual resources (d76915893, wanyaoqi) region: add RequestResizeDiskOnHost to SESXiHostDriver (8c17cdd5e, rainzm) region: server list add parameter eip_associable (8a1d15eba, TangBin) region: networks: add getMtu method (80efc97c6, Yousong Zhou) region: distinguish between pending delete and delete notification (0c7287233, rainzm) region: add instance_snapshot for regionquota (23b1a2b14, rainzm) region: send webhook server_create when canceling pending delete (79eacb5b4, rainzm) region: inter vpc network (eb91e8fcd, spike.lv) region: add instance storage capability (877989529, Qu Xuan) region: divide notify templates into Chinese and English versions (ac438282a, rainzm) region: replace 虚拟机 with 主机 or 云主机 (654c51724, rainzm) region: change fomat ‘id’ to ‘name(id)’ in scheduledtasks' log (33a4f332c, rainzm) region: support aliyun finance cloud (2a1f9ecbc, TangBin) region: add SCloudregionResourceBase for SInstanceSnapshot (35fc62bba, rainzm) region: azure tags (950e75f8b, lvyangyang) region: set pendingUsage before creating instance snapshots (8627818e1, rainzm) region/glance: update cpu arch apis (59102f2dd, wanyaoqi) region/schedtag: schedtag support set multi resources (a16b048f9, Zexi Li) scheduler: support filtering storage via medium (bf30c48ee, rainzm) scripts: add export DOCKER_BUILDKIT=1 (4135e62f6, rainzm) vpcagent: export subnet mac gen funcs (9288c2fd8, Yousong Zhou) webconsole: add huawei vnc support (6e0acab93, TangBin) webhook: send webhook notification when c/d loadbalancerlisterrule (24f4a684a, rainzm)  Glance (1)  check min disk size on update (53d0914cd, wanyaoqi)  Guests (1)  add bgp_type arg when create guest (6bbf09049, Yousong Zhou)  Host (5)  fix order init host srevice (cbb801753, wanyaoqi) restart etcd session on keepalive failed (7dc8f906c, wanyaoqi) specifie bash for start guest (aa45e62cb, wanyaoqi) fix sync storage info duration' (4b09751f5, wanyaoqi) fix rbd storage cache iso image (9e0ce8722, wanyaoqi)  Hostinfo (1)  try create network add is_on_premise (#7706) (74c8c6bfe, wanyaoqi)  Hostman (1)  metadata: add handler for /local-sub-ipv4s (adb998ff5, Yousong Zhou)  Hotfix (1)    allow merge networks without continuous addresses 2. filter guest_ip_start and guest_ip_end with contains operator (6a55acafa, Qiu Jian)    Httperrors (3)  HTTPError: use Error type (776ef9b8b, Yousong Zhou) add Error type (4d7eee4f2, Yousong Zhou) use existing details if id is not present (#7710) (da64e4a26, Yousong Zhou)  Httputils (1)  preserve format val types (d21c262c1, Yousong Zhou)  I18n (2)  add ITable (449c96ad5, Yousong Zhou) move out from httperrors pkg (1c1dcbde4, Yousong Zhou)  Informer (1)  ignore outside context cancel when worker run (ff53671a1, Zexi Li)  Locales (3)  monitor: add translations (0ecdb5cd9, Yousong Zhou) update translation (b075447f9, Yousong Zhou) update translations (69c7af840, Yousong Zhou)  Lockman (1)  test: add prefix setting (cd5163eeb, Yousong Zhou)  Logclient (5)  i18n: en for const (ca8fcb336, Yousong Zhou) i18n: cn for const (08ef1728d, Yousong Zhou) convert const val to use latin chars (31cea0a73, Yousong Zhou) move ws list to separate file (7f90da555, Yousong Zhou) separate lines (ee7b9e287, Yousong Zhou)  Logger (4)  actionlog: i18n for distinct-field (e4cef880a, Yousong Zhou) actionlog: readability change (d8887266a, Yousong Zhou) actionlog: add GetI18N (202ded8c9, Yousong Zhou) actionlog: remove redundant comments (fb28d96d5, Yousong Zhou)  Monitor (4)  query with signature and support measurement without database (3a5bde4a3, Zexi Li) set default influxdb datasource by endpoint type (409c67e24, Zexi Li) add alert resource (31cf935da, Zexi Li) error fmt (50eafd957, Yousong Zhou)  Multicloud (12)  qcloud: fix instancenic (e8ef92ad2, Yousong Zhou) qcloud: add ptr deref func (5f1fd6c7f, Yousong Zhou) qcloud: add apiDomainByRegion (0e0f8bfa9, Yousong Zhou) qcloud: add getVpcClient (1ab4d4049, Yousong Zhou) qcloud: add getSdkClient (9dcd0d2db, Yousong Zhou) aliyun: instancenic: handle InvalidOperation.Ipv4CountExceeded (a3d6a039a, Yousong Zhou) aws: subaddress management (1b6275f80, Yousong Zhou) aws: instancenic: add interface id attribute (3159f6d6d, Yousong Zhou) aliyun: instancenic: secondary address management (0fe90abea, Yousong Zhou) ICloudNic: add GetId() (2afa068d7, Yousong Zhou) ICloudNic: fix GetMAC() (956bc945a, Yousong Zhou) aliyun: make getSdkClient proxy aware (9072a69ae, Yousong Zhou)  Networkaddresses (6)  handle cloudprovider.ErrAddressCountExceed (eec81e73e, Yousong Zhou) do server sync for on premise servers (159453ece, Yousong Zhou) disallow batch create for external resources (05984b49a, Yousong Zhou) cloudprovider support (7343be04b, Yousong Zhou) add to nics field of guest desc (0c8d8358e, Yousong Zhou) add parent_type guestnetwork (87ed4e9a5, Yousong Zhou)  Networks (6)  usedAddressQuery: rename with baseq, ownerq, retq (8ed18fbf3, Yousong Zhou) split getUsedAddressQuery as method of each manager (1609496f9, Yousong Zhou) fix typo in log (f54de809b, Yousong Zhou) make filter by bgp types available (51dafd29e, Yousong Zhou) list: make bgp_type available (d4469ffde, Yousong Zhou) add field BgpType (258ceb7ba, Yousong Zhou)  Opslog (1)  move const to separate file (642a90146, Yousong Zhou)  Optimized (5)  server delete log and wait time (1e160821e, Qu Xuan) aliyun create rds backup (aa5cbd0b0, Qu Xuan) rds zone sync (d207d982e, Qu Xuan) create eip params (17cf23b80, Qu Xuan) region: qcloud bucket policy set and get operation (c0bcfa9a5, Qu Xuan)  Others (186)  update vendor (b4d5400e6, Qiu Jian) update vendor (93ceb707b, Qiu Jian) 负载均衡ACL\u0026证书增加项目和共享 (670a06d53, TangBin) add getStorageType err log (1afaa2950, TangBin) suggestAlert feature: (2bae6c0bb, zhaoxiangchun) add redis and redis skus slave zone info \u0026 huawei aws supported storage type update (2d15a7b97, TangBin) docker 交叉编译规则更新 (c9ec30b5b, Zhang Dongliang) detach AlertResource on alertDisable (357dd4e69, zhaoxiangchun) add:get bucket cdn domain (9b627c10f, lvyangyang) host-deployer: customize user cloudroot home dir (6e66a129d, wanyaoqi) add:bucket ops const i18n (8c29c5396, lvyangyang) qcloud create single zone elb bugfix (63eddd219, TangBin) modify alertResource ws info (d02db0e40, zhaoxiangchun) qcloud bucket task (da4150e5c, lvyangyang) commonalert bugfix: (c39540d5c, zhaoxiangchun) huawei vm support vnc (6b23c5c8f, TangBin) aliyun finance cloud zone add suffix (576120f15, TangBin) aliyun finance cloud region add suffix (7360c544f, TangBin) suggestalet bugfix (922874936, zhaoxiangchun) qemu-arm: fix cdrom params (cc7542cc6, wanyaoqi) allow delete role-policy-binding (f1be0adf6, Qiu Jian) add:aws lb tag (910bec329, lvyangyang) redis set autorenew bugfix (6ce5b1d50, TangBin) redis set autorenew bugfix (fe07cda1a, TangBin) batch user create bugifx (3ceec3aa1, TangBin) huawei create disk bugfix (4e3e5b01a, TangBin) add success note on guest start and stop (f464a904d, wanyaoqi) redis create bugfix (dd2eb4b44, TangBin) redis prepaid create autorenew bugfix (3a4498555, TangBin) commonalert bugfix: (a9c3c5bfd, zhaoxiangchun) qcloud redis secgroup sync fix \u0026 qcloud add renew\u0026 auto_renew (09145c3c1, TangBin) fix:修复dns record name校验的问题 (089aea99d, lvyangyang) add:qcloud routetable (456932632, lvyangyang) qcloud release prepaid resource bugfix (3b7c92521, TangBin) add resource type (0a0b73406, zhaoxiangchun) update vendor for jsonutils (ca0e79eff, Qiu Jian) commonalert bugfix (97ed34038, zhaoxiangchun) Fix a typo: ProviderFactor -\u003e ProviderFactory (47d358ecb, Shaohui Liu) fix:域名正则校验dnsrecord name，同步中文域名取punycode (73d750e1c, lvyangyang) add route (321e3c2f7, lvyangyang) modify monitor querycondition: (d45c09639, zhaoxiangchun) add option PrepaidDeleteExpireCheck (c5a88b80b, TangBin) qcloud delete prepaid redis bugfix (bbe362be2, TangBin) qcloud create prepaid redis bugfix (4be09cfc0, TangBin) lbcert cache delete bugfix (2f7781d15, TangBin) aws create bugfix (0bf274f12, TangBin) modify go test error (72b9f2ec7, zhaoxiangchun) fix stream disk on add disk from snapshot (4a2613a66, wanyaoqi) goimport fix (bf1d8eccf, tangbin) deal return error info: tsdb (8df8e6ca2, zhaoxiangchun) clean duplicate cached certificated at initial (f87c0e397, TangBin) qcloud create project not match bugfix (9a43bb667, TangBin) qcloud certificate sync bugfix (6343e3f4b, TangBin) qcloud cert bugfix (d6677d86d, TangBin) modify monitor dashboard save: (d519be9ab, zhaoxiangchun) qcloud elb cert duplicate fix (46e65d9e0, TangBin) qcloud redis create missing project id bugfix (babed456d, TangBin) update vendor (e48616cdc, rainzm) qcloud lb sync project bugfix (8589d67ac, TangBin) retry generate ifname from random string (f71def645, wanyaoqi) redis 2.8 reset password bugfix (02d0902d9, TangBin) add redis capabilty \u0026 lb purge (0a695c2dc, TangBin) redis delete bugfix (ac03debc9, tangbin) qcloud elb auth mode bugfix (ea497d077, TangBin) ha guest misc fix (0389ec804, wanyaoqi) qcloud redis tags (cfbe92ed9, lvyangyang) elb sync bugfix (399539b92, tangbin) dirve mirror check block replication is support (980396f15, wanyaoqi) sync elb support classic vpc (1eaf06d05, tangbin) qcloud redis support (d7894776f, TangBin) fix get host archs capability (8d07a6308, wanyaoqi) list support scope filter (1805be4d2, Qiu Jian) update api models (48e40fa5a, Qiu Jian) commalertUpdateInput increat param: (10b273938, zhaoxiangchun) qcloud zone sync fix (44b40599a, TangBin) loadbalancer support batch create (541a2d4e0, TangBin) fix on stream disk complete snapshots refcount not update (4efbe27ab, wanyaoqi) check disk is in reset before delete snapshot (e7ce3fd9d, wanyaoqi) create with tags (2c043454a, lvyangyang) bugfix: (b4a83dc15, zhaoxiangchun) elb salve zone 1 external id bugfix (6f2a9d8b7, TangBin) elb sync zone bugfix (94d3fa82a, TangBin) host increase cpu mem max size (6b7a52573, wanyaoqi) add qcloud elb zone1 details (1f17dcf68, TangBin) resource tags (58737942a, lvyangyang) qcloud elb supplort multi zones (f86dc52e9, TangBin) climc lb-create add parameter zone1 (69e0ae9de, TangBin) qcloud elb support multi zones (e6af8ad2c, TangBin) fix:get all project dns resource (efa5a8495, lvyangyang) fix fetch customize columns (cb45349ec, wanyaoqi) fix informer backend (128ec1774, wanyaoqi) lbcert delete bugfix (05f1900a2, TangBin) resource tags (3a73eb9e3, lvyangyang) remove try set informer backend (917a62c14, wanyaoqi) telegraf-raid-plugin: update raid state to lower case (de03ab939, wanyaoqi) keystone init etcd backend (5f5090038, wanyaoqi) fix:qcloud vpc peer error wrap (bb4e09aee, lvyangyang) .circleci: build: make with parallel level 2 (47fd7fb27, Yousong Zhou) add aliyun finance environment (2032e5f1d, TangBin) telegraf raid plugin (225f3b21c, wanyaoqi) remove alpine build cache before make image (0619d3566, Zhang Dongliang) fix:openstack lb 后端ip无法映射到主机的异常处理 (415ef0866, lvyangyang) replace NewFloat by NewFloat64 and NewFloat32 (1cfee7cf6, wanyaoqi) make mode (63887337f, wanyaoqi) fix host-deployer base image (bc26bdb8f, wanyaoqi) fix:aliyun jsonRequest 增加i/o timeout retry (93365de62, lvyangyang) 在 docker push 脚本里创建_output 目录，以便容错 (4be578fc2, Zhang Dongliang) 在 docker push 脚本里创建_output 目录，以便容错 (1f7988ecd, Zhang Dongliang) 解决编译之后 output 的 owerner 问题 (54f86817d, Zhang Dongliang) genreate api models (e64fe802e, wanyaoqi) add interface freeze virtual resource (dcdf45d18, wanyaoqi) esxi-agent 编译方式兼容 arm64 (eda8be1be, Zhang Dongliang) Add web url to alarm template (3d9923a7c, zhaoxiangchun) bugfix:scoperesource FilterByOwner (c0eae040a, zhaoxiangchun) remove aws lbbg cache metedata (1ce5db769, TangBin) modify suggest rule cli (af9e911fd, zhaoxiangchun) fix:允许cname record通过policy多值 (68283ceed, lvyangyang) aliyun public elb region fix (44e9cf049, TangBin) multi-arch 的镜像使用使用支持 arm64 (0b3afa9eb, Zhang Dongliang) bugfix commalert 3.4 (1c7deaf7b, zhaoxiangchun) aliyun public elb brand fix (d71a1f867, TangBin) multi-arch 的镜像使用使用支持 arm64 (65e3900ea, Zhang Dongliang) add mcclient sample (a4bedc7e2, Qiu Jian) fix:forbid top level public domain name (4435255f4, lvyangyang) mcclient modules: fix k8s fed rolebinding joint wrong resource manager (c7e8287c6, Zexi Li) bugfix :esxi 多机器环境下拉取监控超时 (6154f46a6, zhaoxiangchun) aliyun create public lb fix (2de610a3a, TangBin) fix:/dnsrecordset重复检查,dnszonevpc数量 (ed99a6981, lvyangyang) increase rbd check timeout (4ec1727d7, wanyaoqi) umount nfs on detach storage (24eaf5121, wanyaoqi) fix:(region) correct syncSchedtags (fc9b61c2a, rainzm) set stagefail on clean fail (d13cc9949, wanyaoqi) huawei client request add throttling control (1d044f712, TangBin) bugfix:commonalert (6037c84a5, zhaoxiangchun) huawei elb get params log (d8832a167, TangBin) qcloud elb create listener fix (35d155336, TangBin) huawei snapshot delete fix (faeb294d5, TangBin) wait deleted (13823d41e, lvyangyang) commonalert bugfix 3.4 (475c81c58, zhaoxiangchun) bugfix:esxi collect metric (418540c79, zhaoxiangchun) fix esxi-agent dockerfile typo (5db1fa686, Zhang Dongliang) make with ARCH argument (bc6ac93ce, Zhang Dongliang) support search ip (6d6e31813, wanyaoqi) regional network filter bugfix (c8c022733, TangBin) ctyun sync secgroup fix \u0026 cloudaccount delete fix (95e058d06, TangBin) common alert bugfix/3.4 (f58bca93d, zhaoxiangchun) fix host deployer base image (1fc5bac7f, wanyaoqi) ctyun add region cn-bj1 (4a36f82f7, TangBin) support mutli params (f4c1a3ea5, wanyaoqi) fix set host image cache properties (c6eecebed, wanyaoqi) fix update image status after save failed (686b63997, wanyaoqi) dup record process (ff4bde696, lvyangyang) host sync storage size (50a85b73e, wanyaoqi) suggest rule modify: (9a2267230, zhaoxiangchun) bugfix vmware monitor (0842b6f5f, zhaoxiangchun) commonalet bugfix: (a62462552, zhaoxiangchun) Add mock test for genericScheudler.Schedule (57d8f991a, rainzm) dns access (25ddca860, lvyangyang) fix host error output (945fac0a4, wanyaoqi) isolated devices info reenterable (641c71880, wanyaoqi) guest short desc add backup host id (09e568e14, wanyaoqi) fix get ubuntu version (495d9174c, wanyaoqi) pex register add optional column mac_access (88838bb53, TangBin) optimized cachedimages sync (dc1c6c754, Qu Xuan) create classic vpc fix (6a22bf0e7, TangBin) Feature \u0026 Fix for Notify (#7714) (1ed65ddd1, Rain Zheng) update host status to unknown on host offline (4a00c2229, wanyaoqi) listfilter by alert_id (138a16119, zhaoxiangchun) alert record bugfix (bb22fba25, zhaoxiangchun) vmware disk support deploy lvm partition (7dcb24094, wanyaoqi) Bugfix/yousong i18n (#7712) (b314b66b7, Yousong Zhou) Fix problem of esxi (#7661) (e393f3ee2, Rain Zheng) Fix for Notify (#7692) (74af85b8e, Rain Zheng) monitor commonalert bugfix (#7667) (c66ea1145, zhaoxiangchun) fix host get guests (#7682) (795a11fce, wanyaoqi) fix get storage capacity on init' (#7686) (3dec0fdc6, wanyaoqi) snapshot list by guest (fb41d16c9, wanyaoqi) update host deployer base image version (70f953dee, wanyaoqi) baremetal colloct isolated devices info (#7357) (75cd041d7, wanyaoqi) fix mount fetcher fs (#7656) (f255e8fcd, wanyaoqi) remove backup metadata on delete backup (#7653) (b0edff1d8, wanyaoqi) eip \u0026 vpc manager match fix (#7650) (11f86bb29, tb365) add host cpu archs capabilitie (e510ed196, wanyaoqi) support create arm virtual machine (7d94c4e46, wanyaoqi) host campactable with arm64 (bb0d81bc0, wanyaoqi) fix build baremetal agent image (#7646) (cb036b882, wanyaoqi)  README (1)  update architecture img (9fd99a22f, Zexi Li)  Region (7)  networks: attach func use struct args (d8cfba921, Yousong Zhou) networkresource: fix signature of GetExtraDetails (f87d09458, Yousong Zhou) guest detail add field macs (54275ddcf, wanyaoqi) host specs replace space char to ‘_’ (eb093a345, Zexi Li) fix query object by spec not include details (88514a9fc, Zexi Li) fix schedtag joint resource master/slave field wrong order (0113ec40c, Zexi Li) fix network schedtag not cleanup when network deleted (b859f3ba3, Zexi Li)  Regiondrivers (1)  kvm: exact match bgp_type (774cfcbfa, Yousong Zhou)  Schedtags (1)  add ListItemExportKeys (b79915d40, Yousong Zhou)  Scheduler (4)  ignore non running guests only exclude ready status (b47b0dc86, Zexi Li) forecast api with candidates result (0ed41b09e, Zexi Li) fix fillter isolated device (1f51af3a6, wanyaoqi) ignore network type when specified (e129d580b, Zexi Li)  Specs (1)  fix specKey url not escape (bf682f565, Zexi Li)  Stringutils2 (1)  add RemoveUtf8Strings func (f0cc1d3d1, Zexi Li)  Treewide (3)  avoid variable fmt str (152eaa8c5, Yousong Zhou) fmt error (ad52aae79, Yousong Zhou) DeleteFailReason as an object with translated details (6415de33d, Yousong Zhou)  Usage (1)  host show isolated dev reserved memory (0b11854a8, wanyaoqi)  Vendor (7)  add tencentcloud-sdk-go vpc (4a45ca59d, Yousong Zhou) bump alibaba-cloud-sdk-go to v1.61.684 (47a2d0763, Yousong Zhou) add github.com/aliyun/alibaba-cloud-sdk-go/services/ecs (edbddb38b, Yousong Zhou) bump yunion.io/x/pkg (46088408b, Yousong Zhou) bump yunion.io/x/sqlchemy (f0fba9aa2, Yousong Zhou) update yunion.io/x/jsonutils (854ff4079, Yousong Zhou) update yunion.io/x/sqlchemy (b7c3959e0, Yousong Zhou)  Vpcagent (6)  ovn: make aware of sub ips (c3b4edae1, Yousong Zhou) models: join network addresses (314f9fcc0, Yousong Zhou) apihelper: filter by cloud_env=onpremise (f699f7cb5, Yousong Zhou) ovn: increase dhcp lease, renew, rebind time (39f979398, Yousong Zhou) guard against foul eip records (9168284d5, Yousong Zhou) respect guest src check settings (#7677) (ad6b38f68, Yousong Zhou)  Webconsole (3)  ssh: add keyboard-interactive as an option (aa6e45e4d, Yousong Zhou) ssh: each argument on its own line (cce2af501, Yousong Zhou) fix defer order to release zombie process (4f8b80fcc, wanyaoqi)   notify-plugins Repository: https://github.com/yunionio/notify-plugins\n18 commits to notify-plugins - v3.6.0 since this release.\nBug Fixes (4)  common: correct error judgment in BatchSend (1b15dee, rainzm) dingtalk: return correct value in getUseridByMobile (0a041d0, rainzm) robot: Correct err value of ValidateConfig (a367fff, rainzm) workwx: Incorrect variable use for ok (abf098b, rainzm)  Features (9)  break down error from UserIdByMobile (a5ab93b, rainzm) add httpclient timeout for webhook (80e0757, rainzm) add webhook robot(custom robot) (18a1106, rainzm) support multi webhooks config for robot (1f43774, rainzm) email: support toggle ssl (3d4bb13, rainzm) notify: Add BatchSend for websocket (f046407, rainzm) notify: Add common function to batch send (d9a0118, rainzm) robot: Add BatchSend (6d7564e, rainzm) robot: support mutli WebhookPrefix (6054b2a, rainzm)  Others (5)  增加调试开关 (e0c6d39, Zhang Dongliang) buildx for notifyplugins (cf14a4f, Zhang Dongliang) makefile 去掉 sudo; make all bins (51c965a, Zhang Dongliang) docker buildx for notify plugins (9c1c2cd, Zhang Dongliang) update vendor (e3739ac, rainzm)   ocadm Repository: https://github.com/yunionio/ocadm\n7 commits to ocadm - v3.6.0 since this release.\nAutoupdate (1)  clear host tag (df9bab7, Zexi Li)  Bug Fixes (2)  makefile: 更改3.6的 Makefile 号 (649a9dd, Zhang Dongliang) update: cluster update operator parse image digest (ea3bcf8, Zexi Li)  Chore (2)  vendor: update vendor (07dea86, Zexi Li) vendor/v3.6: update vendor (e9d204d, Zexi Li)  Others (2)  metricsserver 自动选择平台 (4277583, Zhang Dongliang) clean info from from autoupdate component when update (a53d4c5, Zexi Li)   onecloud-operator Repository: https://github.com/yunionio/onecloud-operator\n53 commits to onecloud-operator - v3.6.0 since this release.\nBug Fixes (7)  policy description supports i18n (c44eab9, Qiu Jian) skip create policies error (44fc13b, Qiu Jian) role-policy-create many create extra role-policies (0cb1d83, Qiu Jian) add more dashboard default policies (5ab48d2, Qiu Jian) update vendor \u0026 code fix (aac3957, Qiu Jian) monitor: system alert policy cancel description update limit (8036103, zhaoxiangchun) telegraf: fix collect disk measurements (0671287, wanyaoqi)  Bugfix (1)  suggestion: fix err when suggestion syncConfigMap (f7460ca, zhaoxiangchun)  Chore (3)  manifests: update deploy manifests yaml content (a12649e, Zexi Li) monitor: add new service: suggestion (c03365e, zhaoxiangchun) vendor: make mod (94de88d, wanyaoqi)  Feature (3)  optimize host daemonset config (3305513, wanyaoqi) initialize policie and roles v3.5 (8bd28f7, Qiu Jian) keystone: add default member role (a63fddf, Qiu Jian)  Features (6)  add webhook plugin for notify (abf2979, rainzm) component: remove kube-rbac-proxy (7cd57e8, rainzm) framework: support multi zone (df5b6cc, wanyaoqi) host: allow setting ovnEncapIpDetectionMethod (41c2c19, Yousong Zhou) host-deployer: update host-deployer spec (0ffcdf0, wanyaoqi) operator: add nodata alert policy (a28f01e, zhaoxiangchun)  Monitor (2)  alert for host_raid adapter should \u003e= 0 (edfee65, Zexi Li) inject smart_device and host_raid alert rule (ded1e78, Zexi Li)  Notify (1)  remove pvc dependence (ee69174, wanyaoqi)  Others (26)  feat:(monitor): update system monitor alert when alert has diff info (d23f86b, zhaoxiangchun) update Makefile (fec49b1, Qiu Jian) update vendor (27fb644, Qiu Jian) etcd add pod anti affinity (a8e9ae6, wanyaoqi) ce edition should not deploy meter (4858f7b, Zexi Li) modify host_raid alert policy (6188dc0, zhaoxiangchun) 限制 client_body_timeout 时长，预防慢攻击 (da7327e, Zhang Dongliang) 限制 client_body_timeout 时长，预防慢攻击 (ad5c33d, Zhang Dongliang) 限制 client_header_timeout 时长，预防慢攻击 (d22e839, Zhang Dongliang) 更新 nginx 配置以防 dos 攻击 (65dd614, Zhang Dongliang) qcloud add redis crond (c474c0c, zhaoxiangchun) modify commonalert init policy : (fb9ba72, zhaoxiangchun) add qcloud rds crond (2ecc856, zhaoxiangchun) bugfix: (bb13030, zhaoxiangchun) make mod (49408d5, wanyaoqi) set image default policy to if not present (54e78c2, Zexi Li) telegraf add disk plugin (c285508, wanyaoqi) not create notice (3029a7c, Zexi Li) pod affinity by storage class (fde292d, wanyaoqi) BusyBox upgrade ,modify cloudmon timeout arg (eb46544, zhaoxiangchun) host image spec fix (5ba8920, wanyaoqi) add flag check is failed etcd pods need delete (586b3e7, wanyaoqi) push 镜像后,拉回本地 (665a910, Zhang Dongliang) buildx for onecloud-operator (0c9ac24, Zhang Dongliang)   etcd clean failed state pods (89c338d, wanyaoqi)   deployment with pvc not set node affinity (#255) (ce2eed8, Zexi Li)  Regiondns (1)  configmap: quash trailing spaces (641f3b2, Yousong Zhou)  Vendor (1)  update yunion.io/x/master to current release/3.6 (a7054e2, Yousong Zhou)  Web (1)  add docs image (80e00a1, Zexi Li)  Yunionagent (1)  remove onecloud keyword (8792ea6, Zexi Li)   onecloud-service-operator Repository: https://github.com/yunionio/onecloud-service-operator\n10 commits to onecloud-service-operator - v3.6.0 since this release.\nBug Fixes (3)  for last pr (aeb3671, rainzm) retry after a while when dealErr (ec6ecc1, rainzm) resource/vm: convert imageName to imageId before requesting for creating vm (17c8de2, rainzm)  Code Refactoring (1)  change maxRetryTimes to maxTryTimes (d1a8b4a, rainzm)  Features (5)  add more reasonable title for cherry pick PR (b4097f8, rainzm) init docs (a28b5cd, rainzm) keep cloudresource when resource in k8s is invalid (ab1ab79, rainzm) add manager-pro section in Makefile (0f96432, rainzm) resource: better use for logger (22beac3, rainzm)  Others (1)  docker buildx for onecloud-service-operator (e6b93e7, Zhang Dongliang)   sdnagent Repository: https://github.com/yunionio/sdnagent\n30 commits to sdnagent - v3.6.0 since this release.\nAgent (4)  server: enable ovnMdMan (ae3eab6, Yousong Zhou) server: add metadata server (c7af8c7, Yousong Zhou) server: watch: add FindGuestDescByNetIdIP (0b314bd, Yousong Zhou) server: use utils.RunOvsctl (8fd7165, Yousong Zhou)  Bug Fixes (1)  hostconfig: fix watching hostconfig (b895141, Yousong Zhou)  Build (2)  eipgw: track to ensure stop state as well (048a1c9, Yousong Zhou) eipgw: vrrp track script as monitor (a485d61, Yousong Zhou)  Flowsource (5)  make aware of sub ips (b1afd56, Yousong Zhou) relax constraint when mac check on and ip check off (3bf9855, Yousong Zhou) reword ref comments on allow_switch_vms (5e848c1, Yousong Zhou) reword ref comments on allow_router_vms (7ae147d, Yousong Zhou) remove now unused code for dev (bde4723, Yousong Zhou)  Others (3)  .circleci: bump go to 1.14 (122342c, Yousong Zhou) pull image for buildx (08a0395, Zhang Dongliang) docker buildx for sdnagent (c4e72f7, Zhang Dongliang)  Sdnagent (1)  be cooperative (24e75c1, Yousong Zhou)  Tc (6)  QdiscTree: add Root() method (ebcb90d, Yousong Zhou) NewQdiscTree: special case mq (2ce36e0, Yousong Zhou) NewQdiscTree: fix children key (61b5543, Yousong Zhou) NewQdiscTree: use qbase for BaseQdisc() return (98de150, Yousong Zhou) NewQdiscTree: rename vars (5747fb5, Yousong Zhou) NewQdiscTree: use current tree instead of the root (6195925, Yousong Zhou)  Tcman (1)  skip devices with mq qdisc (483628c, Yousong Zhou)  Utils (4)  add RunOvsctl (d0aa06c, Yousong Zhou) guest: add GetJSONObjectDesc (469d4d9, Yousong Zhou) guest: add FindNicByNetIdIP (d42997c, Yousong Zhou) guest: make aware of sub ips (630b4c9, Yousong Zhou)  Vendor (3)  bump to onecloud master branch (beb7661b9fc) (b67c9e1, Yousong Zhou) bump yunion.io/x/onecloud to current tip of release/3.3 (f3e6231, Yousong Zhou) bump yunion.io/x/onecloud to current tip of release/3.3 (a175a5b, Yousong Zhou)  ","excerpt":"Release time: 2020-12-29 14:17:58\n onecloud Repository: …","ref":"/v3.6/en/docs/changelog/release-3.6/3-6-0/","title":"v3.6.0"},{"body":"发布时间 2020-12-29 14:17:58\n onecloud 仓库地址: https://github.com/yunionio/onecloud\n1029 commits to onecloud - v3.6.0 since this release.\nAdd (2)  DisableDelete for lb (73e8080d4, Qu Xuan) vpc peering connection (bd22eb0b1, lvyangyang)  Apigateway (1)  disable influxdb service query proxy (81da6c577, Zexi Li)  Baremetal (1)  fix pxe filter network by guest_dhcp (129001dfb, Zexi Li)  Bug Fixes (516)  自动生成华为云rds密码 (a08fb0044, Qu Xuan) add keystone sync user debug info (#7633) (585ba0ff5, Jian Qiu) turn off some default project policies (#7636) (cb573d340, Jian Qiu) aovid truncated data (#7643) (21342005e, 屈轩) cleanup logic for nics of pending_deleted guests (#7668) (7336ff732, Jian Qiu) 不限制openstack系统盘类型 (#7674) (a5c3a34b7, 屈轩) server purge may fail (#7696) (3ccf78ae7, Jian Qiu) http error limit request body length (#7699) (d0842c62c, Jian Qiu) apigateway user info add is_local attribtue (#7694) (8ba3f86b5, Jian Qiu) vmware esxi host detects vnic portgroup info (#7649) (2ea855a42, Jian Qiu) avoid delete aws iam user failed (#7664) (8cf594785, 屈轩) add details for account delete (#7702) (416afb686, 屈轩) climc params (5eaece551, Qu Xuan) avoid policy value not save (0cc0a1991, Qu Xuan) avoid nil panic (5b3bfd1b3, Qu Xuan) compatiblity fixes with lenovo RD620 and huawei 2288 (f6eb9fc19, Qiu Jian) valid update name and update dns recordset (80c75b19a, Qu Xuan) search by chs projectname or domainname (64f5bc748, Qiu Jian) optimized cloudid (fd318a9cd, Qu Xuan) optimzed sync (ce032ecf1, Qu Xuan) find correct esxi host access ip (053507c3e, Qiu Jian) remove redundant auth cookie in sso login (ef138c05d, Qiu Jian) support VirtualDiskRawDiskMappingVer1BackingInfo (a672c6b33, Qiu Jian) scheduler aware policy (b8238d205, Qiu Jian) cloudid optimized (7232695df, Qu Xuan) network address list respect privilige of user (09944bc1b, Qiu Jian) skup syncing lb, rds, redis instances in tasks (9de29d9af, Qiu Jian) user idps attributes includes template name (383bdef22, Qiu Jian) aliyun wulanchabu region (46e6d37c2, Qu Xuan) sync groups for user (491efe579, Qu Xuan) check assign-host previliges (4d5aadb64, Qiu Jian) prevent users in disabled idp from login (9e1ff8819, Qiu Jian) ignore 409 error when doing redfish power on (65141a277, Qiu Jian) wire usage stats incorrect (d7e330f9e, Qiu Jian) uniform cachedimage active status (f09bb6682, Qu Xuan) optimzed clouduser password (a00447022, Qu Xuan) recode project-role rpc handle to support group role assignment results by user or project (332ba04bd, Qiu Jian) avoid create public zone failed (d9626e310, Qu Xuan) optimzed clouduser (7361da408, Qu Xuan) optimized qcloud keypair (f4ecde37c, Qu Xuan) 腾讯云不支持同时设置秘钥和密码,若设置秘钥，则将密码置空 (a2b9a7906, Qu Xuan) 平滑迁移数据 (8284f7b29, Qu Xuan) add dns recordset dns value check (fc8fb8af5, Qu Xuan) avoid sync natgateway eip panic (dab5b6e43, Qu Xuan) 默认不自动合并安全组 (8e39b7ccb, Qu Xuan) disable webkms for esxi older than 6.5 (239797e33, Qiu Jian) check host sharing status when considering whether a host is assignable (04f036ce2, Qiu Jian) cos use proxy (bb7ad07c2, Qu Xuan) add doc for qcloud (3c29402c1, Qu Xuan) 支持自动根据云上项目修改本地项目名称 (e86509a88, Qu Xuan) lock/unlock cleanup (41f932e38, Qiu Jian) bucket object cnt fix (cbd08138b, Qu Xuan) 避免名称重复 (1b3d3310d, Qu Xuan) enable generate name caused compability issue (1a3acbd05, Qiu Jian) omit empty fail reason (5a91ae886, Qiu Jian) keystone initialize data skip nil extra fields (b80fa64b6, Qiu Jian) disable qcloud verifyAppId temporarily (01fe002dd, Qiu Jian) feature: vpc peering connection support (466d96135, Qu Xuan) add esxicli vmrc/webmks command (5a8ee9d91, Qiu Jian) get jnlp xml from dell idrac6,7,9 (eea88ffbe, Qiu Jian) reset user password without check (b5f01171d, Qiu Jian) scheduler token not support policy (c516525db, Qiu Jian) avoid not reture cloudprovider.ErrNotFound error (37b87d1a5, Qu Xuan) 优化提取显示主账号名 (924053685, ioito) 避免添加新账号后长时间未同步iam用户 (fadb52044, ioito) dns 错误信息补全 (8f7a59894, lvyangyang) apigateway userinfo includes project metadata (06c1de7c1, Qiu Jian) 避免腾讯云同步虚拟机ip异常 (146683059, ioito) role assignment filter by users not working for effective users in groups (6cbd81181, Qiu Jian) error 值重叠 (9b54d58a3, lvyangyang) avoid account delete failed (8be3cfd22, ioito) use i18n.Table to handle Chinese-English conversion (c5a78a902, rainzm) scope resource filter by owner (4a27d4912, Qiu Jian) 仅在可用区故障时可强制挂载磁盘 (0a4bd281d, ioito) avoid serial vm creation (f7010a6d7, ioito) avoid compare err with cloudprovider.ErrNotFound direct (cb919f288, ioito) sql err (1b9106032, ioito) avoid account delete failed (8c0776c2a, ioito) allow cross doamin resource sync (eaef5a757, ioito) openstack zone not emulated (a31339f68, ioito) avoid purge storages (a8996ec9d, Qu Xuan) add climc support vpc/schedtag user metadata (bd122a01f, Qiu Jian) allow create disk prefer manager (74cb19cd8, Qu Xuan) dns zone cache owner info (a14b4e590, Qu Xuan) 支持公有云域过滤操作日志 (ef3d74f4e, Qu Xuan) filter cloudprovider/network by host-schedtag-id (23a18a81f, Qiu Jian) suffix template cache key (5f10a9a39, rainzm) filter storages by host schedtag (69561b40f, Qiu Jian) avoid sync dns zone cache status is init (9d76c3e02, Qu Xuan) allow domain admin view shared dns zone records (d45d48806, Qu Xuan) revert filter-by-owner changes of scoped resource (4e4ea5e6b, Qiu Jian) oidc response user’s info (be4a76b25, Qiu Jian) emulated wire not sync vpc shared info (c5cfceeb9, Qiu Jian) 允许域管理员可以看到共享的dns zone cache列表 (24fcccf5f, Qu Xuan) error code of external bucket not found error should be 404 (6a5fdc5d0, Qiu Jian) avoid qcloud secgroup cache name not sync (35e57a833, Qu Xuan) server name auto index should start from 1 (a08a779ed, Qiu Jian) filter cached images with host schedtag (1c0c66fd4, Qiu Jian) qcloud set hostname for instance (aa7495c9a, Qu Xuan) avoid slice out of bounds (e010c5c1f, rainzm) validate secgroup purge condition (6f2359329, Qu Xuan) not clean pending domain usage (624c4db06, Qiu Jian) format errors that block make test (5e5b0613f, Qiu Jian) ldap sync not update user’s phone and email (13fa3c299, Qiu Jian) project_id in resource details not correct (187dee690, Qiu Jian) vpc peering http error params (db7d32cd1, lvyangyang) qcloud instance with max bandwidth (bb62c0392, Qu Xuan) qcloud eip with bandwidth attr (b32c54f7c, Qu Xuan) trans google new region name (17ff08282, Qu Xuan) 支持带宽包用户 (f3c819299, Qu Xuan) support public ip create (02ec88ccc, Qu Xuan) sync huawei bucket project info (4b1d914b8, Qu Xuan) 优化安全组规则同步 (efa5978cf, Qu Xuan) support fake tempalte when searching template vm (281d1c45d, Rain) use new api (db6846aab, Qu Xuan) filter role assignments by project domains id or name (b2add97a0, Qiu Jian) filter project role with system=true (e2e186a75, Qiu Jian) support filter rds sku by provider (0dc485d58, Qu Xuan) allwo filter resource by with-meta and with-user-meta filter (c4d30371e, Qiu Jian) 避免并发同步安全组导致规则混乱 (0e3f78100, Qu Xuan) resolve with_meta filter conflict (cc7423d55, Qiu Jian) sync dns records after sync vpcs (914b76069, Qu Xuan) get images distinct field (f14ec60a7, Zexi Li) hostname for instance (65582cab9, Qu Xuan) huawei clirc region not correct (3d7021322, Qu Xuan) add rds cpu and memory usage (d7ae0eaa8, Qu Xuan) use correct worker (dc8086b3c, Qu Xuan) do not lock guest after lock eip, to prevent possible dead lock (0466b2c80, Qiu Jian) remote update metadata may cause metadata update loop (20f3feaab, Qiu Jian) reduce change config logs (d681a148d, Qiu Jian) missing authenticate action log for user web login (adbf51316, Qiu Jian) 新增google存储类型 (f7b16c592, Qu Xuan) cancel pending-delete should increase resource quota usages (2486aa307, Qiu Jian) monitor commonalert not detach alert resource (06a30edcf, Zexi Li) add lb quota check (5e4cc3314, Qu Xuan) add rds quota check (f74e345b0, Qu Xuan) secgroup quota support (adcce7538, Qu Xuan) add aliyun new region (80b0ed3cc, Qu Xuan) 避免冲掉设置的到期释放时间 (98bd229b3, Qu Xuan) don’t update NextSyncTime when snapshots that should be added has not (213d495a3, rainzm) sync rds account host info (fb7d22f67, Qu Xuan) add duration match (f159c7318, Qu Xuan) qcloud 5.5 single zone (cdd652c1e, Qu Xuan) 支持批量创建rds (9a03bf17c, Qu Xuan) 支持多安全组 (5cd26b297, Qu Xuan) 避免参数异常 (9821f7fe9, Qu Xuan) climc vpc-create missing cloudregion_id (588fff60f, Qiu Jian) server usage status not correct (ce06e078f, Qiu Jian) avoid delete public ip when sync eip list (d60dee6a9, Qu Xuan) qcloud server create (0e5835ffa, Qu Xuan) optimized cloudaccount climc (64740ff0f, Qu Xuan) avoid sync project panic (6ee94ab41, Qu Xuan) set secgroup status (b6016939c, Qu Xuan) avoid sync part of rds (a01cd0a81, Qu Xuan) use option manager for scheduler (8f2c51469, Qiu Jian) allow set customized private prefixes (dcc689cc1, Qiu Jian) fail to delete public_ip eip (554ec8873, Qiu Jian) make test go vet error (08bb11db6, Qiu Jian) scopedpolicies and scopedpolicybindings swagger resource name (46fe31cbd, Qiu Jian) compatible with qcloud zonal bucket (3f568a63d, Qiu Jian) classic vpc for rds (0f4114449, Qu Xuan) sync rds class vpc (d9e72f78e, 屈轩) enforce response charset (9073461f9, Qiu Jian) secgroup cache tenant_id (373166c50, Qu Xuan) filter scopedpolicybindings with multiple categories (56e5b177d, Qiu Jian) save service config changes may send invalid action log (354bcd9f0, Qiu Jian) scopedpolicybinding filter by category sql error (10a4d86d2, Qiu Jian) avoid not found cdbro- mysql instance (dc59a0872, Qu Xuan) add qcloud hssd (5b4efddec, Qu Xuan) scopedpolicybindings filter by scope project (32fe10b00, Qiu Jian) elasticcache quota not take effect (9f122f745, Qiu Jian) add rds status and expired time (f47f2c51e, Qu Xuan) auth permission result incorrect (4349cc7f9, Qiu Jian) save sso login status in cookie (ae327021d, Qiu Jian)   server generate name should be historically unique 2. ipaddr of a batch of server is in the same order as generated name (4431acde8, Qiu Jian)   missing column error when order by extra fields (03d17e6fb, Qiu Jian) 支持多内存过滤套餐 (25aed0a7e, Qu Xuan) aliyun eip api (cdead1c47, Qu Xuan) change owner should update quota usages (1bd4b85bf, Qiu Jian) add panic log for worker task (e97cd02b5, Qu Xuan) sync remove dirty rds accounts (008fd554c, Qu Xuan) search by name and order by scopedpolicy for scopedpolicybindings (73e117c6e, Qiu Jian) change level of scopedpolicy to system (79ad3c188, Qiu Jian) support rds set auto renew (a7e832488, Qu Xuan) aws secgroup out rule is deny any (bc28c8bdf, Qu Xuan) rds task fix (0272c7695, Qu Xuan) qcloud rds set renew flag (c56ebfd04, 屈轩) role-set-policies support update only operation (d66ee1fd4, Qiu Jian) avoid lock reentry (cfebba255, Qu Xuan) avoid check region log every time when account status is unknown (c2c9edd9c, Qu Xuan) renew rds (98d20725a, Qu Xuan) support create 512mb server sku (c7a6ec8e9, Qu Xuan) public ip and duration for create params (d7ab5fdd1, Qu Xuan) avoid panic (7a6022561, Qu Xuan) creating esxi guest from instance snapshot (781870953, rainzm) support resize qcloud hssd disk (b8410be11, Qu Xuan) keystone init empty catalogy cause panic (b84f23796, Qiu Jian) host memory usage status not correct (157fb1e48, Qiu Jian) mcclient panic when keystone init empty service catalog (2a1b5f8a7, Qiu Jian) baremetal usage should exclude converted hypervisor (8fcc85745, Qiu Jian) set isp’s status as ‘instance_snapshot_reset’ when reseting guest from isp (8ef1af0db, rainzm) adjust default identity quota (4d04059bc, Qiu Jian) qcloud create bucket without appId (38018080c, Qiu Jian) add error cause (83f5ce431, Qu Xuan) support import rules for secgroups (cece2852a, Qu Xuan) add err handler for notifyRobot (36dec7baa, rainzm) 支持关机不收费 (11c3f6a6e, Qu Xuan) add host-joint resources into domain level resources (7fbe72ce5, Qiu Jian) add host.memoty.total and host.cpu.total usage stats (bc5c74b1b, Qiu Jian) cloudid api addr (4592299ff, Qu Xuan) 优化azure资源同步 (0d85df52b, Qu Xuan) optimized jsonRequest (06581ad1a, Qu Xuan) allow disk attach to multiple guests (0718da3d7, Qiu Jian) avoid openstack image-list failed (#7640) (2716d4527, 屈轩) apigateway: allow logout by get method (ff24d4a3e, Qiu Jian) awscli: instance-rebuild-root fix (eee13a549, TangBin) baremetal: convert to host failed (eb857594f, Zexi Li) baremetal: clear jbod disks do PDMakeGood (f6bf3050f, Zexi Li) climc: replace ' -\u003e \" (cb594298d, Qu Xuan) climc: server-create –desc not work (df45ced78, Zexi Li) cloudcommon: add rbac_policy_refresh_internval_seconds option (6caec234a, Qiu Jian) cloudcommon: adjust policy refresh to default 30 seconds (b9d30c08a, Qiu Jian) cloudcommon: disable quota check by default (6f7a3cf8a, Qiu Jian) cloudcommon: panic when query an empty splitable model manager (ba8754687, Qiu Jian) cloudcommon: query filter ineffective for splitable (41b694ad3, Qiu Jian) cloudcommon: perform public should check the sharing scope of resource (de47e4a69, Qiu Jian) cloudcommon: supplement i18n translations (83a5f95b0, Qiu Jian) cloudevent: adjust cloudevents resource scope (540af1a3a, Qiu Jian) cloudevent,devtool: missing metadata table (5d298e71b, Qiu Jian) cloudid: add for notify templete (2faead462, Qu Xuan) cloudid: avoid new public account sync system policy delay 1 day (f05fc1894, Qu Xuan) cloudid: avoid empty auth url (869740775, Qu Xuan) cloudid: sync qcloud collaborators user (82dc17907, Qu Xuan) cloudid: optimized system policy sync (8a5e682b0, Qu Xuan) cloudid: auto update saml provider metadata (61d21d2b4, Qu Xuan) cloudid: huawei saml provider create issue (b460a73b0, Qu Xuan) cloudid: avoid use invalid character for role name (fd948b8cc, Qu Xuan) cloudmon: deal cannot get azure metric (d2459a5cc, –global) compute: filter cachedimage with health storage (625bf2356, rainzm) compute: return InputParameterError while ValidateCreateData (f11a1df3a, rainzm) esxi: check whether some fields of vm are nil (3c59d7fec, rainzm) esxi: filter linkLocalAddress (e4217074c, rainzm) esxi: return when host.Vm is empty (08041d55d, rainzm) esxi: fetch templatevm from datacenter before clone vm (5c209fe3d, rainzm) esxi: check nil value when NewVirtualMachine (01ba4b952, rainzm) esxi: don’t specify spec.Identity when osName is empty (be0e8d73b, rainzm) esxi: Guarantee the uniqueness of the schedtag for esxi host (370e7723b, rainzm) esxi: resize root disk after creating vm (9daef7d97, rainzm) esxi: resize root disk after cloning vm (bd014a6ad, rainzm) esxi: use correct device index (6afa80305, rainzm) esxi: add device after cloning vm (7aa5b28b3, rainzm) esxi: no callback in uploadHandler (d616b4004, rainzm) esxi: use system disk of template only when cloning vm (bffa601dc, rainzm) esxi: search template from whole vCenter (d4c9e6e56, rainzm) esxi: filter vmdk item in lease.info (26b1050b3, rainzm) esxi: return sumsize of disks fo template (d01b6e150, rainzm) esxiagent: add HostDelayTaskWorkerCount (a0c34a044, rainzm) esxiagent: check whether regexp is nil (e43c86586, rainzm) esxiagent: return image extid not id (5789c6ded, rainzm) esxiagent: add humanized tips when searching vm failed (eb3da9369, rainzm) git,make: 更新获取 git branch 的规则 (e8376f998, Zhang Dongliang) git,make: git branch 获取方式优化 (d7d4e6bf6, Zhang Dongliang) git,make: 修正 gitbranch 变量的获取方式，允许外部传入，解决自动升级版本 tag 不统一的问题 (b0a95cbbe, Zhang Dongliang) glance: list image by os arch use startwith (f3404f678, wanyaoqi) glance: allow public and private operations of guestimage (5824b7add, rainzm) go.mod: remove k8s.io/kubernetes dependency (734be7c14, Zexi Li) host: add print migrate progress info (6c96e6d1f, wanyaoqi) host: make sure it won’t match vpc guests by accident (428e3ab1f, Yousong Zhou) host: update telegraf conf adapter to container environment (cbc285924, wanyaoqi) host: check lease living on restart etcd session (1611ddfcd, wanyaoqi) host: fix check hugepage enabled (fbd53b493, wanyaoqi) host: fix set windows password with escape charater (539baf7ba, wanyaoqi) host: wait put host offline success (83c1073f6, wanyaoqi) host: telegraf listen on local ipv4 address explicitly (460645871, Qiu Jian) host-deployer: cancel rename centos vgname (41631ec09, wanyaoqi) host-deployer: probe image info umount rootfs first (7ed96af33, wanyaoqi) hostdeployer: umount rootfs before resize partition (27378f2c8, rainzm) keystone: ignore service config update without changes (e817076c6, Qiu Jian) keystone: panic if request with an invalid token (5a7193198, Qiu Jian) keystone: oidc driver turn on debug mode if log-level is debug (e826239ab, Qiu Jian) keystone: update user attributes whenever user login (a4b4a1d16, Qiu Jian) keystone: rolepolicies list panic if filter by domain scope (695075a85, Qiu Jian) keystone: always upload\u0026refresh service config whenever service restart (97eb6e7bc, Qiu Jian) keystone: add i18n description for policy and role (334b347eb, Qiu Jian) keystone: ignore deleted policies when matching policies (86476c22a, Qiu Jian) keystone: allow unlink a domain from an IDP (253fba47f, Qiu Jian) keystone: not allow to disable sql driver (695aa81f7, Qiu Jian) keystone: allow refresh scope resource (3e7d3c829, Qu Xuan) keystone: service config ignore deploy server socket path (8287f3767, wanyaoqi) keystone: oidc data may be encapuslated in data field (95db19f10, Qiu Jian) locales: fix translation text (65571cc5e, Yousong Zhou) log: fail to submit action log (1a2a40a81, Qiu Jian) mcclient: options: webconsole: fix passing ssh port (8a4c1a0bb, Yousong Zhou) monitor: fix nodata alertresource list (cdcfc7923, –global) monitor: add resType filter (ccf065358, –global) monitor: suggestalert ignore throw err (81e4463ab, zhaoxiangchun) monitor: modify suggestrule process influxdb data (ed13fe9e1, zhaoxiangchun) monitor: other servier create alert add used_by param as a agreement (2ba98e7ce, –global) monitor: modify monitor serviceType in StartService() (db565fe0c, zhaoxiangchun) monitor: monitor notify international and 3.6 bugfix (ab14706ff, –global) monitor: sore reture info：resourceType,measurement (ba2233438, –global) monitor: delete suggestConfig auto init data (815e16eca, zhaoxiangchun) monitor: modify influxdbSuggestDriver query err (96d0f0e63, zhaoxiangchun) monitor: modify notify alertInfo and alertOk detach resource (68dfa8a8c, zhaoxiangchun) monitor: modify monitor nodata alert matching onecloud host func (2564f3c06, zhaoxiangchun) notify: check for changes before updating config (6591ccedc, rainzm) notify: return the result of the second attempt to execute the rpc call (b1ef8865b, rainzm) notify: pull contact for workwx, dingtalk and feishu (1517ed79f, rainzm) notify: allow normal user create their receiver (5bfc3128c, rainzm) notify: break down permissions of notifyconfigs (a9fafc451, rainzm) notify: customize the title of the verification email based on the copyright (d3aae0009, rainzm) notify: clean verifyNote when mark verified (e47f8a896, rainzm) notify: add AllOkContactTypes in where permanently enabled and verified ContactType (fbc951330, rainzm) notify: repull subcontact after changing config (c5acc1b48, rainzm) notify: Set default priority ‘normal’ when creating notification (9af0fe1fe, rainzm) notify: fit correctly when send notification via contact (cdf782537, rainzm) notify: return correct value when sortContactType (c522b4524, rainzm) notify: be compatible with keystone’s UsersV3.GetById (7ed99506a, rainzm) notify: modify name of notification to avoid duplication (087927871, rainzm) notify: Mark verified not enabled in MarkContactTypeVerified (9029e98c2, rainzm) notify: use AfterSend for contact with succuessful sending (9978f1954, rainzm) notify: Allow user list receivers (2ea4138f3, rainzm) notify: avoid deadlock (b1abb353a, rainzm) notify: Replace String() with GetString() (6509ed6e9, rainzm) region: fix backup server start task (735f10a50, wanyaoqi) region: fix modify tags log (de67ee5a2, lvyangyang) region: remove default value of diskConfig.Medium (216e11f29, rainzm) region: roll back the optimization of cachedimage list (eef90b58e, rainzm) region: allow member user get saml auth addr (dea1f29aa, Qu Xuan) region: optimized qcloud secgroup sync, only redis need secgroup be in same project (a84ed01f2, Qu Xuan) region: server skus add cloud_env (d39b3e820, TangBin) region: dbinstance skus sync log level fix (7be898fbc, TangBin) region: change dbinstance sku sync info log to warn (133ba01e9, TangBin) region: validate invalid character for password (35544a7c2, Qu Xuan) region: region qcloud secgroup project id (45a3ce82d, Qu Xuan) region: inspect invalid guest template (5602db8f5, rainzm) region: huawei vnc protocal fix (8db56d90f, TangBin) region: elb cached acl sync (69fa370b0, TangBin) region: optimized azure rebuild root (0252c00ef, Qu Xuan) region: avoid resize azure disk error (0bfa488ac, Qu Xuan) region: sync automatically snapshot for external disk (f13c12d0c, rainzm) region: init NextSyncTimeiwhen create snapshotpolicydisks (a2d221685, rainzm) region: add suffix ‘display’ for time_points and repeat_weekdays (92d862b17, rainzm) region: elastic cache name is empty fix (8bdcc83a8, TangBin) region: redis master zone empty fix (76eb12489, TangBin) region: lb listener filter by acl_id (08dda723b, TangBin) region: lbcert\u0026lbacl releated listener count bugfix (7b96d2593, TangBin) region: avoid timeout for waiting azure async task (f22fe4fe3, Qu Xuan) region: azure win os defualt user (a82327388, Qu Xuan) region: azure reset windows os password (81b31b2fe, Qu Xuan) region: compute binded disk count when deleting snapshotpolicy (2f6678f9a, rainzm) region: avoid qcloud sync local disk error (0c7adedaa, Qu Xuan) region: prevent dirty data when syncing snapshot (c6864e4ae, rainzm) region: detach all snapshotpolicy when realdeleting disk (e660946d2, rainzm) region: temp url sign wrong (c6a7a8701, Qu Xuan) region: omit vpc quota check if vpc created by owner (e38ea05c2, Qiu Jian) region: azure instance data disk storage type (3633baaa2, Qu Xuan) region: clear dirty data of snapshotpolicydisks when start up (7582ead4c, rainzm) region: attach network on register baremetal server (dcd893692, wanyaoqi) region: compute NextSyncTime for snapshotpolicydisk (97f93e6a1, Rain Zheng) region: allow delete resource which status is unknown (f35be9756, Qu Xuan) region: openstack available zones (7abd40c54, Qu Xuan) region: validate isolated devices on migrate (78e8d2f35, wanyaoqi) region: restore password validate condition (acedb4a4f, Qu Xuan) region: sync account id (e540e6561, Qu Xuan) region: allow resize system disk of esxi (46e42724b, rainzm) region: allow update rds account and database desc (e483d1901, Qu Xuan) region: support openstack subnet allocation pools (edcff8045, Qu Xuan) region: optimized qcloud prepaid instance delete (b5b7e89c6, Qu Xuan) region: optimized openstack change config (0d32c5d8e, Qu Xuan) region: sanitize eip charge type on all callsites (14d6c9d6e, Yousong Zhou) region: add SDnsZoneCache to DnsZoneCacheDetails (6efb3fc12, rainzm) region: delete guest without ‘purge’ in GuestDetachScalingGroupTask (0edec40b2, rainzm) region: code gen api error (b6ace002d, Qu Xuan) region: secgrouprule: set model manager (73f434e03, Yousong Zhou) region: aws default account (97eab67f0, Qu Xuan) region: openstack hosts sync (8692498cb, Qu Xuan) region: optimized rds backup create (2a6421258, Qu Xuan) region: reserved name checking while create redis account (a924c9552, TangBin) region: sort excludedNets correctly (c1d95bc31, rainzm) region: pass up error from InitializeData (d2e304bae, Yousong Zhou) region: import rule error hint (a8116b525, Qu Xuan) region: support rds secgroup operation (c5a974e74, Qu Xuan) region: gpu server change config use reserved resources (b07387b57, wanyaoqi) region: apsara is private cloud (21d9edcfa, Qu Xuan) region: aws lb create tags param (4cb9c936c, lvyangyang) region: sku enabled (92fee001e, Qu Xuan) region: allow reset huawei system disk (3ed59afae, TangBin) region: bucket get referer fix (0174e686d, lvyangyang) region: server login info\u0026 keypair import input parameter trimspace (f20ca8b9c, TangBin) region: cloudregion\u0026zone add namei18n (2a4a762f2, TangBin) region: get provider name via GetProviderName (843534c29, rainzm) region: get provider name via GetProviderName (1c475b091, rainzm) region: optimized server stop code (0a8348a36, Qu Xuan) region: network reserved ip count not consider expiration of reserved ips (d8684ea5a, Qiu Jian) region: fix set bucket referer (6f3cabda6, lvyangyang) region: auto sync cloudaccount resources (e056bb102, Qu Xuan) region: apsara optimized (38a0b76a5, Qu Xuan) region: purge private cloud sku (a2b15c596, Qu Xuan) region: sku.meta use global proxy (14bdbea3e, Qu Xuan) region: huawei sync storages bugfix (d5973135d, TangBin) region: prevent infinite recursion (d2ed19175, rainzm) region: optimized disk allocate sched failed log (27a2d36ff, Qu Xuan) region: baremetal post update related server (d001e0ec8, Zexi Li) region: qcloud request retry (e52fb3260, Qu Xuan) region: avolid aliyun fin bucket list objects error (061c5d6dd, Qu Xuan) region: wire get vpc releated hosts is empty (bcfb05019, Zexi Li) region: network clean schedule cache after real deleted (3c85ed11b, Zexi Li) region: vpc list usable fix (b30a40d70, TangBin) region: aws detach igw before delete vpc (da8232807, TangBin) region: vpc create validate cidr mask length (b46d51d1e, TangBin) region: set ownerId as userCred when can’t FetchOwnerId (dbb1d8072, rainzm) region: chooseHostStorage (cfc58a356, rainzm) region: aws create root device name fix (68a2111bf, TangBin) region: aws create storage type fix (9218c9e0b, TangBin) region: sku list query print missing error info (72153ecf5, TangBin) region: aws vpc delete related route table \u0026 internet gateway (9f52afdf9, TangBin) region: aws vpc delete skip delete default secgroup (5ff27734b, TangBin) region: aws delete vpc skipped delete main route table (ac8939494, TangBin) region: fetch correct ownerId in PerformPrepareNets (60490c75d, rainzm) region: aws create vpc with igw add defaultroute (efb436871, TangBin) region: vpc usable fix (596b376d8, TangBin) region: vpc sync external access mode fix (cef3d52f0, TangBin) region: aws sync vpc access mode bugfix (834f5a97d, TangBin) region: split brand as ‘YunionCloud’ and ‘云联壹云’ when notify server event (43d45a1b4, rainzm) region: climc add base projects options (4d4c84801, TangBin) region: allow delete storagecachedimage with ‘cache_failed’ status (ed2a86774, rainzm) region: add GetSlaveFieldName for ScalingGroupGuest (36f43fba9, rainzm) region: start vm when ‘auto_start’ is true (a14b556f2, rainzm) region: exclude network recommended for host when suggesting network for guest (930c64315, rainzm) region: skus add cloudenv (f17593d3f, TangBin) region: apsara metrics fix (a67b09668, Qu Xuan) region: remove i18n fix \u0026 zone \u0026region name support i18n (e28955301, TangBin) region: guestnetworks: use net calculated mtu (6e449c123, Yousong Zhou) region: ignore params.Disks when cloning vm from snapshot (4d13956bc, rainzm) region: add size and storageType for VMware InstanceSnapshot (6ea550d01, rainzm) region: make project of instance snapshot be consistent with the instance (727b89db5, rainzm) region: save when canceling pendingUsage (6d2e91439, rainzm) region: eip_allocate_task: set eip status allocate_fail on task failure (bb0568d18, Yousong Zhou) region: purge all instance snapshots when purging guest (1561d6539, rainzm) region: fix change config forecast (52f0afda0, wanyaoqi) region: update translations (25eb67b37, TangBin) region: create vm with eip task fix (2e401b566, TangBin) region: ctyun delete server bugfix (bc3fdb890, TangBin) region: vpc create data cird validate (ad39e790d, TangBin) region: network create mask length validate (755f4a93a, TangBin) region: remove unnecessary vpc validate create date error wrap (e4f372ba5, TangBin) region: set qcloud instance del timeout to 20m (2d7cdad8f, Qu Xuan) region: guest to create input keep billing info (f8c4c008f, wanyaoqi) region: do not change disk status on migrating (e26fb5cc1, wanyaoqi) region: qcloud bucket set cors (f1b428be0, lvyangyang) region: valid qcloud hssd for system disk (828141168, Qu Xuan) region: sync servers (d2d96b122, Qu Xuan) region: get qcloud bucket cdn-domain (b5d50fdfc, lvyangyang) region: ignore classic vpc checkout while add lb backend (4e811240e, TangBin) region: azure secgroup rule not allow with same priority and direction (2b0e8afe0, Qu Xuan) region: redis create account add name validate (0bbba6d3f, TangBin) region: private cloud sku create (1aec7ab25, Qu Xuan) region: delete aliyun account bugfix (e5289f8a4, TangBin) region: compatible aliyun fin oss (0feddb13a, Qu Xuan) region: avolid panic when list role’s policies (059cd7527, Qu Xuan) region: create redis validate network and sku zone match (c18d1f0e7, TangBin) region: checking cloudenv while create/update aliyun cloud account (767e06a1d, TangBin) region: purge account bugfix (96d2e2403, TangBin) region: create/update aliyun account bugfix (6391ef84d, TangBin) region: add RequestSyncstatusOnHost for SESXiGuestDriver (3fb175ba7, rainzm) region: elasticcache_instances: fix error fmt (ab7ba8322, Yousong Zhou) region: lbbackend: better error reporting for finding influxdb info (48f1cf12a, Yousong Zhou) region: cert\u0026acl cache delete condition check (c4eda6b5a, TangBin) region: aliyun elb listener\u0026lbbg sync project (1a4faf410, TangBin) region: elb acl validate create data fix (0c3a1986f, TangBin) region: lbacl \u0026lbcert default share scope (5a10db10c, TangBin) region: fix openstack instance os type (9c0ce58a0, Qu Xuan) region: add instance capability info(default account) (cfd7c5bd9, Qu Xuan) region: azure host with storage (8207a9c99, Qu Xuan) region: avoid openstack change config error (b60d18c06, Qu Xuan) region: apsara account fix (ab58f0335, Qu Xuan) region: add saml auth for capability (90709ab70, Qu Xuan) region: set classic vpc name to “-” (db00c8355, Qu Xuan) region: 避免从云上同步下来的主机，创建相同配置时network_id为空 (f150da6d9, Qu Xuan) region: add huawei gpssd desc (a9c6579b6, Qu Xuan) region: aliyun sync region fix (8682c71d9, TangBin) region: aliyun region name (bb091a3cb, TangBin) region: aliyun zone name fix (85324cadf, TangBin) region: openstack network is regional (ea41bb4f1, Qu Xuan) region: avoid public ip bandwidth is zero (5dea11952, Qu Xuan) region: change_ipaddr: retain eip_id on detach and attach (f33b9c716, Yousong Zhou) region: 避免OneCloud密码校验通过，公有云厂商密码校验不通过 (782372c35, Qu Xuan) region: azure async task (09adc5f60, Qu Xuan) region: azure metric request path (a79a61c41, Qu Xuan) region: validate cloudaccount saml auth params (a9ef8a1e3, Qu Xuan) region,baremetal: choose candidate network not according by types (9f2b137f0, Zexi Li) region,baremetal: pxe net reuse converted server access ip (829faa1ab, Zexi Li) region,climc: eips: rename arg name for requested eip addr (baff00483, Yousong Zhou) region,esxiagent: allow host behind a nat (197049dcb, Qiu Jian) region,glance: list by os arch adapt to empty strings (027a9439c, wanyaoqi) region,host: fix hot remove nic (7c1923abf, wanyaoqi) region,scheduler: fix netwrok predicate (c8ca855cb, wanyaoqi) region,yunionapi,glance: using global proxy (c1ecb6330, Qu Xuan) scheduler: select resource unordered (5b170650f, Zexi Li) scheduler: more standardized testing (81feadc13, rainzm) scheduler: filter InstanceGroup whose enabled is false (ca58fb8d2, Rain) scheduler: sku filter check zone if only prefer region specified (019c03413, Zexi Li) scheduler: clean expire cache before schedule (a16899c9b, Zexi Li) scheduler: fetch input network when specified (5cfd7f040, Zexi Li) scheduler: get candidates error more info (01124b312, Zexi Li) scheduler: sku by region and fill onecloud vpc networks (24fdb6e84, Zexi Li) scheduler: check candidate tag resource is nil (66eee7f72, Zexi Li) scheduler: storage predicate add actualCapacity filter (e7dd6bba0, Zexi Li) scheduler: fix array out of bounds when sorting hosts (de1b5bc96, rainzm) taskman: use admin token if task userCred token expired (b3c90a804, Qiu Jian) taskman: SSubTask: set model manager (a51a0845b, Yousong Zhou) treewide: fix task error recording (d86834777, Yousong Zhou) vpcagent: ovn: stable dns A record value (b3e196950, Yousong Zhou) vpcagent: models: guestnetworks: accomodate change_ipaddr (d1f1eda98, Yousong Zhou) webconsole: trim api_server url if end with slashes (1236a0326, Zexi Li)  Bugfix (5)  commonalert (444ff1901, zhaoxiangchun) qcloud pull metric (26965521f, zhaoxiangchun) collect esxi metric timout (ec3b5c09b, zhaoxiangchun) region: server change config rebase to sched task (5314ce98b, wanyaoqi) region: fix list by srever type normal (3756993c9, wanyaoqi)  Chore (2)  monitor: delete suggestion files (83e899d9a, zhaoxiangchun) util: update centos build version to 1.1-3 (d98060492, wanyaoqi)  Climc (12)  helper: add BatchCreate helper (91fab1217, Yousong Zhou) helper: create call as a standalone method (f6f4fc125, Yousong Zhou) s/Keyworkd/Keyword/ (9228b1792, Yousong Zhou) network-list with multiple –bgp-type args (6464597c9, Yousong Zhou) k8s machine show resource_id (0f2521487, Zexi Li) servers: create with eip bgp type (4d895d658, Yousong Zhou) add k8s federated resource update subcommand (ddf483bc0, Zexi Li) eip ops by bgp type (bc898e9e3, Yousong Zhou) add k8s fed resource sync action (037fa814f, Zexi Li) refactor k8s sub command (e2604d531, Zexi Li) add k8s federated resource cmd (742e45571, Zexi Li) k8s cluster grafana componet support subpath (930a72667, Zexi Li)  Cloudcommon (5)  db: GET: i18n for result of get property calls (c1468105f, Yousong Zhou) db: add man.GetI18N (d639b0a84, Yousong Zhou) db: modelbase: distinct-field: readability change (d6243fbc6, Yousong Zhou) get joint model should aware fieldname (1af48dc73, Zexi Li) joint model list should add field_name into query (a47553a7a, Zexi Li)  Cloudprovider (2)  add ErrAddressCountExceed (444e66647, Yousong Zhou) ICloudNic: add methods for secondary addresses (9840d7cf7, Yousong Zhou)  Code Refactoring (24)  find the most suitable storage (267929452, rainzm) apis: compute: remove EIP_CHARGE_TYPE_DEFAULT (a28fa3cf4, Yousong Zhou) climc: webconsole: use helper methods of response struct (ce00a1761, Yousong Zhou) esxi: fetchVms and fetchHardwareInfo (4d74a9778, rainzm) esxi: replace GetTemplateVMById with FetchTemplateVMById (dcb6db044, rainzm) host: startvm: for compat (c2d173ae1, Yousong Zhou) host: startvm: nic_speed: use raw string (38492014b, Yousong Zhou) host: startvm: add QEMU_CMD_KVM_ARG (4cf3565b2, Yousong Zhou) host: metadata: eliminate ref of guestNic (0f1fc0fa5, Yousong Zhou) hostman: metadata: eliminate import of guestman (6a2136f6c, Yousong Zhou) hostman: use metadata.DescGetterFunc (de7eb162f, Yousong Zhou) notify: add StartSubcontactPullTask for receiver (8d6defe22, rainzm) notify: hide SSunContact webconsole (8a80f96d6, rainzm) region: faster sync CapacityUsed for Storage (42309b8a7, rainzm) region: remove return value of NotifyWebhook (0d36b3b74, rainzm) region: faster list for cachedimage (de4f1579d, rainzm) region: faster list for cachedimage (bd4851c9f, rainzm) region: faster GetIImageById (936ea0040, rainzm) region: replace ‘ActualCapacity’ with ‘ActualCapacityUsed’ (56d24dfa9, rainzm) region: optimize preparenet of cloudaccount (ed484f4e2, rainzm) scheduler: make forcast result clearer (9d18b94ad, rainzm) scheduler: remove unused k8s predicates code (2a2867daa, Zexi Li) webconsole: use structured response (5959a204f, Yousong Zhou) webconsole: api: add helper methods for response struct (8e9b4aed2, Yousong Zhou)  Db (8)  interface: manager: add HasName() method (ed1999efa, Yousong Zhou) standalone_anon: empty result for name query (c8ad51174, Yousong Zhou) add standalone_anon (c45550ef6, Yousong Zhou) add manager methods appliers (d8ab874ef, Yousong Zhou) virtualjoint: add FilterById on RowId (79120f3de, Yousong Zhou) modelbase: BatchCreateValidateCreateData: return orig data (0e0a39490, Yousong Zhou) check funcs required by dispatcher (3b32ce56c, Yousong Zhou) IModel: add GetI18N() method (9fd0f3088, Yousong Zhou)  Db_dispatcher (3)  allow batch create for models without name (c389aaaeb, Yousong Zhou) delay compute to where needed (f62dddda5, Yousong Zhou) remove unused GetExtraDetails call (0c8ab90f7, Yousong Zhou)  Disk (1)  check disk is need renew on guest set renew (3ac63f537, wanyaoqi)  Dns (1)  isMyDomain: match only strict subdomain of dns_domain (a67026dec, Yousong Zhou)  Eip (3)  create by BgpType (59dd8a0e2, Yousong Zhou) NewEipForVMOnHost: add opslog (b44ac491c, Yousong Zhou) construct a pointer type (83f5a38c2, Yousong Zhou)  Elasticips (6)  NewEipForVMOnHost: make args a struct (f51495048, Yousong Zhou) charge_type: make it varchar column (4537cc3db, Yousong Zhou) bgp_type: make the db column nullable (e61a85b7c, Yousong Zhou) error when we have no usable eip network (63c4818b8, Yousong Zhou) fix calling FilterByOwner (382f62828, Yousong Zhou) filter by owner when doing auto allocation (5afbe831d, Yousong Zhou)  Feature (19)  emualated ssd support (#7701) (0cbad8aea, Jian Qiu) add dns interface (f251559c3, Qu Xuan) allow session level yunion_auth cookie (2a6445c31, Qiu Jian) add apsara support (b195f95bd, Qu Xuan) saml for cloudid (d4edbbb61, Qu Xuan) allow join project across domain (f10267b0f, Qiu Jian) allow specify offset in name pattern (0beee87db, Qiu Jian) auto create domain for sso idp (178e1ab8f, Qiu Jian) support cloudprovider, cloudregion and zone schedtag (cc32bb39e, Zexi Li) support scoped policy that manage ui policies for domains\u0026projects (01d4c2a1c, Qiu Jian) policy group support (2d39cb4cb, Qiu Jian) add qcloud rds support (f77605418, Qu Xuan) remote update qcloud instance metadata and name (e967dd7d6, Qiu Jian) qcloud create VM with tags (38abe9b45, Qiu Jian) filter storages by image (6abd9b0e9, Qiu Jian) qcloud create VM with tags (ddefc2ab3, Qiu Jian) climc: policy save data into file (94dd5c577, Qiu Jian) cloudcommon: split opslog table (ec14f9a6b, Qiu Jian) keystone: user add language attribute (768c88d28, Qiu Jian)  Features (132)  use details data to cover obj data in FetchCustomizeColumns (f6844e3c6, rainzm) change templateid as / in esxi (335c8eecc, rainzm) Add IResultHelper (4b4875cd7, rainzm) update locales (1e297dca1, rainzm) Add method ‘Sku’ to CandidatePropertyGetter (0bd84dd4b, rainzm) download the role to tmpdir not system role dir (deb3758bf, rainzm) add keep_tmpdir options (1eaf2eaff, rainzm) support creating vm from instance snapshot (6f6ea9e38, rainzm) creat, delete, revert and sync operator for esxi instance snapshots (2ed4534f4, rainzm) add WithCtx version to notifyclient function (4b49bcec8, rainzm) add NotifyError in notifyclient (54c7069d9, rainzm) notify user when failing to change config (acf1f1279, rainzm) add ICloudInstanceSnapshot \u0026 modify ICloudVM (e11011ddb, rainzm) log err when sending notification via notifyclient (8eb420e42, rainzm) support snapshot of esxi (7bdcf9552, rainzm) respect params.Disks when cloning vm (a174c32ea, rainzm) add SubImages in Image (564c6cf45, rainzm) add GetSchedtags for ICloudHost (c9039f947, rainzm) add a retry mechanism to AutoSyncExtDiskSnapshot (5e82a7e50, rainzm) add GetCapacityUsedMB for ICloudStorage (fd14e7b6c, rainzm) add ‘ip-list’ for esxicli (4b860cb43, rainzm) filter esxi ip by CIDR (e0aa67357, rainzm) add valid filter for cachedimage list (18fdfad79, rainzm) add NotifyWebhook in notifyclient (264b9ef39, rainzm) add vlanId for suggested network (a4527aec5, rainzm) support lock storage from selected cachedimage (10f0f07bd, rainzm) add ‘vlan_id’ param when creating network (7ab4decab, rainzm) inherit lang from ctx fro Task (e45ddaeb9, rainzm) rds recovery new instance from backup supported (fd4b544fb, Qu Xuan) apis: add const VPC_OVN_ENCAP_COST (aaec97470, Yousong Zhou) appsrv: Application: add Stop method for shutdown behaviour (7d0828410, Yousong Zhou) build: add .dockerignore (2b5014b84, rainzm) build: add DOCKER_BUILDKIT in docker_push.sh (5ab362d05, rainzm) climc: add cloud-account-preparenets-vmware command (67788b179, rainzm) cloudcommon: db: jointbase: add list:“user” for RowId (53125e6ed, Yousong Zhou) cloudcommon: determine the notification template based on the user’s language preference (7d75620d6, rainzm) cloudcommon: allways send webconsole notification via contacts (cff5b8b65, rainzm) cloudcommon: add NotifyWithContact (474bd1440, rainzm) cloudid: notify clouduser created (618d07f45, Qu Xuan) cloudid: support aliyun saml auth (592ae29d7, Qu Xuan) esxi: use more specific storage types (bb6af1e22, rainzm) esxi: support fake template vm via regex filter (48940c77a, rainzm) esxi: add GetSchedtags implementation for esxi.SHost (1cb286080, rainzm) esxi: expand disk config from subimages when creating vm (5251304a4, rainzm) esxi: correctly judge whether inet is nil (3793387b6, rainzm) esxi: copy disk from image when creating vm (937bf4513, rainzm) esxi: support fetchVM form datacenter (0aa9dc6fb, rainzm) esxi: do not specify portkey in NewVNIC (8553f9024, rainzm) esxiagent: keep data disks when cloning vm (d618f61c1, rainzm) esxiagent: try to customize vm if deployfs failed (93df31a97, rainzm) esxiagent: try to resize partition after resizing disk (a1bc77a40, rainzm) esxicli: better vm operator (14c5e18c2, rainzm) host: add option OvnEncapIpDetectionMethod can-reach:xx (8db93257d, Yousong Zhou) host: metadata: make vpc aware metadata handler (8f1f1f55c, Yousong Zhou) host: startvm: set vpc nic mtu (206ae7f9e, Yousong Zhou) host: startvm: add nic_mtu shell func (005fad402, Yousong Zhou) host-deployer: add deploy driver libguestfs (cfa1a4ee4, wanyaoqi) hostdeployer: support resizefs for esxi disk (22cec0964, rainzm) keystone: filter domain/user by idp_entity_id (b27b086cc, Qiu Jian) monitor: add nodata alert policy (766118937, zhaoxiangchun) monitor: add global alertrecord (e2ca41a5f, –global) monitor: add alert slience time and modify scoperesource FetchUniqValues func (1a1df0f07, –global) monitor: add metric description (09660da0a, zhaoxiangchun) monitor: support create nodata alert from web (c2b8f6a83, zhaoxiangchun) netutils2: add MyIPTo (e53bdd5f9, Yousong Zhou) notify: support webhook contact type (012d9b158, rainzm) notify: Support trigger-verify for feishu, dingtalk and workwx (e179191dd, rainzm) notify: replace VerifiedContactTypes with VerifiedInfos in ReceiverDetails (89ec96567, rainzm) notify: enable watching user in keystone (a4dc42e69, rainzm) notify: sort the returned contact type array (77bbb2cfd, rainzm) notify: break down error from UseridByMobile (bf12f5b57, rainzm) notify: user cmdline helpler for climc notify-receiver-xxx (e17768fbc, rainzm) notify: add intellij-get for receiver (75b0889c3, rainzm) notify: Allow use topic to filter notification (0a9a73587, rainzm) notify: Add VerifiedNote for SSubContact (3e982ab79, rainzm) notify: permit admin sending notification via contact (cb663f460, rainzm) notify: Add TNotifyChannel const of robot (f57a199cb, rainzm) notify: allow empty receivers for robot or webhook contact type (2e094a310, rainzm) notify: add webconsole in enabled contact types (bce332272, rainzm) notify: add IntelliNotify (c12b276ea, rainzm) region: larger suggest network and more complete vlanid (cc2675269, rainzm) region: add CloudCaches in DnsZoneDetails with GET (fd360b071, rainzm) region: call NotifyWebhook in when sonme tasks complete (ce0c88d79, rainzm) region: huawei recovery new rds (551aa2f91, Qu Xuan) region: 多云 bucket website.cors,referer 配置 (c9185a43c, lvyangyang) region: use NotifyWebhook when operating dnszone (5a07858e1, rainzm) region: add wire level for preparing network (5a186dbb3, rainzm) region: filter network via storage (f03d5af31, rainzm) region: allow prepare nets for existed cloudaccounts (aad9aba48, rainzm) region: make DeleteSnapshotExpiredRelease applies to postpaid vm (be042a075, rainzm) region: add bucket cloud tags support (66412faf9, lvyangyang) region: call NotifyWebhook in the life cycle of guests (541128d37, rainzm) region: add option NoCheckOsTypeForCachedImage (dfc246ca5, rainzm) region: add list filter server type (6c4ba1737, wanyaoqi) region: networkaddresses: filter by guest ids (b46d50ae3, Yousong Zhou) region: options: allow setting default vpc external access mode (05c95295b, Yousong Zhou) region: regiondriver: add methods on eip charge type (8d7d240b3, Yousong Zhou) region: search server by substr of ip or mac (ca21bcf56, Yousong Zhou) region: set qcloud bucket policy (9872a05be, lvyangyang) region: add SExternalizedResourceBase, SManagedResourceBase to SInstanceSnapshot (bb109953d, rainzm) region: support automatic start vm after reseting isp (f077f0602, rainzm) region: support sync skus by cloudregion (86838db6d, TangBin) region: support sync skus by cloudregion (d86f9a200, TangBin) region: add options DeleteSnapshotExpiredRelease (e4efbdc33, rainzm) region: make address recommendations more precise (fc6a30b20, rainzm) region: add test for CloudaccountManger.PerformPrepareNets (ae94914a7, rainzm) region: sync capacityUsed for storage after deploying or deleting guest (390cc11e7, rainzm) region: sync schedtags when syncing host (0bd75b7bc, rainzm) region: sync CapacityUsed for Storage (0bda9e751, rainzm) region: export user tags support virtual resources (d76915893, wanyaoqi) region: add RequestResizeDiskOnHost to SESXiHostDriver (8c17cdd5e, rainzm) region: server list add parameter eip_associable (8a1d15eba, TangBin) region: networks: add getMtu method (80efc97c6, Yousong Zhou) region: distinguish between pending delete and delete notification (0c7287233, rainzm) region: add instance_snapshot for regionquota (23b1a2b14, rainzm) region: send webhook server_create when canceling pending delete (79eacb5b4, rainzm) region: inter vpc network (eb91e8fcd, spike.lv) region: add instance storage capability (877989529, Qu Xuan) region: divide notify templates into Chinese and English versions (ac438282a, rainzm) region: replace 虚拟机 with 主机 or 云主机 (654c51724, rainzm) region: change fomat ‘id’ to ‘name(id)’ in scheduledtasks' log (33a4f332c, rainzm) region: support aliyun finance cloud (2a1f9ecbc, TangBin) region: add SCloudregionResourceBase for SInstanceSnapshot (35fc62bba, rainzm) region: azure tags (950e75f8b, lvyangyang) region: set pendingUsage before creating instance snapshots (8627818e1, rainzm) region/glance: update cpu arch apis (59102f2dd, wanyaoqi) region/schedtag: schedtag support set multi resources (a16b048f9, Zexi Li) scheduler: support filtering storage via medium (bf30c48ee, rainzm) scripts: add export DOCKER_BUILDKIT=1 (4135e62f6, rainzm) vpcagent: export subnet mac gen funcs (9288c2fd8, Yousong Zhou) webconsole: add huawei vnc support (6e0acab93, TangBin) webhook: send webhook notification when c/d loadbalancerlisterrule (24f4a684a, rainzm)  Glance (1)  check min disk size on update (53d0914cd, wanyaoqi)  Guests (1)  add bgp_type arg when create guest (6bbf09049, Yousong Zhou)  Host (5)  fix order init host srevice (cbb801753, wanyaoqi) restart etcd session on keepalive failed (7dc8f906c, wanyaoqi) specifie bash for start guest (aa45e62cb, wanyaoqi) fix sync storage info duration' (4b09751f5, wanyaoqi) fix rbd storage cache iso image (9e0ce8722, wanyaoqi)  Hostinfo (1)  try create network add is_on_premise (#7706) (74c8c6bfe, wanyaoqi)  Hostman (1)  metadata: add handler for /local-sub-ipv4s (adb998ff5, Yousong Zhou)  Hotfix (1)    allow merge networks without continuous addresses 2. filter guest_ip_start and guest_ip_end with contains operator (6a55acafa, Qiu Jian)    Httperrors (3)  HTTPError: use Error type (776ef9b8b, Yousong Zhou) add Error type (4d7eee4f2, Yousong Zhou) use existing details if id is not present (#7710) (da64e4a26, Yousong Zhou)  Httputils (1)  preserve format val types (d21c262c1, Yousong Zhou)  I18n (2)  add ITable (449c96ad5, Yousong Zhou) move out from httperrors pkg (1c1dcbde4, Yousong Zhou)  Informer (1)  ignore outside context cancel when worker run (ff53671a1, Zexi Li)  Locales (3)  monitor: add translations (0ecdb5cd9, Yousong Zhou) update translation (b075447f9, Yousong Zhou) update translations (69c7af840, Yousong Zhou)  Lockman (1)  test: add prefix setting (cd5163eeb, Yousong Zhou)  Logclient (5)  i18n: en for const (ca8fcb336, Yousong Zhou) i18n: cn for const (08ef1728d, Yousong Zhou) convert const val to use latin chars (31cea0a73, Yousong Zhou) move ws list to separate file (7f90da555, Yousong Zhou) separate lines (ee7b9e287, Yousong Zhou)  Logger (4)  actionlog: i18n for distinct-field (e4cef880a, Yousong Zhou) actionlog: readability change (d8887266a, Yousong Zhou) actionlog: add GetI18N (202ded8c9, Yousong Zhou) actionlog: remove redundant comments (fb28d96d5, Yousong Zhou)  Monitor (4)  query with signature and support measurement without database (3a5bde4a3, Zexi Li) set default influxdb datasource by endpoint type (409c67e24, Zexi Li) add alert resource (31cf935da, Zexi Li) error fmt (50eafd957, Yousong Zhou)  Multicloud (12)  qcloud: fix instancenic (e8ef92ad2, Yousong Zhou) qcloud: add ptr deref func (5f1fd6c7f, Yousong Zhou) qcloud: add apiDomainByRegion (0e0f8bfa9, Yousong Zhou) qcloud: add getVpcClient (1ab4d4049, Yousong Zhou) qcloud: add getSdkClient (9dcd0d2db, Yousong Zhou) aliyun: instancenic: handle InvalidOperation.Ipv4CountExceeded (a3d6a039a, Yousong Zhou) aws: subaddress management (1b6275f80, Yousong Zhou) aws: instancenic: add interface id attribute (3159f6d6d, Yousong Zhou) aliyun: instancenic: secondary address management (0fe90abea, Yousong Zhou) ICloudNic: add GetId() (2afa068d7, Yousong Zhou) ICloudNic: fix GetMAC() (956bc945a, Yousong Zhou) aliyun: make getSdkClient proxy aware (9072a69ae, Yousong Zhou)  Networkaddresses (6)  handle cloudprovider.ErrAddressCountExceed (eec81e73e, Yousong Zhou) do server sync for on premise servers (159453ece, Yousong Zhou) disallow batch create for external resources (05984b49a, Yousong Zhou) cloudprovider support (7343be04b, Yousong Zhou) add to nics field of guest desc (0c8d8358e, Yousong Zhou) add parent_type guestnetwork (87ed4e9a5, Yousong Zhou)  Networks (6)  usedAddressQuery: rename with baseq, ownerq, retq (8ed18fbf3, Yousong Zhou) split getUsedAddressQuery as method of each manager (1609496f9, Yousong Zhou) fix typo in log (f54de809b, Yousong Zhou) make filter by bgp types available (51dafd29e, Yousong Zhou) list: make bgp_type available (d4469ffde, Yousong Zhou) add field BgpType (258ceb7ba, Yousong Zhou)  Opslog (1)  move const to separate file (642a90146, Yousong Zhou)  Optimized (5)  server delete log and wait time (1e160821e, Qu Xuan) aliyun create rds backup (aa5cbd0b0, Qu Xuan) rds zone sync (d207d982e, Qu Xuan) create eip params (17cf23b80, Qu Xuan) region: qcloud bucket policy set and get operation (c0bcfa9a5, Qu Xuan)  Others (186)  update vendor (b4d5400e6, Qiu Jian) update vendor (93ceb707b, Qiu Jian) 负载均衡ACL\u0026证书增加项目和共享 (670a06d53, TangBin) add getStorageType err log (1afaa2950, TangBin) suggestAlert feature: (2bae6c0bb, zhaoxiangchun) add redis and redis skus slave zone info \u0026 huawei aws supported storage type update (2d15a7b97, TangBin) docker 交叉编译规则更新 (c9ec30b5b, Zhang Dongliang) detach AlertResource on alertDisable (357dd4e69, zhaoxiangchun) add:get bucket cdn domain (9b627c10f, lvyangyang) host-deployer: customize user cloudroot home dir (6e66a129d, wanyaoqi) add:bucket ops const i18n (8c29c5396, lvyangyang) qcloud create single zone elb bugfix (63eddd219, TangBin) modify alertResource ws info (d02db0e40, zhaoxiangchun) qcloud bucket task (da4150e5c, lvyangyang) commonalert bugfix: (c39540d5c, zhaoxiangchun) huawei vm support vnc (6b23c5c8f, TangBin) aliyun finance cloud zone add suffix (576120f15, TangBin) aliyun finance cloud region add suffix (7360c544f, TangBin) suggestalet bugfix (922874936, zhaoxiangchun) qemu-arm: fix cdrom params (cc7542cc6, wanyaoqi) allow delete role-policy-binding (f1be0adf6, Qiu Jian) add:aws lb tag (910bec329, lvyangyang) redis set autorenew bugfix (6ce5b1d50, TangBin) redis set autorenew bugfix (fe07cda1a, TangBin) batch user create bugifx (3ceec3aa1, TangBin) huawei create disk bugfix (4e3e5b01a, TangBin) add success note on guest start and stop (f464a904d, wanyaoqi) redis create bugfix (dd2eb4b44, TangBin) redis prepaid create autorenew bugfix (3a4498555, TangBin) commonalert bugfix: (a9c3c5bfd, zhaoxiangchun) qcloud redis secgroup sync fix \u0026 qcloud add renew\u0026 auto_renew (09145c3c1, TangBin) fix:修复dns record name校验的问题 (089aea99d, lvyangyang) add:qcloud routetable (456932632, lvyangyang) qcloud release prepaid resource bugfix (3b7c92521, TangBin) add resource type (0a0b73406, zhaoxiangchun) update vendor for jsonutils (ca0e79eff, Qiu Jian) commonalert bugfix (97ed34038, zhaoxiangchun) Fix a typo: ProviderFactor -\u003e ProviderFactory (47d358ecb, Shaohui Liu) fix:域名正则校验dnsrecord name，同步中文域名取punycode (73d750e1c, lvyangyang) add route (321e3c2f7, lvyangyang) modify monitor querycondition: (d45c09639, zhaoxiangchun) add option PrepaidDeleteExpireCheck (c5a88b80b, TangBin) qcloud delete prepaid redis bugfix (bbe362be2, TangBin) qcloud create prepaid redis bugfix (4be09cfc0, TangBin) lbcert cache delete bugfix (2f7781d15, TangBin) aws create bugfix (0bf274f12, TangBin) modify go test error (72b9f2ec7, zhaoxiangchun) fix stream disk on add disk from snapshot (4a2613a66, wanyaoqi) goimport fix (bf1d8eccf, tangbin) deal return error info: tsdb (8df8e6ca2, zhaoxiangchun) clean duplicate cached certificated at initial (f87c0e397, TangBin) qcloud create project not match bugfix (9a43bb667, TangBin) qcloud certificate sync bugfix (6343e3f4b, TangBin) qcloud cert bugfix (d6677d86d, TangBin) modify monitor dashboard save: (d519be9ab, zhaoxiangchun) qcloud elb cert duplicate fix (46e65d9e0, TangBin) qcloud redis create missing project id bugfix (babed456d, TangBin) update vendor (e48616cdc, rainzm) qcloud lb sync project bugfix (8589d67ac, TangBin) retry generate ifname from random string (f71def645, wanyaoqi) redis 2.8 reset password bugfix (02d0902d9, TangBin) add redis capabilty \u0026 lb purge (0a695c2dc, TangBin) redis delete bugfix (ac03debc9, tangbin) qcloud elb auth mode bugfix (ea497d077, TangBin) ha guest misc fix (0389ec804, wanyaoqi) qcloud redis tags (cfbe92ed9, lvyangyang) elb sync bugfix (399539b92, tangbin) dirve mirror check block replication is support (980396f15, wanyaoqi) sync elb support classic vpc (1eaf06d05, tangbin) qcloud redis support (d7894776f, TangBin) fix get host archs capability (8d07a6308, wanyaoqi) list support scope filter (1805be4d2, Qiu Jian) update api models (48e40fa5a, Qiu Jian) commalertUpdateInput increat param: (10b273938, zhaoxiangchun) qcloud zone sync fix (44b40599a, TangBin) loadbalancer support batch create (541a2d4e0, TangBin) fix on stream disk complete snapshots refcount not update (4efbe27ab, wanyaoqi) check disk is in reset before delete snapshot (e7ce3fd9d, wanyaoqi) create with tags (2c043454a, lvyangyang) bugfix: (b4a83dc15, zhaoxiangchun) elb salve zone 1 external id bugfix (6f2a9d8b7, TangBin) elb sync zone bugfix (94d3fa82a, TangBin) host increase cpu mem max size (6b7a52573, wanyaoqi) add qcloud elb zone1 details (1f17dcf68, TangBin) resource tags (58737942a, lvyangyang) qcloud elb supplort multi zones (f86dc52e9, TangBin) climc lb-create add parameter zone1 (69e0ae9de, TangBin) qcloud elb support multi zones (e6af8ad2c, TangBin) fix:get all project dns resource (efa5a8495, lvyangyang) fix fetch customize columns (cb45349ec, wanyaoqi) fix informer backend (128ec1774, wanyaoqi) lbcert delete bugfix (05f1900a2, TangBin) resource tags (3a73eb9e3, lvyangyang) remove try set informer backend (917a62c14, wanyaoqi) telegraf-raid-plugin: update raid state to lower case (de03ab939, wanyaoqi) keystone init etcd backend (5f5090038, wanyaoqi) fix:qcloud vpc peer error wrap (bb4e09aee, lvyangyang) .circleci: build: make with parallel level 2 (47fd7fb27, Yousong Zhou) add aliyun finance environment (2032e5f1d, TangBin) telegraf raid plugin (225f3b21c, wanyaoqi) remove alpine build cache before make image (0619d3566, Zhang Dongliang) fix:openstack lb 后端ip无法映射到主机的异常处理 (415ef0866, lvyangyang) replace NewFloat by NewFloat64 and NewFloat32 (1cfee7cf6, wanyaoqi) make mode (63887337f, wanyaoqi) fix host-deployer base image (bc26bdb8f, wanyaoqi) fix:aliyun jsonRequest 增加i/o timeout retry (93365de62, lvyangyang) 在 docker push 脚本里创建_output 目录，以便容错 (4be578fc2, Zhang Dongliang) 在 docker push 脚本里创建_output 目录，以便容错 (1f7988ecd, Zhang Dongliang) 解决编译之后 output 的 owerner 问题 (54f86817d, Zhang Dongliang) genreate api models (e64fe802e, wanyaoqi) add interface freeze virtual resource (dcdf45d18, wanyaoqi) esxi-agent 编译方式兼容 arm64 (eda8be1be, Zhang Dongliang) Add web url to alarm template (3d9923a7c, zhaoxiangchun) bugfix:scoperesource FilterByOwner (c0eae040a, zhaoxiangchun) remove aws lbbg cache metedata (1ce5db769, TangBin) modify suggest rule cli (af9e911fd, zhaoxiangchun) fix:允许cname record通过policy多值 (68283ceed, lvyangyang) aliyun public elb region fix (44e9cf049, TangBin) multi-arch 的镜像使用使用支持 arm64 (0b3afa9eb, Zhang Dongliang) bugfix commalert 3.4 (1c7deaf7b, zhaoxiangchun) aliyun public elb brand fix (d71a1f867, TangBin) multi-arch 的镜像使用使用支持 arm64 (65e3900ea, Zhang Dongliang) add mcclient sample (a4bedc7e2, Qiu Jian) fix:forbid top level public domain name (4435255f4, lvyangyang) mcclient modules: fix k8s fed rolebinding joint wrong resource manager (c7e8287c6, Zexi Li) bugfix :esxi 多机器环境下拉取监控超时 (6154f46a6, zhaoxiangchun) aliyun create public lb fix (2de610a3a, TangBin) fix:/dnsrecordset重复检查,dnszonevpc数量 (ed99a6981, lvyangyang) increase rbd check timeout (4ec1727d7, wanyaoqi) umount nfs on detach storage (24eaf5121, wanyaoqi) fix:(region) correct syncSchedtags (fc9b61c2a, rainzm) set stagefail on clean fail (d13cc9949, wanyaoqi) huawei client request add throttling control (1d044f712, TangBin) bugfix:commonalert (6037c84a5, zhaoxiangchun) huawei elb get params log (d8832a167, TangBin) qcloud elb create listener fix (35d155336, TangBin) huawei snapshot delete fix (faeb294d5, TangBin) wait deleted (13823d41e, lvyangyang) commonalert bugfix 3.4 (475c81c58, zhaoxiangchun) bugfix:esxi collect metric (418540c79, zhaoxiangchun) fix esxi-agent dockerfile typo (5db1fa686, Zhang Dongliang) make with ARCH argument (bc6ac93ce, Zhang Dongliang) support search ip (6d6e31813, wanyaoqi) regional network filter bugfix (c8c022733, TangBin) ctyun sync secgroup fix \u0026 cloudaccount delete fix (95e058d06, TangBin) common alert bugfix/3.4 (f58bca93d, zhaoxiangchun) fix host deployer base image (1fc5bac7f, wanyaoqi) ctyun add region cn-bj1 (4a36f82f7, TangBin) support mutli params (f4c1a3ea5, wanyaoqi) fix set host image cache properties (c6eecebed, wanyaoqi) fix update image status after save failed (686b63997, wanyaoqi) dup record process (ff4bde696, lvyangyang) host sync storage size (50a85b73e, wanyaoqi) suggest rule modify: (9a2267230, zhaoxiangchun) bugfix vmware monitor (0842b6f5f, zhaoxiangchun) commonalet bugfix: (a62462552, zhaoxiangchun) Add mock test for genericScheudler.Schedule (57d8f991a, rainzm) dns access (25ddca860, lvyangyang) fix host error output (945fac0a4, wanyaoqi) isolated devices info reenterable (641c71880, wanyaoqi) guest short desc add backup host id (09e568e14, wanyaoqi) fix get ubuntu version (495d9174c, wanyaoqi) pex register add optional column mac_access (88838bb53, TangBin) optimized cachedimages sync (dc1c6c754, Qu Xuan) create classic vpc fix (6a22bf0e7, TangBin) Feature \u0026 Fix for Notify (#7714) (1ed65ddd1, Rain Zheng) update host status to unknown on host offline (4a00c2229, wanyaoqi) listfilter by alert_id (138a16119, zhaoxiangchun) alert record bugfix (bb22fba25, zhaoxiangchun) vmware disk support deploy lvm partition (7dcb24094, wanyaoqi) Bugfix/yousong i18n (#7712) (b314b66b7, Yousong Zhou) Fix problem of esxi (#7661) (e393f3ee2, Rain Zheng) Fix for Notify (#7692) (74af85b8e, Rain Zheng) monitor commonalert bugfix (#7667) (c66ea1145, zhaoxiangchun) fix host get guests (#7682) (795a11fce, wanyaoqi) fix get storage capacity on init' (#7686) (3dec0fdc6, wanyaoqi) snapshot list by guest (fb41d16c9, wanyaoqi) update host deployer base image version (70f953dee, wanyaoqi) baremetal colloct isolated devices info (#7357) (75cd041d7, wanyaoqi) fix mount fetcher fs (#7656) (f255e8fcd, wanyaoqi) remove backup metadata on delete backup (#7653) (b0edff1d8, wanyaoqi) eip \u0026 vpc manager match fix (#7650) (11f86bb29, tb365) add host cpu archs capabilitie (e510ed196, wanyaoqi) support create arm virtual machine (7d94c4e46, wanyaoqi) host campactable with arm64 (bb0d81bc0, wanyaoqi) fix build baremetal agent image (#7646) (cb036b882, wanyaoqi)  README (1)  update architecture img (9fd99a22f, Zexi Li)  Region (7)  networks: attach func use struct args (d8cfba921, Yousong Zhou) networkresource: fix signature of GetExtraDetails (f87d09458, Yousong Zhou) guest detail add field macs (54275ddcf, wanyaoqi) host specs replace space char to ‘_’ (eb093a345, Zexi Li) fix query object by spec not include details (88514a9fc, Zexi Li) fix schedtag joint resource master/slave field wrong order (0113ec40c, Zexi Li) fix network schedtag not cleanup when network deleted (b859f3ba3, Zexi Li)  Regiondrivers (1)  kvm: exact match bgp_type (774cfcbfa, Yousong Zhou)  Schedtags (1)  add ListItemExportKeys (b79915d40, Yousong Zhou)  Scheduler (4)  ignore non running guests only exclude ready status (b47b0dc86, Zexi Li) forecast api with candidates result (0ed41b09e, Zexi Li) fix fillter isolated device (1f51af3a6, wanyaoqi) ignore network type when specified (e129d580b, Zexi Li)  Specs (1)  fix specKey url not escape (bf682f565, Zexi Li)  Stringutils2 (1)  add RemoveUtf8Strings func (f0cc1d3d1, Zexi Li)  Treewide (3)  avoid variable fmt str (152eaa8c5, Yousong Zhou) fmt error (ad52aae79, Yousong Zhou) DeleteFailReason as an object with translated details (6415de33d, Yousong Zhou)  Usage (1)  host show isolated dev reserved memory (0b11854a8, wanyaoqi)  Vendor (7)  add tencentcloud-sdk-go vpc (4a45ca59d, Yousong Zhou) bump alibaba-cloud-sdk-go to v1.61.684 (47a2d0763, Yousong Zhou) add github.com/aliyun/alibaba-cloud-sdk-go/services/ecs (edbddb38b, Yousong Zhou) bump yunion.io/x/pkg (46088408b, Yousong Zhou) bump yunion.io/x/sqlchemy (f0fba9aa2, Yousong Zhou) update yunion.io/x/jsonutils (854ff4079, Yousong Zhou) update yunion.io/x/sqlchemy (b7c3959e0, Yousong Zhou)  Vpcagent (6)  ovn: make aware of sub ips (c3b4edae1, Yousong Zhou) models: join network addresses (314f9fcc0, Yousong Zhou) apihelper: filter by cloud_env=onpremise (f699f7cb5, Yousong Zhou) ovn: increase dhcp lease, renew, rebind time (39f979398, Yousong Zhou) guard against foul eip records (9168284d5, Yousong Zhou) respect guest src check settings (#7677) (ad6b38f68, Yousong Zhou)  Webconsole (3)  ssh: add keyboard-interactive as an option (aa6e45e4d, Yousong Zhou) ssh: each argument on its own line (cce2af501, Yousong Zhou) fix defer order to release zombie process (4f8b80fcc, wanyaoqi)   notify-plugins 仓库地址: https://github.com/yunionio/notify-plugins\n18 commits to notify-plugins - v3.6.0 since this release.\nBug Fixes (4)  common: correct error judgment in BatchSend (1b15dee, rainzm) dingtalk: return correct value in getUseridByMobile (0a041d0, rainzm) robot: Correct err value of ValidateConfig (a367fff, rainzm) workwx: Incorrect variable use for ok (abf098b, rainzm)  Features (9)  break down error from UserIdByMobile (a5ab93b, rainzm) add httpclient timeout for webhook (80e0757, rainzm) add webhook robot(custom robot) (18a1106, rainzm) support multi webhooks config for robot (1f43774, rainzm) email: support toggle ssl (3d4bb13, rainzm) notify: Add BatchSend for websocket (f046407, rainzm) notify: Add common function to batch send (d9a0118, rainzm) robot: Add BatchSend (6d7564e, rainzm) robot: support mutli WebhookPrefix (6054b2a, rainzm)  Others (5)  增加调试开关 (e0c6d39, Zhang Dongliang) buildx for notifyplugins (cf14a4f, Zhang Dongliang) makefile 去掉 sudo; make all bins (51c965a, Zhang Dongliang) docker buildx for notify plugins (9c1c2cd, Zhang Dongliang) update vendor (e3739ac, rainzm)   ocadm 仓库地址: https://github.com/yunionio/ocadm\n7 commits to ocadm - v3.6.0 since this release.\nAutoupdate (1)  clear host tag (df9bab7, Zexi Li)  Bug Fixes (2)  makefile: 更改3.6的 Makefile 号 (649a9dd, Zhang Dongliang) update: cluster update operator parse image digest (ea3bcf8, Zexi Li)  Chore (2)  vendor: update vendor (07dea86, Zexi Li) vendor/v3.6: update vendor (e9d204d, Zexi Li)  Others (2)  metricsserver 自动选择平台 (4277583, Zhang Dongliang) clean info from from autoupdate component when update (a53d4c5, Zexi Li)   onecloud-operator 仓库地址: https://github.com/yunionio/onecloud-operator\n53 commits to onecloud-operator - v3.6.0 since this release.\nBug Fixes (7)  policy description supports i18n (c44eab9, Qiu Jian) skip create policies error (44fc13b, Qiu Jian) role-policy-create many create extra role-policies (0cb1d83, Qiu Jian) add more dashboard default policies (5ab48d2, Qiu Jian) update vendor \u0026 code fix (aac3957, Qiu Jian) monitor: system alert policy cancel description update limit (8036103, zhaoxiangchun) telegraf: fix collect disk measurements (0671287, wanyaoqi)  Bugfix (1)  suggestion: fix err when suggestion syncConfigMap (f7460ca, zhaoxiangchun)  Chore (3)  manifests: update deploy manifests yaml content (a12649e, Zexi Li) monitor: add new service: suggestion (c03365e, zhaoxiangchun) vendor: make mod (94de88d, wanyaoqi)  Feature (3)  optimize host daemonset config (3305513, wanyaoqi) initialize policie and roles v3.5 (8bd28f7, Qiu Jian) keystone: add default member role (a63fddf, Qiu Jian)  Features (6)  add webhook plugin for notify (abf2979, rainzm) component: remove kube-rbac-proxy (7cd57e8, rainzm) framework: support multi zone (df5b6cc, wanyaoqi) host: allow setting ovnEncapIpDetectionMethod (41c2c19, Yousong Zhou) host-deployer: update host-deployer spec (0ffcdf0, wanyaoqi) operator: add nodata alert policy (a28f01e, zhaoxiangchun)  Monitor (2)  alert for host_raid adapter should \u003e= 0 (edfee65, Zexi Li) inject smart_device and host_raid alert rule (ded1e78, Zexi Li)  Notify (1)  remove pvc dependence (ee69174, wanyaoqi)  Others (26)  feat:(monitor): update system monitor alert when alert has diff info (d23f86b, zhaoxiangchun) update Makefile (fec49b1, Qiu Jian) update vendor (27fb644, Qiu Jian) etcd add pod anti affinity (a8e9ae6, wanyaoqi) ce edition should not deploy meter (4858f7b, Zexi Li) modify host_raid alert policy (6188dc0, zhaoxiangchun) 限制 client_body_timeout 时长，预防慢攻击 (da7327e, Zhang Dongliang) 限制 client_body_timeout 时长，预防慢攻击 (ad5c33d, Zhang Dongliang) 限制 client_header_timeout 时长，预防慢攻击 (d22e839, Zhang Dongliang) 更新 nginx 配置以防 dos 攻击 (65dd614, Zhang Dongliang) qcloud add redis crond (c474c0c, zhaoxiangchun) modify commonalert init policy : (fb9ba72, zhaoxiangchun) add qcloud rds crond (2ecc856, zhaoxiangchun) bugfix: (bb13030, zhaoxiangchun) make mod (49408d5, wanyaoqi) set image default policy to if not present (54e78c2, Zexi Li) telegraf add disk plugin (c285508, wanyaoqi) not create notice (3029a7c, Zexi Li) pod affinity by storage class (fde292d, wanyaoqi) BusyBox upgrade ,modify cloudmon timeout arg (eb46544, zhaoxiangchun) host image spec fix (5ba8920, wanyaoqi) add flag check is failed etcd pods need delete (586b3e7, wanyaoqi) push 镜像后,拉回本地 (665a910, Zhang Dongliang) buildx for onecloud-operator (0c9ac24, Zhang Dongliang)   etcd clean failed state pods (89c338d, wanyaoqi)   deployment with pvc not set node affinity (#255) (ce2eed8, Zexi Li)  Regiondns (1)  configmap: quash trailing spaces (641f3b2, Yousong Zhou)  Vendor (1)  update yunion.io/x/master to current release/3.6 (a7054e2, Yousong Zhou)  Web (1)  add docs image (80e00a1, Zexi Li)  Yunionagent (1)  remove onecloud keyword (8792ea6, Zexi Li)   onecloud-service-operator 仓库地址: https://github.com/yunionio/onecloud-service-operator\n10 commits to onecloud-service-operator - v3.6.0 since this release.\nBug Fixes (3)  for last pr (aeb3671, rainzm) retry after a while when dealErr (ec6ecc1, rainzm) resource/vm: convert imageName to imageId before requesting for creating vm (17c8de2, rainzm)  Code Refactoring (1)  change maxRetryTimes to maxTryTimes (d1a8b4a, rainzm)  Features (5)  add more reasonable title for cherry pick PR (b4097f8, rainzm) init docs (a28b5cd, rainzm) keep cloudresource when resource in k8s is invalid (ab1ab79, rainzm) add manager-pro section in Makefile (0f96432, rainzm) resource: better use for logger (22beac3, rainzm)  Others (1)  docker buildx for onecloud-service-operator (e6b93e7, Zhang Dongliang)   sdnagent 仓库地址: https://github.com/yunionio/sdnagent\n30 commits to sdnagent - v3.6.0 since this release.\nAgent (4)  server: enable ovnMdMan (ae3eab6, Yousong Zhou) server: add metadata server (c7af8c7, Yousong Zhou) server: watch: add FindGuestDescByNetIdIP (0b314bd, Yousong Zhou) server: use utils.RunOvsctl (8fd7165, Yousong Zhou)  Bug Fixes (1)  hostconfig: fix watching hostconfig (b895141, Yousong Zhou)  Build (2)  eipgw: track to ensure stop state as well (048a1c9, Yousong Zhou) eipgw: vrrp track script as monitor (a485d61, Yousong Zhou)  Flowsource (5)  make aware of sub ips (b1afd56, Yousong Zhou) relax constraint when mac check on and ip check off (3bf9855, Yousong Zhou) reword ref comments on allow_switch_vms (5e848c1, Yousong Zhou) reword ref comments on allow_router_vms (7ae147d, Yousong Zhou) remove now unused code for dev (bde4723, Yousong Zhou)  Others (3)  .circleci: bump go to 1.14 (122342c, Yousong Zhou) pull image for buildx (08a0395, Zhang Dongliang) docker buildx for sdnagent (c4e72f7, Zhang Dongliang)  Sdnagent (1)  be cooperative (24e75c1, Yousong Zhou)  Tc (6)  QdiscTree: add Root() method (ebcb90d, Yousong Zhou) NewQdiscTree: special case mq (2ce36e0, Yousong Zhou) NewQdiscTree: fix children key (61b5543, Yousong Zhou) NewQdiscTree: use qbase for BaseQdisc() return (98de150, Yousong Zhou) NewQdiscTree: rename vars (5747fb5, Yousong Zhou) NewQdiscTree: use current tree instead of the root (6195925, Yousong Zhou)  Tcman (1)  skip devices with mq qdisc (483628c, Yousong Zhou)  Utils (4)  add RunOvsctl (d0aa06c, Yousong Zhou) guest: add GetJSONObjectDesc (469d4d9, Yousong Zhou) guest: add FindNicByNetIdIP (d42997c, Yousong Zhou) guest: make aware of sub ips (630b4c9, Yousong Zhou)  Vendor (3)  bump to onecloud master branch (beb7661b9fc) (b67c9e1, Yousong Zhou) bump yunion.io/x/onecloud to current tip of release/3.3 (f3e6231, Yousong Zhou) bump yunion.io/x/onecloud to current tip of release/3.3 (a175a5b, Yousong Zhou)  ","excerpt":"发布时间 2020-12-29 14:17:58\n onecloud 仓库地址: …","ref":"/v3.6/zh/docs/changelog/release-3.6/3-6-0/","title":"v3.6.0"},{"body":"Release time: 2020-11-26 15:42:12\n onecloud Repository: https://github.com/yunionio/onecloud\n21 commits to onecloud - v3.4.9 since this release.\nBug Fixes (20)  allow disk attach to multiple guests (3d2b24a35, Qiu Jian) host: wait put host offline success (c325d8355, wanyaoqi) locales: fix translation text (377454997, Yousong Zhou) monitor: modify monitor serviceType in StartService() (09ed698ae, zhaoxiangchun) monitor: modify suggestrule process influxdb data (6e0d4cb35, zhaoxiangchun) monitor: modify notify alertInfo and alertOk detach resource (ff5396b90, zhaoxiangchun) region: 避免OneCloud密码校验通过，公有云厂商密码校验不通过 (fc16c37ea, Qu Xuan) region: update translations (7bf1bef04, TangBin) region: allow reset huawei system disk (024a17de8, TangBin) region: valid qcloud hssd for system disk (0f5a8b640, Qu Xuan) region: elasticcache_instances: fix error fmt (3b2938380, Yousong Zhou) region: change_ipaddr: retain eip_id on detach and attach (a5d82922b, Yousong Zhou) region: allow delete storagecachedimage with ‘cache_failed’ status (61eaea809, rainzm) region: avoid public ip bandwidth is zero (256019894, Qu Xuan) region: network clean schedule cache after real deleted (37f648bfb, Zexi Li) region: elastic cache task fail message fix (71535f670, TangBin) region: wire get vpc releated hosts is empty (372c9a393, Zexi Li) region,esxiagent: allow host behind a nat (6f0d6cbea, Qiu Jian) scheduler: clean expire cache before schedule (1818d4853, Zexi Li) vpcagent: models: guestnetworks: accomodate change_ipaddr (9d19bf34b, Yousong Zhou)  Features (1)  cloudcommon: db: jointbase: add list:“user” for RowId (e4bf0fa8d, Yousong Zhou)   onecloud-service-operator Repository: https://github.com/yunionio/onecloud-service-operator\n5 commits to onecloud-service-operator - v3.4.9 since this release.\nBug Fixes (2)  for last pr (bec75da, rainzm) resource/vm: convert imageName to imageId before requesting for creating vm (62649ce, rainzm)  Code Refactoring (1)  change maxRetryTimes to maxTryTimes (3c14278, rainzm)  Features (2)  init docs (ea4dc59, rainzm) resource: better use for logger (fe928bf, rainzm)   sdnagent Repository: https://github.com/yunionio/sdnagent\n1 commits to sdnagent - v3.4.9 since this release.\nBug Fixes (1)  hostconfig: fix watching hostconfig (24ad2f8, Yousong Zhou)  ","excerpt":"Release time: 2020-11-26 15:42:12\n onecloud Repository: …","ref":"/v3.6/en/docs/changelog/release-3.4/3-4-9/","title":"v3.4.9"},{"body":"发布时间 2020-11-26 15:42:12\n onecloud 仓库地址: https://github.com/yunionio/onecloud\n21 commits to onecloud - v3.4.9 since this release.\nBug Fixes (20)  allow disk attach to multiple guests (3d2b24a35, Qiu Jian) host: wait put host offline success (c325d8355, wanyaoqi) locales: fix translation text (377454997, Yousong Zhou) monitor: modify monitor serviceType in StartService() (09ed698ae, zhaoxiangchun) monitor: modify suggestrule process influxdb data (6e0d4cb35, zhaoxiangchun) monitor: modify notify alertInfo and alertOk detach resource (ff5396b90, zhaoxiangchun) region: 避免OneCloud密码校验通过，公有云厂商密码校验不通过 (fc16c37ea, Qu Xuan) region: update translations (7bf1bef04, TangBin) region: allow reset huawei system disk (024a17de8, TangBin) region: valid qcloud hssd for system disk (0f5a8b640, Qu Xuan) region: elasticcache_instances: fix error fmt (3b2938380, Yousong Zhou) region: change_ipaddr: retain eip_id on detach and attach (a5d82922b, Yousong Zhou) region: allow delete storagecachedimage with ‘cache_failed’ status (61eaea809, rainzm) region: avoid public ip bandwidth is zero (256019894, Qu Xuan) region: network clean schedule cache after real deleted (37f648bfb, Zexi Li) region: elastic cache task fail message fix (71535f670, TangBin) region: wire get vpc releated hosts is empty (372c9a393, Zexi Li) region,esxiagent: allow host behind a nat (6f0d6cbea, Qiu Jian) scheduler: clean expire cache before schedule (1818d4853, Zexi Li) vpcagent: models: guestnetworks: accomodate change_ipaddr (9d19bf34b, Yousong Zhou)  Features (1)  cloudcommon: db: jointbase: add list:“user” for RowId (e4bf0fa8d, Yousong Zhou)   onecloud-service-operator 仓库地址: https://github.com/yunionio/onecloud-service-operator\n5 commits to onecloud-service-operator - v3.4.9 since this release.\nBug Fixes (2)  for last pr (bec75da, rainzm) resource/vm: convert imageName to imageId before requesting for creating vm (62649ce, rainzm)  Code Refactoring (1)  change maxRetryTimes to maxTryTimes (3c14278, rainzm)  Features (2)  init docs (ea4dc59, rainzm) resource: better use for logger (fe928bf, rainzm)   sdnagent 仓库地址: https://github.com/yunionio/sdnagent\n1 commits to sdnagent - v3.4.9 since this release.\nBug Fixes (1)  hostconfig: fix watching hostconfig (24ad2f8, Yousong Zhou)  ","excerpt":"发布时间 2020-11-26 15:42:12\n onecloud 仓库地址: …","ref":"/v3.6/zh/docs/changelog/release-3.4/3-4-9/","title":"v3.4.9"},{"body":"Release time: 2020-11-20 16:52:19\n onecloud Repository: https://github.com/yunionio/onecloud\n3 commits to onecloud - v3.4.8 since this release.\nBug Fixes (1)  region: compatible rds network params (42582043e, Qu Xuan)  Features (1)  rds recovery new instance from backup supported (b6917c560, Qu Xuan)  Optimized (1)  server delete log and wait time (47349e71b, Qu Xuan)  ","excerpt":"Release time: 2020-11-20 16:52:19\n onecloud Repository: …","ref":"/v3.6/en/docs/changelog/release-3.4/3-4-8/","title":"v3.4.8"},{"body":"发布时间 2020-11-20 16:52:19\n onecloud 仓库地址: https://github.com/yunionio/onecloud\n3 commits to onecloud - v3.4.8 since this release.\nBug Fixes (1)  region: compatible rds network params (42582043e, Qu Xuan)  Features (1)  rds recovery new instance from backup supported (b6917c560, Qu Xuan)  Optimized (1)  server delete log and wait time (47349e71b, Qu Xuan)  ","excerpt":"发布时间 2020-11-20 16:52:19\n onecloud 仓库地址: …","ref":"/v3.6/zh/docs/changelog/release-3.4/3-4-8/","title":"v3.4.8"},{"body":"Release time: 2020-11-19 15:25:11\n onecloud Repository: https://github.com/yunionio/onecloud\n22 commits to onecloud - v3.4.7 since this release.\nBug Fixes (10)  add host.memoty.total and host.cpu.total usage stats (6b0ae74ac, Qiu Jian) add host-joint resources into domain level resources (ba2a188f0, Qiu Jian) add err handler for notifyRobot (4a06b38da, rainzm) avoid panic (e9459b4a7, Qu Xuan) add error cause (43f4f5f94, Qu Xuan) baremetal usage should exclude converted hypervisor (dc19e7b03, Qiu Jian) host memory usage status not correct (71ddac232, Qiu Jian) keystone init empty catalogy cause panic (b545066e0, Qiu Jian) support resize qcloud hssd disk (27c8861b6, Qu Xuan) notify: be compatible with keystone’s UsersV3.GetById (aee0299d7, rainzm)  Feature (1)  allow join project across domain (1fce2ec30, Qiu Jian)  Features (1)  notify: enable watching user in keystone (96400124b, rainzm)  Host (1)  restart etcd session on keepalive failed (029530ac3, wanyaoqi)  Optimized (1)  aliyun create rds backup (3a8e99871, Qu Xuan)  Others (7)  docker 交叉编译规则更新 (491a9ece5, Zhang Dongliang) detach AlertResource on alertDisable (ea793d990, zhaoxiangchun) modify alertResource ws info (bef9af4c3, zhaoxiangchun) commonalert bugfix: (37272588f, zhaoxiangchun) aliyun finance cloud zone add suffix (befef016d, TangBin) aliyun finance cloud region add suffix (c32ad0ac5, TangBin) suggestalet bugfix (c4d4700d2, zhaoxiangchun)  Vendor (1)  update yunion.io/x/jsonutils (ca9859f12, Yousong Zhou)   notify-plugins Repository: https://github.com/yunionio/notify-plugins\n1 commits to notify-plugins - v3.4.7 since this release.\nFeatures (1)  email: support toggle ssl (7556a4e, rainzm)   onecloud-operator Repository: https://github.com/yunionio/onecloud-operator\n2 commits to onecloud-operator - v3.4.7 since this release.\nOthers (2)  etcd add pod anti affinity (874ad04, wanyaoqi) ce edition should not deploy meter (4403ccf, Zexi Li)   sdnagent Repository: https://github.com/yunionio/sdnagent\n4 commits to sdnagent - v3.4.7 since this release.\nFlowsource (4)  relax constraint when mac check on and ip check off (374add8, Yousong Zhou) reword ref comments on allow_switch_vms (3e170b7, Yousong Zhou) reword ref comments on allow_router_vms (eced14a, Yousong Zhou) remove now unused code for dev (4271b13, Yousong Zhou)  ","excerpt":"Release time: 2020-11-19 15:25:11\n onecloud Repository: …","ref":"/v3.6/en/docs/changelog/release-3.4/3-4-7/","title":"v3.4.7"},{"body":"发布时间 2020-11-19 15:25:11\n onecloud 仓库地址: https://github.com/yunionio/onecloud\n22 commits to onecloud - v3.4.7 since this release.\nBug Fixes (10)  add host.memoty.total and host.cpu.total usage stats (6b0ae74ac, Qiu Jian) add host-joint resources into domain level resources (ba2a188f0, Qiu Jian) add err handler for notifyRobot (4a06b38da, rainzm) avoid panic (e9459b4a7, Qu Xuan) add error cause (43f4f5f94, Qu Xuan) baremetal usage should exclude converted hypervisor (dc19e7b03, Qiu Jian) host memory usage status not correct (71ddac232, Qiu Jian) keystone init empty catalogy cause panic (b545066e0, Qiu Jian) support resize qcloud hssd disk (27c8861b6, Qu Xuan) notify: be compatible with keystone’s UsersV3.GetById (aee0299d7, rainzm)  Feature (1)  allow join project across domain (1fce2ec30, Qiu Jian)  Features (1)  notify: enable watching user in keystone (96400124b, rainzm)  Host (1)  restart etcd session on keepalive failed (029530ac3, wanyaoqi)  Optimized (1)  aliyun create rds backup (3a8e99871, Qu Xuan)  Others (7)  docker 交叉编译规则更新 (491a9ece5, Zhang Dongliang) detach AlertResource on alertDisable (ea793d990, zhaoxiangchun) modify alertResource ws info (bef9af4c3, zhaoxiangchun) commonalert bugfix: (37272588f, zhaoxiangchun) aliyun finance cloud zone add suffix (befef016d, TangBin) aliyun finance cloud region add suffix (c32ad0ac5, TangBin) suggestalet bugfix (c4d4700d2, zhaoxiangchun)  Vendor (1)  update yunion.io/x/jsonutils (ca9859f12, Yousong Zhou)   notify-plugins 仓库地址: https://github.com/yunionio/notify-plugins\n1 commits to notify-plugins - v3.4.7 since this release.\nFeatures (1)  email: support toggle ssl (7556a4e, rainzm)   onecloud-operator 仓库地址: https://github.com/yunionio/onecloud-operator\n2 commits to onecloud-operator - v3.4.7 since this release.\nOthers (2)  etcd add pod anti affinity (874ad04, wanyaoqi) ce edition should not deploy meter (4403ccf, Zexi Li)   sdnagent 仓库地址: https://github.com/yunionio/sdnagent\n4 commits to sdnagent - v3.4.7 since this release.\nFlowsource (4)  relax constraint when mac check on and ip check off (374add8, Yousong Zhou) reword ref comments on allow_switch_vms (3e170b7, Yousong Zhou) reword ref comments on allow_router_vms (eced14a, Yousong Zhou) remove now unused code for dev (4271b13, Yousong Zhou)  ","excerpt":"发布时间 2020-11-19 15:25:11\n onecloud 仓库地址: …","ref":"/v3.6/zh/docs/changelog/release-3.4/3-4-7/","title":"v3.4.7"},{"body":"Release time: 2020-11-12 14:15:45\n onecloud Repository: https://github.com/yunionio/onecloud\n20 commits to onecloud - v3.4.6 since this release.\nBug Fixes (9)  aliyun eip api (fc4460fa3, Qu Xuan) renew rds (39fe8b213, Qu Xuan) aws secgroup out rule is deny any (1ee8fd05b, Qu Xuan) change owner should update quota usages (6927652a6, Qiu Jian) 支持多内存过滤套餐 (e975fc671, Qu Xuan) missing column error when order by extra fields (c8ddd7653, Qiu Jian) esxi: don’t specify spec.Identity when osName is empty (6f60f1a48, rainzm) esxi: add device after cloning vm (c3b8e7bbd, rainzm) region: prevent infinite recursion (0bbe2e759, rainzm)  Code Refactoring (2)  region: faster GetIImageById (edc651a30, rainzm) region: faster sync CapacityUsed for Storage (76b1796c7, rainzm)  Features (1)  region: add option NoCheckOsTypeForCachedImage (b5201a352, rainzm)  Host (1)  specifie bash for start guest (7d35397d5, wanyaoqi)  Others (5)  add success note on guest start and stop (ea70090f6, wanyaoqi) batch user create bugifx (e9a4a6380, TangBin) huawei create disk bugfix (642b13733, TangBin) fix:修复dns record name校验的问题 (e108d1755, lvyangyang) update vendor for jsonutils (aae3da8c2, Qiu Jian)  Scheduler (1)  ignore non running guests only exclude ready status (827be9167, Zexi Li)  Usage (1)  host show isolated dev reserved memory (30776fc70, wanyaoqi)  ","excerpt":"Release time: 2020-11-12 14:15:45\n onecloud Repository: …","ref":"/v3.6/en/docs/changelog/release-3.4/3-4-6/","title":"v3.4.6"},{"body":"发布时间 2020-11-12 14:15:45\n onecloud 仓库地址: https://github.com/yunionio/onecloud\n20 commits to onecloud - v3.4.6 since this release.\nBug Fixes (9)  aliyun eip api (fc4460fa3, Qu Xuan) renew rds (39fe8b213, Qu Xuan) aws secgroup out rule is deny any (1ee8fd05b, Qu Xuan) change owner should update quota usages (6927652a6, Qiu Jian) 支持多内存过滤套餐 (e975fc671, Qu Xuan) missing column error when order by extra fields (c8ddd7653, Qiu Jian) esxi: don’t specify spec.Identity when osName is empty (6f60f1a48, rainzm) esxi: add device after cloning vm (c3b8e7bbd, rainzm) region: prevent infinite recursion (0bbe2e759, rainzm)  Code Refactoring (2)  region: faster GetIImageById (edc651a30, rainzm) region: faster sync CapacityUsed for Storage (76b1796c7, rainzm)  Features (1)  region: add option NoCheckOsTypeForCachedImage (b5201a352, rainzm)  Host (1)  specifie bash for start guest (7d35397d5, wanyaoqi)  Others (5)  add success note on guest start and stop (ea70090f6, wanyaoqi) batch user create bugifx (e9a4a6380, TangBin) huawei create disk bugfix (642b13733, TangBin) fix:修复dns record name校验的问题 (e108d1755, lvyangyang) update vendor for jsonutils (aae3da8c2, Qiu Jian)  Scheduler (1)  ignore non running guests only exclude ready status (827be9167, Zexi Li)  Usage (1)  host show isolated dev reserved memory (30776fc70, wanyaoqi)  ","excerpt":"发布时间 2020-11-12 14:15:45\n onecloud 仓库地址: …","ref":"/v3.6/zh/docs/changelog/release-3.4/3-4-6/","title":"v3.4.6"},{"body":"Release time: 2020-11-04 19:45:53\n onecloud Repository: https://github.com/yunionio/onecloud\n18 commits to onecloud - v3.4.5 since this release.\nBug Fixes (10)  add qcloud hssd (0c19c21ef, Qu Xuan) save service config changes may send invalid action log (c8138c291, Qiu Jian) fail to delete public_ip eip (b1e91c1c2, Qiu Jian) secgroup cache tenant_id (4cbe93163, Qu Xuan) notify: customize the title of the verification email based on the copyright (58c5514a0, rainzm) region: clear dirty data of snapshotpolicydisks when start up (7460ea146, rainzm) region: detach all snapshotpolicy when realdeleting disk (250ad41c7, rainzm) region: prevent dirty data when syncing snapshot (a53a44cb2, rainzm) region: sync automatically snapshot for external disk (a3f01f133, rainzm) region: compute NextSyncTime for snapshotpolicydisk (f290aa5d5, Rain Zheng)  Informer (1)  ignore outside context cancel when worker run (a0f495db9, Zexi Li)  Optimized (1)  rds zone sync (83d0a3ce0, Qu Xuan)  Others (6)  fix:域名正则校验dnsrecord name，同步中文域名取punycode (6bfff8b70, lvyangyang) lbcert cache delete bugfix (41dd48e8f, TangBin) aws create bugfix (3ceb0e2dc, TangBin) fix stream disk on add disk from snapshot (82f5b9ccb, wanyaoqi) qcloud elb cert duplicate fix (8f2f78b4e, TangBin) update vendor (52a72952c, rainzm)   notify-plugins Repository: https://github.com/yunionio/notify-plugins\n1 commits to notify-plugins - v3.4.5 since this release.\nFeatures (1)  add httpclient timeout for webhook (2341459, rainzm)   onecloud-operator Repository: https://github.com/yunionio/onecloud-operator\n3 commits to onecloud-operator - v3.4.5 since this release.\nMake (1)  RELEASE_BRANCH=release/3.4 (5d5913d, Zexi Li)  Others (2)  限制 client_body_timeout 时长，预防慢攻击 (adf6baf, Zhang Dongliang) 限制 client_header_timeout 时长，预防慢攻击 (22a92e8, Zhang Dongliang)  ","excerpt":"Release time: 2020-11-04 19:45:53\n onecloud Repository: …","ref":"/v3.6/en/docs/changelog/release-3.4/3-4-5/","title":"v3.4.5"},{"body":"发布时间 2020-11-04 19:45:53\n onecloud 仓库地址: https://github.com/yunionio/onecloud\n18 commits to onecloud - v3.4.5 since this release.\nBug Fixes (10)  add qcloud hssd (0c19c21ef, Qu Xuan) save service config changes may send invalid action log (c8138c291, Qiu Jian) fail to delete public_ip eip (b1e91c1c2, Qiu Jian) secgroup cache tenant_id (4cbe93163, Qu Xuan) notify: customize the title of the verification email based on the copyright (58c5514a0, rainzm) region: clear dirty data of snapshotpolicydisks when start up (7460ea146, rainzm) region: detach all snapshotpolicy when realdeleting disk (250ad41c7, rainzm) region: prevent dirty data when syncing snapshot (a53a44cb2, rainzm) region: sync automatically snapshot for external disk (a3f01f133, rainzm) region: compute NextSyncTime for snapshotpolicydisk (f290aa5d5, Rain Zheng)  Informer (1)  ignore outside context cancel when worker run (a0f495db9, Zexi Li)  Optimized (1)  rds zone sync (83d0a3ce0, Qu Xuan)  Others (6)  fix:域名正则校验dnsrecord name，同步中文域名取punycode (6bfff8b70, lvyangyang) lbcert cache delete bugfix (41dd48e8f, TangBin) aws create bugfix (3ceb0e2dc, TangBin) fix stream disk on add disk from snapshot (82f5b9ccb, wanyaoqi) qcloud elb cert duplicate fix (8f2f78b4e, TangBin) update vendor (52a72952c, rainzm)   notify-plugins 仓库地址: https://github.com/yunionio/notify-plugins\n1 commits to notify-plugins - v3.4.5 since this release.\nFeatures (1)  add httpclient timeout for webhook (2341459, rainzm)   onecloud-operator 仓库地址: https://github.com/yunionio/onecloud-operator\n3 commits to onecloud-operator - v3.4.5 since this release.\nMake (1)  RELEASE_BRANCH=release/3.4 (5d5913d, Zexi Li)  Others (2)  限制 client_body_timeout 时长，预防慢攻击 (adf6baf, Zhang Dongliang) 限制 client_header_timeout 时长，预防慢攻击 (22a92e8, Zhang Dongliang)  ","excerpt":"发布时间 2020-11-04 19:45:53\n onecloud 仓库地址: …","ref":"/v3.6/zh/docs/changelog/release-3.4/3-4-5/","title":"v3.4.5"},{"body":"Release time: 2020-10-28 18:20:55\n onecloud Repository: https://github.com/yunionio/onecloud\n70 commits to onecloud - v3.4.4 since this release.\nBug Fixes (29)  cancel pending-delete should increase resource quota usages (2a1a640f6, Qiu Jian) missing authenticate action log for user web login (ecbe76e9f, Qiu Jian) add rds cpu and memory usage (16d13941c, Qu Xuan) set secgroup status (44046f286, Qu Xuan) avoid sync project panic (95f7600b6, Qu Xuan) use correct worker (062301f54, Qu Xuan) avoid delete public ip when sync eip list (a851e0133, Qu Xuan) server usage status not correct (90d649aef, Qiu Jian) do not lock guest after lock eip, to prevent possible dead lock (d774581a2, Qiu Jian) remote update metadata may cause metadata update loop (62f5355b1, Qiu Jian) don’t update NextSyncTime when snapshots that should be added has not (0ba8cb7fb, rainzm) reduce change config logs (9b8758e19, Qiu Jian) 新增google存储类型 (f77bcd3bb, Qu Xuan) 避免冲掉设置的到期释放时间 (8f3cb9cdb, Qu Xuan) add aliyun new region (22349276d, Qu Xuan) missing authenticate action log for user web login (a92a0e2d0, Qiu Jian) monitor commonalert not detach alert resource (d99d93d04, Zexi Li) sync dns records after sync vpcs (11f8e4f71, Qu Xuan) compute: filter cachedimage with health storage (2a1bbfd57, rainzm) esxi: no callback in uploadHandler (57dad6281, rainzm) esxi: use correct device index (d3964bf0d, rainzm) esxi: resize root disk after cloning vm (8f3b8c7ff, rainzm) esxi: filter vmdk item in lease.info (d31802c87, rainzm) glance: allow public and private operations of guestimage (3fae388db, rainzm) notify: add AllOkContactTypes in where permanently enabled and verified ContactType (f367f1abe, rainzm) region: compute binded disk count when deleting snapshotpolicy (6f1417d26, rainzm) region: roll back the optimization of cachedimage list (be5a6a93c, rainzm) region: add suffix ‘display’ for time_points and repeat_weekdays (bbfb9db90, rainzm) region: init NextSyncTimeiwhen create snapshotpolicydisks (93bb4022f, rainzm)  Bugfix (2)  commonalert (8a0eeb7d6, zhaoxiangchun) qcloud pull metric (06db7339e, zhaoxiangchun)  Cloudcommon (3)  db: GET: i18n for result of get property calls (5d0fd14cb, Yousong Zhou) db: add man.GetI18N (cd123e007, Yousong Zhou) db: modelbase: distinct-field: readability change (91736710b, Yousong Zhou)  Code Refactoring (3)  find the most suitable storage (7a2c2b804, rainzm) region: faster list for cachedimage (c45658686, rainzm) region: faster list for cachedimage (b0823a09b, rainzm)  Feature (2)  remote update qcloud instance metadata and name (a764a6469, Qiu Jian) qcloud create VM with tags (f05a56aad, Qiu Jian)  Features (10)  use details data to cover obj data in FetchCustomizeColumns (37c14d756, rainzm) add a retry mechanism to AutoSyncExtDiskSnapshot (93ac3260a, rainzm) add valid filter for cachedimage list (d454b0a79, rainzm) add NotifyWebhook in notifyclient (0fd6481e4, rainzm) support lock storage from selected cachedimage (5a7876ae4, rainzm) esxiagent: try to customize vm if deployfs failed (a35a6f3c1, rainzm) notify: add IntelliNotify (5306add70, rainzm) notify: allow empty receivers for robot or webhook contact type (d799a71fd, rainzm) notify: support webhook contact type (436f1e5cb, rainzm) region: call NotifyWebhook in the life cycle of guests (9dee4c1b9, rainzm)  Host (1)  fix sync storage info duration' (7a9b491d1, wanyaoqi)  Lockman (1)  test: add prefix setting (f7f7c7be8, Yousong Zhou)  Logger (2)  actionlog: i18n for distinct-field (0964c6ad8, Yousong Zhou) actionlog: readability change (c2589e735, Yousong Zhou)  Monitor (2)  set default influxdb datasource by endpoint type (b43f8b3fa, Zexi Li) add alert resource (af11737e7, Zexi Li)  Others (15)  commalertUpdateInput increat param: (002a2af27, zhaoxiangchun) fix on stream disk complete snapshots refcount not update (8e5b74a3f, wanyaoqi) check disk is in reset before delete snapshot (d78068d43, wanyaoqi) bugfix: (e7674116e, zhaoxiangchun) host increase cpu mem max size (a4b1d3952, wanyaoqi) fix:get all project dns resource (66c81ee54, lvyangyang) fix informer backend (d6a9b5dac, wanyaoqi) fix fetch customize columns (f706d59ac, wanyaoqi) lbcert delete bugfix (7da0a67af, TangBin) remove try set informer backend (15bd6bacd, wanyaoqi) telegraf-raid-plugin: update raid state to lower case (6706c39f8, wanyaoqi) keystone init etcd backend (8ce183eaf, wanyaoqi) .circleci: build: make with parallel level 2 (3aadaf15b, Yousong Zhou) add aliyun finance environment (a9c44ed30, TangBin) telegraf raid plugin (8b2680ed5, wanyaoqi)   notify-plugins Repository: https://github.com/yunionio/notify-plugins\n4 commits to notify-plugins - v3.4.4 since this release.\nDocker_push (1)  amd64 just use build_process (d4bbb03, Zexi Li)  Features (2)  add webhook robot(custom robot) (06bde6a, rainzm) support multi webhooks config for robot (52669eb, rainzm)  Others (1)  增加调试开关 (ab97c2e, Zhang Dongliang)   onecloud-operator Repository: https://github.com/yunionio/onecloud-operator\n9 commits to onecloud-operator - v3.4.4 since this release.\nFeatures (1)  add webhook plugin for notify (e8cedb1, rainzm)  Monitor (2)  alert for host_raid adapter should \u003e= 0 (dc52030, Zexi Li) inject smart_device and host_raid alert rule (fee4e8a, Zexi Li)  Others (6)  更新 nginx 配置以防 dos 攻击 (e1c8023, Zhang Dongliang) modify commonalert init policy : (c446862, zhaoxiangchun) bugfix: (5b4e57f, zhaoxiangchun) make mod (8afc21f, wanyaoqi) telegraf add disk plugin (face8be, wanyaoqi) set image default policy to if not present (96aaea7, Zexi Li)   onecloud-service-operator Repository: https://github.com/yunionio/onecloud-service-operator\n1 commits to onecloud-service-operator - v3.4.4 since this release.\nFeatures (1)  keep cloudresource when resource in k8s is invalid (68a1e48, rainzm)  ","excerpt":"Release time: 2020-10-28 18:20:55\n onecloud Repository: …","ref":"/v3.6/en/docs/changelog/release-3.4/3-4-4/","title":"v3.4.4"},{"body":"发布时间 2020-10-28 18:20:55\n onecloud 仓库地址: https://github.com/yunionio/onecloud\n70 commits to onecloud - v3.4.4 since this release.\nBug Fixes (29)  cancel pending-delete should increase resource quota usages (2a1a640f6, Qiu Jian) missing authenticate action log for user web login (ecbe76e9f, Qiu Jian) add rds cpu and memory usage (16d13941c, Qu Xuan) set secgroup status (44046f286, Qu Xuan) avoid sync project panic (95f7600b6, Qu Xuan) use correct worker (062301f54, Qu Xuan) avoid delete public ip when sync eip list (a851e0133, Qu Xuan) server usage status not correct (90d649aef, Qiu Jian) do not lock guest after lock eip, to prevent possible dead lock (d774581a2, Qiu Jian) remote update metadata may cause metadata update loop (62f5355b1, Qiu Jian) don’t update NextSyncTime when snapshots that should be added has not (0ba8cb7fb, rainzm) reduce change config logs (9b8758e19, Qiu Jian) 新增google存储类型 (f77bcd3bb, Qu Xuan) 避免冲掉设置的到期释放时间 (8f3cb9cdb, Qu Xuan) add aliyun new region (22349276d, Qu Xuan) missing authenticate action log for user web login (a92a0e2d0, Qiu Jian) monitor commonalert not detach alert resource (d99d93d04, Zexi Li) sync dns records after sync vpcs (11f8e4f71, Qu Xuan) compute: filter cachedimage with health storage (2a1bbfd57, rainzm) esxi: no callback in uploadHandler (57dad6281, rainzm) esxi: use correct device index (d3964bf0d, rainzm) esxi: resize root disk after cloning vm (8f3b8c7ff, rainzm) esxi: filter vmdk item in lease.info (d31802c87, rainzm) glance: allow public and private operations of guestimage (3fae388db, rainzm) notify: add AllOkContactTypes in where permanently enabled and verified ContactType (f367f1abe, rainzm) region: compute binded disk count when deleting snapshotpolicy (6f1417d26, rainzm) region: roll back the optimization of cachedimage list (be5a6a93c, rainzm) region: add suffix ‘display’ for time_points and repeat_weekdays (bbfb9db90, rainzm) region: init NextSyncTimeiwhen create snapshotpolicydisks (93bb4022f, rainzm)  Bugfix (2)  commonalert (8a0eeb7d6, zhaoxiangchun) qcloud pull metric (06db7339e, zhaoxiangchun)  Cloudcommon (3)  db: GET: i18n for result of get property calls (5d0fd14cb, Yousong Zhou) db: add man.GetI18N (cd123e007, Yousong Zhou) db: modelbase: distinct-field: readability change (91736710b, Yousong Zhou)  Code Refactoring (3)  find the most suitable storage (7a2c2b804, rainzm) region: faster list for cachedimage (c45658686, rainzm) region: faster list for cachedimage (b0823a09b, rainzm)  Feature (2)  remote update qcloud instance metadata and name (a764a6469, Qiu Jian) qcloud create VM with tags (f05a56aad, Qiu Jian)  Features (10)  use details data to cover obj data in FetchCustomizeColumns (37c14d756, rainzm) add a retry mechanism to AutoSyncExtDiskSnapshot (93ac3260a, rainzm) add valid filter for cachedimage list (d454b0a79, rainzm) add NotifyWebhook in notifyclient (0fd6481e4, rainzm) support lock storage from selected cachedimage (5a7876ae4, rainzm) esxiagent: try to customize vm if deployfs failed (a35a6f3c1, rainzm) notify: add IntelliNotify (5306add70, rainzm) notify: allow empty receivers for robot or webhook contact type (d799a71fd, rainzm) notify: support webhook contact type (436f1e5cb, rainzm) region: call NotifyWebhook in the life cycle of guests (9dee4c1b9, rainzm)  Host (1)  fix sync storage info duration' (7a9b491d1, wanyaoqi)  Lockman (1)  test: add prefix setting (f7f7c7be8, Yousong Zhou)  Logger (2)  actionlog: i18n for distinct-field (0964c6ad8, Yousong Zhou) actionlog: readability change (c2589e735, Yousong Zhou)  Monitor (2)  set default influxdb datasource by endpoint type (b43f8b3fa, Zexi Li) add alert resource (af11737e7, Zexi Li)  Others (15)  commalertUpdateInput increat param: (002a2af27, zhaoxiangchun) fix on stream disk complete snapshots refcount not update (8e5b74a3f, wanyaoqi) check disk is in reset before delete snapshot (d78068d43, wanyaoqi) bugfix: (e7674116e, zhaoxiangchun) host increase cpu mem max size (a4b1d3952, wanyaoqi) fix:get all project dns resource (66c81ee54, lvyangyang) fix informer backend (d6a9b5dac, wanyaoqi) fix fetch customize columns (f706d59ac, wanyaoqi) lbcert delete bugfix (7da0a67af, TangBin) remove try set informer backend (15bd6bacd, wanyaoqi) telegraf-raid-plugin: update raid state to lower case (6706c39f8, wanyaoqi) keystone init etcd backend (8ce183eaf, wanyaoqi) .circleci: build: make with parallel level 2 (3aadaf15b, Yousong Zhou) add aliyun finance environment (a9c44ed30, TangBin) telegraf raid plugin (8b2680ed5, wanyaoqi)   notify-plugins 仓库地址: https://github.com/yunionio/notify-plugins\n4 commits to notify-plugins - v3.4.4 since this release.\nDocker_push (1)  amd64 just use build_process (d4bbb03, Zexi Li)  Features (2)  add webhook robot(custom robot) (06bde6a, rainzm) support multi webhooks config for robot (52669eb, rainzm)  Others (1)  增加调试开关 (ab97c2e, Zhang Dongliang)   onecloud-operator 仓库地址: https://github.com/yunionio/onecloud-operator\n9 commits to onecloud-operator - v3.4.4 since this release.\nFeatures (1)  add webhook plugin for notify (e8cedb1, rainzm)  Monitor (2)  alert for host_raid adapter should \u003e= 0 (dc52030, Zexi Li) inject smart_device and host_raid alert rule (fee4e8a, Zexi Li)  Others (6)  更新 nginx 配置以防 dos 攻击 (e1c8023, Zhang Dongliang) modify commonalert init policy : (c446862, zhaoxiangchun) bugfix: (5b4e57f, zhaoxiangchun) make mod (8afc21f, wanyaoqi) telegraf add disk plugin (face8be, wanyaoqi) set image default policy to if not present (96aaea7, Zexi Li)   onecloud-service-operator 仓库地址: https://github.com/yunionio/onecloud-service-operator\n1 commits to onecloud-service-operator - v3.4.4 since this release.\nFeatures (1)  keep cloudresource when resource in k8s is invalid (68a1e48, rainzm)  ","excerpt":"发布时间 2020-10-28 18:20:55\n onecloud 仓库地址: …","ref":"/v3.6/zh/docs/changelog/release-3.4/3-4-4/","title":"v3.4.4"},{"body":"Release time: 2020-10-16 17:58:13\n onecloud Repository: https://github.com/yunionio/onecloud\n8 commits to onecloud - v3.4.3 since this release.\nBug Fixes (4)  hostname for instance (950a2c29f, Qu Xuan) get images distinct field (d298c7544, Zexi Li) resolve with_meta filter conflict (9c9cb17d3, Qiu Jian) 避免并发同步安全组导致规则混乱 (4b2d67de4, Qu Xuan)  Feature (1)  filter storages by image (45e092bd2, Qiu Jian)  Features (1)  esxi: do not specify portkey in NewVNIC (cc96c01c0, rainzm)  Others (1)  remove alpine build cache before make image (28cb75f41, Zhang Dongliang)  Stringutils2 (1)  add RemoveUtf8Strings func (64593fc88, Zexi Li)  ","excerpt":"Release time: 2020-10-16 17:58:13\n onecloud Repository: …","ref":"/v3.6/en/docs/changelog/release-3.4/3-4-3/","title":"v3.4.3"},{"body":"发布时间 2020-10-16 17:58:13\n onecloud 仓库地址: https://github.com/yunionio/onecloud\n8 commits to onecloud - v3.4.3 since this release.\nBug Fixes (4)  hostname for instance (950a2c29f, Qu Xuan) get images distinct field (d298c7544, Zexi Li) resolve with_meta filter conflict (9c9cb17d3, Qiu Jian) 避免并发同步安全组导致规则混乱 (4b2d67de4, Qu Xuan)  Feature (1)  filter storages by image (45e092bd2, Qiu Jian)  Features (1)  esxi: do not specify portkey in NewVNIC (cc96c01c0, rainzm)  Others (1)  remove alpine build cache before make image (28cb75f41, Zhang Dongliang)  Stringutils2 (1)  add RemoveUtf8Strings func (64593fc88, Zexi Li)  ","excerpt":"发布时间 2020-10-16 17:58:13\n onecloud 仓库地址: …","ref":"/v3.6/zh/docs/changelog/release-3.4/3-4-3/","title":"v3.4.3"},{"body":"Release time: 2020-10-15 20:07:38\n onecloud Repository: https://github.com/yunionio/onecloud\n12 commits to onecloud - v3.4.2 since this release.\nBug Fixes (8)  allwo filter resource by with-meta and with-user-meta filter (ff2b7eb34, Qiu Jian) support filter rds sku by provider (7b5d82237, Qu Xuan) filter project role with system=true (8042b9430, Qiu Jian) filter role assignments by project domains id or name (d1cbaead0, Qiu Jian) use new api (1768d1e7d, Qu Xuan) support fake tempalte when searching template vm (c7d6bb781, Rain) 优化安全组规则同步 (d2d2934e8, Qu Xuan) esxiagent: check whether regexp is nil (2076a7511, rainzm)  Features (3)  add ‘vlan_id’ param when creating network (ff34e9386, rainzm) change templateid as / in esxi (a891d1d87, rainzm) esxiagent: keep data disks when cloning vm (5d0d6d960, rainzm)  Others (1)  fix:openstack lb 后端ip无法映射到主机的异常处理 (cf89e8a23, lvyangyang)  ","excerpt":"Release time: 2020-10-15 20:07:38\n onecloud Repository: …","ref":"/v3.6/en/docs/changelog/release-3.4/3-4-2/","title":"v3.4.2"},{"body":"发布时间 2020-10-15 20:07:38\n onecloud 仓库地址: https://github.com/yunionio/onecloud\n12 commits to onecloud - v3.4.2 since this release.\nBug Fixes (8)  allwo filter resource by with-meta and with-user-meta filter (ff2b7eb34, Qiu Jian) support filter rds sku by provider (7b5d82237, Qu Xuan) filter project role with system=true (8042b9430, Qiu Jian) filter role assignments by project domains id or name (d1cbaead0, Qiu Jian) use new api (1768d1e7d, Qu Xuan) support fake tempalte when searching template vm (c7d6bb781, Rain) 优化安全组规则同步 (d2d2934e8, Qu Xuan) esxiagent: check whether regexp is nil (2076a7511, rainzm)  Features (3)  add ‘vlan_id’ param when creating network (ff34e9386, rainzm) change templateid as / in esxi (a891d1d87, rainzm) esxiagent: keep data disks when cloning vm (5d0d6d960, rainzm)  Others (1)  fix:openstack lb 后端ip无法映射到主机的异常处理 (cf89e8a23, lvyangyang)  ","excerpt":"发布时间 2020-10-15 20:07:38\n onecloud 仓库地址: …","ref":"/v3.6/zh/docs/changelog/release-3.4/3-4-2/","title":"v3.4.2"},{"body":"Release time: 2020-10-14 18:03:02\n onecloud Repository: https://github.com/yunionio/onecloud\n48 commits to onecloud - v3.4.1 since this release.\nBaremetal (1)  fix pxe filter network by guest_dhcp (d0d3d8e33, Zexi Li)  Bug Fixes (22)  qcloud set hostname for instance (5b79ba560, Qu Xuan) support public ip create (2a210407a, Qu Xuan) 支持带宽包用户 (84e8e4e6c, Qu Xuan) trans google new region name (3fe15d267, Qu Xuan) qcloud eip with bandwidth attr (d574a823b, Qu Xuan) avoid qcloud secgroup cache name not sync (e8d737ff6, Qu Xuan) server name auto index should start from 1 (7ce0d7b44, Qiu Jian) qcloud instance with max bandwidth (715db28e3, Qu Xuan) format errors that block make test (152ea54f3, Qiu Jian) project_id in resource details not correct (d2aacafa4, Qiu Jian) ldap sync not update user’s phone and email (1aa82ae95, Qiu Jian) not clean pending domain usage (488e7e56a, Qiu Jian) validate secgroup purge condition (9fbd4f059, Qu Xuan) avoid slice out of bounds (078b1d635, rainzm) filter cached images with host schedtag (49887e540, Qiu Jian) sync huawei bucket project info (cb36572c1, Qu Xuan) error code of external bucket not found error should be 404 (76f794d1a, Qiu Jian) esxi: check whether some fields of vm are nil (27bd564d2, rainzm) esxi: check nil value when NewVirtualMachine (1bc4b3cb9, rainzm) esxi: filter linkLocalAddress (b8e0599e3, rainzm) esxi: search template from whole vCenter (2259fe119, rainzm) esxi: use system disk of template only when cloning vm (d16affc9a, rainzm)  Eip (2)  NewEipForVMOnHost: add opslog (896bec8f4, Yousong Zhou) construct a pointer type (a8426482b, Yousong Zhou)  Feature (1)  qcloud create VM with tags (ef9b64990, Qiu Jian)  Features (5)  add vlanId for suggested network (7edcd151e, rainzm) filter esxi ip by CIDR (552ce3b2e, rainzm) add ‘ip-list’ for esxicli (8528d7981, rainzm) esxi: support fake template vm via regex filter (df90d99bc, rainzm) region: make address recommendations more precise (91c852676, rainzm)  Hotfix (1)    allow merge networks without continuous addresses 2. filter guest_ip_start and guest_ip_end with contains operator (adccad348, Qiu Jian)    Others (13)  replace NewFloat by NewFloat64 and NewFloat32 (f19fe2178, wanyaoqi) make mode (2265c9422, wanyaoqi) fix:aliyun jsonRequest 增加i/o timeout retry (d72081770, lvyangyang) fix host-deployer base image (407251975, wanyaoqi) 在 docker push 脚本里创建_output 目录，以便容错 (b7fd879e4, Zhang Dongliang) 在 docker push 脚本里创建_output 目录，以便容错 (7efb85ba0, Zhang Dongliang) resolve conflict (d7316b26a, Zhang Dongliang) genreate api models (dee1aa26d, wanyaoqi) add interface freeze virtual resource (c973bf163, wanyaoqi) Add web url to alarm template (58d52d947, zhaoxiangchun) bugfix:scoperesource FilterByOwner (c5ef564d3, zhaoxiangchun) remove aws lbbg cache metedata (e82cf184f, TangBin) modify suggest rule cli (bba2cf23f, zhaoxiangchun)  Vpcagent (1)  ovn: increase dhcp lease, renew, rebind time (e9415ae49, Yousong Zhou)  Webconsole (2)  ssh: add keyboard-interactive as an option (63b0d0c07, Yousong Zhou) ssh: each argument on its own line (39a45229a, Yousong Zhou)   onecloud-operator Repository: https://github.com/yunionio/onecloud-operator\n2 commits to onecloud-operator - v3.4.1 since this release.\nOthers (1)  not create notice (a834a78, Zexi Li)  Regiondns (1)  configmap: quash trailing spaces (746963f, Yousong Zhou)  ","excerpt":"Release time: 2020-10-14 18:03:02\n onecloud Repository: …","ref":"/v3.6/en/docs/changelog/release-3.4/3-4-1/","title":"v3.4.1"},{"body":"发布时间 2020-10-14 18:03:02\n onecloud 仓库地址: https://github.com/yunionio/onecloud\n48 commits to onecloud - v3.4.1 since this release.\nBaremetal (1)  fix pxe filter network by guest_dhcp (d0d3d8e33, Zexi Li)  Bug Fixes (22)  qcloud set hostname for instance (5b79ba560, Qu Xuan) support public ip create (2a210407a, Qu Xuan) 支持带宽包用户 (84e8e4e6c, Qu Xuan) trans google new region name (3fe15d267, Qu Xuan) qcloud eip with bandwidth attr (d574a823b, Qu Xuan) avoid qcloud secgroup cache name not sync (e8d737ff6, Qu Xuan) server name auto index should start from 1 (7ce0d7b44, Qiu Jian) qcloud instance with max bandwidth (715db28e3, Qu Xuan) format errors that block make test (152ea54f3, Qiu Jian) project_id in resource details not correct (d2aacafa4, Qiu Jian) ldap sync not update user’s phone and email (1aa82ae95, Qiu Jian) not clean pending domain usage (488e7e56a, Qiu Jian) validate secgroup purge condition (9fbd4f059, Qu Xuan) avoid slice out of bounds (078b1d635, rainzm) filter cached images with host schedtag (49887e540, Qiu Jian) sync huawei bucket project info (cb36572c1, Qu Xuan) error code of external bucket not found error should be 404 (76f794d1a, Qiu Jian) esxi: check whether some fields of vm are nil (27bd564d2, rainzm) esxi: check nil value when NewVirtualMachine (1bc4b3cb9, rainzm) esxi: filter linkLocalAddress (b8e0599e3, rainzm) esxi: search template from whole vCenter (2259fe119, rainzm) esxi: use system disk of template only when cloning vm (d16affc9a, rainzm)  Eip (2)  NewEipForVMOnHost: add opslog (896bec8f4, Yousong Zhou) construct a pointer type (a8426482b, Yousong Zhou)  Feature (1)  qcloud create VM with tags (ef9b64990, Qiu Jian)  Features (5)  add vlanId for suggested network (7edcd151e, rainzm) filter esxi ip by CIDR (552ce3b2e, rainzm) add ‘ip-list’ for esxicli (8528d7981, rainzm) esxi: support fake template vm via regex filter (df90d99bc, rainzm) region: make address recommendations more precise (91c852676, rainzm)  Hotfix (1)    allow merge networks without continuous addresses 2. filter guest_ip_start and guest_ip_end with contains operator (adccad348, Qiu Jian)    Others (13)  replace NewFloat by NewFloat64 and NewFloat32 (f19fe2178, wanyaoqi) make mode (2265c9422, wanyaoqi) fix:aliyun jsonRequest 增加i/o timeout retry (d72081770, lvyangyang) fix host-deployer base image (407251975, wanyaoqi) 在 docker push 脚本里创建_output 目录，以便容错 (b7fd879e4, Zhang Dongliang) 在 docker push 脚本里创建_output 目录，以便容错 (7efb85ba0, Zhang Dongliang) resolve conflict (d7316b26a, Zhang Dongliang) genreate api models (dee1aa26d, wanyaoqi) add interface freeze virtual resource (c973bf163, wanyaoqi) Add web url to alarm template (58d52d947, zhaoxiangchun) bugfix:scoperesource FilterByOwner (c5ef564d3, zhaoxiangchun) remove aws lbbg cache metedata (e82cf184f, TangBin) modify suggest rule cli (bba2cf23f, zhaoxiangchun)  Vpcagent (1)  ovn: increase dhcp lease, renew, rebind time (e9415ae49, Yousong Zhou)  Webconsole (2)  ssh: add keyboard-interactive as an option (63b0d0c07, Yousong Zhou) ssh: each argument on its own line (39a45229a, Yousong Zhou)   onecloud-operator 仓库地址: https://github.com/yunionio/onecloud-operator\n2 commits to onecloud-operator - v3.4.1 since this release.\nOthers (1)  not create notice (a834a78, Zexi Li)  Regiondns (1)  configmap: quash trailing spaces (746963f, Yousong Zhou)  ","excerpt":"发布时间 2020-10-14 18:03:02\n onecloud 仓库地址: …","ref":"/v3.6/zh/docs/changelog/release-3.4/3-4-1/","title":"v3.4.1"},{"body":"Release time: 2020-09-30 16:43:35\n onecloud Repository: https://github.com/yunionio/onecloud\n607 commits to onecloud - v3.4.0 since this release.\nAdd (3)  openstack loadbalancer (#7497) (eb56fcf7b, lvyangyang) region/sync openstack routetables (eac0a797b, lvyangyang) region/openstack 迁移接入 (41a4188bb, lvyangyang)  Ansibleserver (1)  register metadata manager (1ae8c9786, Yousong Zhou)  Appsrv (1)  quash low-value debug log lines (7a3f24145, Yousong Zhou)  Baremetal (2)  fix hpssactl split last LV size out of limit (#7426) (b1603153e, Zexi Li) set zone when enable netif (c27433103, Zexi Li)  Bug Fixes (279)  允许域管理员可以看到共享的dns zone cache列表 (02bcce195, Qu Xuan) emulated wire not sync vpc shared info (5c4423bcb, Qiu Jian) oidc response user’s info (8cdab93c1, Qiu Jian) revert filter-by-owner changes of scoped resource (8a28d2627, Qiu Jian) allow domain admin view shared dns zone records (b0e1d0de2, Qu Xuan) avoid sync dns zone cache status is init (f931deb41, Qu Xuan) filter storages by host schedtag (11ea89795, Qiu Jian) 避免azure同步项目失败 (1021bf151, Qu Xuan) suffix template cache key (ad2248311, rainzm) filter cloudprovider/network by host-schedtag-id (82c0dcfb3, Qiu Jian) dns zone cache owner info (da8529a00, Qu Xuan) allow create disk prefer manager (73aee1147, Qu Xuan) simplify forbidden user login message (91f098430, Qiu Jian) 支持同步project标签到本地资源 (4794b1606, Qu Xuan) avoid purge storages (f5cf093e0, Qu Xuan) openstack zone not emulated (3903af786, ioito) allow cross doamin resource sync (91cac5c21, ioito) avoid account delete failed (5f50314df, ioito) sql err (310baa266, ioito) avoid compare err with cloudprovider.ErrNotFound direct (5f2c771f7, ioito) dns 错误信息补全 (8d28bfc6d, lvyangyang) google资源名称兼容处理 (26a3df33b, Qu Xuan) avoid serial vm creation (b5088230b, ioito) 仅在可用区故障时可强制挂载磁盘 (4038bfb8a, ioito) scope resource filter by owner (975e7fb1e, Qiu Jian) use i18n.Table to handle Chinese-English conversion (1c786a034, rainzm) keystone project resource count not accurate (95bde0a14, Qiu Jian) sort quota list result by usage rate (f3fa6f82b, Qiu Jian) disable domain sharing if non_default_domain_projects turned off (e796437a3, Qiu Jian) Error occurs when suitableWire exists or all suitableNetwork exist. (5f1cd20aa, rainzm) avoid account delete failed (c38cb271f, ioito) error 值重叠 (9a04238b7, lvyangyang) 避免同步不到其他域的云账号 (0a87b3101, Qu Xuan) role assignment filter by users not working for effective users in groups (b32eddce0, Qiu Jian) 避免腾讯云同步虚拟机ip异常 (f659ccd0d, ioito) apigateway userinfo includes project metadata (5b6b5eeb7, Qiu Jian) 避免添加新账号后长时间未同步iam用户 (b3c235fe3, ioito) 优化提取显示主账号名 (686df64ea, ioito) avoid not reture cloudprovider.ErrNotFound error (bb3317cc3, Qu Xuan) scheduler token not support policy (e444ab7a1, Qiu Jian) reset user password without check (5f35bba0d, Qiu Jian) get jnlp xml from dell idrac6,7,9 (760ac9900, Qiu Jian) reduce totp verification overhead (49cf94abb, Qiu Jian) add esxicli vmrc/webmks command (5f9088d24, Qiu Jian) disable qcloud verifyAppId temporarily (7601ca437, Qiu Jian) keystone initialize data skip nil extra fields (967d46bbf, Qiu Jian) omit empty fail reason (a475a7b41, Qiu Jian) enable generate name caused compability issue (0d798412e, Qiu Jian) 避免名称重复 (a1ba06a92, Qu Xuan) bucket object cnt fix (cc5e0cd7c, Qu Xuan) lock/unlock cleanup (ada735246, Qiu Jian) 支持自动根据云上项目修改本地项目名称 (5c71349fe, Qu Xuan) 修复权限组权限同步异常问题 (24cbdf673, Qu Xuan) cos use proxy (0a5ee4ca6, Qu Xuan) check host sharing status when considering whether a host is assignable (6b5339900, Qiu Jian) disable webkms for esxi older than 6.5 (7cf5ad913, Qiu Jian) 默认不自动合并安全组 (ce777855a, Qu Xuan) avoid sync natgateway eip panic (960742029, Qu Xuan) 优化sku同步逻辑 (ea518358c, Qu Xuan) add dns recordset dns value check (2e93ee3d6, Qu Xuan) 平滑迁移数据 (d6d490af6, Qu Xuan) 腾讯云不支持同时设置秘钥和密码,若设置秘钥，则将密码置空 (5576819f0, Qu Xuan) optimized qcloud keypair (dc20313ef, Qu Xuan) 修复cloudid问题 (642af06ba, Qu Xuan) optimzed clouduser password (aa26c6ec9, Qu Xuan) 避免未本地缓存usercache (835261e9e, Qu Xuan) capability for cloudid (0b4a562f0, Qu Xuan) optimzed clouduser (9281c5429, Qu Xuan) avoid create public zone failed (2ad1a4afe, Qu Xuan) recode project-role rpc handle to support group role assignment results by user or project (0268d9585, Qiu Jian) uniform cachedimage active status (025eca548, Qu Xuan) wire usage stats incorrect (621c2796d, Qiu Jian) ignore 409 error when doing redfish power on (d10adf22d, Qiu Jian) validate candiate ip for sync-fix-nics (f739c8ff0, Qiu Jian) Override Master and Slave for scalinggroup_guest (ba2b1d9bd, rainzm) manager_id资源隔离获取 (9bb4eb5d4, Qu Xuan) prevent users in disabled idp from login (e758c4aa9, Qiu Jian) check assign-host previliges (623c71b14, Qiu Jian) sync groups for user (4cd73c16c, Qu Xuan) aliyun wulanchabu region (0a79d1d23, Qu Xuan) 取消aliyun lb scheduler创建限制 (933dddd8a, Qu Xuan) 修复cloudid同步问题 (88e5119fd, Qu Xuan) user idps attributes includes template name (bfa4ce38e, Qiu Jian) skup syncing lb, rds, redis instances in tasks (c5c2b4b69, Qiu Jian) network address list respect privilige of user (29edf8329, Qiu Jian) cloudid optimized (390d6f07e, Qu Xuan) valid update name and update dns recordset (b4252c7c2, Qu Xuan) scheduler aware policy (485388394, Qiu Jian) support VirtualDiskRawDiskMappingVer1BackingInfo (0619da6f1, Qiu Jian) find correct esxi host access ip (29a3db9ff, Qiu Jian) remove redundant auth cookie in sso login (c50497090, Qiu Jian) 公有云子账号加域属性 (02bf5b76d, Qu Xuan) 优化安全组list速度，并发挥rule规则信息 (8279f62c9, Qu Xuan) clouduser can_delete always be false (91a5e4ab7, Qu Xuan) 同步不需要判断账号是否有iam权限 (2c17e6e66, Qu Xuan) optimzed sync (5cc25ae10, Qu Xuan) optimized cloudid (cfd76b23a, Qu Xuan) search by chs projectname or domainname (976dbd779, Qiu Jian) 避免slave zoneid异常 (cac7dc529, Qu Xuan) compatiblity fixes with lenovo RD620 and huawei 2288 (949e2ebed, Qiu Jian) avoid nil panic (03456eaaa, Qu Xuan) avoid policy value not save (d03fddcd7, Qu Xuan) climc params (893085a2c, Qu Xuan) add details for account delete (#7703) (800dd26c6, 屈轩) vmware esxi host detects vnic portgroup info (#7660) (836151eee, Jian Qiu) apigateway user info add is_local attribtue (#7695) (0566e1dec, Jian Qiu) server purge may fail (#7698) (cca226738, Jian Qiu) http error limit request body length fix: http error limit request body length (#7700) (538bc873a, Jian Qiu) 不限制openstack系统盘类型 (#7675) (9812864bc, 屈轩) cleanup logic for nics of pending_deleted guests (#7669) (5647a6842, Jian Qiu) avoid delete aws iam user failed (6ed3a4833, Qu Xuan) aovid truncated data (#7644) (3243e5a03, 屈轩) add keystone sync user debug info (#7639) (e3fe66e8e, Jian Qiu) turn off some default project policies (#7637) (de80f1705, Jian Qiu) avoid openstack image-list failed (#7641) (aef249ea8, 屈轩) project role rpc returns policies info (#7632) (5b2b40d6c, Jian Qiu) add keystone sync user debug info (ccf55963a, Qiu Jian) make old notify send SDK compatible (#7628) (707051ec0, Rain Zheng) avoid network-list –zone not work (#7619) (4593c1fb9, 屈轩) ignore invalid zone sku for rds sku sync (#7617) (ca2e8bece, 屈轩) oauth2 not support default_project_id and default_role_id (#7622) (fea4a6b07, Jian Qiu) idp deletel logic cleanup (#7616) (852a3bb13, Jian Qiu) hide locked cloud policy by default (#7614) (7c3fa87ed, Jian Qiu) GetDefaultClient always return a new http client instance (3762df808, Qiu Jian) avoid change user name for google (#7613) (c1a6b2db9, 屈轩) limit the length of error message when do idp redirect (#7612) (a94f32ed5, Jian Qiu) avoid storage=nil, dis can not delete (#7608) (4555b00c3, 屈轩) apigateway option to turn off login domain list (fe0182333, Qiu Jian) optimized for cloudid (#7604) (5b898bbf6, 屈轩) opslog filter by owner_project_ids and owner_domain_ids (#7600) (777059648, Jian Qiu)   remove Azure OIDC extra user scope 2. yunionauth cookie missing (#7599) (7bab39daf, Jian Qiu)   member user only can get user \u0026 domain resource (#7597) (a23a94714, 屈轩) option for metadata path (#7595) (e70fe59bc, 屈轩) 修复cloudid用户同步及权限同步 (8a78c54dc, Qu Xuan) dns record create ignore is_public field (016b65a4b, Qiu Jian) 支持自定义权限 (#7565) (d5524d1ea, 屈轩) GetIImages correctly without ‘image_cache’ dir (#7575) (0ab75b52d, Rain Zheng) allow delete shared role and policy (4a0439da8, Qiu Jian) aovid duplicate sku name (#7572) (196d3b360, 屈轩) cloud poilcy count (d2b9ba5bc, Qu Xuan) json TAG_PREFIX invalid syntax (#7564) (6a57435f1, Zexi Li) avoid virtual resource project id is empty when cloudaccount with no project (#7560) (7cd419f78, 屈轩) Merge the host network correctly when preparenet (#7557) (098b4e5b5, Rain Zheng) network port count stat recode (#7554) (b89845584, Jian Qiu) user with sso idp fail to login with password (#7552) (320d7cabc, Jian Qiu) oidc auth callback url not complete (#7545) (a02611db1, Jian Qiu) recode user project role list to include group info (#7544) (59c026f0d, Jian Qiu) change publicNetworkCount to autoAllocNetworkCount in Capability (#7546) (e1bd01162, Jian Qiu) separete enabled and status field (5b31ca8da, Qu Xuan) update vendor (#7526) (c277d492f, Jian Qiu) optimized huawei security group get and create operation (#7520) (930ca23ea, 屈轩) compatible for macOS (a6bff9498, Qu Xuan) 修复安全组合并导致重复计算虚拟机绑定安全组数量\u0026优化安全组操作 (#7496) (f343b071f, 屈轩) avoid nil pointer (#7508) (4696a3e47, 屈轩) password authentication may choose wrong idp backend (#7513) (c98e72e6e, Jian Qiu) preserve state while doing sso redirect (60eec6440, Qiu Jian) 提高zstack认证兼容性 (0850bd516, Qu Xuan) 隐藏auzre经典类型存储 (629a4e93d, Qu Xuan) 增加openstack兼容性 (#7492) (327b60baf, 屈轩) do not search response key if empty json returned (#7495) (c63230f37, Jian Qiu) idp validate config not complete (#7488) (19b69de1d, Jian Qiu) support AzureAD oidc in china area (12bbbc541, Qiu Jian) capabilities get auto alloc network count (#7483) (d4a93f0dc, Jian Qiu) unlink-user illegal mix of collations (#7482) (0a580b3c9, Jian Qiu) filter public network count by zone and region (#7477) (04eaf3de6, Jian Qiu) typo running_geusts =\u003e running_guests (eae229b35, Qiu Jian) typo (9da8095f8, Qu Xuan) ignore bucket-set-acl not implemented error (#7470) (1929076fa, Jian Qiu) avoid host globalid change (#7465) (a51f0271e, 屈轩) avoid generated codes having duplicate PerformSetScope methods (9bdf2c75e, Qiu Jian) 避免azure同步资源组异常 (be51f3b49, Qu Xuan) sync share mode between vpc and wire (9ea80725a, Qiu Jian) upgrade aliyun sdk (#7432) (27168fc72, 屈轩) 避免glance metadata-list project scope无权限 (#7402) (1244c170b, 屈轩) 优化openstack项目认证 (#7397) (fd2f1c0e3, 屈轩) 避免在仅调整虚拟机磁盘时opslog日志记录mem cpu异常 (#7392) (0cad2efd2, 屈轩) avoid lost backend params (846f90d54, Qu Xuan) openstack win image user data need encode (781618023, Qu Xuan) avoid account sync deadlock (509ebb92c, Qu Xuan) ignore general s3 set acl not implemented error (7f829f24f, Qiu Jian) cloud account sync may block (1985aab89, Qiu Jian) openstack多项目问题 (859ab9717, Qu Xuan) avoid parse json err nil pointer (598e8a924, Qu Xuan) avoid nil pointer (6477e0e14, Qu Xuan) adjust API input field names according to spec (#7382) (f0f406c24, Jian Qiu) use json to store task error message (#7351) (ba292dfed, Jian Qiu) 添加阿里云rds备份恢复限制条件 (#7378) (3df146ff6, 屈轩) change owner should check required domain list (#7375) (984bfeb6e, Jian Qiu) 普通视图下，安全组仅统计可看到的vm count (#7358) (76f78cdda, 屈轩) 同步sku与磁盘类型关系 (#7368) (d8f046365, 屈轩) 避免创建rds备份时对rds进行一些操作 (#7354) (78a68bffd, 屈轩) 修复vm绑定重复安全组 (8c31bba0a, Qu Xuan) add default perform allow policy to sysadmin (757706db9, Qiu Jian) cleanup auth error message return by apigateway (f1bfcfbd9, Qiu Jian) 避免status_code\u003e=400并且resp为空时err为nil (#7264) (a67f3e548, 屈轩) cloud account delete may fail due to inconsistent status (9f8f2b6c4, Qiu Jian) do accessibility check when dissociate eip from resource (845195440, Qiu Jian) modify list details for guesttemplate (34e66ab2e, rainzm) schedtag should be system resource (8f1b93472, Qiu Jian) choose candidate list from the list returned from backend (35da086cc, Qiu Jian) 单独添加更新账单文件日志 (c6df1944c, Qu Xuan) 支持多项目安全组规则过滤 (b20cd1364, Qu Xuan) domain resource domain share to system when non_default_domain_projects off (8d8acab90, Qiu Jian) update auto generate model api (208b69573, Qiu Jian) 避免未能导出共享安全组规则 (9a329453a, Qu Xuan) image upload not clean pending usage (587f533da, Qiu Jian) quota usage not updated after disk resizing (ce3d0906b, Qiu Jian) google rds regional and zonal (718e36b32, Qu Xuan) rds备份恢复优化 (8d85f04d8, Qu Xuan) default vpc must be shared globally (d3741d9a4, rainzm) globalvpc跟随云账号共享 (3bf9b5b0d, Qu Xuan) 过滤可用eip (ecaa1ad45, Qu Xuan) 避免乌兰察布区域拉取资源异常 (8bd23cf3d, Qu Xuan) prefetch image error when create guest with vmware template (2f1093a14, rainzm) not work for network-list –zones (bf65a8816, Qu Xuan) sec rule export missing fields (3ddcaad3c, Qu Xuan) check azure image format when rebuild root (466a3f728, Qu Xuan) 避免华为云安全组规则删除失败 (cc948a4d5, Qu Xuan) clouduser’s cloudgroups info (769dcae0e, Qu Xuan) 添加secgroup rule过滤参数 (6b591b455, Qu Xuan) 修复cloudid get权限问题 (34aa55114, Qu Xuan) azure 支持权限 (4cd67270a, Qu Xuan) 修复cloudid用户列表权限问题 (dccf685f6, Qu Xuan) 优化webconsole代码\u0026bugfix (dee1283c0, Qu Xuan) 修复阿里云同步安全组规则异常问题 (367c59117, Qu Xuan) 优化减少对etcd组件依赖 (9003d3702, Qu Xuan) mo.VirtualMachine’s Config maybe nil (b6753af32, rainzm) 优化azure订阅创建 (3d9e8b872, Qu Xuan) 支持azure创建订阅 (16f93d665, Qu Xuan) 避免google clouduser同步权限异常 (169b13f16, Qu Xuan) 修复vpc同步异常问题 (d7e16e334, Qu Xuan) 避免越界访问 (45f5bc526, Qu Xuan) opslog show the owners operation logs only (d59bff336, Qiu Jian) remove default allow policy for storages (6af7c5923, Qiu Jian) cloudid 权限修复 (dc32fe42e, Qu Xuan) cloudid 异常修复 (4b0bfa734, Qu Xuan) 修复资源组云上同步异常问题 (b41eea1d8, Qu Xuan) 修复qcloud同步权限组异常问题 (bfc414530, Qu Xuan) 修复azure 项目同步问题 (cb1ad2cf0, Qu Xuan) 避免请求中国区iam异常 (c82f307e4, Qu Xuan) 修复腾讯云操作日志时间异常问题 (9507a7209, Qu Xuan) 修复elastic cache sku zone_id异常问题 (862b926aa, Qu Xuan) 分开统计安全组关联虚拟机数量 (3db15d59f, Qu Xuan) json request 支持自定义匹配err (5e50740b3, Qu Xuan) orderedstring add performance improvements (f0c3b9627, Qiu Jian) perform private on vpc will private all wires if no networks in wires (0005cf868, Qiu Jian) remove default host list policy (87dc4743d, Qiu Jian) init wire domain_id for local vpc (#7566) (cedfd6410, Jian Qiu) 避免cloudprovider同步缺失 (067b0ab76, Qu Xuan) 修正项目映射同步 (4b16fac0b, Qu Xuan) compute: return InputParameterError while ValidateCreateData (c050629ba, rainzm) esxi: return when host.Vm is empty (6bfca36cb, rainzm) esxi: Select correct unitNumber for ide control when creating disk (5975887d5, Rain Zheng) esxi: fetch templatevm from datacenter before clone vm (ac69f8a59, rainzm) esxi: Guarantee the uniqueness of the schedtag for esxi host (5460f2244, rainzm) esxiagent: add HostDelayTaskWorkerCount (4e7e8a59d, rainzm) esxiagent: return image extid not id (3ef91f92e, rainzm) notify: return correct value when sortContactType (d917e8e38, rainzm) notify: Replace String() with GetString() (8524fda7f, rainzm) notify: Set default priority ‘normal’ when creating notification (851b2d4bb, rainzm) notify: break down permissions of notifyconfigs (72276d038, rainzm) notify: Mark verified not enabled in MarkContactTypeVerified (ab02e166e, rainzm) notify: Allow user list receivers (82b7e659a, rainzm) notify: use AfterSend for contact with succuessful sending (9e1a7c5e1, rainzm) notify: clean verifyNote when mark verified (09bebcf5f, rainzm) notify: pull contact for workwx, dingtalk and feishu (dba92d4b0, rainzm) notify: modify name of notification to avoid duplication (043fdcfec, rainzm) notify: allow normal user create their receiver (aecf97780, rainzm) region: add RequestSyncstatusOnHost for SESXiGuestDriver (55b2b2900, rainzm) region: add GetSlaveFieldName for ScalingGroupGuest (35842df1b, rainzm) region: set ownerId as userCred when can’t FetchOwnerId (1215d723a, rainzm) region: Don’t allow address conflicts under vpc (47b9b91b8, rainzm) region: zone from guesttemplate’s preferzone maybe nil (#7387) (0deb908ac, Rain Zheng) region: split brand as ‘YunionCloud’ and ‘云联壹云’ when notify server event (471e2b4f1, rainzm) region: fetch correct ownerId in PerformPrepareNets (c7b8e84ff, rainzm) region: Remove default secgroup for esxi guest (68ba4361d, rainzm) scheduler: more standardized testing (348ca46a0, rainzm) scheduler: fix array out of bounds when sorting hosts (4f9c37239, rainzm) scheduler: filter InstanceGroup whose enabled is false (e6de7be7e, Rain)  Bugfix (1)  collect esxi metric timout (caa26b756, zhaoxiangchun)  Build (3)  ansibleserver: use native alpine, include openssh (28ad028d8, Yousong Zhou) use alpine-build:1.0-2 (e94d41558, Yousong Zhou) docker-centos-build: use centos-build:1.1-1 (e1e56eaa7, Yousong Zhou)  Capability (1)  public network count filter by default vpc (8dd25e01c, Zexi Li)  Climc (8)  add k8s fed resource sync action (37b9a2e53, Zexi Li) refactor k8s sub command (51020aac0, Zexi Li) add k8s federated resource cmd (02dc68f20, Zexi Li) k8s cluster grafana componet support subpath (7f5124bdf, Zexi Li) add cmd helper to reduce duplicate code (aa8177f53, Zexi Li) update k8s resource list options (cd25b4ac6, Zexi Li) refactor k8s resource (e5bd6f26d, Zexi Li) update k8s-release-create params (253dc22cf, Zexi Li)  Cloudcommon (11)  get joint model should aware fieldname (4164bf58c, Zexi Li) joint model list should add field_name into query (82e38b8f5, Zexi Li) remove query for fetchitem when not GET (#7551) (c672521ce, Zexi Li) remove unnecessary joint interface (#7524) (9af25a2aa, Zexi Li) taskman: fix table insert (de1e1b100, Yousong Zhou) tablespec: informer: use %#v to log bad obj (4fc35f92c, Yousong Zhou) taskman: SetModelManager (08cd41b60, Yousong Zhou) etcd: quash low-value debug log lines (2eeb45ded, Yousong Zhou) policy: fix interval and oneshot sync (29a3171a3, Yousong Zhou) tablespec: informer: log obj type (145c88f79, Yousong Zhou) app: cosmetic change (d9f3dfbbf, Yousong Zhou)  Cloudprovider (1)  remove redundant error log (ffcea2ae5, Yousong Zhou)  Code Refactoring (6)  esxi: replace GetTemplateVMById with FetchTemplateVMById (42faf34f1, rainzm) esxi: fetchVms and fetchHardwareInfo (ef8768fce, rainzm) notify: hide SSunContact webconsole (10caff1d9, rainzm) region: replace ‘ActualCapacity’ with ‘ActualCapacityUsed’ (e0c94daaf, rainzm) region: optimize preparenet of cloudaccount (3f77c01e6, rainzm) scheduler: make forcast result clearer (6000874b3, rainzm)  Db (1)  IModel: add GetI18N() method (62c0c11c3, Yousong Zhou)  Db_dispatcher (1)  pass query for fetchItem (c777793d9, Zexi Li)  Disk (1)  check disk is need renew on guest set renew (77f479ce6, wanyaoqi)  Dns (1)  isMyDomain: match only strict subdomain of dns_domain (7e191a503, Yousong Zhou)  Elasticips (3)  error when we have no usable eip network (59a5e9201, Yousong Zhou) fix calling FilterByOwner (430e9cd0f, Yousong Zhou) filter by owner when doing auto allocation (8a0f940b3, Yousong Zhou)  Feature (13)  add dns interface (a85a1aecd, Qu Xuan) use informer to update endpoint, policy and service configs (#7596) (34ee80f01, Jian Qiu) cloudid saml support phase1 – framework and api (92f05be30, Qiu Jian) do uniqueness check when create/update idp configs (#7584) (2b7586140, Jian Qiu) OpenID Connect provider support (#7490) (604b6b7ff, Jian Qiu) OpenID Connect provider support (#7446) (0e775e68e, Jian Qiu) add is_auto_alloc flag to networks (#7473) (1ba9715ec, Jian Qiu) unified sso login framework (096784389, Qiu Jian) project filter that list jointable projects for user or group (eb4a252d0, Qiu Jian) apigateway store auth state in cookie instead of sqlite (7ba3945d8, Qiu Jian) keystone add support for OpenID Connection idp (2183490a5, Qiu Jian)   idp as domain resource 2. keystone support SAML IDP (889a35bc7, Qiu Jian)   support SAML idp (3b7a1e946, Qiu Jian)  Features (28)  add NotifyError in notifyclient (cee07e786, rainzm) Add BatchSendMessage for feishu SDK (aa364a3d7, rainzm) add GetCapacityUsedMB for ICloudStorage (116d347c8, rainzm) Add method ‘Sku’ to CandidatePropertyGetter (d086161a6, rainzm) add WithCtx version to notifyclient function (8eba2c369, rainzm) add GetSchedtags for ICloudHost (0d05f9ee1, rainzm) log err when sending notification via notifyclient (2d5055c90, rainzm) inherit lang from ctx fro Task (8da2d5ff7, rainzm) Add IResultHelper (39fed764f, rainzm) notify user when failing to change config (0308ce288, rainzm) esxi: support fetchVM form datacenter (6b340264e, rainzm) esxi: add GetSchedtags implementation for esxi.SHost (857e76ab7, rainzm) esxi: correctly judge whether inet is nil (65ca3ace7, rainzm) esxicli: better vm operator (3f8f9e6c5, rainzm) notify: replace VerifiedContactTypes with VerifiedInfos in ReceiverDetails (8c6fdd110, rainzm) notify: Support trigger-verify for feishu, dingtalk and workwx (beee6e2c9, rainzm) notify: Add VerifiedNote for SSubContact (60412cf7e, rainzm) notify: break down error from UseridByMobile (90b84e995, rainzm) notify: sort the returned contact type array (f24950da9, rainzm) notify: Allow use topic to filter notification (ff52e0044, rainzm) notify: Add TNotifyChannel const of robot (7c6e053a0, rainzm) region: sync capacityUsed for storage after deploying or deleting guest (9ded6e43f, rainzm) region: change fomat ‘id’ to ‘name(id)’ in scheduledtasks' log (7b67554dc, rainzm) region: replace 虚拟机 with 主机 or 云主机 (c542249c7, rainzm) region: divide notify templates into Chinese and English versions (5a10f9dd9, rainzm) region: sync schedtags when syncing host (679ccb825, rainzm) region: sync CapacityUsed for Storage (547b2960b, rainzm) scheduler: Change the action for guests with backup and instanceGroup (fa0450b45, rainzm)  Glance (1)  check min disk size on update (00265fedd, wanyaoqi)  Guests (1)  guests with vpc nics are available for eip association (5c7ae23d8, Yousong Zhou)  Host (1)  fix rbd storage cache iso image (6a7cf0608, wanyaoqi)  Hostinfo (1)  try create network add is_on_premise (#7707) (607e3d8fd, wanyaoqi)  Hotfix (1)  vpc change owners with wire (5e721b929, Qiu Jian)  Httperrors (3)  HTTPError: use Error type (918dce80e, Yousong Zhou) add Error type (12899ab00, Yousong Zhou) use existing details if id is not present (#7711) (bde5e1b96, Yousong Zhou)  Httputils (1)  preserve format val types (4fb45676a, Yousong Zhou)  I18n (2)  add ITable (8164854fd, Yousong Zhou) move out from httperrors pkg (8dc179676, Yousong Zhou)  Iproute2 (1)  address: make Exact idempotent (05b72a9d0, Yousong Zhou)  Keystone (2)  passwords: SetModelManager (61cd611aa, Yousong Zhou) config: SetModelManager for whitelisted config (6c9e8f194, Yousong Zhou)  Lb (1)  include cluster name info in details (7add76415, Yousong Zhou)  Locales (3)  monitor: add translations (70fd9dfb7, Yousong Zhou) update translation (a54d0e592, Yousong Zhou) update translations (c4f4e7d30, Yousong Zhou)  Logclient (5)  i18n: en for const (6bff7caf9, Yousong Zhou) i18n: cn for const (27d0452fa, Yousong Zhou) convert const val to use latin chars (b1a332fec, Yousong Zhou) move ws list to separate file (bc066edc0, Yousong Zhou) separate lines (0b878134b, Yousong Zhou)  Logger (2)  actionlog: add GetI18N (3f7155c39, Yousong Zhou) actionlog: remove redundant comments (b13d0f603, Yousong Zhou)  Mcclient (1)  options: loadbalanceragents: yum as the default deploy method (24379db85, Yousong Zhou)  Monitor (4)  error fmt (572e45968, Yousong Zhou) suggestsysalert add ignore action (7aa3c9dde, Zexi Li) reduce subscription mysql usage (cdf33052c, Zexi Li) support suggest rule alert config and add snapshot_unused driver (7a9662c6f, Zexi Li)  Opslog (1)  move const to separate file (986031fc9, Yousong Zhou)  Opt (1)  scheduler: better sort for hosts when selectHost (ed4847dff, rainzm)  Optimized (2)  create eip params (becf92f6b, Qu Xuan) 支持ip和端口过滤安全组 (594f05d94, Qu Xuan)  Others (178)  fix:允许cname record通过policy多值 (9b7fbf33b, lvyangyang) aliyun public elb region fix (7a61d77b0, TangBin) bugfix commalert 3.4 (e87d2c0e8, zhaoxiangchun) bugfix:commonalert (a9c95cf36, zhaoxiangchun) aliyun public elb brand fix (540f4631f, TangBin) fix:forbid top level public domain name (fba8349e8, lvyangyang) mcclient modules: fix k8s fed rolebinding joint wrong resource manager (1a1d7c70a, Zexi Li) bugfix :esxi 多机器环境下拉取监控超时 (b88c114ba, zhaoxiangchun) aliyun create public lb fix (3ddce26aa, TangBin) fix:/dnsrecordset重复检查,dnszonevpc数量 (d94e55501, lvyangyang) increase rbd check timeout (adbe292f4, wanyaoqi) umount nfs on detach storage (61cc18010, wanyaoqi) fix:(region) correct syncSchedtags (4586c82cb, rainzm) huawei client request add throttling control (77865d894, TangBin) huawei elb get params log (454aabca7, TangBin) qcloud elb create listener fix (c6d214991, TangBin) huawei snapshot delete fix (ebee60810, TangBin) set stagefail on clean fail (7e2e7ade1, wanyaoqi) wait deleted (d90b661f7, lvyangyang) commonalert bugfix 3.4 (365e555c9, zhaoxiangchun) bugfix:esxi collect metric (a7198dc21, zhaoxiangchun) fix esxi-agent dockerfile typo (78fc35d3a, Zhang Dongliang) support mutli params (8102e7ed0, wanyaoqi) make with ARCH argument (384e86664, Zhang Dongliang) support search ip (884e82a15, wanyaoqi) regional network filter bugfix (0bba6e63f, TangBin) ctyun sync secgroup fix \u0026 cloudaccount delete fix (0acbfc89f, TangBin) common alert bugfix/3.4 (477d36f82, zhaoxiangchun) fix host deployer base image (33fb33a58, wanyaoqi) ctyun add region cn-bj1 (12bd187ec, TangBin) fix set host image cache properties (5593b88e9, wanyaoqi) fix update image status after save failed (785da09d6, wanyaoqi) host sync storage size (585ef5833, wanyaoqi) dup record process (4487867f5, lvyangyang) suggest rule modify: (9b12c675d, zhaoxiangchun) bugfix vmware monitor (2a680f99a, zhaoxiangchun) dns access (70297e313, lvyangyang) commonalet bugfix: (1a323667a, zhaoxiangchun) Add mock test for genericScheudler.Schedule (89980b626, rainzm) fix host error output (ada6c870d, wanyaoqi) isolated devices info reenterable (78f9db1ba, wanyaoqi) guest short desc add backup host id (8c4941ea7, wanyaoqi) fix get ubuntu version (d22676906, wanyaoqi) optimized cachedimages sync (7095ea8f8, Qu Xuan) pex register add optional column mac_access (24af17757, TangBin) create classic vpc fix (612ad9286, TangBin) Automated cherry pick of #7714: Feature \u0026 Fix for Notify (#7715) (eb9d794fa, Rain Zheng) update host status to unknown on host offline (20b949091, wanyaoqi) vmware disk support deploy lvm partition (43ce3b545, wanyaoqi) listfilter by alert_id (d95e64e59, zhaoxiangchun) alert record bugfix (06bd735f0, zhaoxiangchun) Automated cherry pick of #7712: httperrors: support setting lang with X-Yunion-Lang (#7713) (77a5c1ff8, Yousong Zhou) Automated cherry pick of #7692: feat(notify): Support update for notify config (#7693) (b03c8ce50, Rain Zheng) Automated cherry pick of #7661: fix(host-deployer): Exit correctly after mounting (#7672) (c914dafa7, Rain Zheng) fix host get guests (#7683) (4af4bcb96, wanyaoqi) fix get storage capacity on init' (#7687) (b85fb9829, wanyaoqi) snapshot list by guest (438c1ced5, wanyaoqi) commonalert bugfix (be5bf11eb, zhaoxiangchun) 统一监控查询面板保存 (6cea2883a, zhaoxiangchun) update host deployer base image version (53a6c40a8, wanyaoqi) baremetal colloct isolated devices info (#7658) (eee193165, wanyaoqi) fix mount fetcher fs (#7657) (8e83ab476, wanyaoqi) remove backup metadata on delete backup (#7654) (b97764133, wanyaoqi) eip \u0026 vpc manager match fix (132c58379, TangBin) fix build baremetal agent image (#7647) (557240155, wanyaoqi) metric describe 接口 (#7381) (dd8a07f36, zhaoxiangchun) fix github action workflow (#7635) (c1cf72899, wanyaoqi) separate guest doamin and dns (#7621) (61214f2e2, wanyaoqi) fix gpfs check mountpoint (#7623) (2904364de, wanyaoqi) Refactor for Notify (#7611) (853153c73, Rain Zheng) docker build support buildx and arm architecture (6b944626b, wanyaoqi) Feature/yousong text (#7487) (c2bca8ab3, Yousong Zhou) feature:host image fetcher fs (#7606) (a4b27a3cf, wanyaoqi) fix:wrap params (#7605) (46683b210, lvyangyang) alter table guestcdrom_tbl modify column size bigint (#7593) (dcf8183c3, wanyaoqi) only notify watched resource (#7592) (86253534d, Zexi Li) Bugfix/yousong vpc ext (#7585) (6dc007425, Yousong Zhou) Bugfix/yousong hostman routes (#7563) (e01f0ce2a, Yousong Zhou) fix usage not set prefix (#7568) (29c0e5384, wanyaoqi) support diable usb kbd (df9e47cbf, wanyaoqi) fix usage get storage capbility (#7527) (aa483edeb, wanyaoqi) fix mount xfs (cdaff2126, wanyaoqi) usage report reserved memory (#7525) (54ff56c04, wanyaoqi) set disk status on disk detached (#7517) (cad24ac69, wanyaoqi) nodealert bugfix： (#7512) (b63d9b55d, zhaoxiangchun) modify telegraf reporting tag (#7489) (22cd20c3f, zhaoxiangchun) add image upload\u0026 s3 upload api (#7514) (280039ab3, tb365) Hotfix/qj password login wrong idp (#7511) (b0505ba5f, Jian Qiu) fix host info get sshkey (#7484) (716f647f7, wanyaoqi) fix reauth condition on influxdb not found (#7456) (a962db0e9, wanyaoqi) fix cache non lvm disks (#7459) (2cdfed2ca, wanyaoqi) aws elb listener\u0026rule name too long fix (ff4840b46, tangbin) fix redis reset account password action log (e59e40d3b, tangbin) loadblancer listener modify name fix (bd3d581f4, tangbin) fix deploy admin auth key (9bc1cfe6f, wanyaoqi) Feature/yousong lblis names (#7395) (d95584b11, Yousong Zhou) fix host register info (#7401) (ae0bd556c, wanyaoqi) fix panic on storage failed get host (#7390) (d6fdf3361, wanyaoqi) make rpc handle exportable (#7367) (9acc8c629, tb365) adjust schedule resource condition width (59e4f7d61, Zexi Li) Add more tips for make image cmd (51cb278ae, Shaohui Liu) fix schedtag list output (051205066, wanyaoqi) Add metadata for GuestTempalte details (49e4e31da, rainzm) Add network info when list scalingGroup details (45a3e0805, rainzm) 修改报警消息模版： (5e0cb9319, zhaoxiangchun) go fmt (1583da57f, tangbin) go fmt (d45ee2c0e, tangbin) host upload template check (e660e25be, tangbin) huawei fetch regions\u0026projects fix (0f2453189, tangbin) 修复统一报警bug (921472455, zhaoxiangchun) rename vgname centos (399488991, wanyaoqi) fix clone clean pending usage (31c0d5a42, wanyaoqi) capabilites add available host count (64935a465, wanyaoqi) fix snapshot clean pending usage (cd5d31763, wanyaoqi) Remove sudo before the docker cmd (96bb34ea0, Shaohui Liu)   add precheck for perform action (a677f2435, wanyaoqi)   format fix (d10e15ed9, tangbin) fix empty else (d5591001c, tangbin) fix host import (3ff402f4b, tangbin) fix huawei delete resource (94bb91716, tangbin) fix huawei elb disable healthcheck (7fcc85f85, tangbin) lb sync project fix (6d9a55638, tangbin) add more log (edc10b14d, tangbin) apigateway host imports data validate (cea012162, tangbin) update vendor (5d4efcc63, Qiu Jian) fix GetOrCreateVpcForClassicNetwork (a755d0d37, tangbin) 修复监控报警规则删除的问题 (bd80fa889, zhaoxiangchun) fix error output (7f8be7d4b, wanyaoqi) huawei eip delete fix (081a3eabd, tangbin) acl delete condition fix (a74853db7, tangbin) fix server sync status (41fcf38cf, wanyaoqi) sync classic redis fix (b9a45c8bb, tangbin) add params auto_migrate_on_host_down (a39b0c87e, wanyaoqi) misc ha guest fix (3e759a3a4, wanyaoqi) fix list guests on host (f4ee70c0b, wanyaoqi) cloudprovider usable filter with zone (22d000e73, tangbin) disable procutils print error info (66064a4c4, wanyaoqi) fix guest template health check (014540e4d, rainzm) fix:修复路由表映射到public网络的问题 (2d12d7898, lvyangyang) user batch register bugfix (c1e49d02c, tangbin) 新增优化建议： (7cd1f1de5, zhaoxiangchun) fix format (f24fd4aa1, bistuzx@163.com) add cost alert modules (f5a2215a9, bistuzx@163.com) vendor update: update jsonutils (2028dbabb, wanyaoqi)   fix local storage init local man (e2043d6bc, wanyaoqi)   misc fix (04dfa4879, wanyaoqi) add:region/esxi 迁移接口 (c75b63eb7, lvyangyang) fix set storage info bind mount (e2ad0101e, wanyaoqi) update vendor (47bb16e51, tangbin) Update docker image onecloud-base and its references (81784aea3, rainzm) suggestAlert cost:modify the request param to meter (a0dc33266, zhaoxiangchun) 增加influxdb的tag 的一些filter (98d2e489e, zhaoxiangchun) update vendor (00d7ce83e, Qiu Jian) remove obsolete codes from apigateway (27b3fb5d5, Qiu Jian) itsm climc (36408ab4a, zhaoxiangchun) add mcclient cloudaccount gcp\u0026huawei bucket (6e9718d4e, bistuzx@163.com) Update Dockerfile.ansibleserver (f909a1d2c, rainzm) 优化建议中增加费用统计接口 (2fde31764, zhaoxiangchun) update vendor (182c96a16, Qiu Jian) add meter modules amount_estimation\u0026daily_bill (70c07d4a8, 张旭) bind mount nfs storage path (322117f6d, wanyaoqi) cluster_d required-\u003eoptional (63babfed8, tangbin) fix the bug introduced in #6643 (17721c4d5, rainzm) update jsonutils (ae3827f9a, rainzm) copyright api update (60c8c25c0, tangbin) fix deploy backup server order (1d59ceb5d, wanyaoqi) keep input mem and cpu on create from instance snapshot (dae606d28, wanyaoqi) .travis.yml: use go1.14 (8e9c58799, Yousong Zhou) .github: workflows: use go1.14 (1152c3c24, Yousong Zhou) .github: bump backport hint to release/3.2 (2463396ef, Yousong Zhou)   add server pending deleted for host details (38a05c490, wanyaoqi)   include system usage (fabd3577a, wanyaoqi) server name enable upper case (75588d00a, wanyaoqi) report host stat (4e6512040, wanyaoqi) disable dhclient (c4d5da440, wanyaoqi) add known sp metadata xml (c30262241, Qiu Jian) fix get storage capabilities with null field (854bf59f8, wanyaoqi) sp support (3b32f0a4d, Qiu Jian)  README (1)  update architecture picture (bb540ff10, Zexi Li)  Region (13)  host specs replace space char to ‘_’ (3b0ba2caa, Zexi Li) fix query object by spec not include details (a05f50dbf, Zexi Li) fix schedtag joint resource master/slave field wrong order (1b6ac9bc4, Zexi Li) fix network schedtag not cleanup when network deleted (1d7ffc704, Zexi Li) validate network auto alloc update data (#7559) (95130f8ef, Zexi Li) schedtag list support resource_types (48d982b39, Zexi Li) lbagents: skip tls check for default influxdb endpoint url (e5dd2409d, Yousong Zhou) lbagents: default vrrp vrid, priority (495a2d995, Yousong Zhou) lbagents: use local params var (4596f3f11, Yousong Zhou) lbagents: set some vrrp params to values of peers (746cb8679, Yousong Zhou) lbagents: make vrrp interface default to eth0 (b0c39bfad, Yousong Zhou) lbagents: turn off guest src check (afac0604d, Yousong Zhou) loadbalanceragents: yum as the default method (7926e59d7, Yousong Zhou)  Scheduler (5)  fix fillter isolated device (8e0f47aa0, wanyaoqi) ignore network type when specified (a1c7a291d, Zexi Li) refactor network predicate (#7553) (7a08a60db, Zexi Li) fix network auto alloc logic (6f2ddbd3a, Zexi Li) fix storage filter duplicate error message (0957fee3d, Zexi Li)  Specs (1)  fix specKey url not escape (a4d7b2b4b, Zexi Li)  Treewide (3)  avoid variable fmt str (822fae009, Yousong Zhou) fmt error (23b9991a7, Yousong Zhou) DeleteFailReason as an object with translated details (f1995a46d, Yousong Zhou)  Vendor (1)  update yunion.io/x/sqlchemy (4e16eaf21, Yousong Zhou)  Vpcagent (4)  guard against foul eip records (f0faf07b6, Yousong Zhou) respect guest src check settings (#7678) (19ba4b975, Yousong Zhou) ignore network without wire ids (#7629) (500e2edad, Yousong Zhou) ClaimVpcGuestDnsRecords: guard against pending_deleted guests (20f36afdc, Yousong Zhou)  Webconsole (2)  fix defer order to release zombie process (fa2d8723a, wanyaoqi) fix old session make new session closed (642d69427, Zexi Li)   notify-plugins Repository: https://github.com/yunionio/notify-plugins\n25 commits to notify-plugins - v3.4.0 since this release.\nBug Fixes (4)  common: correct error judgment in BatchSend (4c76dd8, rainzm) dingtalk: return correct value in getUseridByMobile (4241c3d, rainzm) robot: Correct err value of ValidateConfig (5e2b642, rainzm) workwx: Incorrect variable use for ok (05eabba, rainzm)  Features (5)  break down error from UserIdByMobile (a9ff6b9, rainzm) Support workwx (52b50d2, rainzm) notify: Add BatchSend for websocket (0eaa49a, rainzm) notify: Add common function to batch send (63924dc, rainzm) robot: Add BatchSend (b70b205, rainzm)  Others (15)  buildx for notifyplugins (e6a246b, Zhang Dongliang) makefile 去掉 sudo; make all bins (65d52fe, Zhang Dongliang) docker buildx for notify plugins (8f5747f, Zhang Dongliang) update vendor (8df6b86, rainzm) change email const name (0531db3, rainzm) fix batch send of workwx (cab236d, rainzm) update vendor (c3b8d64, rainzm) Support batch send for eamil and smsaliyun (8ff79b6, rainzm) Support sending a batch of workwx messages (d33068e, rainzm) Support markdown when sending single user dingtalk message (6bec1bd, rainzm) Update vendor (ec2bfad, rainzm) Support batch send (80397bb, rainzm) change ‘corp_secret’ to ‘secret’ (6801a1e, rainzm) remove default config file (061987a, rainzm) Add workwx-robot for webhook (c09687f, rainzm)  Test (1)  update vendor for go-workwx (62b2a41, rainzm)   ocadm Repository: https://github.com/yunionio/ocadm\n17 commits to ocadm - v3.4.0 since this release.\nAutoupdate (1)  clear host tag (611c2c4, Zexi Li)  Others (16)  clean info from from autoupdate component when update (48d9fe4, Zexi Li) 更新 3.4 的 makefile 版本变量 (80c6081, Zhang Dongliang) make mod (f4f0696, wanyaoqi) meter baremetalagent esxiagent use longhorn (6c6379e, wanyaoqi) update vendor for v3.2: (e3fa33e, Zexi Li) update onecloud-operator vendor (752e2d2, Zexi Li) ocadm create cluster, 延时等待容错 (2441304, Zhang Dongliang) 高可用部署主备选取应将kube-apiserver是否工作考虑进去 (d8f027f, Zhang Dongliang) fix longhron template (b6afd3b, wanyaoqi) 修复 keepalived master state bug (fa22d63, Zhang Dongliang) longhorn deploy misc fix (c9ef80b, wanyaoqi) update vendor (c9f7d19, Zexi Li) update vendor for master (657f5e9, Zhang Dongliang) fix create region zone where upgrade from v2 (284f65a, wanyaoqi) ocadm 接入 keepalived，支持高可用 (a8b6713, Zhang Dongliang) update DefaultCalicoVersion to 3.12.1 (6c1fc6d, Zhang Dongliang)   onecloud-operator Repository: https://github.com/yunionio/onecloud-operator\n41 commits to onecloud-operator - v3.4.0 since this release.\nBug Fixes (3)  apigateway totp should default on (d14c152, Qiu Jian) member policy requires member role (323b403, Qiu Jian) check before doing perform_public for roles and policies (3ea8576, Qiu Jian)  Feature (1)  add cloudid service (4066231, Qu Xuan)  Notify (1)  remove pvc dependence (f1e64f3, wanyaoqi)  Others (33)  pod affinity by storage class (0a85313, wanyaoqi) BusyBox upgrade ,modify cloudmon timeout arg (724b1ec, zhaoxiangchun) host image spec fix (1ab0562, wanyaoqi) add flag check is failed etcd pods need delete (965c589, wanyaoqi) push 镜像后,拉回本地 (2ad7c37, Zhang Dongliang) buildx for onecloud-operator (d81484e, Zhang Dongliang)   etcd clean failed state pods (b244a1e, wanyaoqi)   deployment with pvc not set node affinity (#256) (eddc03d, Zexi Li) replace cloud affinity preferred by required (#253) (9cf0d16, wanyaoqi) remove api/v1 from notify endpoint url (#252) (7b21b4b, Rain Zheng) etcd add cloud affinity (cb35295, wanyaoqi) statusfulset set cloud affinity: (ce4e78a, wanyaoqi) update host image default spec (3bedb0b, wanyaoqi) crontab timeout (0398ed0, zhaoxiangchun) fix baremetal storage size (d2f57ec, wanyaoqi) Add workwx and workwx-robot for notify (#240) (e6ee55d, Rain Zheng) cloudmon deployment increate cloudaccount monitor config: (#241) (699ec4a, zhaoxiangchun) itsm 开启https (#242) (0e9f304, zhaoxiangchun) remove etcd-operator dependcies (#235) (8c022f3, Zexi Li) 调整统一监控 系统报警规则的注入配置 (752e28c, zhaoxiangchun) fix etcd member count (500ddc5, wanyaoqi) recreate pods on pvc not local path (64cc832, wanyaoqi) 修复系统报警规则重复创建的问题 (32e05ea, zhaoxiangchun) fix set pvc name (ddf338e, wanyaoqi) fix glance pvc name (41d9deb, wanyaoqi) update vendor (e6922a7, Zexi Li) cloudmon deployment increase [rds redis oss] monitor information collectiona (b9c27f2, zhaoxiangchun) add check if cronjob exist (51ce335, wanyaoqi) service etcd client disable unready client (0b90038, wanyaoqi) host image component set default toleration (b1083b9, wanyaoqi) cloudmon as deployment (3a8ddec, wanyaoqi) check etcd dbsize, do compact and defrag (e18c1a3, wanyaoqi) system alert init info create in operator (23add7b, zhaoxiangchun)  Web (1)  add dashboard overview (#243) (b99abd0, Zexi Li)  Yunionagent (2)  remove onecloud keyword (aba6c28, Zexi Li) update content (29b149c, Zexi Li)   onecloud-service-operator Repository: https://github.com/yunionio/onecloud-service-operator\n13 commits to onecloud-service-operator - v3.4.0 since this release.\nBug Fixes (4)  retry after a while when dealErr (89dbcc9, rainzm) the error judgment in dealErr (7695a89, rainzm) vmPendingAfter’s unit should be second (00fb031, rainzm) Update status and return when resource is invalid (5d604ab, rainzm)  Code Refactoring (1)  Abstract the same logic and abstract interface (afb74a5, rainzm)  Features (1)  add manager-pro section in Makefile (4a5e4ba, rainzm)  Others (7)  docker buildx for onecloud-service-operator (32b22c2, Zhang Dongliang) fix the usage of vmPendingAfter (f6d2d87, rainzm) remove regionid for endpoint (678a87d, rainzm) Build failed for some small bugs by following the README.md (987363c, Shaohui Liu) Add Endpoint document (d5cb366, rainzm) Add CRD Endpoint (077a994, rainzm) support yaml string (cbd3a0a, rainzm)   sdnagent Repository: https://github.com/yunionio/sdnagent\n13 commits to sdnagent - v3.4.0 since this release.\nAgent (1)  ovn: no error log if the mapped bridge does not exist (a9ce756, Yousong Zhou)  Build (7)  eipgw: vrrp track script as monitor (32941bd, Yousong Zhou) systemd: add keepalived reload command (271c0e2, Yousong Zhou) eipgw: use 8 byte char for auth_pass (7936112, Yousong Zhou) eipgw: let keepalived use detail log (6331131, Yousong Zhou) add ansible playbook README (ec48e2d, Yousong Zhou) bump to alpine-build:1.0-2 (9cffe97, Yousong Zhou) separate artifact and docker image build (29e2d68, Yousong Zhou)  Others (2)  pull image for buildx (cc574b6, Zhang Dongliang) docker buildx for sdnagent (c86cc8a, Zhang Dongliang)  Sdnagent (1)  be cooperative (d73fbef, Yousong Zhou)  Vendor (2)  bump yunion.io/x/onecloud to current tip of release/3.3 (b599b01, Yousong Zhou) bump 3.3 (#105) (6e67604, Yousong Zhou)  ","excerpt":"Release time: 2020-09-30 16:43:35\n onecloud Repository: …","ref":"/v3.6/en/docs/changelog/release-3.4/3-4-0/","title":"v3.4.0"},{"body":"发布时间 2020-09-30 16:43:35\n onecloud 仓库地址: https://github.com/yunionio/onecloud\n607 commits to onecloud - v3.4.0 since this release.\nAdd (3)  openstack loadbalancer (#7497) (eb56fcf7b, lvyangyang) region/sync openstack routetables (eac0a797b, lvyangyang) region/openstack 迁移接入 (41a4188bb, lvyangyang)  Ansibleserver (1)  register metadata manager (1ae8c9786, Yousong Zhou)  Appsrv (1)  quash low-value debug log lines (7a3f24145, Yousong Zhou)  Baremetal (2)  fix hpssactl split last LV size out of limit (#7426) (b1603153e, Zexi Li) set zone when enable netif (c27433103, Zexi Li)  Bug Fixes (279)  允许域管理员可以看到共享的dns zone cache列表 (02bcce195, Qu Xuan) emulated wire not sync vpc shared info (5c4423bcb, Qiu Jian) oidc response user’s info (8cdab93c1, Qiu Jian) revert filter-by-owner changes of scoped resource (8a28d2627, Qiu Jian) allow domain admin view shared dns zone records (b0e1d0de2, Qu Xuan) avoid sync dns zone cache status is init (f931deb41, Qu Xuan) filter storages by host schedtag (11ea89795, Qiu Jian) 避免azure同步项目失败 (1021bf151, Qu Xuan) suffix template cache key (ad2248311, rainzm) filter cloudprovider/network by host-schedtag-id (82c0dcfb3, Qiu Jian) dns zone cache owner info (da8529a00, Qu Xuan) allow create disk prefer manager (73aee1147, Qu Xuan) simplify forbidden user login message (91f098430, Qiu Jian) 支持同步project标签到本地资源 (4794b1606, Qu Xuan) avoid purge storages (f5cf093e0, Qu Xuan) openstack zone not emulated (3903af786, ioito) allow cross doamin resource sync (91cac5c21, ioito) avoid account delete failed (5f50314df, ioito) sql err (310baa266, ioito) avoid compare err with cloudprovider.ErrNotFound direct (5f2c771f7, ioito) dns 错误信息补全 (8d28bfc6d, lvyangyang) google资源名称兼容处理 (26a3df33b, Qu Xuan) avoid serial vm creation (b5088230b, ioito) 仅在可用区故障时可强制挂载磁盘 (4038bfb8a, ioito) scope resource filter by owner (975e7fb1e, Qiu Jian) use i18n.Table to handle Chinese-English conversion (1c786a034, rainzm) keystone project resource count not accurate (95bde0a14, Qiu Jian) sort quota list result by usage rate (f3fa6f82b, Qiu Jian) disable domain sharing if non_default_domain_projects turned off (e796437a3, Qiu Jian) Error occurs when suitableWire exists or all suitableNetwork exist. (5f1cd20aa, rainzm) avoid account delete failed (c38cb271f, ioito) error 值重叠 (9a04238b7, lvyangyang) 避免同步不到其他域的云账号 (0a87b3101, Qu Xuan) role assignment filter by users not working for effective users in groups (b32eddce0, Qiu Jian) 避免腾讯云同步虚拟机ip异常 (f659ccd0d, ioito) apigateway userinfo includes project metadata (5b6b5eeb7, Qiu Jian) 避免添加新账号后长时间未同步iam用户 (b3c235fe3, ioito) 优化提取显示主账号名 (686df64ea, ioito) avoid not reture cloudprovider.ErrNotFound error (bb3317cc3, Qu Xuan) scheduler token not support policy (e444ab7a1, Qiu Jian) reset user password without check (5f35bba0d, Qiu Jian) get jnlp xml from dell idrac6,7,9 (760ac9900, Qiu Jian) reduce totp verification overhead (49cf94abb, Qiu Jian) add esxicli vmrc/webmks command (5f9088d24, Qiu Jian) disable qcloud verifyAppId temporarily (7601ca437, Qiu Jian) keystone initialize data skip nil extra fields (967d46bbf, Qiu Jian) omit empty fail reason (a475a7b41, Qiu Jian) enable generate name caused compability issue (0d798412e, Qiu Jian) 避免名称重复 (a1ba06a92, Qu Xuan) bucket object cnt fix (cc5e0cd7c, Qu Xuan) lock/unlock cleanup (ada735246, Qiu Jian) 支持自动根据云上项目修改本地项目名称 (5c71349fe, Qu Xuan) 修复权限组权限同步异常问题 (24cbdf673, Qu Xuan) cos use proxy (0a5ee4ca6, Qu Xuan) check host sharing status when considering whether a host is assignable (6b5339900, Qiu Jian) disable webkms for esxi older than 6.5 (7cf5ad913, Qiu Jian) 默认不自动合并安全组 (ce777855a, Qu Xuan) avoid sync natgateway eip panic (960742029, Qu Xuan) 优化sku同步逻辑 (ea518358c, Qu Xuan) add dns recordset dns value check (2e93ee3d6, Qu Xuan) 平滑迁移数据 (d6d490af6, Qu Xuan) 腾讯云不支持同时设置秘钥和密码,若设置秘钥，则将密码置空 (5576819f0, Qu Xuan) optimized qcloud keypair (dc20313ef, Qu Xuan) 修复cloudid问题 (642af06ba, Qu Xuan) optimzed clouduser password (aa26c6ec9, Qu Xuan) 避免未本地缓存usercache (835261e9e, Qu Xuan) capability for cloudid (0b4a562f0, Qu Xuan) optimzed clouduser (9281c5429, Qu Xuan) avoid create public zone failed (2ad1a4afe, Qu Xuan) recode project-role rpc handle to support group role assignment results by user or project (0268d9585, Qiu Jian) uniform cachedimage active status (025eca548, Qu Xuan) wire usage stats incorrect (621c2796d, Qiu Jian) ignore 409 error when doing redfish power on (d10adf22d, Qiu Jian) validate candiate ip for sync-fix-nics (f739c8ff0, Qiu Jian) Override Master and Slave for scalinggroup_guest (ba2b1d9bd, rainzm) manager_id资源隔离获取 (9bb4eb5d4, Qu Xuan) prevent users in disabled idp from login (e758c4aa9, Qiu Jian) check assign-host previliges (623c71b14, Qiu Jian) sync groups for user (4cd73c16c, Qu Xuan) aliyun wulanchabu region (0a79d1d23, Qu Xuan) 取消aliyun lb scheduler创建限制 (933dddd8a, Qu Xuan) 修复cloudid同步问题 (88e5119fd, Qu Xuan) user idps attributes includes template name (bfa4ce38e, Qiu Jian) skup syncing lb, rds, redis instances in tasks (c5c2b4b69, Qiu Jian) network address list respect privilige of user (29edf8329, Qiu Jian) cloudid optimized (390d6f07e, Qu Xuan) valid update name and update dns recordset (b4252c7c2, Qu Xuan) scheduler aware policy (485388394, Qiu Jian) support VirtualDiskRawDiskMappingVer1BackingInfo (0619da6f1, Qiu Jian) find correct esxi host access ip (29a3db9ff, Qiu Jian) remove redundant auth cookie in sso login (c50497090, Qiu Jian) 公有云子账号加域属性 (02bf5b76d, Qu Xuan) 优化安全组list速度，并发挥rule规则信息 (8279f62c9, Qu Xuan) clouduser can_delete always be false (91a5e4ab7, Qu Xuan) 同步不需要判断账号是否有iam权限 (2c17e6e66, Qu Xuan) optimzed sync (5cc25ae10, Qu Xuan) optimized cloudid (cfd76b23a, Qu Xuan) search by chs projectname or domainname (976dbd779, Qiu Jian) 避免slave zoneid异常 (cac7dc529, Qu Xuan) compatiblity fixes with lenovo RD620 and huawei 2288 (949e2ebed, Qiu Jian) avoid nil panic (03456eaaa, Qu Xuan) avoid policy value not save (d03fddcd7, Qu Xuan) climc params (893085a2c, Qu Xuan) add details for account delete (#7703) (800dd26c6, 屈轩) vmware esxi host detects vnic portgroup info (#7660) (836151eee, Jian Qiu) apigateway user info add is_local attribtue (#7695) (0566e1dec, Jian Qiu) server purge may fail (#7698) (cca226738, Jian Qiu) http error limit request body length fix: http error limit request body length (#7700) (538bc873a, Jian Qiu) 不限制openstack系统盘类型 (#7675) (9812864bc, 屈轩) cleanup logic for nics of pending_deleted guests (#7669) (5647a6842, Jian Qiu) avoid delete aws iam user failed (6ed3a4833, Qu Xuan) aovid truncated data (#7644) (3243e5a03, 屈轩) add keystone sync user debug info (#7639) (e3fe66e8e, Jian Qiu) turn off some default project policies (#7637) (de80f1705, Jian Qiu) avoid openstack image-list failed (#7641) (aef249ea8, 屈轩) project role rpc returns policies info (#7632) (5b2b40d6c, Jian Qiu) add keystone sync user debug info (ccf55963a, Qiu Jian) make old notify send SDK compatible (#7628) (707051ec0, Rain Zheng) avoid network-list –zone not work (#7619) (4593c1fb9, 屈轩) ignore invalid zone sku for rds sku sync (#7617) (ca2e8bece, 屈轩) oauth2 not support default_project_id and default_role_id (#7622) (fea4a6b07, Jian Qiu) idp deletel logic cleanup (#7616) (852a3bb13, Jian Qiu) hide locked cloud policy by default (#7614) (7c3fa87ed, Jian Qiu) GetDefaultClient always return a new http client instance (3762df808, Qiu Jian) avoid change user name for google (#7613) (c1a6b2db9, 屈轩) limit the length of error message when do idp redirect (#7612) (a94f32ed5, Jian Qiu) avoid storage=nil, dis can not delete (#7608) (4555b00c3, 屈轩) apigateway option to turn off login domain list (fe0182333, Qiu Jian) optimized for cloudid (#7604) (5b898bbf6, 屈轩) opslog filter by owner_project_ids and owner_domain_ids (#7600) (777059648, Jian Qiu)   remove Azure OIDC extra user scope 2. yunionauth cookie missing (#7599) (7bab39daf, Jian Qiu)   member user only can get user \u0026 domain resource (#7597) (a23a94714, 屈轩) option for metadata path (#7595) (e70fe59bc, 屈轩) 修复cloudid用户同步及权限同步 (8a78c54dc, Qu Xuan) dns record create ignore is_public field (016b65a4b, Qiu Jian) 支持自定义权限 (#7565) (d5524d1ea, 屈轩) GetIImages correctly without ‘image_cache’ dir (#7575) (0ab75b52d, Rain Zheng) allow delete shared role and policy (4a0439da8, Qiu Jian) aovid duplicate sku name (#7572) (196d3b360, 屈轩) cloud poilcy count (d2b9ba5bc, Qu Xuan) json TAG_PREFIX invalid syntax (#7564) (6a57435f1, Zexi Li) avoid virtual resource project id is empty when cloudaccount with no project (#7560) (7cd419f78, 屈轩) Merge the host network correctly when preparenet (#7557) (098b4e5b5, Rain Zheng) network port count stat recode (#7554) (b89845584, Jian Qiu) user with sso idp fail to login with password (#7552) (320d7cabc, Jian Qiu) oidc auth callback url not complete (#7545) (a02611db1, Jian Qiu) recode user project role list to include group info (#7544) (59c026f0d, Jian Qiu) change publicNetworkCount to autoAllocNetworkCount in Capability (#7546) (e1bd01162, Jian Qiu) separete enabled and status field (5b31ca8da, Qu Xuan) update vendor (#7526) (c277d492f, Jian Qiu) optimized huawei security group get and create operation (#7520) (930ca23ea, 屈轩) compatible for macOS (a6bff9498, Qu Xuan) 修复安全组合并导致重复计算虚拟机绑定安全组数量\u0026优化安全组操作 (#7496) (f343b071f, 屈轩) avoid nil pointer (#7508) (4696a3e47, 屈轩) password authentication may choose wrong idp backend (#7513) (c98e72e6e, Jian Qiu) preserve state while doing sso redirect (60eec6440, Qiu Jian) 提高zstack认证兼容性 (0850bd516, Qu Xuan) 隐藏auzre经典类型存储 (629a4e93d, Qu Xuan) 增加openstack兼容性 (#7492) (327b60baf, 屈轩) do not search response key if empty json returned (#7495) (c63230f37, Jian Qiu) idp validate config not complete (#7488) (19b69de1d, Jian Qiu) support AzureAD oidc in china area (12bbbc541, Qiu Jian) capabilities get auto alloc network count (#7483) (d4a93f0dc, Jian Qiu) unlink-user illegal mix of collations (#7482) (0a580b3c9, Jian Qiu) filter public network count by zone and region (#7477) (04eaf3de6, Jian Qiu) typo running_geusts =\u003e running_guests (eae229b35, Qiu Jian) typo (9da8095f8, Qu Xuan) ignore bucket-set-acl not implemented error (#7470) (1929076fa, Jian Qiu) avoid host globalid change (#7465) (a51f0271e, 屈轩) avoid generated codes having duplicate PerformSetScope methods (9bdf2c75e, Qiu Jian) 避免azure同步资源组异常 (be51f3b49, Qu Xuan) sync share mode between vpc and wire (9ea80725a, Qiu Jian) upgrade aliyun sdk (#7432) (27168fc72, 屈轩) 避免glance metadata-list project scope无权限 (#7402) (1244c170b, 屈轩) 优化openstack项目认证 (#7397) (fd2f1c0e3, 屈轩) 避免在仅调整虚拟机磁盘时opslog日志记录mem cpu异常 (#7392) (0cad2efd2, 屈轩) avoid lost backend params (846f90d54, Qu Xuan) openstack win image user data need encode (781618023, Qu Xuan) avoid account sync deadlock (509ebb92c, Qu Xuan) ignore general s3 set acl not implemented error (7f829f24f, Qiu Jian) cloud account sync may block (1985aab89, Qiu Jian) openstack多项目问题 (859ab9717, Qu Xuan) avoid parse json err nil pointer (598e8a924, Qu Xuan) avoid nil pointer (6477e0e14, Qu Xuan) adjust API input field names according to spec (#7382) (f0f406c24, Jian Qiu) use json to store task error message (#7351) (ba292dfed, Jian Qiu) 添加阿里云rds备份恢复限制条件 (#7378) (3df146ff6, 屈轩) change owner should check required domain list (#7375) (984bfeb6e, Jian Qiu) 普通视图下，安全组仅统计可看到的vm count (#7358) (76f78cdda, 屈轩) 同步sku与磁盘类型关系 (#7368) (d8f046365, 屈轩) 避免创建rds备份时对rds进行一些操作 (#7354) (78a68bffd, 屈轩) 修复vm绑定重复安全组 (8c31bba0a, Qu Xuan) add default perform allow policy to sysadmin (757706db9, Qiu Jian) cleanup auth error message return by apigateway (f1bfcfbd9, Qiu Jian) 避免status_code\u003e=400并且resp为空时err为nil (#7264) (a67f3e548, 屈轩) cloud account delete may fail due to inconsistent status (9f8f2b6c4, Qiu Jian) do accessibility check when dissociate eip from resource (845195440, Qiu Jian) modify list details for guesttemplate (34e66ab2e, rainzm) schedtag should be system resource (8f1b93472, Qiu Jian) choose candidate list from the list returned from backend (35da086cc, Qiu Jian) 单独添加更新账单文件日志 (c6df1944c, Qu Xuan) 支持多项目安全组规则过滤 (b20cd1364, Qu Xuan) domain resource domain share to system when non_default_domain_projects off (8d8acab90, Qiu Jian) update auto generate model api (208b69573, Qiu Jian) 避免未能导出共享安全组规则 (9a329453a, Qu Xuan) image upload not clean pending usage (587f533da, Qiu Jian) quota usage not updated after disk resizing (ce3d0906b, Qiu Jian) google rds regional and zonal (718e36b32, Qu Xuan) rds备份恢复优化 (8d85f04d8, Qu Xuan) default vpc must be shared globally (d3741d9a4, rainzm) globalvpc跟随云账号共享 (3bf9b5b0d, Qu Xuan) 过滤可用eip (ecaa1ad45, Qu Xuan) 避免乌兰察布区域拉取资源异常 (8bd23cf3d, Qu Xuan) prefetch image error when create guest with vmware template (2f1093a14, rainzm) not work for network-list –zones (bf65a8816, Qu Xuan) sec rule export missing fields (3ddcaad3c, Qu Xuan) check azure image format when rebuild root (466a3f728, Qu Xuan) 避免华为云安全组规则删除失败 (cc948a4d5, Qu Xuan) clouduser’s cloudgroups info (769dcae0e, Qu Xuan) 添加secgroup rule过滤参数 (6b591b455, Qu Xuan) 修复cloudid get权限问题 (34aa55114, Qu Xuan) azure 支持权限 (4cd67270a, Qu Xuan) 修复cloudid用户列表权限问题 (dccf685f6, Qu Xuan) 优化webconsole代码\u0026bugfix (dee1283c0, Qu Xuan) 修复阿里云同步安全组规则异常问题 (367c59117, Qu Xuan) 优化减少对etcd组件依赖 (9003d3702, Qu Xuan) mo.VirtualMachine’s Config maybe nil (b6753af32, rainzm) 优化azure订阅创建 (3d9e8b872, Qu Xuan) 支持azure创建订阅 (16f93d665, Qu Xuan) 避免google clouduser同步权限异常 (169b13f16, Qu Xuan) 修复vpc同步异常问题 (d7e16e334, Qu Xuan) 避免越界访问 (45f5bc526, Qu Xuan) opslog show the owners operation logs only (d59bff336, Qiu Jian) remove default allow policy for storages (6af7c5923, Qiu Jian) cloudid 权限修复 (dc32fe42e, Qu Xuan) cloudid 异常修复 (4b0bfa734, Qu Xuan) 修复资源组云上同步异常问题 (b41eea1d8, Qu Xuan) 修复qcloud同步权限组异常问题 (bfc414530, Qu Xuan) 修复azure 项目同步问题 (cb1ad2cf0, Qu Xuan) 避免请求中国区iam异常 (c82f307e4, Qu Xuan) 修复腾讯云操作日志时间异常问题 (9507a7209, Qu Xuan) 修复elastic cache sku zone_id异常问题 (862b926aa, Qu Xuan) 分开统计安全组关联虚拟机数量 (3db15d59f, Qu Xuan) json request 支持自定义匹配err (5e50740b3, Qu Xuan) orderedstring add performance improvements (f0c3b9627, Qiu Jian) perform private on vpc will private all wires if no networks in wires (0005cf868, Qiu Jian) remove default host list policy (87dc4743d, Qiu Jian) init wire domain_id for local vpc (#7566) (cedfd6410, Jian Qiu) 避免cloudprovider同步缺失 (067b0ab76, Qu Xuan) 修正项目映射同步 (4b16fac0b, Qu Xuan) compute: return InputParameterError while ValidateCreateData (c050629ba, rainzm) esxi: return when host.Vm is empty (6bfca36cb, rainzm) esxi: Select correct unitNumber for ide control when creating disk (5975887d5, Rain Zheng) esxi: fetch templatevm from datacenter before clone vm (ac69f8a59, rainzm) esxi: Guarantee the uniqueness of the schedtag for esxi host (5460f2244, rainzm) esxiagent: add HostDelayTaskWorkerCount (4e7e8a59d, rainzm) esxiagent: return image extid not id (3ef91f92e, rainzm) notify: return correct value when sortContactType (d917e8e38, rainzm) notify: Replace String() with GetString() (8524fda7f, rainzm) notify: Set default priority ‘normal’ when creating notification (851b2d4bb, rainzm) notify: break down permissions of notifyconfigs (72276d038, rainzm) notify: Mark verified not enabled in MarkContactTypeVerified (ab02e166e, rainzm) notify: Allow user list receivers (82b7e659a, rainzm) notify: use AfterSend for contact with succuessful sending (9e1a7c5e1, rainzm) notify: clean verifyNote when mark verified (09bebcf5f, rainzm) notify: pull contact for workwx, dingtalk and feishu (dba92d4b0, rainzm) notify: modify name of notification to avoid duplication (043fdcfec, rainzm) notify: allow normal user create their receiver (aecf97780, rainzm) region: add RequestSyncstatusOnHost for SESXiGuestDriver (55b2b2900, rainzm) region: add GetSlaveFieldName for ScalingGroupGuest (35842df1b, rainzm) region: set ownerId as userCred when can’t FetchOwnerId (1215d723a, rainzm) region: Don’t allow address conflicts under vpc (47b9b91b8, rainzm) region: zone from guesttemplate’s preferzone maybe nil (#7387) (0deb908ac, Rain Zheng) region: split brand as ‘YunionCloud’ and ‘云联壹云’ when notify server event (471e2b4f1, rainzm) region: fetch correct ownerId in PerformPrepareNets (c7b8e84ff, rainzm) region: Remove default secgroup for esxi guest (68ba4361d, rainzm) scheduler: more standardized testing (348ca46a0, rainzm) scheduler: fix array out of bounds when sorting hosts (4f9c37239, rainzm) scheduler: filter InstanceGroup whose enabled is false (e6de7be7e, Rain)  Bugfix (1)  collect esxi metric timout (caa26b756, zhaoxiangchun)  Build (3)  ansibleserver: use native alpine, include openssh (28ad028d8, Yousong Zhou) use alpine-build:1.0-2 (e94d41558, Yousong Zhou) docker-centos-build: use centos-build:1.1-1 (e1e56eaa7, Yousong Zhou)  Capability (1)  public network count filter by default vpc (8dd25e01c, Zexi Li)  Climc (8)  add k8s fed resource sync action (37b9a2e53, Zexi Li) refactor k8s sub command (51020aac0, Zexi Li) add k8s federated resource cmd (02dc68f20, Zexi Li) k8s cluster grafana componet support subpath (7f5124bdf, Zexi Li) add cmd helper to reduce duplicate code (aa8177f53, Zexi Li) update k8s resource list options (cd25b4ac6, Zexi Li) refactor k8s resource (e5bd6f26d, Zexi Li) update k8s-release-create params (253dc22cf, Zexi Li)  Cloudcommon (11)  get joint model should aware fieldname (4164bf58c, Zexi Li) joint model list should add field_name into query (82e38b8f5, Zexi Li) remove query for fetchitem when not GET (#7551) (c672521ce, Zexi Li) remove unnecessary joint interface (#7524) (9af25a2aa, Zexi Li) taskman: fix table insert (de1e1b100, Yousong Zhou) tablespec: informer: use %#v to log bad obj (4fc35f92c, Yousong Zhou) taskman: SetModelManager (08cd41b60, Yousong Zhou) etcd: quash low-value debug log lines (2eeb45ded, Yousong Zhou) policy: fix interval and oneshot sync (29a3171a3, Yousong Zhou) tablespec: informer: log obj type (145c88f79, Yousong Zhou) app: cosmetic change (d9f3dfbbf, Yousong Zhou)  Cloudprovider (1)  remove redundant error log (ffcea2ae5, Yousong Zhou)  Code Refactoring (6)  esxi: replace GetTemplateVMById with FetchTemplateVMById (42faf34f1, rainzm) esxi: fetchVms and fetchHardwareInfo (ef8768fce, rainzm) notify: hide SSunContact webconsole (10caff1d9, rainzm) region: replace ‘ActualCapacity’ with ‘ActualCapacityUsed’ (e0c94daaf, rainzm) region: optimize preparenet of cloudaccount (3f77c01e6, rainzm) scheduler: make forcast result clearer (6000874b3, rainzm)  Db (1)  IModel: add GetI18N() method (62c0c11c3, Yousong Zhou)  Db_dispatcher (1)  pass query for fetchItem (c777793d9, Zexi Li)  Disk (1)  check disk is need renew on guest set renew (77f479ce6, wanyaoqi)  Dns (1)  isMyDomain: match only strict subdomain of dns_domain (7e191a503, Yousong Zhou)  Elasticips (3)  error when we have no usable eip network (59a5e9201, Yousong Zhou) fix calling FilterByOwner (430e9cd0f, Yousong Zhou) filter by owner when doing auto allocation (8a0f940b3, Yousong Zhou)  Feature (13)  add dns interface (a85a1aecd, Qu Xuan) use informer to update endpoint, policy and service configs (#7596) (34ee80f01, Jian Qiu) cloudid saml support phase1 – framework and api (92f05be30, Qiu Jian) do uniqueness check when create/update idp configs (#7584) (2b7586140, Jian Qiu) OpenID Connect provider support (#7490) (604b6b7ff, Jian Qiu) OpenID Connect provider support (#7446) (0e775e68e, Jian Qiu) add is_auto_alloc flag to networks (#7473) (1ba9715ec, Jian Qiu) unified sso login framework (096784389, Qiu Jian) project filter that list jointable projects for user or group (eb4a252d0, Qiu Jian) apigateway store auth state in cookie instead of sqlite (7ba3945d8, Qiu Jian) keystone add support for OpenID Connection idp (2183490a5, Qiu Jian)   idp as domain resource 2. keystone support SAML IDP (889a35bc7, Qiu Jian)   support SAML idp (3b7a1e946, Qiu Jian)  Features (28)  add NotifyError in notifyclient (cee07e786, rainzm) Add BatchSendMessage for feishu SDK (aa364a3d7, rainzm) add GetCapacityUsedMB for ICloudStorage (116d347c8, rainzm) Add method ‘Sku’ to CandidatePropertyGetter (d086161a6, rainzm) add WithCtx version to notifyclient function (8eba2c369, rainzm) add GetSchedtags for ICloudHost (0d05f9ee1, rainzm) log err when sending notification via notifyclient (2d5055c90, rainzm) inherit lang from ctx fro Task (8da2d5ff7, rainzm) Add IResultHelper (39fed764f, rainzm) notify user when failing to change config (0308ce288, rainzm) esxi: support fetchVM form datacenter (6b340264e, rainzm) esxi: add GetSchedtags implementation for esxi.SHost (857e76ab7, rainzm) esxi: correctly judge whether inet is nil (65ca3ace7, rainzm) esxicli: better vm operator (3f8f9e6c5, rainzm) notify: replace VerifiedContactTypes with VerifiedInfos in ReceiverDetails (8c6fdd110, rainzm) notify: Support trigger-verify for feishu, dingtalk and workwx (beee6e2c9, rainzm) notify: Add VerifiedNote for SSubContact (60412cf7e, rainzm) notify: break down error from UseridByMobile (90b84e995, rainzm) notify: sort the returned contact type array (f24950da9, rainzm) notify: Allow use topic to filter notification (ff52e0044, rainzm) notify: Add TNotifyChannel const of robot (7c6e053a0, rainzm) region: sync capacityUsed for storage after deploying or deleting guest (9ded6e43f, rainzm) region: change fomat ‘id’ to ‘name(id)’ in scheduledtasks' log (7b67554dc, rainzm) region: replace 虚拟机 with 主机 or 云主机 (c542249c7, rainzm) region: divide notify templates into Chinese and English versions (5a10f9dd9, rainzm) region: sync schedtags when syncing host (679ccb825, rainzm) region: sync CapacityUsed for Storage (547b2960b, rainzm) scheduler: Change the action for guests with backup and instanceGroup (fa0450b45, rainzm)  Glance (1)  check min disk size on update (00265fedd, wanyaoqi)  Guests (1)  guests with vpc nics are available for eip association (5c7ae23d8, Yousong Zhou)  Host (1)  fix rbd storage cache iso image (6a7cf0608, wanyaoqi)  Hostinfo (1)  try create network add is_on_premise (#7707) (607e3d8fd, wanyaoqi)  Hotfix (1)  vpc change owners with wire (5e721b929, Qiu Jian)  Httperrors (3)  HTTPError: use Error type (918dce80e, Yousong Zhou) add Error type (12899ab00, Yousong Zhou) use existing details if id is not present (#7711) (bde5e1b96, Yousong Zhou)  Httputils (1)  preserve format val types (4fb45676a, Yousong Zhou)  I18n (2)  add ITable (8164854fd, Yousong Zhou) move out from httperrors pkg (8dc179676, Yousong Zhou)  Iproute2 (1)  address: make Exact idempotent (05b72a9d0, Yousong Zhou)  Keystone (2)  passwords: SetModelManager (61cd611aa, Yousong Zhou) config: SetModelManager for whitelisted config (6c9e8f194, Yousong Zhou)  Lb (1)  include cluster name info in details (7add76415, Yousong Zhou)  Locales (3)  monitor: add translations (70fd9dfb7, Yousong Zhou) update translation (a54d0e592, Yousong Zhou) update translations (c4f4e7d30, Yousong Zhou)  Logclient (5)  i18n: en for const (6bff7caf9, Yousong Zhou) i18n: cn for const (27d0452fa, Yousong Zhou) convert const val to use latin chars (b1a332fec, Yousong Zhou) move ws list to separate file (bc066edc0, Yousong Zhou) separate lines (0b878134b, Yousong Zhou)  Logger (2)  actionlog: add GetI18N (3f7155c39, Yousong Zhou) actionlog: remove redundant comments (b13d0f603, Yousong Zhou)  Mcclient (1)  options: loadbalanceragents: yum as the default deploy method (24379db85, Yousong Zhou)  Monitor (4)  error fmt (572e45968, Yousong Zhou) suggestsysalert add ignore action (7aa3c9dde, Zexi Li) reduce subscription mysql usage (cdf33052c, Zexi Li) support suggest rule alert config and add snapshot_unused driver (7a9662c6f, Zexi Li)  Opslog (1)  move const to separate file (986031fc9, Yousong Zhou)  Opt (1)  scheduler: better sort for hosts when selectHost (ed4847dff, rainzm)  Optimized (2)  create eip params (becf92f6b, Qu Xuan) 支持ip和端口过滤安全组 (594f05d94, Qu Xuan)  Others (178)  fix:允许cname record通过policy多值 (9b7fbf33b, lvyangyang) aliyun public elb region fix (7a61d77b0, TangBin) bugfix commalert 3.4 (e87d2c0e8, zhaoxiangchun) bugfix:commonalert (a9c95cf36, zhaoxiangchun) aliyun public elb brand fix (540f4631f, TangBin) fix:forbid top level public domain name (fba8349e8, lvyangyang) mcclient modules: fix k8s fed rolebinding joint wrong resource manager (1a1d7c70a, Zexi Li) bugfix :esxi 多机器环境下拉取监控超时 (b88c114ba, zhaoxiangchun) aliyun create public lb fix (3ddce26aa, TangBin) fix:/dnsrecordset重复检查,dnszonevpc数量 (d94e55501, lvyangyang) increase rbd check timeout (adbe292f4, wanyaoqi) umount nfs on detach storage (61cc18010, wanyaoqi) fix:(region) correct syncSchedtags (4586c82cb, rainzm) huawei client request add throttling control (77865d894, TangBin) huawei elb get params log (454aabca7, TangBin) qcloud elb create listener fix (c6d214991, TangBin) huawei snapshot delete fix (ebee60810, TangBin) set stagefail on clean fail (7e2e7ade1, wanyaoqi) wait deleted (d90b661f7, lvyangyang) commonalert bugfix 3.4 (365e555c9, zhaoxiangchun) bugfix:esxi collect metric (a7198dc21, zhaoxiangchun) fix esxi-agent dockerfile typo (78fc35d3a, Zhang Dongliang) support mutli params (8102e7ed0, wanyaoqi) make with ARCH argument (384e86664, Zhang Dongliang) support search ip (884e82a15, wanyaoqi) regional network filter bugfix (0bba6e63f, TangBin) ctyun sync secgroup fix \u0026 cloudaccount delete fix (0acbfc89f, TangBin) common alert bugfix/3.4 (477d36f82, zhaoxiangchun) fix host deployer base image (33fb33a58, wanyaoqi) ctyun add region cn-bj1 (12bd187ec, TangBin) fix set host image cache properties (5593b88e9, wanyaoqi) fix update image status after save failed (785da09d6, wanyaoqi) host sync storage size (585ef5833, wanyaoqi) dup record process (4487867f5, lvyangyang) suggest rule modify: (9b12c675d, zhaoxiangchun) bugfix vmware monitor (2a680f99a, zhaoxiangchun) dns access (70297e313, lvyangyang) commonalet bugfix: (1a323667a, zhaoxiangchun) Add mock test for genericScheudler.Schedule (89980b626, rainzm) fix host error output (ada6c870d, wanyaoqi) isolated devices info reenterable (78f9db1ba, wanyaoqi) guest short desc add backup host id (8c4941ea7, wanyaoqi) fix get ubuntu version (d22676906, wanyaoqi) optimized cachedimages sync (7095ea8f8, Qu Xuan) pex register add optional column mac_access (24af17757, TangBin) create classic vpc fix (612ad9286, TangBin) Automated cherry pick of #7714: Feature \u0026 Fix for Notify (#7715) (eb9d794fa, Rain Zheng) update host status to unknown on host offline (20b949091, wanyaoqi) vmware disk support deploy lvm partition (43ce3b545, wanyaoqi) listfilter by alert_id (d95e64e59, zhaoxiangchun) alert record bugfix (06bd735f0, zhaoxiangchun) Automated cherry pick of #7712: httperrors: support setting lang with X-Yunion-Lang (#7713) (77a5c1ff8, Yousong Zhou) Automated cherry pick of #7692: feat(notify): Support update for notify config (#7693) (b03c8ce50, Rain Zheng) Automated cherry pick of #7661: fix(host-deployer): Exit correctly after mounting (#7672) (c914dafa7, Rain Zheng) fix host get guests (#7683) (4af4bcb96, wanyaoqi) fix get storage capacity on init' (#7687) (b85fb9829, wanyaoqi) snapshot list by guest (438c1ced5, wanyaoqi) commonalert bugfix (be5bf11eb, zhaoxiangchun) 统一监控查询面板保存 (6cea2883a, zhaoxiangchun) update host deployer base image version (53a6c40a8, wanyaoqi) baremetal colloct isolated devices info (#7658) (eee193165, wanyaoqi) fix mount fetcher fs (#7657) (8e83ab476, wanyaoqi) remove backup metadata on delete backup (#7654) (b97764133, wanyaoqi) eip \u0026 vpc manager match fix (132c58379, TangBin) fix build baremetal agent image (#7647) (557240155, wanyaoqi) metric describe 接口 (#7381) (dd8a07f36, zhaoxiangchun) fix github action workflow (#7635) (c1cf72899, wanyaoqi) separate guest doamin and dns (#7621) (61214f2e2, wanyaoqi) fix gpfs check mountpoint (#7623) (2904364de, wanyaoqi) Refactor for Notify (#7611) (853153c73, Rain Zheng) docker build support buildx and arm architecture (6b944626b, wanyaoqi) Feature/yousong text (#7487) (c2bca8ab3, Yousong Zhou) feature:host image fetcher fs (#7606) (a4b27a3cf, wanyaoqi) fix:wrap params (#7605) (46683b210, lvyangyang) alter table guestcdrom_tbl modify column size bigint (#7593) (dcf8183c3, wanyaoqi) only notify watched resource (#7592) (86253534d, Zexi Li) Bugfix/yousong vpc ext (#7585) (6dc007425, Yousong Zhou) Bugfix/yousong hostman routes (#7563) (e01f0ce2a, Yousong Zhou) fix usage not set prefix (#7568) (29c0e5384, wanyaoqi) support diable usb kbd (df9e47cbf, wanyaoqi) fix usage get storage capbility (#7527) (aa483edeb, wanyaoqi) fix mount xfs (cdaff2126, wanyaoqi) usage report reserved memory (#7525) (54ff56c04, wanyaoqi) set disk status on disk detached (#7517) (cad24ac69, wanyaoqi) nodealert bugfix： (#7512) (b63d9b55d, zhaoxiangchun) modify telegraf reporting tag (#7489) (22cd20c3f, zhaoxiangchun) add image upload\u0026 s3 upload api (#7514) (280039ab3, tb365) Hotfix/qj password login wrong idp (#7511) (b0505ba5f, Jian Qiu) fix host info get sshkey (#7484) (716f647f7, wanyaoqi) fix reauth condition on influxdb not found (#7456) (a962db0e9, wanyaoqi) fix cache non lvm disks (#7459) (2cdfed2ca, wanyaoqi) aws elb listener\u0026rule name too long fix (ff4840b46, tangbin) fix redis reset account password action log (e59e40d3b, tangbin) loadblancer listener modify name fix (bd3d581f4, tangbin) fix deploy admin auth key (9bc1cfe6f, wanyaoqi) Feature/yousong lblis names (#7395) (d95584b11, Yousong Zhou) fix host register info (#7401) (ae0bd556c, wanyaoqi) fix panic on storage failed get host (#7390) (d6fdf3361, wanyaoqi) make rpc handle exportable (#7367) (9acc8c629, tb365) adjust schedule resource condition width (59e4f7d61, Zexi Li) Add more tips for make image cmd (51cb278ae, Shaohui Liu) fix schedtag list output (051205066, wanyaoqi) Add metadata for GuestTempalte details (49e4e31da, rainzm) Add network info when list scalingGroup details (45a3e0805, rainzm) 修改报警消息模版： (5e0cb9319, zhaoxiangchun) go fmt (1583da57f, tangbin) go fmt (d45ee2c0e, tangbin) host upload template check (e660e25be, tangbin) huawei fetch regions\u0026projects fix (0f2453189, tangbin) 修复统一报警bug (921472455, zhaoxiangchun) rename vgname centos (399488991, wanyaoqi) fix clone clean pending usage (31c0d5a42, wanyaoqi) capabilites add available host count (64935a465, wanyaoqi) fix snapshot clean pending usage (cd5d31763, wanyaoqi) Remove sudo before the docker cmd (96bb34ea0, Shaohui Liu)   add precheck for perform action (a677f2435, wanyaoqi)   format fix (d10e15ed9, tangbin) fix empty else (d5591001c, tangbin) fix host import (3ff402f4b, tangbin) fix huawei delete resource (94bb91716, tangbin) fix huawei elb disable healthcheck (7fcc85f85, tangbin) lb sync project fix (6d9a55638, tangbin) add more log (edc10b14d, tangbin) apigateway host imports data validate (cea012162, tangbin) update vendor (5d4efcc63, Qiu Jian) fix GetOrCreateVpcForClassicNetwork (a755d0d37, tangbin) 修复监控报警规则删除的问题 (bd80fa889, zhaoxiangchun) fix error output (7f8be7d4b, wanyaoqi) huawei eip delete fix (081a3eabd, tangbin) acl delete condition fix (a74853db7, tangbin) fix server sync status (41fcf38cf, wanyaoqi) sync classic redis fix (b9a45c8bb, tangbin) add params auto_migrate_on_host_down (a39b0c87e, wanyaoqi) misc ha guest fix (3e759a3a4, wanyaoqi) fix list guests on host (f4ee70c0b, wanyaoqi) cloudprovider usable filter with zone (22d000e73, tangbin) disable procutils print error info (66064a4c4, wanyaoqi) fix guest template health check (014540e4d, rainzm) fix:修复路由表映射到public网络的问题 (2d12d7898, lvyangyang) user batch register bugfix (c1e49d02c, tangbin) 新增优化建议： (7cd1f1de5, zhaoxiangchun) fix format (f24fd4aa1, bistuzx@163.com) add cost alert modules (f5a2215a9, bistuzx@163.com) vendor update: update jsonutils (2028dbabb, wanyaoqi)   fix local storage init local man (e2043d6bc, wanyaoqi)   misc fix (04dfa4879, wanyaoqi) add:region/esxi 迁移接口 (c75b63eb7, lvyangyang) fix set storage info bind mount (e2ad0101e, wanyaoqi) update vendor (47bb16e51, tangbin) Update docker image onecloud-base and its references (81784aea3, rainzm) suggestAlert cost:modify the request param to meter (a0dc33266, zhaoxiangchun) 增加influxdb的tag 的一些filter (98d2e489e, zhaoxiangchun) update vendor (00d7ce83e, Qiu Jian) remove obsolete codes from apigateway (27b3fb5d5, Qiu Jian) itsm climc (36408ab4a, zhaoxiangchun) add mcclient cloudaccount gcp\u0026huawei bucket (6e9718d4e, bistuzx@163.com) Update Dockerfile.ansibleserver (f909a1d2c, rainzm) 优化建议中增加费用统计接口 (2fde31764, zhaoxiangchun) update vendor (182c96a16, Qiu Jian) add meter modules amount_estimation\u0026daily_bill (70c07d4a8, 张旭) bind mount nfs storage path (322117f6d, wanyaoqi) cluster_d required-\u003eoptional (63babfed8, tangbin) fix the bug introduced in #6643 (17721c4d5, rainzm) update jsonutils (ae3827f9a, rainzm) copyright api update (60c8c25c0, tangbin) fix deploy backup server order (1d59ceb5d, wanyaoqi) keep input mem and cpu on create from instance snapshot (dae606d28, wanyaoqi) .travis.yml: use go1.14 (8e9c58799, Yousong Zhou) .github: workflows: use go1.14 (1152c3c24, Yousong Zhou) .github: bump backport hint to release/3.2 (2463396ef, Yousong Zhou)   add server pending deleted for host details (38a05c490, wanyaoqi)   include system usage (fabd3577a, wanyaoqi) server name enable upper case (75588d00a, wanyaoqi) report host stat (4e6512040, wanyaoqi) disable dhclient (c4d5da440, wanyaoqi) add known sp metadata xml (c30262241, Qiu Jian) fix get storage capabilities with null field (854bf59f8, wanyaoqi) sp support (3b32f0a4d, Qiu Jian)  README (1)  update architecture picture (bb540ff10, Zexi Li)  Region (13)  host specs replace space char to ‘_’ (3b0ba2caa, Zexi Li) fix query object by spec not include details (a05f50dbf, Zexi Li) fix schedtag joint resource master/slave field wrong order (1b6ac9bc4, Zexi Li) fix network schedtag not cleanup when network deleted (1d7ffc704, Zexi Li) validate network auto alloc update data (#7559) (95130f8ef, Zexi Li) schedtag list support resource_types (48d982b39, Zexi Li) lbagents: skip tls check for default influxdb endpoint url (e5dd2409d, Yousong Zhou) lbagents: default vrrp vrid, priority (495a2d995, Yousong Zhou) lbagents: use local params var (4596f3f11, Yousong Zhou) lbagents: set some vrrp params to values of peers (746cb8679, Yousong Zhou) lbagents: make vrrp interface default to eth0 (b0c39bfad, Yousong Zhou) lbagents: turn off guest src check (afac0604d, Yousong Zhou) loadbalanceragents: yum as the default method (7926e59d7, Yousong Zhou)  Scheduler (5)  fix fillter isolated device (8e0f47aa0, wanyaoqi) ignore network type when specified (a1c7a291d, Zexi Li) refactor network predicate (#7553) (7a08a60db, Zexi Li) fix network auto alloc logic (6f2ddbd3a, Zexi Li) fix storage filter duplicate error message (0957fee3d, Zexi Li)  Specs (1)  fix specKey url not escape (a4d7b2b4b, Zexi Li)  Treewide (3)  avoid variable fmt str (822fae009, Yousong Zhou) fmt error (23b9991a7, Yousong Zhou) DeleteFailReason as an object with translated details (f1995a46d, Yousong Zhou)  Vendor (1)  update yunion.io/x/sqlchemy (4e16eaf21, Yousong Zhou)  Vpcagent (4)  guard against foul eip records (f0faf07b6, Yousong Zhou) respect guest src check settings (#7678) (19ba4b975, Yousong Zhou) ignore network without wire ids (#7629) (500e2edad, Yousong Zhou) ClaimVpcGuestDnsRecords: guard against pending_deleted guests (20f36afdc, Yousong Zhou)  Webconsole (2)  fix defer order to release zombie process (fa2d8723a, wanyaoqi) fix old session make new session closed (642d69427, Zexi Li)   notify-plugins 仓库地址: https://github.com/yunionio/notify-plugins\n25 commits to notify-plugins - v3.4.0 since this release.\nBug Fixes (4)  common: correct error judgment in BatchSend (4c76dd8, rainzm) dingtalk: return correct value in getUseridByMobile (4241c3d, rainzm) robot: Correct err value of ValidateConfig (5e2b642, rainzm) workwx: Incorrect variable use for ok (05eabba, rainzm)  Features (5)  break down error from UserIdByMobile (a9ff6b9, rainzm) Support workwx (52b50d2, rainzm) notify: Add BatchSend for websocket (0eaa49a, rainzm) notify: Add common function to batch send (63924dc, rainzm) robot: Add BatchSend (b70b205, rainzm)  Others (15)  buildx for notifyplugins (e6a246b, Zhang Dongliang) makefile 去掉 sudo; make all bins (65d52fe, Zhang Dongliang) docker buildx for notify plugins (8f5747f, Zhang Dongliang) update vendor (8df6b86, rainzm) change email const name (0531db3, rainzm) fix batch send of workwx (cab236d, rainzm) update vendor (c3b8d64, rainzm) Support batch send for eamil and smsaliyun (8ff79b6, rainzm) Support sending a batch of workwx messages (d33068e, rainzm) Support markdown when sending single user dingtalk message (6bec1bd, rainzm) Update vendor (ec2bfad, rainzm) Support batch send (80397bb, rainzm) change ‘corp_secret’ to ‘secret’ (6801a1e, rainzm) remove default config file (061987a, rainzm) Add workwx-robot for webhook (c09687f, rainzm)  Test (1)  update vendor for go-workwx (62b2a41, rainzm)   ocadm 仓库地址: https://github.com/yunionio/ocadm\n17 commits to ocadm - v3.4.0 since this release.\nAutoupdate (1)  clear host tag (611c2c4, Zexi Li)  Others (16)  clean info from from autoupdate component when update (48d9fe4, Zexi Li) 更新 3.4 的 makefile 版本变量 (80c6081, Zhang Dongliang) make mod (f4f0696, wanyaoqi) meter baremetalagent esxiagent use longhorn (6c6379e, wanyaoqi) update vendor for v3.2: (e3fa33e, Zexi Li) update onecloud-operator vendor (752e2d2, Zexi Li) ocadm create cluster, 延时等待容错 (2441304, Zhang Dongliang) 高可用部署主备选取应将kube-apiserver是否工作考虑进去 (d8f027f, Zhang Dongliang) fix longhron template (b6afd3b, wanyaoqi) 修复 keepalived master state bug (fa22d63, Zhang Dongliang) longhorn deploy misc fix (c9ef80b, wanyaoqi) update vendor (c9f7d19, Zexi Li) update vendor for master (657f5e9, Zhang Dongliang) fix create region zone where upgrade from v2 (284f65a, wanyaoqi) ocadm 接入 keepalived，支持高可用 (a8b6713, Zhang Dongliang) update DefaultCalicoVersion to 3.12.1 (6c1fc6d, Zhang Dongliang)   onecloud-operator 仓库地址: https://github.com/yunionio/onecloud-operator\n41 commits to onecloud-operator - v3.4.0 since this release.\nBug Fixes (3)  apigateway totp should default on (d14c152, Qiu Jian) member policy requires member role (323b403, Qiu Jian) check before doing perform_public for roles and policies (3ea8576, Qiu Jian)  Feature (1)  add cloudid service (4066231, Qu Xuan)  Notify (1)  remove pvc dependence (f1e64f3, wanyaoqi)  Others (33)  pod affinity by storage class (0a85313, wanyaoqi) BusyBox upgrade ,modify cloudmon timeout arg (724b1ec, zhaoxiangchun) host image spec fix (1ab0562, wanyaoqi) add flag check is failed etcd pods need delete (965c589, wanyaoqi) push 镜像后,拉回本地 (2ad7c37, Zhang Dongliang) buildx for onecloud-operator (d81484e, Zhang Dongliang)   etcd clean failed state pods (b244a1e, wanyaoqi)   deployment with pvc not set node affinity (#256) (eddc03d, Zexi Li) replace cloud affinity preferred by required (#253) (9cf0d16, wanyaoqi) remove api/v1 from notify endpoint url (#252) (7b21b4b, Rain Zheng) etcd add cloud affinity (cb35295, wanyaoqi) statusfulset set cloud affinity: (ce4e78a, wanyaoqi) update host image default spec (3bedb0b, wanyaoqi) crontab timeout (0398ed0, zhaoxiangchun) fix baremetal storage size (d2f57ec, wanyaoqi) Add workwx and workwx-robot for notify (#240) (e6ee55d, Rain Zheng) cloudmon deployment increate cloudaccount monitor config: (#241) (699ec4a, zhaoxiangchun) itsm 开启https (#242) (0e9f304, zhaoxiangchun) remove etcd-operator dependcies (#235) (8c022f3, Zexi Li) 调整统一监控 系统报警规则的注入配置 (752e28c, zhaoxiangchun) fix etcd member count (500ddc5, wanyaoqi) recreate pods on pvc not local path (64cc832, wanyaoqi) 修复系统报警规则重复创建的问题 (32e05ea, zhaoxiangchun) fix set pvc name (ddf338e, wanyaoqi) fix glance pvc name (41d9deb, wanyaoqi) update vendor (e6922a7, Zexi Li) cloudmon deployment increase [rds redis oss] monitor information collectiona (b9c27f2, zhaoxiangchun) add check if cronjob exist (51ce335, wanyaoqi) service etcd client disable unready client (0b90038, wanyaoqi) host image component set default toleration (b1083b9, wanyaoqi) cloudmon as deployment (3a8ddec, wanyaoqi) check etcd dbsize, do compact and defrag (e18c1a3, wanyaoqi) system alert init info create in operator (23add7b, zhaoxiangchun)  Web (1)  add dashboard overview (#243) (b99abd0, Zexi Li)  Yunionagent (2)  remove onecloud keyword (aba6c28, Zexi Li) update content (29b149c, Zexi Li)   onecloud-service-operator 仓库地址: https://github.com/yunionio/onecloud-service-operator\n13 commits to onecloud-service-operator - v3.4.0 since this release.\nBug Fixes (4)  retry after a while when dealErr (89dbcc9, rainzm) the error judgment in dealErr (7695a89, rainzm) vmPendingAfter’s unit should be second (00fb031, rainzm) Update status and return when resource is invalid (5d604ab, rainzm)  Code Refactoring (1)  Abstract the same logic and abstract interface (afb74a5, rainzm)  Features (1)  add manager-pro section in Makefile (4a5e4ba, rainzm)  Others (7)  docker buildx for onecloud-service-operator (32b22c2, Zhang Dongliang) fix the usage of vmPendingAfter (f6d2d87, rainzm) remove regionid for endpoint (678a87d, rainzm) Build failed for some small bugs by following the README.md (987363c, Shaohui Liu) Add Endpoint document (d5cb366, rainzm) Add CRD Endpoint (077a994, rainzm) support yaml string (cbd3a0a, rainzm)   sdnagent 仓库地址: https://github.com/yunionio/sdnagent\n13 commits to sdnagent - v3.4.0 since this release.\nAgent (1)  ovn: no error log if the mapped bridge does not exist (a9ce756, Yousong Zhou)  Build (7)  eipgw: vrrp track script as monitor (32941bd, Yousong Zhou) systemd: add keepalived reload command (271c0e2, Yousong Zhou) eipgw: use 8 byte char for auth_pass (7936112, Yousong Zhou) eipgw: let keepalived use detail log (6331131, Yousong Zhou) add ansible playbook README (ec48e2d, Yousong Zhou) bump to alpine-build:1.0-2 (9cffe97, Yousong Zhou) separate artifact and docker image build (29e2d68, Yousong Zhou)  Others (2)  pull image for buildx (cc574b6, Zhang Dongliang) docker buildx for sdnagent (c86cc8a, Zhang Dongliang)  Sdnagent (1)  be cooperative (d73fbef, Yousong Zhou)  Vendor (2)  bump yunion.io/x/onecloud to current tip of release/3.3 (b599b01, Yousong Zhou) bump 3.3 (#105) (6e67604, Yousong Zhou)  ","excerpt":"发布时间 2020-09-30 16:43:35\n onecloud 仓库地址: …","ref":"/v3.6/zh/docs/changelog/release-3.4/3-4-0/","title":"v3.4.0"},{"body":"Release time: 2020-12-09 17:03:16\n onecloud Repository: https://github.com/yunionio/onecloud\n10 commits to onecloud - v3.3.8 since this release.\nBug Fixes (7)  aws secgroup out rule is deny any (6ef75538e, Qu Xuan) avoid panic (dc8c341a1, Qu Xuan) renew rds (a2391a50c, Qu Xuan) host: make sure it won’t match vpc guests by accident (1ee1493d6, Yousong Zhou) monitor: modify monitor serviceType in StartService() (379fbf458, zhaoxiangchun) region: change_ipaddr: retain eip_id on detach and attach (841f5aadc, Yousong Zhou) vpcagent: models: guestnetworks: accomodate change_ipaddr (335f3c6b1, Yousong Zhou)  Features (1)  cloudcommon: db: jointbase: add list:“user” for RowId (b88c079db, Yousong Zhou)  Scheduler (1)  ignore non running guests only exclude ready status (ba4c506b5, Zexi Li)  Vendor (1)  update yunion.io/x/jsonutils (d6e37aa6b, Yousong Zhou)   notify-plugins Repository: https://github.com/yunionio/notify-plugins\n1 commits to notify-plugins - v3.3.8 since this release.\nFeatures (1)  robot: support multi WebhookPrefixs (bae94c7, rainzm)   sdnagent Repository: https://github.com/yunionio/sdnagent\n8 commits to sdnagent - v3.3.8 since this release.\nBug Fixes (1)  hostconfig: fix watching hostconfig (22c758c, Yousong Zhou)  Build (1)  eipgw: track to ensure stop state as well (e98b195, Yousong Zhou)  Flowsource (4)  relax constraint when mac check on and ip check off (f68ca1a, Yousong Zhou) reword ref comments on allow_switch_vms (711050d, Yousong Zhou) reword ref comments on allow_router_vms (2b5eb6d, Yousong Zhou) remove now unused code for dev (1fc7aba, Yousong Zhou)  Others (1)  .circleci: bump go to 1.14 (f5adb38, Yousong Zhou)  Vendor (1)  bump yunion.io/x/onecloud to current tip of release/3.3 (6747d8f, Yousong Zhou)  ","excerpt":"Release time: 2020-12-09 17:03:16\n onecloud Repository: …","ref":"/v3.6/en/docs/changelog/release-3.3/3-3-8/","title":"v3.3.8"},{"body":"发布时间 2020-12-09 17:03:16\n onecloud 仓库地址: https://github.com/yunionio/onecloud\n10 commits to onecloud - v3.3.8 since this release.\nBug Fixes (7)  aws secgroup out rule is deny any (6ef75538e, Qu Xuan) avoid panic (dc8c341a1, Qu Xuan) renew rds (a2391a50c, Qu Xuan) host: make sure it won’t match vpc guests by accident (1ee1493d6, Yousong Zhou) monitor: modify monitor serviceType in StartService() (379fbf458, zhaoxiangchun) region: change_ipaddr: retain eip_id on detach and attach (841f5aadc, Yousong Zhou) vpcagent: models: guestnetworks: accomodate change_ipaddr (335f3c6b1, Yousong Zhou)  Features (1)  cloudcommon: db: jointbase: add list:“user” for RowId (b88c079db, Yousong Zhou)  Scheduler (1)  ignore non running guests only exclude ready status (ba4c506b5, Zexi Li)  Vendor (1)  update yunion.io/x/jsonutils (d6e37aa6b, Yousong Zhou)   notify-plugins 仓库地址: https://github.com/yunionio/notify-plugins\n1 commits to notify-plugins - v3.3.8 since this release.\nFeatures (1)  robot: support multi WebhookPrefixs (bae94c7, rainzm)   sdnagent 仓库地址: https://github.com/yunionio/sdnagent\n8 commits to sdnagent - v3.3.8 since this release.\nBug Fixes (1)  hostconfig: fix watching hostconfig (22c758c, Yousong Zhou)  Build (1)  eipgw: track to ensure stop state as well (e98b195, Yousong Zhou)  Flowsource (4)  relax constraint when mac check on and ip check off (f68ca1a, Yousong Zhou) reword ref comments on allow_switch_vms (711050d, Yousong Zhou) reword ref comments on allow_router_vms (2b5eb6d, Yousong Zhou) remove now unused code for dev (1fc7aba, Yousong Zhou)  Others (1)  .circleci: bump go to 1.14 (f5adb38, Yousong Zhou)  Vendor (1)  bump yunion.io/x/onecloud to current tip of release/3.3 (6747d8f, Yousong Zhou)  ","excerpt":"发布时间 2020-12-09 17:03:16\n onecloud 仓库地址: …","ref":"/v3.6/zh/docs/changelog/release-3.3/3-3-8/","title":"v3.3.8"},{"body":"Release time: 2020-11-04 11:44:25\n onecloud Repository: https://github.com/yunionio/onecloud\n29 commits to onecloud - v3.3.7 since this release.\nBug Fixes (21)  missing authenticate action log for user web login (d46eadf6e, Qiu Jian) use new api (d5f295d1e, Qu Xuan) support filter rds sku by provider (28782b05a, Qu Xuan) set secgroup status (1c46b2273, Qu Xuan) avoid sync project panic (167ade114, Qu Xuan) avoid delete public ip when sync eip list (7f5f33c5f, Qu Xuan) 避免并发同步安全组导致规则混乱 (699b7351b, Qu Xuan) 避免冲掉设置的到期释放时间 (a106c9431, Qu Xuan) get images distinct field (f68995cc6, Zexi Li) cancel pending-delete should increase resource quota usages (52cc6b7d2, Qiu Jian) missing authenticate action log for user web login (a6058a2c9, Qiu Jian) 新增google存储类型 (59ceeb3a2, Qu Xuan) do not lock guest after lock eip, to prevent possible dead lock (c545ea1df, Qiu Jian) use correct worker (7e145bf82, Qu Xuan) add rds cpu and memory usage (9a888f507, Qu Xuan) 优化安全组规则同步 (3dd3d808d, Qu Xuan) esxi: resize root disk after cloning vm (82826037b, rainzm) esxi: no callback in uploadHandler (cfea1d524, rainzm) esxi: use correct device index (14803b64d, rainzm) esxi: filter vmdk item in lease.info (0e9751c48, rainzm) region: compute binded disk count when deleting snapshotpolicy (0619b5445, rainzm)  Bugfix (1)  qcloud pull metric (bbb48fcb9, zhaoxiangchun)  Features (2)  use details data to cover obj data in FetchCustomizeColumns (cea274e18, rainzm) esxi: do not specify portkey in NewVNIC (94e29fe6d, rainzm)  Lockman (1)  test: add prefix setting (b57099f07, Yousong Zhou)  Monitor (1)  set default influxdb datasource by endpoint type (5d873ddb2, Zexi Li)  Others (2)  fix fetch customize columns (33196d57c, wanyaoqi) .circleci: build: make with parallel level 2 (cd37a3c1c, Yousong Zhou)  Stringutils2 (1)  add RemoveUtf8Strings func (2bc2e576b, Zexi Li)   onecloud-operator Repository: https://github.com/yunionio/onecloud-operator\n1 commits to onecloud-operator - v3.3.7 since this release.\nOthers (1)  set image default policy to if not present (bf5e0ec, Zexi Li)  ","excerpt":"Release time: 2020-11-04 11:44:25\n onecloud Repository: …","ref":"/v3.6/en/docs/changelog/release-3.3/3-3-7/","title":"v3.3.7"},{"body":"发布时间 2020-11-04 11:44:25\n onecloud 仓库地址: https://github.com/yunionio/onecloud\n29 commits to onecloud - v3.3.7 since this release.\nBug Fixes (21)  missing authenticate action log for user web login (d46eadf6e, Qiu Jian) use new api (d5f295d1e, Qu Xuan) support filter rds sku by provider (28782b05a, Qu Xuan) set secgroup status (1c46b2273, Qu Xuan) avoid sync project panic (167ade114, Qu Xuan) avoid delete public ip when sync eip list (7f5f33c5f, Qu Xuan) 避免并发同步安全组导致规则混乱 (699b7351b, Qu Xuan) 避免冲掉设置的到期释放时间 (a106c9431, Qu Xuan) get images distinct field (f68995cc6, Zexi Li) cancel pending-delete should increase resource quota usages (52cc6b7d2, Qiu Jian) missing authenticate action log for user web login (a6058a2c9, Qiu Jian) 新增google存储类型 (59ceeb3a2, Qu Xuan) do not lock guest after lock eip, to prevent possible dead lock (c545ea1df, Qiu Jian) use correct worker (7e145bf82, Qu Xuan) add rds cpu and memory usage (9a888f507, Qu Xuan) 优化安全组规则同步 (3dd3d808d, Qu Xuan) esxi: resize root disk after cloning vm (82826037b, rainzm) esxi: no callback in uploadHandler (cfea1d524, rainzm) esxi: use correct device index (14803b64d, rainzm) esxi: filter vmdk item in lease.info (0e9751c48, rainzm) region: compute binded disk count when deleting snapshotpolicy (0619b5445, rainzm)  Bugfix (1)  qcloud pull metric (bbb48fcb9, zhaoxiangchun)  Features (2)  use details data to cover obj data in FetchCustomizeColumns (cea274e18, rainzm) esxi: do not specify portkey in NewVNIC (94e29fe6d, rainzm)  Lockman (1)  test: add prefix setting (b57099f07, Yousong Zhou)  Monitor (1)  set default influxdb datasource by endpoint type (5d873ddb2, Zexi Li)  Others (2)  fix fetch customize columns (33196d57c, wanyaoqi) .circleci: build: make with parallel level 2 (cd37a3c1c, Yousong Zhou)  Stringutils2 (1)  add RemoveUtf8Strings func (2bc2e576b, Zexi Li)   onecloud-operator 仓库地址: https://github.com/yunionio/onecloud-operator\n1 commits to onecloud-operator - v3.3.7 since this release.\nOthers (1)  set image default policy to if not present (bf5e0ec, Zexi Li)  ","excerpt":"发布时间 2020-11-04 11:44:25\n onecloud 仓库地址: …","ref":"/v3.6/zh/docs/changelog/release-3.3/3-3-7/","title":"v3.3.7"},{"body":"Release time: 2020-10-14 13:09:19\n onecloud Repository: https://github.com/yunionio/onecloud\n67 commits to onecloud - v3.3.6 since this release.\nBaremetal (1)  fix pxe filter network by guest_dhcp (c1b5fa1da, Zexi Li)  Bug Fixes (35)  避免腾讯云同步虚拟机ip异常 (b59696a69, ioito) 支持带宽包用户 (1bdce8f88, Qu Xuan) trans google new region name (53522134d, Qu Xuan) qcloud eip with bandwidth attr (8e994e9fb, Qu Xuan) lock/unlock cleanup (d86534c16, Qiu Jian) bucket object cnt fix (6d31c44ef, Qu Xuan) qcloud instance with max bandwidth (a0ab506a6, Qu Xuan) ldap sync not update user’s phone and email (89669c8cb, Qiu Jian) validate secgroup purge condition (ae261321e, Qu Xuan) avoid slice out of bounds (d06e6927c, rainzm) keystone initialize data skip nil extra fields (91634336c, Qiu Jian) disable qcloud verifyAppId temporarily (8ebaf8bf2, Qiu Jian) qcloud set hostname for instance (324e7a7ee, Qu Xuan) add esxicli vmrc/webmks command (6a459ec41, Qiu Jian) server name auto index should start from 1 (75260982b, Qiu Jian) error code of external bucket not found error should be 404 (0fc0630c7, Qiu Jian) emulated wire not sync vpc shared info (6a6489f68, Qiu Jian) sync huawei bucket project info (3fbf7d033, Qu Xuan) avoid purge storages (4fbea0dca, Qu Xuan) avoid account delete failed (b5cdd84b5, ioito) sql err (95a5ec092, ioito) avoid compare err with cloudprovider.ErrNotFound direct (f16b8dbc0, ioito) get jnlp xml from dell idrac6,7,9 (f27a461f0, Qiu Jian) avoid serial vm creation (05ba352c8, ioito) 仅在可用区故障时可强制挂载磁盘 (f7f0a7e30, ioito) avoid account delete failed (812f50f6a, ioito) 支持自动根据云上项目修改本地项目名称 (ecade9a3d, Qu Xuan) esxi: use system disk of template only when cloning vm (fa70835a8, rainzm) esxi: check nil value when NewVirtualMachine (ed29844d4, rainzm) esxi: check whether some fields of vm are nil (71a6b6d14, rainzm) esxi: filter linkLocalAddress (18d19006d, rainzm) esxi: search template from whole vCenter (2ce77ac21, rainzm) region: fetch correct ownerId in PerformPrepareNets (912d7a697, rainzm) region: add GetSlaveFieldName for ScalingGroupGuest (dea65a5a1, rainzm) region: set ownerId as userCred when can’t FetchOwnerId (1a6f9bc71, rainzm)  Bugfix (1)  collect esxi metric timout (e5fb2771b, zhaoxiangchun)  Dns (1)  isMyDomain: match only strict subdomain of dns_domain (b6f5229f8, Yousong Zhou)  Eip (2)  NewEipForVMOnHost: add opslog (d81ed410d, Yousong Zhou) construct a pointer type (8e4f04ffa, Yousong Zhou)  Elasticips (2)  error when we have no usable eip network (15a1e7672, Yousong Zhou) fix calling FilterByOwner (c71a2e6ca, Yousong Zhou)  Optimized (1)  create eip params (2eaedeafa, Qu Xuan)  Others (19)  remove aws lbbg cache metedata (c01b06d0e, TangBin) separate guest doamin and dns (4bf21e32b, wanyaoqi) aliyun public elb region fix (acf49c449, TangBin) aliyun public elb brand fix (97acce2c2, TangBin) aliyun create public lb fix (62beb58fc, TangBin) increase rbd check timeout (36e089e63, wanyaoqi) umount nfs on detach storage (ea0ccfa0d, wanyaoqi) set stagefail on clean fail (80de477a8, wanyaoqi) huawei client request add throttling control (d69011079, TangBin) huawei elb get params log (42a24640a, TangBin) qcloud elb create listener fix (9d4d17f40, TangBin) huawei snapshot delete fix (999c315ce, TangBin) bugfix:esxi collect metric (fda1e1f0f, zhaoxiangchun) regional network filter bugfix (a16b7a2f3, TangBin) ctyun sync secgroup fix \u0026 cloudaccount delete fix (5bd27fed6, TangBin) ctyun add region cn-bj1 (93f16973d, TangBin) fix set host image cache properties (33a18462e, wanyaoqi) fix update image status after save failed (9aeb802af, wanyaoqi) bugfix vmware monitor (43add1b09, zhaoxiangchun)  Region (2)  fix schedtag joint resource master/slave field wrong order (98f65243d, Zexi Li) fix network schedtag not cleanup when network deleted (86189f981, Zexi Li)  Vpcagent (1)  ovn: increase dhcp lease, renew, rebind time (d097a7637, Yousong Zhou)  Webconsole (2)  ssh: add keyboard-interactive as an option (861bc56a9, Yousong Zhou) ssh: each argument on its own line (bba99aef9, Yousong Zhou)   onecloud-operator Repository: https://github.com/yunionio/onecloud-operator\n4 commits to onecloud-operator - v3.3.6 since this release.\nOthers (3)  not create notice (9085ed7, Zexi Li) pod affinity by storage class (a15f167, wanyaoqi) host image spec fix (9315dd7, wanyaoqi)  Regiondns (1)  configmap: quash trailing spaces (0261d6d, Yousong Zhou)  ","excerpt":"Release time: 2020-10-14 13:09:19\n onecloud Repository: …","ref":"/v3.6/en/docs/changelog/release-3.3/3-3-6/","title":"v3.3.6"},{"body":"发布时间 2020-10-14 13:09:19\n onecloud 仓库地址: https://github.com/yunionio/onecloud\n67 commits to onecloud - v3.3.6 since this release.\nBaremetal (1)  fix pxe filter network by guest_dhcp (c1b5fa1da, Zexi Li)  Bug Fixes (35)  避免腾讯云同步虚拟机ip异常 (b59696a69, ioito) 支持带宽包用户 (1bdce8f88, Qu Xuan) trans google new region name (53522134d, Qu Xuan) qcloud eip with bandwidth attr (8e994e9fb, Qu Xuan) lock/unlock cleanup (d86534c16, Qiu Jian) bucket object cnt fix (6d31c44ef, Qu Xuan) qcloud instance with max bandwidth (a0ab506a6, Qu Xuan) ldap sync not update user’s phone and email (89669c8cb, Qiu Jian) validate secgroup purge condition (ae261321e, Qu Xuan) avoid slice out of bounds (d06e6927c, rainzm) keystone initialize data skip nil extra fields (91634336c, Qiu Jian) disable qcloud verifyAppId temporarily (8ebaf8bf2, Qiu Jian) qcloud set hostname for instance (324e7a7ee, Qu Xuan) add esxicli vmrc/webmks command (6a459ec41, Qiu Jian) server name auto index should start from 1 (75260982b, Qiu Jian) error code of external bucket not found error should be 404 (0fc0630c7, Qiu Jian) emulated wire not sync vpc shared info (6a6489f68, Qiu Jian) sync huawei bucket project info (3fbf7d033, Qu Xuan) avoid purge storages (4fbea0dca, Qu Xuan) avoid account delete failed (b5cdd84b5, ioito) sql err (95a5ec092, ioito) avoid compare err with cloudprovider.ErrNotFound direct (f16b8dbc0, ioito) get jnlp xml from dell idrac6,7,9 (f27a461f0, Qiu Jian) avoid serial vm creation (05ba352c8, ioito) 仅在可用区故障时可强制挂载磁盘 (f7f0a7e30, ioito) avoid account delete failed (812f50f6a, ioito) 支持自动根据云上项目修改本地项目名称 (ecade9a3d, Qu Xuan) esxi: use system disk of template only when cloning vm (fa70835a8, rainzm) esxi: check nil value when NewVirtualMachine (ed29844d4, rainzm) esxi: check whether some fields of vm are nil (71a6b6d14, rainzm) esxi: filter linkLocalAddress (18d19006d, rainzm) esxi: search template from whole vCenter (2ce77ac21, rainzm) region: fetch correct ownerId in PerformPrepareNets (912d7a697, rainzm) region: add GetSlaveFieldName for ScalingGroupGuest (dea65a5a1, rainzm) region: set ownerId as userCred when can’t FetchOwnerId (1a6f9bc71, rainzm)  Bugfix (1)  collect esxi metric timout (e5fb2771b, zhaoxiangchun)  Dns (1)  isMyDomain: match only strict subdomain of dns_domain (b6f5229f8, Yousong Zhou)  Eip (2)  NewEipForVMOnHost: add opslog (d81ed410d, Yousong Zhou) construct a pointer type (8e4f04ffa, Yousong Zhou)  Elasticips (2)  error when we have no usable eip network (15a1e7672, Yousong Zhou) fix calling FilterByOwner (c71a2e6ca, Yousong Zhou)  Optimized (1)  create eip params (2eaedeafa, Qu Xuan)  Others (19)  remove aws lbbg cache metedata (c01b06d0e, TangBin) separate guest doamin and dns (4bf21e32b, wanyaoqi) aliyun public elb region fix (acf49c449, TangBin) aliyun public elb brand fix (97acce2c2, TangBin) aliyun create public lb fix (62beb58fc, TangBin) increase rbd check timeout (36e089e63, wanyaoqi) umount nfs on detach storage (ea0ccfa0d, wanyaoqi) set stagefail on clean fail (80de477a8, wanyaoqi) huawei client request add throttling control (d69011079, TangBin) huawei elb get params log (42a24640a, TangBin) qcloud elb create listener fix (9d4d17f40, TangBin) huawei snapshot delete fix (999c315ce, TangBin) bugfix:esxi collect metric (fda1e1f0f, zhaoxiangchun) regional network filter bugfix (a16b7a2f3, TangBin) ctyun sync secgroup fix \u0026 cloudaccount delete fix (5bd27fed6, TangBin) ctyun add region cn-bj1 (93f16973d, TangBin) fix set host image cache properties (33a18462e, wanyaoqi) fix update image status after save failed (9aeb802af, wanyaoqi) bugfix vmware monitor (43add1b09, zhaoxiangchun)  Region (2)  fix schedtag joint resource master/slave field wrong order (98f65243d, Zexi Li) fix network schedtag not cleanup when network deleted (86189f981, Zexi Li)  Vpcagent (1)  ovn: increase dhcp lease, renew, rebind time (d097a7637, Yousong Zhou)  Webconsole (2)  ssh: add keyboard-interactive as an option (861bc56a9, Yousong Zhou) ssh: each argument on its own line (bba99aef9, Yousong Zhou)   onecloud-operator 仓库地址: https://github.com/yunionio/onecloud-operator\n4 commits to onecloud-operator - v3.3.6 since this release.\nOthers (3)  not create notice (9085ed7, Zexi Li) pod affinity by storage class (a15f167, wanyaoqi) host image spec fix (9315dd7, wanyaoqi)  Regiondns (1)  configmap: quash trailing spaces (0261d6d, Yousong Zhou)  ","excerpt":"发布时间 2020-10-14 13:09:19\n onecloud 仓库地址: …","ref":"/v3.6/zh/docs/changelog/release-3.3/3-3-6/","title":"v3.3.6"},{"body":"Release time: 2020-09-15 18:05:31\n onecloud Repository: https://github.com/yunionio/onecloud\n32 commits to onecloud - v3.3.5 since this release.\nBug Fixes (19)  ignore 409 error when doing redfish power on (508c934e8, Qiu Jian) cos use proxy (24e3da781, Qu Xuan) disable webkms for esxi older than 6.5 (c2fbe4faf, Qiu Jian) avoid sync natgateway eip panic (9920e3b50, Qu Xuan) 默认不自动合并安全组 (e5d7fee93, Qu Xuan) aliyun wulanchabu region (fb9ae22fe, Qu Xuan) 平滑迁移数据 (042842501, Qu Xuan) 腾讯云不支持同时设置秘钥和密码,若设置秘钥，则将密码置空 (dfafa0336, Qu Xuan) optimized qcloud keypair (a1aafa67d, Qu Xuan) uniform cachedimage active status (cb288f65e, Qu Xuan) prevent users in disabled idp from login (e64af28e8, Qiu Jian) wire usage stats incorrect (45d6686a3, Qiu Jian) esxi: fetch templatevm from datacenter before clone vm (be4a95ca8, rainzm) esxi: return when host.Vm is empty (c4180811b, rainzm) esxiagent: return image extid not id (171c95bf5, rainzm) esxiagent: add HostDelayTaskWorkerCount (da0246e66, rainzm) notify: Replace String() with GetString() (4da5a0042, rainzm) region: add RequestSyncstatusOnHost for SESXiGuestDriver (13608b43e, rainzm) scheduler: fix array out of bounds when sorting hosts (6874b9440, rainzm)  Code Refactoring (3)  esxi: replace GetTemplateVMById with FetchTemplateVMById (35919e1ec, rainzm) esxi: fetchVms and fetchHardwareInfo (86c0af8ca, rainzm) region: optimize preparenet of cloudaccount (df64b9080, rainzm)  Disk (1)  check disk is need renew on guest set renew (6f5bb55ea, wanyaoqi)  Elasticips (1)  filter by owner when doing auto allocation (ef8b9e6ae, Yousong Zhou)  Features (2)  esxi: support fetchVM form datacenter (3a8c90d7d, rainzm) esxicli: better vm operator (af76ae975, rainzm)  Host (1)  fix rbd storage cache iso image (f017daafc, wanyaoqi)  Others (3)  guest short desc add backup host id (b120b87c4, wanyaoqi) fix get ubuntu version (22e4181b3, wanyaoqi) optimized cachedimages sync (23b02045a, Qu Xuan)  Vpcagent (1)  guard against foul eip records (96058b4af, Yousong Zhou)  Webconsole (1)  fix defer order to release zombie process (77c3e490c, wanyaoqi)   onecloud-operator Repository: https://github.com/yunionio/onecloud-operator\n3 commits to onecloud-operator - v3.3.5 since this release.\nNotify (1)  remove pvc dependence (5f1fadf, wanyaoqi)  Others (2)  etcd add cloud affinity (fd8c8c4, wanyaoqi) statusfulset set cloud affinity: (539d129, wanyaoqi)   sdnagent Repository: https://github.com/yunionio/sdnagent\n3 commits to sdnagent - v3.3.5 since this release.\nBuild (1)  eipgw: vrrp track script as monitor (fd4cf95, Yousong Zhou)  Sdnagent (1)  be cooperative (bda4f40, Yousong Zhou)  Vendor (1)  bump yunion.io/x/onecloud to current tip of release/3.3 (9f5ccbb, Yousong Zhou)  ","excerpt":"Release time: 2020-09-15 18:05:31\n onecloud Repository: …","ref":"/v3.6/en/docs/changelog/release-3.3/3-3-5/","title":"v3.3.5"},{"body":"发布时间 2020-09-15 18:05:31\n onecloud 仓库地址: https://github.com/yunionio/onecloud\n32 commits to onecloud - v3.3.5 since this release.\nBug Fixes (19)  ignore 409 error when doing redfish power on (508c934e8, Qiu Jian) cos use proxy (24e3da781, Qu Xuan) disable webkms for esxi older than 6.5 (c2fbe4faf, Qiu Jian) avoid sync natgateway eip panic (9920e3b50, Qu Xuan) 默认不自动合并安全组 (e5d7fee93, Qu Xuan) aliyun wulanchabu region (fb9ae22fe, Qu Xuan) 平滑迁移数据 (042842501, Qu Xuan) 腾讯云不支持同时设置秘钥和密码,若设置秘钥，则将密码置空 (dfafa0336, Qu Xuan) optimized qcloud keypair (a1aafa67d, Qu Xuan) uniform cachedimage active status (cb288f65e, Qu Xuan) prevent users in disabled idp from login (e64af28e8, Qiu Jian) wire usage stats incorrect (45d6686a3, Qiu Jian) esxi: fetch templatevm from datacenter before clone vm (be4a95ca8, rainzm) esxi: return when host.Vm is empty (c4180811b, rainzm) esxiagent: return image extid not id (171c95bf5, rainzm) esxiagent: add HostDelayTaskWorkerCount (da0246e66, rainzm) notify: Replace String() with GetString() (4da5a0042, rainzm) region: add RequestSyncstatusOnHost for SESXiGuestDriver (13608b43e, rainzm) scheduler: fix array out of bounds when sorting hosts (6874b9440, rainzm)  Code Refactoring (3)  esxi: replace GetTemplateVMById with FetchTemplateVMById (35919e1ec, rainzm) esxi: fetchVms and fetchHardwareInfo (86c0af8ca, rainzm) region: optimize preparenet of cloudaccount (df64b9080, rainzm)  Disk (1)  check disk is need renew on guest set renew (6f5bb55ea, wanyaoqi)  Elasticips (1)  filter by owner when doing auto allocation (ef8b9e6ae, Yousong Zhou)  Features (2)  esxi: support fetchVM form datacenter (3a8c90d7d, rainzm) esxicli: better vm operator (af76ae975, rainzm)  Host (1)  fix rbd storage cache iso image (f017daafc, wanyaoqi)  Others (3)  guest short desc add backup host id (b120b87c4, wanyaoqi) fix get ubuntu version (22e4181b3, wanyaoqi) optimized cachedimages sync (23b02045a, Qu Xuan)  Vpcagent (1)  guard against foul eip records (96058b4af, Yousong Zhou)  Webconsole (1)  fix defer order to release zombie process (77c3e490c, wanyaoqi)   onecloud-operator 仓库地址: https://github.com/yunionio/onecloud-operator\n3 commits to onecloud-operator - v3.3.5 since this release.\nNotify (1)  remove pvc dependence (5f1fadf, wanyaoqi)  Others (2)  etcd add cloud affinity (fd8c8c4, wanyaoqi) statusfulset set cloud affinity: (539d129, wanyaoqi)   sdnagent 仓库地址: https://github.com/yunionio/sdnagent\n3 commits to sdnagent - v3.3.5 since this release.\nBuild (1)  eipgw: vrrp track script as monitor (fd4cf95, Yousong Zhou)  Sdnagent (1)  be cooperative (bda4f40, Yousong Zhou)  Vendor (1)  bump yunion.io/x/onecloud to current tip of release/3.3 (9f5ccbb, Yousong Zhou)  ","excerpt":"发布时间 2020-09-15 18:05:31\n onecloud 仓库地址: …","ref":"/v3.6/zh/docs/changelog/release-3.3/3-3-5/","title":"v3.3.5"},{"body":"Release time: 2020-09-06 15:33:08\n onecloud Repository: https://github.com/yunionio/onecloud\n33 commits to onecloud - v3.3.4 since this release.\nBug Fixes (18)  skup syncing lb, rds, redis instances in tasks (ec659ddd4, Qiu Jian) network address list respect privilige of user (e2d98a4ce, Qiu Jian) support VirtualDiskRawDiskMappingVer1BackingInfo (79ef55b4f, Qiu Jian) find correct esxi host access ip (c7c1082e9, Qiu Jian) search by chs projectname or domainname (03de172d8, Qiu Jian) ignore invalid zone sku for rds sku sync (#7618) (64d0b4f8c, 屈轩) compatiblity fixes with lenovo RD620 and huawei 2288 (6ea402b57, Qiu Jian) add details for account delete (#7704) (32195ed70, 屈轩) avoid delete aws iam user failed (#7666) (3c7c7c172, 屈轩) vmware esxi host detects vnic portgroup info (#7659) (f15d7d8f3, Jian Qiu) server purge may fail (#7697) (589d7d48a, Jian Qiu) 不限制openstack系统盘类型 (#7676) (9424de9cf, 屈轩) cleanup logic for nics of pending_deleted guests (#7670) (f14220665, Jian Qiu) aovid truncated data (#7645) (c5e616b19, 屈轩) turn off some default project policies (#7638) (23d01a1e3, Jian Qiu) avoid openstack image-list failed (#7642) (ac1870272, 屈轩) avoid storage=nil, dis can not delete (#7609) (9f3b937e6, 屈轩) compute: return InputParameterError while ValidateCreateData (94409c25c, rainzm)  Features (1)  esxi: correctly judge whether inet is nil (03590d9f9, rainzm)  Glance (1)  check min disk size on update (a0246b410, wanyaoqi)  Hostinfo (1)  try create network add is_on_premise (#7708) (d5251af97, wanyaoqi)  Others (10)  pex register add optional column mac_access (6eb7c39d3, TangBin) create classic vpc fix (142b1bee2, TangBin) update host status to unknown on host offline (8a3d9e7d0, wanyaoqi) vmware disk support deploy lvm partition (e52415a73, wanyaoqi) Automated cherry pick of #7661: fix(host-deployer): Exit correctly after mounting (#7673) (938c9a681, Rain Zheng) fix host get guests (#7684) (9272b4399, wanyaoqi) fix get storage capacity on init' (#7688) (cc051942d, wanyaoqi) remove backup metadata on delete backup (#7655) (d8275fa79, wanyaoqi) eip \u0026 vpc manager match fix (#7651) (9ec851df2, tb365) fix gpfs check mountpoint (a04ee820f, wanyaoqi)  Vpcagent (2)  respect guest src check settings (#7679) (3268e59d2, Yousong Zhou) ignore network without wire ids (#7630) (3a966df65, Yousong Zhou)   ocadm Repository: https://github.com/yunionio/ocadm\n2 commits to ocadm - v3.3.4 since this release.\nAutoupdate (1)  clear host tag (b02ac92, Zexi Li)  Others (1)  clean info from from autoupdate component when update (b810dbc, Zexi Li)   onecloud-operator Repository: https://github.com/yunionio/onecloud-operator\n3 commits to onecloud-operator - v3.3.4 since this release.\nOthers (3)  deployment with pvc not set node affinity (#257) (e8533ef, Zexi Li) replace cloud affinity preferred by required (#254) (c0787c1, wanyaoqi) crontab timeout (bdecedb, zhaoxiangchun)   sdnagent Repository: https://github.com/yunionio/sdnagent\n1 commits to sdnagent - v3.3.4 since this release.\nOthers (1)  Automated cherry pick of #105: vendor: bump onecloud to 3.3 master (#106) (6347cbc, Yousong Zhou)  ","excerpt":"Release time: 2020-09-06 15:33:08\n onecloud Repository: …","ref":"/v3.6/en/docs/changelog/release-3.3/3-3-4/","title":"v3.3.4"},{"body":"发布时间 2020-09-06 15:33:08\n onecloud 仓库地址: https://github.com/yunionio/onecloud\n33 commits to onecloud - v3.3.4 since this release.\nBug Fixes (18)  skup syncing lb, rds, redis instances in tasks (ec659ddd4, Qiu Jian) network address list respect privilige of user (e2d98a4ce, Qiu Jian) support VirtualDiskRawDiskMappingVer1BackingInfo (79ef55b4f, Qiu Jian) find correct esxi host access ip (c7c1082e9, Qiu Jian) search by chs projectname or domainname (03de172d8, Qiu Jian) ignore invalid zone sku for rds sku sync (#7618) (64d0b4f8c, 屈轩) compatiblity fixes with lenovo RD620 and huawei 2288 (6ea402b57, Qiu Jian) add details for account delete (#7704) (32195ed70, 屈轩) avoid delete aws iam user failed (#7666) (3c7c7c172, 屈轩) vmware esxi host detects vnic portgroup info (#7659) (f15d7d8f3, Jian Qiu) server purge may fail (#7697) (589d7d48a, Jian Qiu) 不限制openstack系统盘类型 (#7676) (9424de9cf, 屈轩) cleanup logic for nics of pending_deleted guests (#7670) (f14220665, Jian Qiu) aovid truncated data (#7645) (c5e616b19, 屈轩) turn off some default project policies (#7638) (23d01a1e3, Jian Qiu) avoid openstack image-list failed (#7642) (ac1870272, 屈轩) avoid storage=nil, dis can not delete (#7609) (9f3b937e6, 屈轩) compute: return InputParameterError while ValidateCreateData (94409c25c, rainzm)  Features (1)  esxi: correctly judge whether inet is nil (03590d9f9, rainzm)  Glance (1)  check min disk size on update (a0246b410, wanyaoqi)  Hostinfo (1)  try create network add is_on_premise (#7708) (d5251af97, wanyaoqi)  Others (10)  pex register add optional column mac_access (6eb7c39d3, TangBin) create classic vpc fix (142b1bee2, TangBin) update host status to unknown on host offline (8a3d9e7d0, wanyaoqi) vmware disk support deploy lvm partition (e52415a73, wanyaoqi) Automated cherry pick of #7661: fix(host-deployer): Exit correctly after mounting (#7673) (938c9a681, Rain Zheng) fix host get guests (#7684) (9272b4399, wanyaoqi) fix get storage capacity on init' (#7688) (cc051942d, wanyaoqi) remove backup metadata on delete backup (#7655) (d8275fa79, wanyaoqi) eip \u0026 vpc manager match fix (#7651) (9ec851df2, tb365) fix gpfs check mountpoint (a04ee820f, wanyaoqi)  Vpcagent (2)  respect guest src check settings (#7679) (3268e59d2, Yousong Zhou) ignore network without wire ids (#7630) (3a966df65, Yousong Zhou)   ocadm 仓库地址: https://github.com/yunionio/ocadm\n2 commits to ocadm - v3.3.4 since this release.\nAutoupdate (1)  clear host tag (b02ac92, Zexi Li)  Others (1)  clean info from from autoupdate component when update (b810dbc, Zexi Li)   onecloud-operator 仓库地址: https://github.com/yunionio/onecloud-operator\n3 commits to onecloud-operator - v3.3.4 since this release.\nOthers (3)  deployment with pvc not set node affinity (#257) (e8533ef, Zexi Li) replace cloud affinity preferred by required (#254) (c0787c1, wanyaoqi) crontab timeout (bdecedb, zhaoxiangchun)   sdnagent 仓库地址: https://github.com/yunionio/sdnagent\n1 commits to sdnagent - v3.3.4 since this release.\nOthers (1)  Automated cherry pick of #105: vendor: bump onecloud to 3.3 master (#106) (6347cbc, Yousong Zhou)  ","excerpt":"发布时间 2020-09-06 15:33:08\n onecloud 仓库地址: …","ref":"/v3.6/zh/docs/changelog/release-3.3/3-3-4/","title":"v3.3.4"},{"body":"Release time: 2020-08-21 17:38:33\n onecloud Repository: https://github.com/yunionio/onecloud\n12 commits to onecloud - v3.3.3 since this release.\nBug Fixes (11)  opslog filter by owner_project_ids and owner_domain_ids (#7601) (99818a7c0, Jian Qiu) member user only can get user \u0026 domain resource (#7598) (6cab61ecb, 屈轩) dns record create ignore is_public field (#7590) (01a838407, Jian Qiu) allow delete shared role and policy (cedd4ccdf, Qiu Jian) GetIImages correctly without ‘image_cache’ dir (f5d1adcbd, rainzm) aovid duplicate sku name (#7573) (66a5410e7, 屈轩) init wire domain_id for local vpc (#7567) (7a58d9f19, Jian Qiu) json TAG_PREFIX invalid syntax (5c8a7769e, Zexi Li) avoid virtual resource project id is empty when cloudaccount with no project (#7561) (ebe1eb603, 屈轩) Merge the host network correctly when preparenet (#7558) (eb67c681d, Rain Zheng) network port count stat recode (#7555) (e099f006f, Jian Qiu)  Others (1)  Automated cherry pick of #7585: apis: vpcs_ovn: alloc for interconnects (#7586) (d91f5fa87, Yousong Zhou)   onecloud-operator Repository: https://github.com/yunionio/onecloud-operator\n1 commits to onecloud-operator - v3.3.3 since this release.\nOthers (1)  fix baremetal storage size (b05d689, wanyaoqi)  ","excerpt":"Release time: 2020-08-21 17:38:33\n onecloud Repository: …","ref":"/v3.6/en/docs/changelog/release-3.3/3-3-3/","title":"v3.3.3"},{"body":"发布时间 2020-08-21 17:38:33\n onecloud 仓库地址: https://github.com/yunionio/onecloud\n12 commits to onecloud - v3.3.3 since this release.\nBug Fixes (11)  opslog filter by owner_project_ids and owner_domain_ids (#7601) (99818a7c0, Jian Qiu) member user only can get user \u0026 domain resource (#7598) (6cab61ecb, 屈轩) dns record create ignore is_public field (#7590) (01a838407, Jian Qiu) allow delete shared role and policy (cedd4ccdf, Qiu Jian) GetIImages correctly without ‘image_cache’ dir (f5d1adcbd, rainzm) aovid duplicate sku name (#7573) (66a5410e7, 屈轩) init wire domain_id for local vpc (#7567) (7a58d9f19, Jian Qiu) json TAG_PREFIX invalid syntax (5c8a7769e, Zexi Li) avoid virtual resource project id is empty when cloudaccount with no project (#7561) (ebe1eb603, 屈轩) Merge the host network correctly when preparenet (#7558) (eb67c681d, Rain Zheng) network port count stat recode (#7555) (e099f006f, Jian Qiu)  Others (1)  Automated cherry pick of #7585: apis: vpcs_ovn: alloc for interconnects (#7586) (d91f5fa87, Yousong Zhou)   onecloud-operator 仓库地址: https://github.com/yunionio/onecloud-operator\n1 commits to onecloud-operator - v3.3.3 since this release.\nOthers (1)  fix baremetal storage size (b05d689, wanyaoqi)  ","excerpt":"发布时间 2020-08-21 17:38:33\n onecloud 仓库地址: …","ref":"/v3.6/zh/docs/changelog/release-3.3/3-3-3/","title":"v3.3.3"},{"body":"Release time: 2020-08-13 17:59:30\n","excerpt":"Release time: 2020-08-13 17:59:30\n","ref":"/v3.6/en/docs/changelog/release-3.3/3-3-2/","title":"v3.3.2"},{"body":"发布时间 2020-08-13 17:59:30\n","excerpt":"发布时间 2020-08-13 17:59:30\n","ref":"/v3.6/zh/docs/changelog/release-3.3/3-3-2/","title":"v3.3.2"},{"body":"发布时间 2020-08-11 20:59:07\n onecloud 仓库地址: https://github.com/yunionio/onecloud\n18 commits to onecloud - v3.3.1 since this release.\nBug Fixes (11)  separete enabled and status field (3b036e6c3, Qu Xuan) optimized huawei security group get and create operation (#7521) (3c63af8de, 屈轩) avoid nil pointer (6f5be444c, Qu Xuan) backport fix (bb1752fb7, Qu Xuan) 提高zstack认证兼容性 (b152aa333, Qu Xuan) 隐藏auzre经典类型存储 (bb0123694, Qu Xuan) 增加openstack兼容性 (#7493) (7a81820cd, 屈轩) typo running_geusts =\u003e running_guests (2153a79dc, Qiu Jian) filter public network count by zone and region (780cf826c, Qiu Jian) typo (62d2a732e, Qu Xuan) ignore bucket-set-acl not implemented error (4cbe29d0c, Qiu Jian)  Others (7)  support diable usb kbd (0742afb48, wanyaoqi) fix usage get storage capbility (#7528) (5439457bb, wanyaoqi) fix mount xfs (57cd48354, wanyaoqi) set disk status on disk detached (#7518) (52488eeb5, wanyaoqi) nodealert bugfix： (abe44154b, zhaoxiangchun) add image upload\u0026 s3 upload api (#7515) (6cdbae22a, tb365) fix host info get sshkey (39bcc36c2, wanyaoqi)   notify-plugins 仓库地址: https://github.com/yunionio/notify-plugins\n2 commits to notify-plugins - v3.3.1 since this release.\nBug Fixes (1)  Add deadline for email and fix some proble (225694c, rainzm)  Others (1)  fix bug for email and smsaliyun (c59bf42, rainzm)   ocadm 仓库地址: https://github.com/yunionio/ocadm\n2 commits to ocadm - v3.3.1 since this release.\nOthers (2)  update vendor for v3.2: (774b517, Zexi Li) update vendor cause of onecloud-operator (3208d00, Zexi Li)   onecloud-operator 仓库地址: https://github.com/yunionio/onecloud-operator\n1 commits to onecloud-operator - v3.3.1 since this release.\nOthers (1)  remove etcd-operator dependcies (#236) (698c93a, Zexi Li)  ","excerpt":"发布时间 2020-08-11 20:59:07\n onecloud 仓库地址: …","ref":"/v3.6/en/docs/changelog/release-3.3/3-3-1/","title":"v3.3.1"},{"body":"发布时间 2020-08-11 20:59:07\n onecloud 仓库地址: https://github.com/yunionio/onecloud\n18 commits to onecloud - v3.3.1 since this release.\nBug Fixes (11)  separete enabled and status field (3b036e6c3, Qu Xuan) optimized huawei security group get and create operation (#7521) (3c63af8de, 屈轩) avoid nil pointer (6f5be444c, Qu Xuan) backport fix (bb1752fb7, Qu Xuan) 提高zstack认证兼容性 (b152aa333, Qu Xuan) 隐藏auzre经典类型存储 (bb0123694, Qu Xuan) 增加openstack兼容性 (#7493) (7a81820cd, 屈轩) typo running_geusts =\u003e running_guests (2153a79dc, Qiu Jian) filter public network count by zone and region (780cf826c, Qiu Jian) typo (62d2a732e, Qu Xuan) ignore bucket-set-acl not implemented error (4cbe29d0c, Qiu Jian)  Others (7)  support diable usb kbd (0742afb48, wanyaoqi) fix usage get storage capbility (#7528) (5439457bb, wanyaoqi) fix mount xfs (57cd48354, wanyaoqi) set disk status on disk detached (#7518) (52488eeb5, wanyaoqi) nodealert bugfix： (abe44154b, zhaoxiangchun) add image upload\u0026 s3 upload api (#7515) (6cdbae22a, tb365) fix host info get sshkey (39bcc36c2, wanyaoqi)   notify-plugins 仓库地址: https://github.com/yunionio/notify-plugins\n2 commits to notify-plugins - v3.3.1 since this release.\nBug Fixes (1)  Add deadline for email and fix some proble (225694c, rainzm)  Others (1)  fix bug for email and smsaliyun (c59bf42, rainzm)   ocadm 仓库地址: https://github.com/yunionio/ocadm\n2 commits to ocadm - v3.3.1 since this release.\nOthers (2)  update vendor for v3.2: (774b517, Zexi Li) update vendor cause of onecloud-operator (3208d00, Zexi Li)   onecloud-operator 仓库地址: https://github.com/yunionio/onecloud-operator\n1 commits to onecloud-operator - v3.3.1 since this release.\nOthers (1)  remove etcd-operator dependcies (#236) (698c93a, Zexi Li)  ","excerpt":"发布时间 2020-08-11 20:59:07\n onecloud 仓库地址: …","ref":"/v3.6/zh/docs/changelog/release-3.3/3-3-1/","title":"v3.3.1"},{"body":"Release time: 2020-08-02 19:03:34\n onecloud Repo: https://github.com/yunionio/onecloud\n763 commits to onecloud - v3.3.0 since this release.\nAdd (1)  region/openstack 迁移接入 (386746365, lvyangyang)  Ansibleserver (1)  register metadata manager (916943a7c, Yousong Zhou)  Apigateway (2)  expose identity/image/k8s usage rpc method (686cc7824, Zexi Li) handlers: register cloudnet modules (a70d17d6d, Yousong Zhou)  Apis (4)  compute: move struct defs (8a79c0f70, Yousong Zhou) network: add NETWORK_TYPE_EIP (b62d41a83, Yousong Zhou) add const definitions for eip gateway ips (30844db32, Yousong Zhou) add ovn distgw const definitions (12639e027, Yousong Zhou)  Appsrv (2)  rework TestRing (358f5d41a, Yousong Zhou) ring: release ring content on pop (e37f15cac, Yousong Zhou)  Baremetal (6)  fix hpssactl split last LV size out of limit (#7427) (e64f24945, Zexi Li) set zone when enable netif (df4d88e19, Zexi Li) fix forget init lockman pkg (8ebabd6ae, Zexi Li) fix ssh put empty content file not created (541c72849, Zexi Li) find baremetal add scope system (cfc9fcedd, Zexi Li) ensure power up add retries (5693ae05d, Zexi Li)  Bug Fixes (301)  avoid generated codes having duplicate PerformSetScope methods (d834f3331, Qiu Jian) avoid host globalid change (#7466) (6e64fc4ca, 屈轩) elasticcache_account_reset_password_task.go cherry pick build fail (#7452) (88497da74, Jian Qiu) cloudaccount is created as system shared by default (e0fc57bea, Qiu Jian) sync share mode between vpc and wire (9dfed2845, Qiu Jian) 避免glance metadata-list project scope无权限 (#7403) (92d8437c4, 屈轩) 优化openstack项目认证 (#7398) (65cd074ff, 屈轩) 避免在仅调整虚拟机磁盘时opslog日志记录mem cpu异常 (#7393) (5dc829633, 屈轩) avoid lost backend params (46fa77b29, Qu Xuan) openstack win image user data need encode (c39de392c, Qu Xuan) ignore general s3 set acl not implemented error (7e47d7aeb, Qiu Jian) avoid account sync deadlock (01f384cf8, Qu Xuan) adjust scope of isolated_device and reservedips (1c78817ab, Qiu Jian) openstack多项目问题 (816b29267, Qu Xuan) avoid parse json err nil pointer (f9b51a9f5, Qu Xuan) 添加阿里云rds备份恢复限制条件 (ba953f20c, Qu Xuan) change owner should check required domain list (04b4ab376, Qiu Jian) 普通视图下，安全组仅统计可看到的vm count (6b2cb20f4, Qu Xuan) 同步sku与磁盘类型关系 (28a80ac52, Qu Xuan) 避免创建rds备份时对rds进行一些操作 (#7355) (bd6b45aae, 屈轩) 修复vm绑定重复安全组 (f03d021aa, Qu Xuan) add default perform allow policy to sysadmin (3f09d0019, Qiu Jian) modify list details for guesttemplate (d06d2026f, rainzm) list item export recode (880b0ecf4, Qiu Jian) 避免status_code\u003e=400并且resp为空时err为nil (#7265) (f2456d236, 屈轩) cloud account delete may fail due to inconsistent status (f624ab152, Qiu Jian) do accessibility check when dissociate eip from resource (ded8da001, Qiu Jian) schedtag should be system resource (4d33d1a70, Qiu Jian) choose candidate list from the list returned from backend (c90c0944c, Qiu Jian) 单独添加更新账单文件日志 (e7fc9b94b, Qu Xuan) 支持多项目安全组规则过滤 (fef5147ae, Qu Xuan) domain resource domain share to system when non_default_domain_projects off (671d20227, Qiu Jian) 阿里云资源组同步 (f5ed69217, Qu Xuan) 避免未能导出共享安全组规则 (1c4e9e00a, Qu Xuan) image upload not clean pending usage (ba983df32, Qiu Jian) quota usage not updated after disk resizing (508f30901, Qiu Jian) rds备份恢复优化 (ecb7249a1, Qu Xuan) default vpc must be shared globally (fa67bd831, rainzm) globalvpc跟随云账号共享 (f8471832e, Qu Xuan) 过滤可用eip (23e17fe0a, Qu Xuan) 避免乌兰察布区域拉取资源异常 (a443975f7, Qu Xuan) prefetch image error when create guest with vmware template (4ef5267a8, rainzm) not work for network-list –zones (d6b83fbbf, Qu Xuan) sec rule export missing fields (cee24b2a7, Qu Xuan) check azure image format when rebuild root (1b5b8081f, Qu Xuan) 避免华为云安全组规则删除失败 (64599b481, Qu Xuan) clouduser’s cloudgroups info (fb229f6c7, Qu Xuan) 添加secgroup rule过滤参数 (a5fc7c807, Qu Xuan) 修复cloudid get权限问题 (09f2b2af2, Qu Xuan) azure 支持权限 (c003f78f6, Qu Xuan) 修复cloudid用户列表权限问题 (26434683c, Qu Xuan) 优化webconsole代码\u0026bugfix (ea3097240, Qu Xuan) mo.VirtualMachine’s Config maybe nil (0420266b7, rainzm) 修复阿里云同步安全组规则异常问题 (2f42e9e5f, Qu Xuan) 避免google clouduser同步权限异常 (7056fa01b, Qu Xuan) 修复vpc同步异常问题 (ef6d0c2ad, Qu Xuan) 避免越界访问 (09ccf107c, Qu Xuan) opslog show the owners operation logs only (a186f2587, Qiu Jian) remove default allow policy for storages (8f7223b1d, Qiu Jian) cloudid 权限修复 (05c730ace, Qu Xuan) cloudid 异常修复 (b4ed25963, Qu Xuan) 修复资源组云上同步异常问题 (89cb75bfe, Qu Xuan) 修复qcloud同步权限组异常问题 (21178638f, Qu Xuan) 修复azure 项目同步问题 (e8ff39a01, Qu Xuan) 避免请求中国区iam异常 (5f9b6622f, Qu Xuan) perform private on vpc will private all wires if no networks in wires (2286ef19b, Qiu Jian) 修复腾讯云操作日志时间异常问题 (8a1d2d1ea, Qu Xuan) 修复elastic cache sku zone_id异常问题 (76906efea, Qu Xuan) 分开统计安全组关联虚拟机数量 (a997cf498, Qu Xuan) json request 支持自定义匹配err (6ac6768e3, Qu Xuan) remove default host list policy (eb342a70a, Qiu Jian) cloud poilcy count (367d3f147, Qu Xuan) 避免cloudprovider同步缺失 (e7cd84275, Qu Xuan) google rds regional and zonal (79d016985, Qu Xuan) cloud account sync may block (6133b1a5c, Qiu Jian) 避免azure同步资源组异常 (fcf1e193b, Qu Xuan) 避免slave zoneid异常 (f303512a7, Qu Xuan) 同步不需要判断账号是否有iam权限 (acf641be2, Qu Xuan) clouduser can_delete always be false (a54a9c05b, Qu Xuan) 优化安全组list速度，并发挥rule规则信息 (dc3ef5c61, Qu Xuan) 公有云子账号加域属性 (9c6234307, Qu Xuan) 修复cloudid同步问题 (544c19f3c, Qu Xuan) 取消aliyun lb scheduler创建限制 (82d0f5c03, Qu Xuan) manager_id资源隔离获取 (66fc71cc8, Qu Xuan) 优化sku同步逻辑 (04427515f, Qu Xuan) Override Master and Slave for scalinggroup_guest (23c76dc79, rainzm) validate candiate ip for sync-fix-nics (41a9d9242, Qiu Jian) capability for cloudid (781cc3ed6, Qu Xuan) 避免未本地缓存usercache (45819e6c1, Qu Xuan) 修复cloudid问题 (223c9439b, Qu Xuan) 支持同步project标签到本地资源 (e31334b47, Qu Xuan) 修正项目映射同步 (b25295bf0, Qu Xuan) 修复权限组权限同步异常问题 (21a09d29d, Qu Xuan) reduce totp verification overhead (265bbc6e7, Qiu Jian) 避免同步不到其他域的云账号 (ef0242d15, Qu Xuan) Error occurs when suitableWire exists or all suitableNetwork exist. (030a2edfb, rainzm) disable domain sharing if non_default_domain_projects turned off (a23f57da4, Qiu Jian) sort quota list result by usage rate (9012180b6, Qiu Jian) keystone project resource count not accurate (161db6d95, Qiu Jian) google资源名称兼容处理 (4f5a2ff43, Qu Xuan) simplify forbidden user login message (611b9e9b5, Qiu Jian) 避免azure同步项目失败 (f8cce2892, Qu Xuan) wrong cloud provider status when sync disconnected cloud account (1d9a3f273, Qiu Jian) network created by sysadmin should be shared by default (5c53ccc3d, Qiu Jian) Fix problems about sending verify email (109bdc05d, rainzm) 避免同步删除失败 (3c75119c5, Qu Xuan) Fix the url of ‘notify-template-delete’ in climc (8ed4148fb, rainzm) policy allow if one of the matching rules is allow (2efb7fc9e, Qiu Jian) disable policy rule compaction (818d40c08, Qiu Jian) 优化标签列表version问题 (d296a1801, Qu Xuan) Support to set the label of scheduledtask to Chinese (3e7a5acb9, rainzm) Add zero padding in front of execution time for scheduledtask (0dad8351d, rainzm) 避免openstack磁盘和存储窜位 (4e48d33ec, Qu Xuan) 避免sql erorr (aa0d05ccd, Qu Xuan) policy-explain not working properly (5ebb18b69, Qiu Jian) Hanle the error of vdisk.GetIStorage in syncCloudDisk (4c6682617, rainzm) Add ‘/version’ handler for notify (2cd2f3d02, rainzm) 更正华为云操作成功判断 (5837b696d, Qu Xuan) disable updating zone_id for host, storage, wire (1e4acedf2, Qiu Jian) Wait for ticker when get status is wrong (7e80ecf61, rainzm) 优化安全组同步逻辑 (03a3dfcd7, Qu Xuan) handler param.convert’s error in caller.go (c793746f0, rainzm) explainPolicy piggyback owner’s privilige (e7b198ab3, Qiu Jian) base64 decode 12-bytes plain text password return nil (a51d554d7, Qiu Jian) remove spaces in name (06e19c494, Qiu Jian) oss-upload fail to set object acl (d519a6584, Qiu Jian) 返回object默认acl (510eb101e, Qu Xuan) xsky recode using endpoint as accesskey key (de081a768, Qiu Jian) Support ‘generate_name’ when saving template from guest (27f746eb2, rainzm) 避免openstack session==nil (90aa83494, Qu Xuan) keystone event list fail to find user (b917ea6a1, Qiu Jian) 添加region翻译 (6ba9a8fae, Qu Xuan) 修复gcp object编码问题 (c706821a7, Qu Xuan) 移除默认调度策略 (c2ce0460a, Qu Xuan) 转换gcp错误 (9069814b1, Qu Xuan) 避免越过tenantcache过期检查 (8754ef243, Qu Xuan) 允许gcp创建vpc时不指定cidr (53d771025, Qu Xuan) gcp默认创建允许所有地址访问的用户 (f73b3ed03, Qu Xuan) apigateway expose esxiagent service avaiability (ddc483509, Qiu Jian) 避免锁超时 (a519a6612, Qu Xuan) gcp path escape for object (23df2235e, Qu Xuan) sync s3 bucket status (7cb40ec3c, Qu Xuan) add us-west4 for google region (1997e41ea, Qu Xuan) class method GetPropertyXXX should support rbac (a99deb614, Qiu Jian) 安全组规则返回项目id信息 (61ff1544e, Qu Xuan) 华为企业项目映射同步 (3a0b5c5e2, Qu Xuan) byte size fix (5ed624d15, Qu Xuan) ignore match weights when searching matched policysets (015702846, Qiu Jian) generating bucket APIs (5e77a9682, Qiu Jian) typo (f9dcb2bb7, Qu Xuan) lb FetchCustomizedColumes fixes (f82543e23, Qiu Jian) 避免因磁盘数量导致创建机器失败 (caf07c256, Qu Xuan) sysadmin cannot convert host in non-default domain (f54d63325, Qiu Jian) 避免azure卸载磁盘失败 (d4b16667d, Qu Xuan) domain user no previleges to convert host (c563f021b, Qiu Jian) scheduler test ignore quota limit (354a61632, Qiu Jian) 移除azure policy sync部分 (9e07cda2b, Qu Xuan) sku status filter (95ae69c2b, Qu Xuan) bucket信息修正 (f89be60e6, Qu Xuan) tmp update (893d77398, Qu Xuan) 通用指定项目到云上创建资源 (9916c9917, Qu Xuan) retry ipmi probe if redfish-api-probe fails (3699a9b20, Qiu Jian) identity_provider details missing fields (f9bc5f692, Qiu Jian) default policy not effective (03477cbe7, Qiu Jian) 避免openstack以镜像做系统盘创建失败 (b31922a3b, Qu Xuan) Support filtering notification with contactType (ee85dec1c, rainzm) empty matched policies list for roles (728524fef, Qiu Jian) 返回项目信息 (5cdeebb04, Qu Xuan) 加入Azure套餐和镜像的检查 (0f2ff5384, Qu Xuan) 避免azure uefi重装系统失败 (a9c001200, Qu Xuan) 避免因io问题导致同步镜像列表为空 (a7e1bdf6f, Qu Xuan) usage for schetag not accurate (1dfef4dcf, Qiu Jian) gcp bucket文件夹默认设为private (ef25bf328, Qu Xuan) aliyun rds backup create fix (b260c04c3, Qu Xuan) 避免regional network-list –zone导致返回结果为空 (8bc4927d5, Qu Xuan) system privileges user cannot access system console (29283ff11, Qiu Jian) 避免忽略本地allow any云上deny any安全组规则同步 (c8ba52c94, Qu Xuan) 上传镜像为转换列表之外时,subformat状态异常 (1354270c5, Qu Xuan) ‘requirements’ in ansibleplaybookv2 should be optional (77e5801ad, rainzm) cloudaccount share_mode not initialized (08eda0d44, Qiu Jian) 仅当变更domainId时才需要更新projectId (bf57b829a, Qu Xuan) policy details should carry updated_at and created_at fields (4c313f5a2, Qiu Jian) delete idp also delete users/groups in target domain (3118a1020, Qiu Jian) 尽量避免因代理问题导致google request异常 (f7bf34ee1, Qu Xuan) 支持公有云指定资源组 (f9b1466f4, Qu Xuan) 支持指定resource group (4b5f8b8d5, Qu Xuan) 修复zstack使用win镜像时userdata base64加密问题 (f162ac46f, Qu Xuan) cloudprovider list support filter by zone and cloudregion (50f55c299, Qiu Jian) 优化azure image同步逻辑 (b18035442, Qu Xuan) policy create fail on initialization phrase (5b60c4fad, Qiu Jian) anonymous user may list resources (f4a676575, Qiu Jian) 避免大范围安全组共享 (8f4e0a5e8, Qu Xuan) image-list –sub-format support (f9c794f74, Qu Xuan) 加入azure镜像vhd检查 (589a4678f, Qu Xuan) update fields permission tags (d1fd24538, Qiu Jian) 避免设置自动释放后磁盘的expired_at失效 (3fe417c4f, Qu Xuan) 避免仅同步一个region时，其余region状态变为准备中 (33c2b5fa9, Qu Xuan) 优化标签列表过滤参数 (e306a4e23, Qu Xuan) bugfixes (b312b5dac, Qiu Jian) disable delete standard image (ed5463ca6, Qiu Jian) fail to explain permission for disabled policy (54689d862, Qiu Jian) server-sync-fix-nics should return errors if vnics ip is not reachable on host (605978a94, Qiu Jian) xxx-agent should generally use scope=system to list resources (41125788f, Qiu Jian) esxi disk project sync (039644e89, Qu Xuan) do not share porject resource by default (ea254c8ed, Qiu Jian) blacklist keystone reset admin password (7655f8e2a, Qiu Jian) 自动创建项目 (72fb9a58d, Qu Xuan) 修复华为云eneterprise-project-list异常问题 (4d71f7e2a, Qu Xuan) 非私有云同步region name (86087b9ac, Qu Xuan) 避免backup list未能正常显示rds信息 (d82cf4184, Qu Xuan) FindAnonymousStructPoint needs input as a pointer to struct (ead8825dc, Qiu Jian) set public_scope to system for image with is_public=true (eb54f316c, Qiu Jian) 优化rds zone同步逻辑 (fc4778f33, Qu Xuan) 优化windows powershell userdata (5c6b016c2, Qu Xuan) avoid using background context (c35758dd0, Qiu Jian) status-base resource’s action log missing owner project/domain (9c26c0408, Qiu Jian) host agent list use baremetalagents model (5c8081b6b, Qiu Jian) reserved ip owner filter (07766b7b4, Qiu Jian) i-ps -\u003e ips (b0b45c420, Qu Xuan) openstack 安全组规则同步 (df5f5c9b9, Qu Xuan) change-owner-candidate-domains not implemented for some resources (4a84beee0, Qiu Jian) 避免provider错乱返回 (bd21b346a, Qu Xuan) 优化openstack错误处理 (2da49eb0d, Qu Xuan) cloud-provider-list support filter by cloudregion (d271ff69f, Qu Xuan) 支持访问其他服务的标签列表 (f01bed833, Qu Xuan) isolated_devices domain filter not working (e9101ebc2, Qiu Jian) gcp rds 默认不使用vpc网络 (8cfbf9a8f, Qu Xuan) 避免卸载完已删除的磁盘后，磁盘状态为ready (8a8d0f900, Qu Xuan) globalvpc count vpc (b6ec2b406, Qu Xuan) 避免aliyun磁盘计费类型多次转换 (2560fa345, Qu Xuan) create cloudaccount with disabled state (3b0bc3858, Qiu Jian) panic when disk has no valid storage_id (42171cb9c, Qiu Jian) init sharing status of default vpc and default secgroup (77f35bae2, Qiu Jian) recode sync public_src of cloud resources (bea90b4b1, Qiu Jian) guestsecgroup-list panic (99ddc175b, Qiu Jian) allow delete shared resource (8bd0205bb, Qiu Jian)   vpc, cloudprovider should not violate the sharing limit of cloud account 2. sharing mode of host and attached local storage should be consistent. 3. cannot change owner of shared resource (f2e0fcf4e, Qiu Jian)   export missing keys \u0026\u0026 export panic (bfa878676, Qiu Jian) missing methods for SDomainRegionalCloudResourceKeys (c7d58dee9, Qiu Jian) fail to sync share state for on-premise storages (45b8494cd, Qiu Jian) api doc(guests -\u003e servers) (6cff98f85, Qu Xuan) missing perform public/private actionlog (c473c9299, Qiu Jian) shared cloudprovider not accessible (a2a60245b, Qiu Jian) shared resource should not be deletable (6f3e18930, Qiu Jian) fail to fetch real client ip from httprequest (5ff4b9748, Qiu Jian) secgroupcache权限问题修复 (10469342b, Qu Xuan) list lbbg panic (34aacdcde, Qiu Jian) remove cloudaccount autosync randomness (0e03bfc27, Qiu Jian) 云账号创建可以指定项目 (c12c489e9, Qu Xuan) sysadmin can override policy violation check (b1647e7eb, Qiu Jian) usage-handler 不统计虚拟的vpc wire (d66197068, Qu Xuan) cloud-account-usage vpc/storage not accurate (f39f83816, Qiu Jian) export files complain duplicate field name error (5c138b919, Qiu Jian) prevent policy violation (ecb483b9b, Qiu Jian) 避免gcp创建创建文件夹失败 (b805d3495, Qu Xuan) 修复openstack存储同步问题 (e43af577b, Qu Xuan) 普通用户可获取rds账号密码 (0ff17ebef, Qu Xuan) gcp fake region status (86251d1ca, Qu Xuan) cloudaccount usage region/zone count not accurate (8d7bc247c, Qiu Jian) gcp use project name for cloudprovider (139b9592c, Qu Xuan) cloud-account/provider usage not accurate (912bf5c69, Qiu Jian) proxysetting attributes should be domain-settable (1e81c79ad, Qiu Jian) json unmarshal (b48dbbc5c, Qu Xuan) resolve parameter name conflict in google cloud account create input (d4600430a, Qiu Jian) opslog FetchOwnerId fail (1882232b4, Qiu Jian) network allocation according to sharing status (68c03778a, Qiu Jian) GetOnPremiseNetworkOfIP should return underlay networks (2498af7c3, Qiu Jian) update README api docs url to v2 (5f4f11bee, Qiu Jian) dns name pattern revisited (61051b843, Qiu Jian) code autogen issues (7ab3a06b4, Qiu Jian) 避免rds任务交叉运行 (5754fe90c, Qu Xuan) domain resources' field tags should changed to domain tags (ee42b9c01, Qiu Jian) cloudevent使用代理优化 (cea9cf95b, Qu Xuan) 添加cloudevent过滤参数 (a5b6e894b, Qu Xuan) opslog create fail (1b861a41f, Qiu Jian) clean pending usage caused by pre-validate-create-data (2297c6e96, Qiu Jian) is_managed filter is not accurate (b7b496676, Qiu Jian) typo (05012f0ba, Qu Xuan) 转换非标准存储类型到lrs (0f2e997f6, Qu Xuan) show sql connection error (9cb2727bf, Qu Xuan) esxi: Remove ‘Destory’ operation that is unnecessary for VirtualDiskManager (dae02ec01, rainzm) esxi: Disable automatically add host to the dvs (3530bca49, rainzm) esxi: Select correct unitNumber for ide control when creating disk (7c8200290, Rain Zheng) esxi: Modify the disk size correctly when creating vm (d71024849, rainzm) esxi: Set ‘WindowsDefaultAdminUser’ as true when deploy vm. (33184357b, rainzm) esxi: Detach all disk first when deleting vm (9bb732077, rainzm) esxi: Fix GetDriver and add driver log for vdisk. (81ffd582f, rainzm) esxi: Add usb to support mouse in vnc viewer (874ea4eb4, rainzm) esxi: Allow the creation of duplicate vcenter machines. (60a363a79, rainzm) esxi: Separate detach disk and delete disk when rebuilding. (b6ce495d4, rainzm) esxi: Set ‘IsInit’ as true when rebuildroot (2fe738b46, rainzm) host: No tag when tag’s value is empty (72716b8d5, Rain) notify: Remove default mobile template (9374c65a8, rainzm) region: Fix problems for Auto Scaling (4f27908ff, Rain) region: Set default value if rootdisk’s driver is empty. (45305648d, rainzm) region: Remove default secgroup for esxi guest (cd0125855, rainzm) region: zone from guesttemplate’s preferzone maybe nil (5ee969821, rainzm) region: Don’t allow address conflicts under vpc (18f5f9cb8, rainzm) region: Fix problems for Auto Scaling (7d52e5de8, Rain) region: Add CustomizeListFilter for snapshotpolicy (a9b7ca520, Rain) region: Add implements about owner for ScalingPolicy and ScalingActivity (6e9366f56, Rain)  Build (3)  ansibleserver: use native alpine, include openssh (e5dd8efd7, Yousong Zhou) docker: use openvswitch:2.10.4-0 (235339601, Yousong Zhou) add vet-check (8e40ff64f, Yousong Zhou)  Capability (1)  public network count filter by default vpc (80ae1b6cd, Zexi Li)  Climc (14)  refactor k8s resource (a6db3d353, Zexi Li) lbagent-show-default-params: add –cluster option support (333954add, Yousong Zhou) add command lbagent-show-default-params (e8b680352, Yousong Zhou) lb-update: add –cluster argument (1a308442c, Yousong Zhou) lbcluster-create: mark –zone as required (74e19af51, Yousong Zhou) lblistener-create: make –scheduler an optional arg (ea8cd6d7e, Yousong Zhou) shell: networks: add eip to server type choices (eaa16f333, Yousong Zhou) eip-create: make manager, region optional arguments (56c89ed57, Yousong Zhou) vpcs: add –external-access-mode argument (a0b39cc7b, Yousong Zhou) update k8s resource cmd (9f0df58c9, Zexi Li) k8s component add monitor options (8df155916, Zexi Li) remove stale zsh completion code (16adec3a5, Zexi Li) add k8s monitor component (90618466b, Zexi Li) support zsh completion (e884f4b6f, Zexi Li)  Cloudaccounts (1)  one sync task in queue per cloudaccount (8f5c65b92, Yousong Zhou)  Cloudcommon (11)  taskman: fix table insert (986878289, Yousong Zhou) tablespec: informer: use %#v to log bad obj (60293ef05, Yousong Zhou) taskman: SetModelManager (db9789c86, Yousong Zhou) tablespec: informer: log obj type (2f79c99dc, Yousong Zhou) policy: fix interval and oneshot sync (aeba29c4b, Yousong Zhou) app: cosmetic change (28e83a312, Yousong Zhou) cmdline: rework test (2a32627b5, Yousong Zhou) expose ITableSpec function (10603b4f6, Zexi Li) rbac: fix typo (5499f3509, Yousong Zhou) elect: notifyOne on subscribe (d845700ca, Yousong Zhou) allow create:“domain” tag (14389667a, Yousong Zhou)  Cloudprovider (2)  fix typo (ef695acae, Yousong Zhou) add methods for getting http client (a9061e545, Yousong Zhou)  Disks (1)  reword error message on bad DiskConfig struct (749fd878b, Yousong Zhou)  Dnsrecords (2)  allow updating only description (2f056b9ef, Yousong Zhou) note that DnsRecordManager is a IAdminSharableVirtualModelManager (06abfccbb, Yousong Zhou)  Elasticips (7)  onecloud: support changing bandwidth (df3c337bf, Yousong Zhou) list usable eips for onecloud kvm guests (2390e352f, Yousong Zhou) onecloud: support sync and syncstatus (18fe12a4a, Yousong Zhou) onecloud: create op (325464624, Yousong Zhou) onecloud: delete op for non-managed eip (fa833e694, Yousong Zhou) make manager, region arguments optional (8e1b6ded3, Yousong Zhou) only create eip of mode elastic_ip (0bf41caa3, Yousong Zhou)  Feature (9)  project filter that list jointable projects for user or group (b49272eb3, Qiu Jian) CloudId服务支持 (a07b112be, Qu Xuan)   allow enable/disable idp-synced-users 2. turn off user’s MFA by default (2cf49c37d, Qiu Jian)   add functime get lastest last start time of a billing duration (81b6a766a, Qiu Jian) user login into project with highest privilege automatically (c209fdd97, Qiu Jian) reorganize climc codes (1843ba334, Qiu Jian) decouple metadata resource and standalone resource (722498bf9, Qiu Jian) make baremetal options managed by service config (ee9289c23, Qiu Jian) climc support auth by token (7de51b9d7, Qiu Jian)  Features (16)  Support vm to save server template (1265e5d1e, rainzm) Support suggest network config before create vmware cloud account (14f324ea4, rainzm) Add ‘ScheduledTaskQueueSize’ options (3ea4beeb8, rainzm) Add climc command for ScheduledTask and ScheduledTaskActivity (2b7bd7a12, rainzm) Detach ScheduledTask when pending delete guest (8d30ef0ad, rainzm) Add handers and table for ScheduledTask… (d6c5c29c6, rainzm) Add ScheduledTask, ScheduledTaskActivity and ScheduledTaskLabel (058cc4fdc, rainzm) Extract STimer from SScalingTimer (8a2e23fd4, rainzm) Logo and copyright in verify email are same with these in company info (156ef6bd2, rainzm) Supports disabling of feishu and dingtalk notification (f73bcf8ad, rainzm) notify: Support ‘socpe:domain’ when list contacts (cfcaa50e2, rainzm) notify: Change the format of verify email (c706cfa27, rainzm) region: Add ‘EipAutoDellocate’ option when creating vm (727154461, Rain) region: Check periodically whether Guest Template is valid (f9b7c7e57, rainzm) region: Structured diskinfo and add ‘Id’, ‘Name’ field (8c4b025dc, Rain) scheduler: Change the action for guests with backup and instanceGroup (2a0c16c6f, rainzm)  Guestdrivers (3)  rework test (e27a12ec6, Yousong Zhou) kvm: eip associate (8b82d67b6, Yousong Zhou) managed: use const api.EIP_STATUS_ASSOCIATE (df2d98d8c, Yousong Zhou)  Guestnetworks (5)  reduce odds of collision seeded by epoch seconds (173448ee4, Yousong Zhou) use math/rand instead of crypto/rand (6a63aa942, Yousong Zhou) add EipId field (ff6e3e236, Yousong Zhou) try allocation of mapped addr on sync (06ea1b170, Yousong Zhou) add vpc id and mapped ip addr info to nic desc (9990ad3bc, Yousong Zhou)  Guests (6)  guests with vpc nics are available for eip association (2270704c4, Yousong Zhou) support server-create-eip for onecloud guests and eip (7e02808c8, Yousong Zhou) list usable guests for specified eip (df4d80fbd, Yousong Zhou) include vpc, network info in guest nics list (b29c4b386, Yousong Zhou) simplify code (64f269ac2, Yousong Zhou) always include host_id in desc (ff2686689, Yousong Zhou)  Hostman (9)  options: add option –ovn-underlay-mtu (d714e450f, Yousong Zhou) options: add option –sdn-pid-file (61659d7b2, Yousong Zhou) options: knobs for enabling features in sdnagent (25d05899d, Yousong Zhou) options: remove k8s_cluster_cidr (68b7ecf83, Yousong Zhou) options: fix default value spec (cbe5ef416, Yousong Zhou) options: pack up a Parse() func (0e16bf8ff, Yousong Zhou) let sdnagent do port cleanup (f05e16bd1, Yousong Zhou) options: add ovn_mapped_bridge (279e68ae0, Yousong Zhou) options: add allow_xx_vms (5acbec452, Yousong Zhou)  Hotfix (1)  vpc change owners with wire (c97e2ab1c, Qiu Jian)  Informer (1)  do not inform if backend not init (7c61e9662, Zexi Li)  Iproute2 (4)  address: make Exact idempotent (4b6d385e1, Yousong Zhou) route: add del funcs (91defab40, Yousong Zhou) errors: add IsErrSrch() (690039309, Yousong Zhou) route: prepare for route del (a5c253e12, Yousong Zhou)  Keystone (3)  passwords: SetModelManager (f1dfcd5e0, Yousong Zhou) config: SetModelManager for whitelisted config (7d47ac4dd, Yousong Zhou) fix db not sync (9a6065fbf, Zexi Li)  Lb (4)  include cluster name info in details (5f49670e1, Yousong Zhou) onecloud: allow empty string for redirect_{scheme,host,path} (3fe10a738, Yousong Zhou) onecloud: disallow creating lb with vpc network (ce741a24c, Yousong Zhou) allow update cluster_id with PUT request (539521087, Yousong Zhou)  Lbagent (6)  default-params: default vrrp params from peer lbagents (71e9f99b6, Yousong Zhou) new API: GET /loadbalanceragents/default-params (2b98f75c7, Yousong Zhou) fix condition for “nothing to serve” (3ae45d55e, Yousong Zhou) standalone rate control between listener and its rules (7e2273bfb, Yousong Zhou) decouple rule redirect from listener redirect (3d58d51ab, Yousong Zhou) fend off unexpected resources just in case (7f982d5b2, Yousong Zhou)  Lbagents (2)  add check on vrrp.advert_int (258aba250, Yousong Zhou) params: add needsUpdatePeer() and updateBy() methods (57e29330b, Yousong Zhou)  Lbbackend (2)  kvm: allow adding ‘host’,“ip” backend type (b6110fd3a, Yousong Zhou) ValidateCreateLoadbalancerBackendData: use httperrors (97c5afda5, Yousong Zhou)  Lbbackends (1)  allow backends of the same region (vs. zone) (1dc312303, Yousong Zhou)  Lblistener (5)  rename filter name certificate{,_id} (0f953b8b2, Yousong Zhou) allow turning on/off redirect (471755103, Yousong Zhou) redirect: try avoid endless redirect (d3313eba4, Yousong Zhou) make scheduler an optional arg on creation (473932311, Yousong Zhou) fix updating lblistener without backend_group field (1224cd819, Yousong Zhou)  Lblistenerrule (3)  allow turning on/off redirect (856310331, Yousong Zhou) redirect: try avoid endless redirect (2cd6c8588, Yousong Zhou) allow creation even for redirect listener (d55af7af2, Yousong Zhou)  Lblisteners (4)  remove unused acl_name field (5833f1a90, Yousong Zhou) list: show acl name (04abe448f, Yousong Zhou) list: show certificate name (ab71f5e6c, Yousong Zhou) list: filter with certificate ids (07ae9c12e, Yousong Zhou)  Mcclient (5)  options: loadbalanceragents: yum as the default deploy method (5218f8aab, Yousong Zhou) lb: allow empty string as arg for –redirect-{scheme,host,path} (003884860, Yousong Zhou) options: lb: arg rename cluster{,_id} (b4ce65109, Yousong Zhou) options: add EmptyOption (d4416f614, Yousong Zhou) options: remove implied details=true for pending_delete=all (9a47116a1, Yousong Zhou)  Monitor (2)  reduce subscription mysql usage (de889ec6c, Zexi Li) refactor suggest code (995e5859e, Zexi Li)  Multicloud (4)  speed up objectstore test (d4f54af5a, Yousong Zhou) huawei: rework responses_test (020831407, Yousong Zhou) loader: guard against changing proxyFunc of default client (e711ae764, Yousong Zhou) avoid changing transport of global default http client (fd3c9e5cd, Yousong Zhou)  Networks (7)  validate that start, end, gateway ip are in the same subnet (0280b6aa5, Yousong Zhou) validateUpdateData: eliminate intermediate vars (f4a001ad6, Yousong Zhou) decrease indent (927cbd415, Yousong Zhou) sep check of masklen only for start,end type creation (f27e17727, Yousong Zhou) create eip network only in default vpc (772038024, Yousong Zhou) return HTTP 404 for sql.ErrNoRows (72c23e877, Yousong Zhou) eliminate a variable (1d78510fa, Yousong Zhou)  Opslog (4)  remove unneeded nil check (4bbf7c048, Yousong Zhou) group literal fields (50449ca01, Yousong Zhou) readability change (fbc48c792, Yousong Zhou) LogEvent: set model manager (be46546ba, Yousong Zhou)  Opt (1)  scheduler: better sort for hosts when selectHost (49b0a01b0, rainzm)  Optimized (1)  支持ip和端口过滤安全组 (f12192f1c, Qu Xuan)  Others (199)  update apis generate model (042cd597f, Zexi Li) fix reauth condition on influxdb not found (#7457) (8172a551b, wanyaoqi) fix cache non lvm disks (#7460) (381a2796b, wanyaoqi) aws elb listener\u0026rule name too long fix (38e02db07, tangbin) fix redis reset account password action log (bb500edc8, tangbin) loadblancer listener modify name fix (d9488f552, tangbin) fix deploy admin auth key (7ad7774f8, wanyaoqi) fix panic on storage failed get host (#7391) (a2d562cca, wanyaoqi) adjust schedule resource condition width (7103f4e71, Zexi Li) fix schedtag list output (2ac39e704, wanyaoqi) Add metadata for GuestTempalte details (a66ba3f39, rainzm) Add network info when list scalingGroup details (02b30326f, rainzm) 修改报警消息模版： (619322176, zhaoxiangchun) 修复统一报警bug (bb66e2d19, zhaoxiangchun) go fmt (92fbc44b6, tangbin) go fmt (d93edbe42, tangbin) host upload template check (a4d89b1f6, tangbin) huawei fetch regions\u0026projects fix (5255df021, tangbin) rename vgname centos (7ef340fb6, wanyaoqi) fix clone clean pending usage (a329cd536, wanyaoqi) capabilites add available host count (32b36ee10, wanyaoqi) fix snapshot clean pending usage (2c27db42c, wanyaoqi)   add precheck for perform action (ec933e480, wanyaoqi)   format fix (2ff5d2aaf, tangbin) fix empty else (b5aceb67f, tangbin) fix host import (2794c84ac, tangbin) fix huawei delete resource (ce9646f9e, tangbin) fix huawei elb disable healthcheck (be8da39ce, tangbin) lb sync project fix (dacc8adce, tangbin) add more log (b79c410b0, tangbin) apigateway host imports data validate (b5754d2e3, tangbin) fix GetOrCreateVpcForClassicNetwork (f9c422112, tangbin) huawei eip delete fix (fdcaa1c8e, tangbin) 修复监控报警规则删除的问题 (c65fc0f1d, zhaoxiangchun) fix error output (18bae1849, wanyaoqi) acl delete condition fix (3e5eceeef, tangbin) fix server sync status (0e617ec13, wanyaoqi) sync classic redis fix (30aa75e04, tangbin) add params auto_migrate_on_host_down (b806e536f, wanyaoqi) misc ha guest fix (65408519a, wanyaoqi) disable procutils print error info (4831aee2d, wanyaoqi) fix list guests on host (f09eb6690, wanyaoqi) cloudprovider usable filter with zone (26757cb8d, tangbin) fix guest template health check (550883197, rainzm) remove informer code for release/3.3 (a365a0f45, Zexi Li) user batch register bugfix (b52eb8491, tangbin) vendor update: update jsonutils (d335c570c, wanyaoqi)   fix local storage init local man (fe472cbf4, wanyaoqi)   misc fix (5070775cd, wanyaoqi) fix set storage info bind mount (18a023f2f, wanyaoqi) update vendor (13f44debc, tangbin) Update docker image onecloud-base and its references (eb7b055ca, rainzm) 增加influxdb的tag 的一些filter (5db35871e, zhaoxiangchun) Update Dockerfile.ansibleserver (69a4b1272, rainzm) bind mount nfs storage path (5db73a667, wanyaoqi) cluster_d required-\u003eoptional (87cf251d2, tangbin) copyright api update (a3245195a, tangbin) fix the bug introduced in #6643 (968568487, rainzm) update jsonutils (b4884e3dd, rainzm) fix deploy backup server order (207cd93fe, wanyaoqi)   add server pending deleted for host details (875108248, wanyaoqi)   include system usage (89ec83fec, wanyaoqi) server name enable upper case (6f20638f8, wanyaoqi) fix get storage capabilities with null field (615fe1da8, wanyaoqi) disable dhclient (9a6c26de1, wanyaoqi) Modify alert structure and inherit scoperesource (f20a87a5d, zhaoxiangchun) 统一报警模块 (6c66185bd, zhaoxiangchun) ignore common etcd endpoint not found error (e9da1022b, Zexi Li) support filter by cloudaccounts (561d7b0cc, wanyaoqi) fix reserved ip export keys (6af753c81, wanyaoqi) replace err with errors.cause (6b8e37c88, tangbin) shuzhou to suzhou (8514e1910, tangbin) rds postpaid instance create fix (6ecebc5f2, tangbin) fix cpu usage metrics (25310ed92, wanyaoqi) configureable reload telegraf config (714b87aa3, wanyaoqi) scripts/coverage.sh: ignore packages without test files (200029dfd, Yousong Zhou) .circleci: run tests parallelly (bf1b1f48b, Yousong Zhou) fix windows install regedit record (9372a7b9c, wanyaoqi) fix host set reserved resource func name (413d292c2, wanyaoqi) fix informer worker heap large usage (cc5f731fc, Zexi Li) fix the tag filter and result record for scheduledtask (5f2a91f2a, rainzm) fix host list servers filter (1b055f24a, wanyaoqi) Add ‘trigger’ for ScheduledTask (8a69558c8, rainzm) refactor ITableSpec signature with context (9f4d4a450, Zexi Li) image support generate name (a3043520e, wanyaoqi) 修改框架查询influxdb的时间单位 (86e687015, zhaoxiangchun) climc:allow disable term line width (0a0af5cfa, root) cancel condition release (7e9575040, tangbin) ctyun sync host wire fix (f58a9305e, tangbin) bind mount local image path to container path (8e4668213, wanyaoqi) isolated device manager: (44cbdd07a, wanyaoqi) add-enterprise-info-update-climc (bb808bd8a, tangbin) 监控数据查询增加对任意时间范围的支持 (ecd4a9407, zhaoxiangchun) 统一监控接口 (3f63e4737, zhaoxiangchun) get snapshots order by created at asc (6e0f4a494, wanyaoqi) implement generic service informer (95a58cc60, Zexi Li) 在优化建议资源列表中增加费用信息 (585385f0c, zhaoxiangchun) fix migrate with multi local storage (4d404e09d, wanyaoqi) redis\u0026rds add postpaid duration (346d55850, tangbin) declear variable and define (8fde0c62a, wanyaoqi) 修复优化建议资源列表cloudenv过滤失效的问题 (00fb77e0c, zhaoxiangchun) 类型是onecloud的notifier增加webconsole的alert (0a7b381cf, zhaoxiangchun) clean network scripts on init (73297de60, wanyaoqi) host storage misc fix: (690a5f2fc, wanyaoqi) .circleci: run with parallel level 3 (e80c938ba, Yousong Zhou) fix host name validator (ec2cb3113, wanyaoqi) fix remotefile fetch image propertites (810de8a7e, wanyaoqi) isolated device add attribute reserved resource (91ff1d7d8, wanyaoqi) zstack宿主机监控中增加参数信息进行Unmarshal (47cac3c7b, zhaoxiangchun) update for doc-gen (8a7703082, Qiu Jian) Fix the problem of field duplication when exporting fields (849628fe9, rainzm) aws lbbg cache bugfix (d99ec5771, tangbin) fix list disk attachable servers (df2e05b5b, wanyaoqi) bugfix-优化建议 (c8a0d7736, zhaoxiangchun) 优化建议增加时间筛选范围 (42ed0b1c5, zhaoxiangchun) 修复当prestate=alerting，newstate=alerting的情况无法触发notify的问题 (4a784c1d7, zhaoxiangchun) Kill processes in time \u0026 Add debug info (ff2fc7440, rainzm) image cache use lockman (127bd0ff1, wanyaoqi) add sys usage (844b865e2, wanyaoqi) README.md: use travis-ci.com as badge target link (ea373821d, Yousong Zhou) redis\u0026dbinstance add clean expired postpaids resources (0029b25f9, tangbin) host convert inject dockerd config (04b4e5713, Zexi Li) add fuzzy ip matching (f602979a2, tangbin) sync storage shared info when syncing local storage (14abf05cf, Qiu Jian) update lisDescendent scope params (6037f1514, Qiu Jian) 根据调度标签过滤网络和存储资源 (888a5463a, Qu Xuan) 可根据代理过滤云账号 (6ea25e6fc, Qu Xuan) 修复无法获取vmware宿主机监控数据的问题 (6ffb3653a, zhaoxiangchun) update vendor (d98b2b405, rainzm) modify the logic of queryCondition save the evalMatch (387880164, zhaoxiangchun) allow delete paramter config (cbe5e8890, tangbin) 修改规则执行时间 (e8a61b035, zhaoxiangchun) fix esxi disk disconnect (a5d2651fb, wanyaoqi) remove statefile in start script (0fe396d5c, wanyaoqi) clear yunionauth cookie (75328cf08, tangbin) 基于监控数据的优化建议 (cc3f5ed19, zhaoxiangchun) 在monitor的package中新增influxdb相关的功能 (6251d2da3, zhaoxiangchun) do not close worker chan (7bcedd41e, wanyaoqi) detect bmagent and hostagent service (108613bd3, Qiu Jian) guest set login account (8144d2d2f, wanyaoqi) fix import from libvirt (1ba2d92e6, wanyaoqi) huawei network id fix (002a618e7, tangbin) new local lb backend fix (8c06b50ed, tangbin) feat/ansibleserver: Install git in Dockerfile.ansibleserver-base (1fbfc7f22, Rain) feat/ansible_pb: Add climc operator for ansibleplaybooks_v2 (cf514364e, Rain) feat/ansible_pb: Add IncludeRole implments ‘ITask’ in pkg/util/ansiblev2 (faf32415f, Rain) lb acl cache add acl filter (4882a6bb2, tangbin) bm register use domain token (4f23ffb90, wanyaoqi) set cookie domain (f25bbee90, tangbin) feat/ansible_pb: Add support for requirements (331ba9bb3, Rain) 修复规则无法禁用的问题 (cb13b2241, zhaoxiangchun) bugfix mem paginate (d874b52b0, zhaoxiangchun) set host list scope system (6779db23f, wanyaoqi) apigateway-yunionauth-domain-setting (4e9264cb2, tangbin) 修复谷歌监控无法获取的问题 (d4531972d, zhaoxiangchun) support custom service url (26780e2c8, wanyaoqi) bugfix mem paginate (7c0d70414, zhaoxiangchun) fix host init without etcd (9652c97dc, wanyaoqi) fix host details output (db2d02fe0, wanyaoqi) fix update input (7353622d2, wanyaoqi) fix host health (d72724892, wanyaoqi) fix/monitor: AutoScalingNotifier.ShouldNotify should call NotifierBase.ShouldNotify (e67effaf3, Rain) add cookie domain setting option (849d1d669, tangbin) monitor,对于监控数据nodata，默认不发送邮件 (e81334c0a, zhaoxiangchun) fix/as: Set ScalingPolicy’s project as its ScalingGroup’s project (352e912c2, Rain) enable etcd lock (5158a509e, wanyaoqi) host health check (38c1c70a2, wanyaoqi) gpu host enable huge page (98377116f, wanyaoqi) fix/autoscaling: Chang the format of CoolingTime (be5c539e9, Rain) fix exsi convert disk path (9c4d3c62b, wanyaoqi) fix/notify: remove ‘v2’ from email verify url (9aa132cf3, Rain) fix/notify: Add deadline for rpc client (e1c63729d, Rain) host health check (af6c6fee8, wanyaoqi) yunionapi reset password fix (32e4ae98c, tangbin) fix/autoscaling: Change Sunday as 7 from 0 (09d7aaf39, Rain) fix/guesttemplate: Change ResetPassword as true default (203bdb2df, Rain) fix/autoscaling: fix some problem (4d8e0ba1b, Rain) host fix cmt bound, minor fix (b05d22834, wanyaoqi) aws elb health check type fix (7b6f45789, tangbin) huawei elb cookie timeout fix (b62727ae0, tangbin) ctyun subnet create bugfix (8618be1fd, tangbin) misc bugfix: (9a7c7623c, wanyaoqi) make DIRECT proxysettting default share to system (6faa4d91a, Qiu Jian) lb 负载均衡优化建议 (fc05c2d0e, zhaoxiangchun) fix/autoscaling: Add ‘scaling_group_id’ for server-list result (16226becf, Rain) fix/autoscaling: Add status ‘pending_remove’ for ScalingGroup_Guest (32280e214, Rain) guestnetworks,hosts: add alloc mapped ip addr for use in onecloud vpc (3142957f5, Yousong Zhou) fix/autoscaling: Change ScalingPolicy as VirtualResource (39d5603af, Rain) fix/autoscaling: Use UserCred’s session but AdminSession to request monitor (acb4d1cab, Rain) aliyun create elb listener fix (a06f7e7b5, tangbin) supermicro redfish support (98cec09a6, Qiu Jian) fix check ca cert (cf0cf484a, wanyaoqi) support sync disk snapshot status (54596fc42, wanyaoqi) huawei elb sync vpc (bd0a8f709, tangbin) remove aws invalid backendgroup (674764208, tangbin) keystone store service cert (b682e1b44, wanyaoqi) VMware resource pool同步 (1ef9a481c, Qu Xuan) 优化邮件格式 (6c3daec4c, zhaoxiangchun) lblis \u0026 lbbg \u0026 lbr \u0026 lbb create add fetch owner id (c977fd02c, tangbin)  Region (15)  schedtag list support resource_types (65562c25f, Zexi Li) lbagents: skip tls check for default influxdb endpoint url (7f7aef031, Yousong Zhou) lbagents: turn off guest src check (f30b191d0, Yousong Zhou) loadbalanceragents: yum as the default method (4a0d019b6, Yousong Zhou) retry set influxdb policy until completed (8e51f627a, Zexi Li) fix get resource details panic (0b70491ea, Zexi Li) fix server create params not include specified resource (4713312b3, Zexi Li) fix baremetal can’t enable public baremetal type network (80a405a8a, Zexi Li) server create prefer resource fetch by name or id (536be2ead, Zexi Li) guests: include secgroup ids in listing (e8cbaee90, Yousong Zhou) lbagent: undeploy: make it idempotent (f226d342e, Yousong Zhou) lbagents: fix deleting pending_deleted objects (f890b2b18, Yousong Zhou) cloudaccounts: re-validate only when proxysetting changed (d716405eb, Yousong Zhou) vpcs_mapped_address: fix locking (25d1c3693, Yousong Zhou) vpcs_mapped_address: alloc guestnic mapped addr backwards (138b596ec, Yousong Zhou)  Scheduler (7)  fix storage filter duplicate error message (d6b1fa02d, Zexi Li) fix memory over committed (d8d6e8c5b, Zexi Li) fix min counter get count not correct (db65bf4ef, Zexi Li) filter disabled cloudprovider (2e9307269, Zexi Li) set schedtag default strategy if input empty (e00b1fdc3, Zexi Li) get region nil panic (d049ac936, Zexi Li) fix network predicate get wrong free port (f39c82959, Zexi Li)  Sysutils (1)  rework test (458bd0c7f, Yousong Zhou)  Tasks (2)  onecloud: support disassociate eip (74920a37e, Yousong Zhou) EipDissociateTask: lock associated model (02ea7b462, Yousong Zhou)  Vendor (7)  update yunion.io/x/structarg (4ce404dd8, Yousong Zhou) update yunion.io/x/{jsonutils.pkg} (a2fda726d, Yousong Zhou) update yunion.io/x/sqlchemy (2e687997a, Yousong Zhou) update yunion.io/x/ovsdb (5ad06097c, Yousong Zhou) update yunion.io/x/ovsdb (4f68026b8, Yousong Zhou) import yunion.io/x/ovsdb (7c3d9d7f8, Yousong Zhou) tidy and vendoring (ffadb30c6, Yousong Zhou)  Vet (5)  composite literal uses unkeyed fields (fb26b0c38, Yousong Zhou) bad syntax for struct tag value (d25f92af8, Yousong Zhou) pairs not separated by spaces (b99157f64, Yousong Zhou) bad syntax for struct tag pair (c18d347b0, Yousong Zhou) unreachable code (85d238cb5, Yousong Zhou)  Vpcagent (55)  ClaimVpcGuestDnsRecords: guard against pending_deleted guests (821283952, Yousong Zhou) different direction for l3 and l4 match (97251c7cc, Yousong Zhou) ovn: claim dnsrecords for all vpcs (ba0e41d99, Yousong Zhou) models: include dnsrecords (583718014, Yousong Zhou) ovn: dns records for guest names (88095c6d8, Yousong Zhou) ovn: mark and sweep dns records (d51791396, Yousong Zhou) ovn: apply qos on eip (e442e7a25, Yousong Zhou) ovn: apply guestnetwork bw_limit (4b44f21ab, Yousong Zhou) ovn: use FindXxxReferrer_yyy (4b299846d, Yousong Zhou) ovn: set underlay mtu size in config file (2841e245e, Yousong Zhou) ovn: mix eipgw and distgw (83a44ce94, Yousong Zhou) models: include elasticip (822ba5875, Yousong Zhou) ovn: add and use mac.HashVpcHostDistgwMac() (22090a379, Yousong Zhou) models: separate Copy() and CopyJoined() (146ab44fb, Yousong Zhou) apihelper: use CopyJoined() (cb27b1805, Yousong Zhou) models: add CopyJoined() (c4b308489, Yousong Zhou) remove unused code (8873c8905, Yousong Zhou) apihelper: use its own options (230f004f3, Yousong Zhou) models: remove now boilerplate code (3e09d4920, Yousong Zhou) apihelper: add interface IModelSetListOptionProvider (c7fee7c76, Yousong Zhou) models: modelset: details=false for networks (f5360264f, Yousong Zhou) models: include wires (3a51985fc, Yousong Zhou) ovn: preparation: skip default vpc (5fdd534f7, Yousong Zhou) ovn: preparation: use network.Vpc.Id (a7a3beae2, Yousong Zhou) apihelper: use IModelSet.IncludeEmulated() (e0349f92b, Yousong Zhou) models: modelset: add IncludeEmulated() method (5bf45ad65, Yousong Zhou) apihelper: use IModelSet.IncludeDetails() (39a19d1c6, Yousong Zhou) models: modelset: add IncludeDetails() method (2a0cac9d4, Yousong Zhou) ovnutil: destroy non root obj first (4d54972a9, Yousong Zhou) ovn: cmp: generate clean args in a single batch (6d788e052, Yousong Zhou) ovn: use db.FindOneMatchByAnyIndex (4962bdc7e, Yousong Zhou) ovn: configure acl for lport (579641a26, Yousong Zhou) ovnutil: OvnNbctlArgsDestroy: take into account ACL (53f354612, Yousong Zhou) ovn: secgrouprules_acl (9f4daafee, Yousong Zhou) models: sort security group rules (1abdb4f13, Yousong Zhou) models: include secgroup and rules (7ba46e928, Yousong Zhou) apihelper: do not set details=true by default (f33a2e177, Yousong Zhou) ovnutil: remove old generated code (654845fd4, Yousong Zhou) ovn: use yunion.io/x/ovsdb (cae9594da, Yousong Zhou) ignore possible external subnets (218df2416, Yousong Zhou) ovn: explicitly include gateway route in classless routes (5caaccd43, Yousong Zhou) models: ignore possible external guests (4496a7bbc, Yousong Zhou) ad-hoc replacement for db.FindByIndex() (503735ebf, Yousong Zhou) models: allow guest to have multiple vpc nics (09cc38f96, Yousong Zhou) work around nics of pending deleted guest (11835889c, Yousong Zhou) fend off non-onecloud-vpc guest nics (16ced399a, Yousong Zhou) ovn: use network.GuestDns when available (d2c0ba4d5, Yousong Zhou) ovn: manage static routes (05c38c813, Yousong Zhou) ovn: guestnetwork: guard against empty dhcpopt (0578d6c49, Yousong Zhou) ovn: rename subnet, guestnetwork ovn obj names (1c50ffb21, Yousong Zhou) ovn: use cmp() when claimVpc (38354229b, Yousong Zhou) ovn: use cmp() (d8e419cfa, Yousong Zhou) add cmp() for search and pre-cleanup (4d3eba9ba, Yousong Zhou) ovn: make host ls when claimVpc (e6bb3397d, Yousong Zhou) models: include guest, host (e4ad3f419, Yousong Zhou)  Vpcs (1)  add ExternalAccessMode field (eebd15e0d, Yousong Zhou)  Webconsole (2)  fix old session make new session closed (37ee6f844, Zexi Li) fix version and others handler not handle (e56152aa4, Zexi Li)  Wires (1)  default to “default” vpc on creation (d83a7dade, Yousong Zhou)   ocadm 仓库地址: https://github.com/yunionio/ocadm\n28 commits to ocadm - v3.3.0 since this release.\nAddon (1)  add metrics server and remove itsm server (6e8ffa2, Zexi Li)  Others (27)  ocadm create cluster, 延时等待容错 (3269146, Zhang Dongliang) 高可用部署主备选取应将kube-apiserver是否工作考虑进去 (dd775ca, Zhang Dongliang) fix longhron template (6d28362, wanyaoqi) 修复 keepalived master state bug (3d452ac, Zhang Dongliang) longhorn deploy misc fix (53cbebc, wanyaoqi) update vendor for release/3.3 (ec96e95, Zexi Li) update vendor for 3.3 (bd902c2, Zhang Dongliang) fix create region zone where upgrade from v2 (b581b3d, wanyaoqi) update vendor for 3.3 (ec2d04c, Zhang Dongliang) ocadm 接入 keepalived，支持高可用 (08d74c0, Zhang Dongliang) update DefaultCalicoVersion to 3.12.1 (f82dd55, Zhang Dongliang) migrate data to longhorn (9dda325, wanyaoqi) addon longhorn (737c7c3, wanyaoqi) fetch itsm config from globalrc (0eabd9a, wanyaoqi) sync vendor with operator (d6eb026, Zexi Li) fix upgrade from v2 (442f19e, wanyaoqi) add operator priority schedule class (0c22cef, Zexi Li) 修改itsm镜像仓库信息，和项目信息对应 (eb07ee0, zhaoxiangchun) set node override name (1a51fda, wanyaoqi) set default control plane endpoint (a8f7a53, wanyaoqi) 多网卡环境下 calico 网卡选择策略 (4fbd02d, Zhang Dongliang) disable loki stack (f089a4c, Zexi Li) 修改itsm的template (3f50a3c, zhaoxiangchun) support upgrade (3ccb7eb, wanyaoqi) join args (faa9e3f, Zhang Dongliang) inherit print addon yaml opt (a4ea4d1, Zexi Li) custom csi dependent image (f0bfd56, wanyaoqi)   onecloud-operator 仓库地址: https://github.com/yunionio/onecloud-operator\n64 commits to onecloud-operator - v3.3.0 since this release.\nBug Fixes (5)  apigateway totp should default on (0520f4e, Qiu Jian) member policy requires member role (3d85738, Qiu Jian) Change xxIntervalxx type from ‘int’ to ‘*int’ (0cc2996, rainzm) Change api prefix ‘/api/v1’ as ‘api/v1’ (5fcceb2, rainzm) change command of init container for oso (019c5b0, rainzm)  Defaults (1)  using openvswitch image of tag 2.10.4-0 (cbbaa01, Yousong Zhou)  Feature (1)  add cloudid service (525f310, Qu Xuan)  Features (1)  Add support for onecloud-resource-operator (b5b9181, rainzm)  Host (1)  tell sdnagent to use common.conf (a260f9c, Yousong Zhou)  Itsm (1)  limit memory to 1G (83c05e9, Zexi Li)  Others (52)  调整统一监控 系统报警规则的注入配置 (7dc8266, zhaoxiangchun) fix etcd member count (8f5c7b5, wanyaoqi) recreate pods on pvc not local path (03b924e, wanyaoqi) 修复系统报警规则重复创建的问题 (6576384, zhaoxiangchun) fix set pvc name (821875d, wanyaoqi) fix glance pvc name (54bffda, wanyaoqi) update vendor for release/3.3 (0d99429, Zexi Li) cloudmon deployment increase [rds redis oss] monitor information collectiona (5dbf86e, zhaoxiangchun) add check if cronjob exist (5862b3b, wanyaoqi) service etcd client disable unready client (052dca4, wanyaoqi) cloudmon as deployment (d5f78cd, wanyaoqi) host image component set default toleration (6f564a2, wanyaoqi) check etcd dbsize, do compact and defrag (9ec773c, wanyaoqi) system alert init info create in operator (61f9c09, zhaoxiangchun) host image as daemonset (dcf7299, wanyaoqi) fix etcd defrag (e947444, wanyaoqi) add daemonset telegraf (78e082e, wanyaoqi) telegraf init tool (ca58141, wanyaoqi) fix:优化manifest example (4c7e1fe, lvyangyang) new pvc name with storage class (6b300f5, wanyaoqi) itsm endpoint注册为http请求 (14fcbe1, zhaoxiangchun) not register azure classic host data (e345786, Zexi Li) operator增加itsm服务 (9739e8a, zhaoxiangchun) remove put/del key on liveness probe (ffdf0eb, wanyaoqi) set cronjob default attributes (292f37a, Zexi Li) etcd cluster default use version 3.4.6 (2b293d6, wanyaoqi) bugfix：宿主机监控没有默认值注入的函数 (e48997d, zhaoxiangchun) etcd operator fix (f71a98e, wanyaoqi) fix etcd liveness probe (a7d57db, wanyaoqi) first create policy (5eae948, wanyaoqi) add max wal file (cfc762a, wanyaoqi) fix etcd arguments (d661676, wanyaoqi) 增加宿主机的监控查询的cronjob (011ae7d, zhaoxiangchun) report-server 监控间隔调整 (fba6be1, zhaoxiangchun) 修改reportserver cronjob采集监控数据的间隔 (fb88568, zhaoxiangchun) set keystone url (2bd2d63, wanyaoqi) kubeserver add service account (4cbff0a, Zexi Li) onecloud culster fix: (8a61750, wanyaoqi) mount etcd tls (6391bf8, wanyaoqi) web nginx config (0649323, Zexi Li) fix api_server url (8bc9f6c, wanyaoqi) fix cronjob update (28ca0af, wanyaoqi) etcd use tempfs (23c8a3e, wanyaoqi) adjust web nginx config (b770851, Zexi Li) create etcd service (91b75cc, wanyaoqi) do not always sync configmap (437091a, wanyaoqi) create etcd service (00127da, wanyaoqi) etcd tls endpoint (69f02e3, wanyaoqi) create etcd cluster (e25a2f7, wanyaoqi)   sync config api_server to common service (2ce9c33, wanyaoqi)   添加cronjob StartingDeadlineSeconds 参数 (daed9d9, zhaoxiangchun) add sockio web location (a0b437e, Zexi Li)  Web (1)  remove unused nginx config (6f37389, Zexi Li)  Yunionagent (1)  update content (87badd5, Zexi Li)   onecloud-service-operator 仓库地址: https://github.com/yunionio/onecloud-service-operator\n36 commits to onecloud-service-operator - v3.3.0 since this release.\nCode Refactoring (1)  Abstract the same logic and abstract interface (178b33b, rainzm)  Features (3)  init docs (1b18737, rainzm) Change field of IntOrStringStore (655cf96, rainzm) Normalize options \u0026 Add ‘dense’ options (6ec0326, rainzm)  Others (32)  Add Endpoint document (3696dc6, rainzm) Add CRD Endpoint (8e7de75, rainzm) support yaml string (e1ac25c, rainzm) fix about field reference (1341f22, rainzm) fix the reference of option’s field (368fcf2, rainzm) update README.md and CONTRIBUTING.md (2bdd574, rainzm) modify Dockerfile (454c20c, rainzm) Modify the code structure in the pkg directory (0c4466a, rainzm) Add README.md and CONTRIBUTING.md (01cff42, rainzm) modify the image name in Makefile (2fd0ec9, rainzm) add LICENSE (4c79f85, rainzm) modify copyright (758336b, rainzm) Reduce the dependence on executing ‘make image’ (a235dba, rainzm) change module name: onecloud-resource-operator=\u003eonecloud-service-operator (d4a574e, rainzm) remove ‘MetricsAddr’ and add ‘WebhookPort’ for Options (6b58d3c, rainzm) Modify Makefile and Dockerfile for vendor (b1885e7, rainzm) init vendor (be4e55a, rainzm) change module name: onecloud-service-operator=\u003eonecloud-resource-operator (6baefaa, rainzm) Modify Dockerfile and Makefile (4a14009, rainzm) Adjust the project’s directory structure (958333e, rainzm) Improve value abstraction (8abac21, rainzm) fix some problem in provider/virtualmachine.go (8b812fb, rainzm) Set the ansible_user as ‘cloudroot’ when hypervisor is not ‘kvm’ (6b12bdc, rainzm) fix IsServerErr: code ‘500’ is also ServerErr (403c3bc, rainzm) Modify the json desc about ‘Bw’ in VMNewEipSpec (c794687, rainzm) fix some comment (29ce124, rainzm) fix ‘dealErr’ and update Dockerfile, kustomization.yaml (6c0c072, rainzm) clear external ansibleplaybook which is finished (dbe77e4, rainzm) fix and update (7f60c79, rainzm) change module name ‘onecloud-service-operator’ to ‘yunion.io/x/onecloud-service-operator’ (2430e12, rainzm) fix and update (45c9033, rainzm) init (0e138d9, rainzm)   sdnagent 仓库地址: https://github.com/yunionio/sdnagent\n39 commits to sdnagent - v3.3.0 since this release.\nAgent (18)  ovn: no error log if the mapped bridge does not exist (eec5b58, Yousong Zhou) add eip man (24c7338, Yousong Zhou) parse/watch config from main (616a4e5, Yousong Zhou) server: use sdn_enable_guest_man (d6452ef, Yousong Zhou) server: move hostConfig watch to AgentServer (2bee515, Yousong Zhou) server: shuffle lines to prepare for conditionals (d778a93, Yousong Zhou) drop support for k8s_cluster_cidr (cf5b8bf, Yousong Zhou) use hostman options (0856fcc, Yousong Zhou) server: guest: do region api sync when needed (0b22e05, Yousong Zhou) utils: add g.NeedsSync method (e87a9e8, Yousong Zhou) server: guest: guard against emtpy g.HostId (36f6603, Yousong Zhou) server: guest: clear up classic and vpc nics handling (b56d74d, Yousong Zhou) server: guest: rename flow update/clear method names (e118828, Yousong Zhou) add ovn distgw manager (5d16d37, Yousong Zhou) utils: add mapped ip addr info (5c4a41d, Yousong Zhou) flowman: log also bridge name (bc2f5ea, Yousong Zhou) fix log level (4d985a4, Yousong Zhou) export guest.IsPending method (dc7f907, Yousong Zhou)  Build (10)  systemd: add keepalived reload command (1fd0c9d, Yousong Zhou) eipgw: use 8 byte char for auth_pass (1084304, Yousong Zhou) eipgw: let keepalived use detail log (7d8f62d, Yousong Zhou) add ansible playbook README (9263c95, Yousong Zhou) separate artifact and docker image build (c5cae93, Yousong Zhou) docker: use openvswitch 2.10.4-0 as base (86e8bc1, Yousong Zhou) add example ansible playbook for ha deployment (124d8ea, Yousong Zhou) Makefile: add mod target (a4ced7e, Yousong Zhou) remove python2 dependency (0d0b7b4, Yousong Zhou) build binaries parallelly (6239ea3, Yousong Zhou)  Hostconfig (3)  add GetOverlayMTU() (1d2f96a, Yousong Zhou) add option ovn_mapped_bridge (3e4fa32, Yousong Zhou) import auth info (02f5657, Yousong Zhou)  OWNERS (1)  add wanyaoqi (89aacb7, Yousong Zhou)  Others (1)  go.mod: vendoring onecloud v0.0.0-20200603092502-73bcfb4bb731 (a6dfd5b, Yousong Zhou)  Ovn (1)  use yunion.io/x/onecloud/pkg/vpcagent/ovn/mac (8c2d6cd, Yousong Zhou)  Utils (2)  add Empty (f3e1069, Yousong Zhou) guest: reset VpcNICs on LoadDesc (44598a7, Yousong Zhou)  Vendor (3)  use tip of onecloud release 3.2 (3cef7d3, Yousong Zhou) update yunion.io/x/onecloud (dd77171, Yousong Zhou) go mod vendor (6af0f56, Yousong Zhou)  ","excerpt":"Release time: 2020-08-02 19:03:34\n onecloud Repo: …","ref":"/v3.6/en/docs/changelog/release-3.3/3-3-0/","title":"v3.3.0"},{"body":"发布时间 2020-08-02 19:03:34\n onecloud 仓库地址: https://github.com/yunionio/onecloud\n763 commits to onecloud - v3.3.0 since this release.\nAdd (1)  region/openstack 迁移接入 (386746365, lvyangyang)  Ansibleserver (1)  register metadata manager (916943a7c, Yousong Zhou)  Apigateway (2)  expose identity/image/k8s usage rpc method (686cc7824, Zexi Li) handlers: register cloudnet modules (a70d17d6d, Yousong Zhou)  Apis (4)  compute: move struct defs (8a79c0f70, Yousong Zhou) network: add NETWORK_TYPE_EIP (b62d41a83, Yousong Zhou) add const definitions for eip gateway ips (30844db32, Yousong Zhou) add ovn distgw const definitions (12639e027, Yousong Zhou)  Appsrv (2)  rework TestRing (358f5d41a, Yousong Zhou) ring: release ring content on pop (e37f15cac, Yousong Zhou)  Baremetal (6)  fix hpssactl split last LV size out of limit (#7427) (e64f24945, Zexi Li) set zone when enable netif (df4d88e19, Zexi Li) fix forget init lockman pkg (8ebabd6ae, Zexi Li) fix ssh put empty content file not created (541c72849, Zexi Li) find baremetal add scope system (cfc9fcedd, Zexi Li) ensure power up add retries (5693ae05d, Zexi Li)  Bug Fixes (301)  avoid generated codes having duplicate PerformSetScope methods (d834f3331, Qiu Jian) avoid host globalid change (#7466) (6e64fc4ca, 屈轩) elasticcache_account_reset_password_task.go cherry pick build fail (#7452) (88497da74, Jian Qiu) cloudaccount is created as system shared by default (e0fc57bea, Qiu Jian) sync share mode between vpc and wire (9dfed2845, Qiu Jian) 避免glance metadata-list project scope无权限 (#7403) (92d8437c4, 屈轩) 优化openstack项目认证 (#7398) (65cd074ff, 屈轩) 避免在仅调整虚拟机磁盘时opslog日志记录mem cpu异常 (#7393) (5dc829633, 屈轩) avoid lost backend params (46fa77b29, Qu Xuan) openstack win image user data need encode (c39de392c, Qu Xuan) ignore general s3 set acl not implemented error (7e47d7aeb, Qiu Jian) avoid account sync deadlock (01f384cf8, Qu Xuan) adjust scope of isolated_device and reservedips (1c78817ab, Qiu Jian) openstack多项目问题 (816b29267, Qu Xuan) avoid parse json err nil pointer (f9b51a9f5, Qu Xuan) 添加阿里云rds备份恢复限制条件 (ba953f20c, Qu Xuan) change owner should check required domain list (04b4ab376, Qiu Jian) 普通视图下，安全组仅统计可看到的vm count (6b2cb20f4, Qu Xuan) 同步sku与磁盘类型关系 (28a80ac52, Qu Xuan) 避免创建rds备份时对rds进行一些操作 (#7355) (bd6b45aae, 屈轩) 修复vm绑定重复安全组 (f03d021aa, Qu Xuan) add default perform allow policy to sysadmin (3f09d0019, Qiu Jian) modify list details for guesttemplate (d06d2026f, rainzm) list item export recode (880b0ecf4, Qiu Jian) 避免status_code\u003e=400并且resp为空时err为nil (#7265) (f2456d236, 屈轩) cloud account delete may fail due to inconsistent status (f624ab152, Qiu Jian) do accessibility check when dissociate eip from resource (ded8da001, Qiu Jian) schedtag should be system resource (4d33d1a70, Qiu Jian) choose candidate list from the list returned from backend (c90c0944c, Qiu Jian) 单独添加更新账单文件日志 (e7fc9b94b, Qu Xuan) 支持多项目安全组规则过滤 (fef5147ae, Qu Xuan) domain resource domain share to system when non_default_domain_projects off (671d20227, Qiu Jian) 阿里云资源组同步 (f5ed69217, Qu Xuan) 避免未能导出共享安全组规则 (1c4e9e00a, Qu Xuan) image upload not clean pending usage (ba983df32, Qiu Jian) quota usage not updated after disk resizing (508f30901, Qiu Jian) rds备份恢复优化 (ecb7249a1, Qu Xuan) default vpc must be shared globally (fa67bd831, rainzm) globalvpc跟随云账号共享 (f8471832e, Qu Xuan) 过滤可用eip (23e17fe0a, Qu Xuan) 避免乌兰察布区域拉取资源异常 (a443975f7, Qu Xuan) prefetch image error when create guest with vmware template (4ef5267a8, rainzm) not work for network-list –zones (d6b83fbbf, Qu Xuan) sec rule export missing fields (cee24b2a7, Qu Xuan) check azure image format when rebuild root (1b5b8081f, Qu Xuan) 避免华为云安全组规则删除失败 (64599b481, Qu Xuan) clouduser’s cloudgroups info (fb229f6c7, Qu Xuan) 添加secgroup rule过滤参数 (a5fc7c807, Qu Xuan) 修复cloudid get权限问题 (09f2b2af2, Qu Xuan) azure 支持权限 (c003f78f6, Qu Xuan) 修复cloudid用户列表权限问题 (26434683c, Qu Xuan) 优化webconsole代码\u0026bugfix (ea3097240, Qu Xuan) mo.VirtualMachine’s Config maybe nil (0420266b7, rainzm) 修复阿里云同步安全组规则异常问题 (2f42e9e5f, Qu Xuan) 避免google clouduser同步权限异常 (7056fa01b, Qu Xuan) 修复vpc同步异常问题 (ef6d0c2ad, Qu Xuan) 避免越界访问 (09ccf107c, Qu Xuan) opslog show the owners operation logs only (a186f2587, Qiu Jian) remove default allow policy for storages (8f7223b1d, Qiu Jian) cloudid 权限修复 (05c730ace, Qu Xuan) cloudid 异常修复 (b4ed25963, Qu Xuan) 修复资源组云上同步异常问题 (89cb75bfe, Qu Xuan) 修复qcloud同步权限组异常问题 (21178638f, Qu Xuan) 修复azure 项目同步问题 (e8ff39a01, Qu Xuan) 避免请求中国区iam异常 (5f9b6622f, Qu Xuan) perform private on vpc will private all wires if no networks in wires (2286ef19b, Qiu Jian) 修复腾讯云操作日志时间异常问题 (8a1d2d1ea, Qu Xuan) 修复elastic cache sku zone_id异常问题 (76906efea, Qu Xuan) 分开统计安全组关联虚拟机数量 (a997cf498, Qu Xuan) json request 支持自定义匹配err (6ac6768e3, Qu Xuan) remove default host list policy (eb342a70a, Qiu Jian) cloud poilcy count (367d3f147, Qu Xuan) 避免cloudprovider同步缺失 (e7cd84275, Qu Xuan) google rds regional and zonal (79d016985, Qu Xuan) cloud account sync may block (6133b1a5c, Qiu Jian) 避免azure同步资源组异常 (fcf1e193b, Qu Xuan) 避免slave zoneid异常 (f303512a7, Qu Xuan) 同步不需要判断账号是否有iam权限 (acf641be2, Qu Xuan) clouduser can_delete always be false (a54a9c05b, Qu Xuan) 优化安全组list速度，并发挥rule规则信息 (dc3ef5c61, Qu Xuan) 公有云子账号加域属性 (9c6234307, Qu Xuan) 修复cloudid同步问题 (544c19f3c, Qu Xuan) 取消aliyun lb scheduler创建限制 (82d0f5c03, Qu Xuan) manager_id资源隔离获取 (66fc71cc8, Qu Xuan) 优化sku同步逻辑 (04427515f, Qu Xuan) Override Master and Slave for scalinggroup_guest (23c76dc79, rainzm) validate candiate ip for sync-fix-nics (41a9d9242, Qiu Jian) capability for cloudid (781cc3ed6, Qu Xuan) 避免未本地缓存usercache (45819e6c1, Qu Xuan) 修复cloudid问题 (223c9439b, Qu Xuan) 支持同步project标签到本地资源 (e31334b47, Qu Xuan) 修正项目映射同步 (b25295bf0, Qu Xuan) 修复权限组权限同步异常问题 (21a09d29d, Qu Xuan) reduce totp verification overhead (265bbc6e7, Qiu Jian) 避免同步不到其他域的云账号 (ef0242d15, Qu Xuan) Error occurs when suitableWire exists or all suitableNetwork exist. (030a2edfb, rainzm) disable domain sharing if non_default_domain_projects turned off (a23f57da4, Qiu Jian) sort quota list result by usage rate (9012180b6, Qiu Jian) keystone project resource count not accurate (161db6d95, Qiu Jian) google资源名称兼容处理 (4f5a2ff43, Qu Xuan) simplify forbidden user login message (611b9e9b5, Qiu Jian) 避免azure同步项目失败 (f8cce2892, Qu Xuan) wrong cloud provider status when sync disconnected cloud account (1d9a3f273, Qiu Jian) network created by sysadmin should be shared by default (5c53ccc3d, Qiu Jian) Fix problems about sending verify email (109bdc05d, rainzm) 避免同步删除失败 (3c75119c5, Qu Xuan) Fix the url of ‘notify-template-delete’ in climc (8ed4148fb, rainzm) policy allow if one of the matching rules is allow (2efb7fc9e, Qiu Jian) disable policy rule compaction (818d40c08, Qiu Jian) 优化标签列表version问题 (d296a1801, Qu Xuan) Support to set the label of scheduledtask to Chinese (3e7a5acb9, rainzm) Add zero padding in front of execution time for scheduledtask (0dad8351d, rainzm) 避免openstack磁盘和存储窜位 (4e48d33ec, Qu Xuan) 避免sql erorr (aa0d05ccd, Qu Xuan) policy-explain not working properly (5ebb18b69, Qiu Jian) Hanle the error of vdisk.GetIStorage in syncCloudDisk (4c6682617, rainzm) Add ‘/version’ handler for notify (2cd2f3d02, rainzm) 更正华为云操作成功判断 (5837b696d, Qu Xuan) disable updating zone_id for host, storage, wire (1e4acedf2, Qiu Jian) Wait for ticker when get status is wrong (7e80ecf61, rainzm) 优化安全组同步逻辑 (03a3dfcd7, Qu Xuan) handler param.convert’s error in caller.go (c793746f0, rainzm) explainPolicy piggyback owner’s privilige (e7b198ab3, Qiu Jian) base64 decode 12-bytes plain text password return nil (a51d554d7, Qiu Jian) remove spaces in name (06e19c494, Qiu Jian) oss-upload fail to set object acl (d519a6584, Qiu Jian) 返回object默认acl (510eb101e, Qu Xuan) xsky recode using endpoint as accesskey key (de081a768, Qiu Jian) Support ‘generate_name’ when saving template from guest (27f746eb2, rainzm) 避免openstack session==nil (90aa83494, Qu Xuan) keystone event list fail to find user (b917ea6a1, Qiu Jian) 添加region翻译 (6ba9a8fae, Qu Xuan) 修复gcp object编码问题 (c706821a7, Qu Xuan) 移除默认调度策略 (c2ce0460a, Qu Xuan) 转换gcp错误 (9069814b1, Qu Xuan) 避免越过tenantcache过期检查 (8754ef243, Qu Xuan) 允许gcp创建vpc时不指定cidr (53d771025, Qu Xuan) gcp默认创建允许所有地址访问的用户 (f73b3ed03, Qu Xuan) apigateway expose esxiagent service avaiability (ddc483509, Qiu Jian) 避免锁超时 (a519a6612, Qu Xuan) gcp path escape for object (23df2235e, Qu Xuan) sync s3 bucket status (7cb40ec3c, Qu Xuan) add us-west4 for google region (1997e41ea, Qu Xuan) class method GetPropertyXXX should support rbac (a99deb614, Qiu Jian) 安全组规则返回项目id信息 (61ff1544e, Qu Xuan) 华为企业项目映射同步 (3a0b5c5e2, Qu Xuan) byte size fix (5ed624d15, Qu Xuan) ignore match weights when searching matched policysets (015702846, Qiu Jian) generating bucket APIs (5e77a9682, Qiu Jian) typo (f9dcb2bb7, Qu Xuan) lb FetchCustomizedColumes fixes (f82543e23, Qiu Jian) 避免因磁盘数量导致创建机器失败 (caf07c256, Qu Xuan) sysadmin cannot convert host in non-default domain (f54d63325, Qiu Jian) 避免azure卸载磁盘失败 (d4b16667d, Qu Xuan) domain user no previleges to convert host (c563f021b, Qiu Jian) scheduler test ignore quota limit (354a61632, Qiu Jian) 移除azure policy sync部分 (9e07cda2b, Qu Xuan) sku status filter (95ae69c2b, Qu Xuan) bucket信息修正 (f89be60e6, Qu Xuan) tmp update (893d77398, Qu Xuan) 通用指定项目到云上创建资源 (9916c9917, Qu Xuan) retry ipmi probe if redfish-api-probe fails (3699a9b20, Qiu Jian) identity_provider details missing fields (f9bc5f692, Qiu Jian) default policy not effective (03477cbe7, Qiu Jian) 避免openstack以镜像做系统盘创建失败 (b31922a3b, Qu Xuan) Support filtering notification with contactType (ee85dec1c, rainzm) empty matched policies list for roles (728524fef, Qiu Jian) 返回项目信息 (5cdeebb04, Qu Xuan) 加入Azure套餐和镜像的检查 (0f2ff5384, Qu Xuan) 避免azure uefi重装系统失败 (a9c001200, Qu Xuan) 避免因io问题导致同步镜像列表为空 (a7e1bdf6f, Qu Xuan) usage for schetag not accurate (1dfef4dcf, Qiu Jian) gcp bucket文件夹默认设为private (ef25bf328, Qu Xuan) aliyun rds backup create fix (b260c04c3, Qu Xuan) 避免regional network-list –zone导致返回结果为空 (8bc4927d5, Qu Xuan) system privileges user cannot access system console (29283ff11, Qiu Jian) 避免忽略本地allow any云上deny any安全组规则同步 (c8ba52c94, Qu Xuan) 上传镜像为转换列表之外时,subformat状态异常 (1354270c5, Qu Xuan) ‘requirements’ in ansibleplaybookv2 should be optional (77e5801ad, rainzm) cloudaccount share_mode not initialized (08eda0d44, Qiu Jian) 仅当变更domainId时才需要更新projectId (bf57b829a, Qu Xuan) policy details should carry updated_at and created_at fields (4c313f5a2, Qiu Jian) delete idp also delete users/groups in target domain (3118a1020, Qiu Jian) 尽量避免因代理问题导致google request异常 (f7bf34ee1, Qu Xuan) 支持公有云指定资源组 (f9b1466f4, Qu Xuan) 支持指定resource group (4b5f8b8d5, Qu Xuan) 修复zstack使用win镜像时userdata base64加密问题 (f162ac46f, Qu Xuan) cloudprovider list support filter by zone and cloudregion (50f55c299, Qiu Jian) 优化azure image同步逻辑 (b18035442, Qu Xuan) policy create fail on initialization phrase (5b60c4fad, Qiu Jian) anonymous user may list resources (f4a676575, Qiu Jian) 避免大范围安全组共享 (8f4e0a5e8, Qu Xuan) image-list –sub-format support (f9c794f74, Qu Xuan) 加入azure镜像vhd检查 (589a4678f, Qu Xuan) update fields permission tags (d1fd24538, Qiu Jian) 避免设置自动释放后磁盘的expired_at失效 (3fe417c4f, Qu Xuan) 避免仅同步一个region时，其余region状态变为准备中 (33c2b5fa9, Qu Xuan) 优化标签列表过滤参数 (e306a4e23, Qu Xuan) bugfixes (b312b5dac, Qiu Jian) disable delete standard image (ed5463ca6, Qiu Jian) fail to explain permission for disabled policy (54689d862, Qiu Jian) server-sync-fix-nics should return errors if vnics ip is not reachable on host (605978a94, Qiu Jian) xxx-agent should generally use scope=system to list resources (41125788f, Qiu Jian) esxi disk project sync (039644e89, Qu Xuan) do not share porject resource by default (ea254c8ed, Qiu Jian) blacklist keystone reset admin password (7655f8e2a, Qiu Jian) 自动创建项目 (72fb9a58d, Qu Xuan) 修复华为云eneterprise-project-list异常问题 (4d71f7e2a, Qu Xuan) 非私有云同步region name (86087b9ac, Qu Xuan) 避免backup list未能正常显示rds信息 (d82cf4184, Qu Xuan) FindAnonymousStructPoint needs input as a pointer to struct (ead8825dc, Qiu Jian) set public_scope to system for image with is_public=true (eb54f316c, Qiu Jian) 优化rds zone同步逻辑 (fc4778f33, Qu Xuan) 优化windows powershell userdata (5c6b016c2, Qu Xuan) avoid using background context (c35758dd0, Qiu Jian) status-base resource’s action log missing owner project/domain (9c26c0408, Qiu Jian) host agent list use baremetalagents model (5c8081b6b, Qiu Jian) reserved ip owner filter (07766b7b4, Qiu Jian) i-ps -\u003e ips (b0b45c420, Qu Xuan) openstack 安全组规则同步 (df5f5c9b9, Qu Xuan) change-owner-candidate-domains not implemented for some resources (4a84beee0, Qiu Jian) 避免provider错乱返回 (bd21b346a, Qu Xuan) 优化openstack错误处理 (2da49eb0d, Qu Xuan) cloud-provider-list support filter by cloudregion (d271ff69f, Qu Xuan) 支持访问其他服务的标签列表 (f01bed833, Qu Xuan) isolated_devices domain filter not working (e9101ebc2, Qiu Jian) gcp rds 默认不使用vpc网络 (8cfbf9a8f, Qu Xuan) 避免卸载完已删除的磁盘后，磁盘状态为ready (8a8d0f900, Qu Xuan) globalvpc count vpc (b6ec2b406, Qu Xuan) 避免aliyun磁盘计费类型多次转换 (2560fa345, Qu Xuan) create cloudaccount with disabled state (3b0bc3858, Qiu Jian) panic when disk has no valid storage_id (42171cb9c, Qiu Jian) init sharing status of default vpc and default secgroup (77f35bae2, Qiu Jian) recode sync public_src of cloud resources (bea90b4b1, Qiu Jian) guestsecgroup-list panic (99ddc175b, Qiu Jian) allow delete shared resource (8bd0205bb, Qiu Jian)   vpc, cloudprovider should not violate the sharing limit of cloud account 2. sharing mode of host and attached local storage should be consistent. 3. cannot change owner of shared resource (f2e0fcf4e, Qiu Jian)   export missing keys \u0026\u0026 export panic (bfa878676, Qiu Jian) missing methods for SDomainRegionalCloudResourceKeys (c7d58dee9, Qiu Jian) fail to sync share state for on-premise storages (45b8494cd, Qiu Jian) api doc(guests -\u003e servers) (6cff98f85, Qu Xuan) missing perform public/private actionlog (c473c9299, Qiu Jian) shared cloudprovider not accessible (a2a60245b, Qiu Jian) shared resource should not be deletable (6f3e18930, Qiu Jian) fail to fetch real client ip from httprequest (5ff4b9748, Qiu Jian) secgroupcache权限问题修复 (10469342b, Qu Xuan) list lbbg panic (34aacdcde, Qiu Jian) remove cloudaccount autosync randomness (0e03bfc27, Qiu Jian) 云账号创建可以指定项目 (c12c489e9, Qu Xuan) sysadmin can override policy violation check (b1647e7eb, Qiu Jian) usage-handler 不统计虚拟的vpc wire (d66197068, Qu Xuan) cloud-account-usage vpc/storage not accurate (f39f83816, Qiu Jian) export files complain duplicate field name error (5c138b919, Qiu Jian) prevent policy violation (ecb483b9b, Qiu Jian) 避免gcp创建创建文件夹失败 (b805d3495, Qu Xuan) 修复openstack存储同步问题 (e43af577b, Qu Xuan) 普通用户可获取rds账号密码 (0ff17ebef, Qu Xuan) gcp fake region status (86251d1ca, Qu Xuan) cloudaccount usage region/zone count not accurate (8d7bc247c, Qiu Jian) gcp use project name for cloudprovider (139b9592c, Qu Xuan) cloud-account/provider usage not accurate (912bf5c69, Qiu Jian) proxysetting attributes should be domain-settable (1e81c79ad, Qiu Jian) json unmarshal (b48dbbc5c, Qu Xuan) resolve parameter name conflict in google cloud account create input (d4600430a, Qiu Jian) opslog FetchOwnerId fail (1882232b4, Qiu Jian) network allocation according to sharing status (68c03778a, Qiu Jian) GetOnPremiseNetworkOfIP should return underlay networks (2498af7c3, Qiu Jian) update README api docs url to v2 (5f4f11bee, Qiu Jian) dns name pattern revisited (61051b843, Qiu Jian) code autogen issues (7ab3a06b4, Qiu Jian) 避免rds任务交叉运行 (5754fe90c, Qu Xuan) domain resources' field tags should changed to domain tags (ee42b9c01, Qiu Jian) cloudevent使用代理优化 (cea9cf95b, Qu Xuan) 添加cloudevent过滤参数 (a5b6e894b, Qu Xuan) opslog create fail (1b861a41f, Qiu Jian) clean pending usage caused by pre-validate-create-data (2297c6e96, Qiu Jian) is_managed filter is not accurate (b7b496676, Qiu Jian) typo (05012f0ba, Qu Xuan) 转换非标准存储类型到lrs (0f2e997f6, Qu Xuan) show sql connection error (9cb2727bf, Qu Xuan) esxi: Remove ‘Destory’ operation that is unnecessary for VirtualDiskManager (dae02ec01, rainzm) esxi: Disable automatically add host to the dvs (3530bca49, rainzm) esxi: Select correct unitNumber for ide control when creating disk (7c8200290, Rain Zheng) esxi: Modify the disk size correctly when creating vm (d71024849, rainzm) esxi: Set ‘WindowsDefaultAdminUser’ as true when deploy vm. (33184357b, rainzm) esxi: Detach all disk first when deleting vm (9bb732077, rainzm) esxi: Fix GetDriver and add driver log for vdisk. (81ffd582f, rainzm) esxi: Add usb to support mouse in vnc viewer (874ea4eb4, rainzm) esxi: Allow the creation of duplicate vcenter machines. (60a363a79, rainzm) esxi: Separate detach disk and delete disk when rebuilding. (b6ce495d4, rainzm) esxi: Set ‘IsInit’ as true when rebuildroot (2fe738b46, rainzm) host: No tag when tag’s value is empty (72716b8d5, Rain) notify: Remove default mobile template (9374c65a8, rainzm) region: Fix problems for Auto Scaling (4f27908ff, Rain) region: Set default value if rootdisk’s driver is empty. (45305648d, rainzm) region: Remove default secgroup for esxi guest (cd0125855, rainzm) region: zone from guesttemplate’s preferzone maybe nil (5ee969821, rainzm) region: Don’t allow address conflicts under vpc (18f5f9cb8, rainzm) region: Fix problems for Auto Scaling (7d52e5de8, Rain) region: Add CustomizeListFilter for snapshotpolicy (a9b7ca520, Rain) region: Add implements about owner for ScalingPolicy and ScalingActivity (6e9366f56, Rain)  Build (3)  ansibleserver: use native alpine, include openssh (e5dd8efd7, Yousong Zhou) docker: use openvswitch:2.10.4-0 (235339601, Yousong Zhou) add vet-check (8e40ff64f, Yousong Zhou)  Capability (1)  public network count filter by default vpc (80ae1b6cd, Zexi Li)  Climc (14)  refactor k8s resource (a6db3d353, Zexi Li) lbagent-show-default-params: add –cluster option support (333954add, Yousong Zhou) add command lbagent-show-default-params (e8b680352, Yousong Zhou) lb-update: add –cluster argument (1a308442c, Yousong Zhou) lbcluster-create: mark –zone as required (74e19af51, Yousong Zhou) lblistener-create: make –scheduler an optional arg (ea8cd6d7e, Yousong Zhou) shell: networks: add eip to server type choices (eaa16f333, Yousong Zhou) eip-create: make manager, region optional arguments (56c89ed57, Yousong Zhou) vpcs: add –external-access-mode argument (a0b39cc7b, Yousong Zhou) update k8s resource cmd (9f0df58c9, Zexi Li) k8s component add monitor options (8df155916, Zexi Li) remove stale zsh completion code (16adec3a5, Zexi Li) add k8s monitor component (90618466b, Zexi Li) support zsh completion (e884f4b6f, Zexi Li)  Cloudaccounts (1)  one sync task in queue per cloudaccount (8f5c65b92, Yousong Zhou)  Cloudcommon (11)  taskman: fix table insert (986878289, Yousong Zhou) tablespec: informer: use %#v to log bad obj (60293ef05, Yousong Zhou) taskman: SetModelManager (db9789c86, Yousong Zhou) tablespec: informer: log obj type (2f79c99dc, Yousong Zhou) policy: fix interval and oneshot sync (aeba29c4b, Yousong Zhou) app: cosmetic change (28e83a312, Yousong Zhou) cmdline: rework test (2a32627b5, Yousong Zhou) expose ITableSpec function (10603b4f6, Zexi Li) rbac: fix typo (5499f3509, Yousong Zhou) elect: notifyOne on subscribe (d845700ca, Yousong Zhou) allow create:“domain” tag (14389667a, Yousong Zhou)  Cloudprovider (2)  fix typo (ef695acae, Yousong Zhou) add methods for getting http client (a9061e545, Yousong Zhou)  Disks (1)  reword error message on bad DiskConfig struct (749fd878b, Yousong Zhou)  Dnsrecords (2)  allow updating only description (2f056b9ef, Yousong Zhou) note that DnsRecordManager is a IAdminSharableVirtualModelManager (06abfccbb, Yousong Zhou)  Elasticips (7)  onecloud: support changing bandwidth (df3c337bf, Yousong Zhou) list usable eips for onecloud kvm guests (2390e352f, Yousong Zhou) onecloud: support sync and syncstatus (18fe12a4a, Yousong Zhou) onecloud: create op (325464624, Yousong Zhou) onecloud: delete op for non-managed eip (fa833e694, Yousong Zhou) make manager, region arguments optional (8e1b6ded3, Yousong Zhou) only create eip of mode elastic_ip (0bf41caa3, Yousong Zhou)  Feature (9)  project filter that list jointable projects for user or group (b49272eb3, Qiu Jian) CloudId服务支持 (a07b112be, Qu Xuan)   allow enable/disable idp-synced-users 2. turn off user’s MFA by default (2cf49c37d, Qiu Jian)   add functime get lastest last start time of a billing duration (81b6a766a, Qiu Jian) user login into project with highest privilege automatically (c209fdd97, Qiu Jian) reorganize climc codes (1843ba334, Qiu Jian) decouple metadata resource and standalone resource (722498bf9, Qiu Jian) make baremetal options managed by service config (ee9289c23, Qiu Jian) climc support auth by token (7de51b9d7, Qiu Jian)  Features (16)  Support vm to save server template (1265e5d1e, rainzm) Support suggest network config before create vmware cloud account (14f324ea4, rainzm) Add ‘ScheduledTaskQueueSize’ options (3ea4beeb8, rainzm) Add climc command for ScheduledTask and ScheduledTaskActivity (2b7bd7a12, rainzm) Detach ScheduledTask when pending delete guest (8d30ef0ad, rainzm) Add handers and table for ScheduledTask… (d6c5c29c6, rainzm) Add ScheduledTask, ScheduledTaskActivity and ScheduledTaskLabel (058cc4fdc, rainzm) Extract STimer from SScalingTimer (8a2e23fd4, rainzm) Logo and copyright in verify email are same with these in company info (156ef6bd2, rainzm) Supports disabling of feishu and dingtalk notification (f73bcf8ad, rainzm) notify: Support ‘socpe:domain’ when list contacts (cfcaa50e2, rainzm) notify: Change the format of verify email (c706cfa27, rainzm) region: Add ‘EipAutoDellocate’ option when creating vm (727154461, Rain) region: Check periodically whether Guest Template is valid (f9b7c7e57, rainzm) region: Structured diskinfo and add ‘Id’, ‘Name’ field (8c4b025dc, Rain) scheduler: Change the action for guests with backup and instanceGroup (2a0c16c6f, rainzm)  Guestdrivers (3)  rework test (e27a12ec6, Yousong Zhou) kvm: eip associate (8b82d67b6, Yousong Zhou) managed: use const api.EIP_STATUS_ASSOCIATE (df2d98d8c, Yousong Zhou)  Guestnetworks (5)  reduce odds of collision seeded by epoch seconds (173448ee4, Yousong Zhou) use math/rand instead of crypto/rand (6a63aa942, Yousong Zhou) add EipId field (ff6e3e236, Yousong Zhou) try allocation of mapped addr on sync (06ea1b170, Yousong Zhou) add vpc id and mapped ip addr info to nic desc (9990ad3bc, Yousong Zhou)  Guests (6)  guests with vpc nics are available for eip association (2270704c4, Yousong Zhou) support server-create-eip for onecloud guests and eip (7e02808c8, Yousong Zhou) list usable guests for specified eip (df4d80fbd, Yousong Zhou) include vpc, network info in guest nics list (b29c4b386, Yousong Zhou) simplify code (64f269ac2, Yousong Zhou) always include host_id in desc (ff2686689, Yousong Zhou)  Hostman (9)  options: add option –ovn-underlay-mtu (d714e450f, Yousong Zhou) options: add option –sdn-pid-file (61659d7b2, Yousong Zhou) options: knobs for enabling features in sdnagent (25d05899d, Yousong Zhou) options: remove k8s_cluster_cidr (68b7ecf83, Yousong Zhou) options: fix default value spec (cbe5ef416, Yousong Zhou) options: pack up a Parse() func (0e16bf8ff, Yousong Zhou) let sdnagent do port cleanup (f05e16bd1, Yousong Zhou) options: add ovn_mapped_bridge (279e68ae0, Yousong Zhou) options: add allow_xx_vms (5acbec452, Yousong Zhou)  Hotfix (1)  vpc change owners with wire (c97e2ab1c, Qiu Jian)  Informer (1)  do not inform if backend not init (7c61e9662, Zexi Li)  Iproute2 (4)  address: make Exact idempotent (4b6d385e1, Yousong Zhou) route: add del funcs (91defab40, Yousong Zhou) errors: add IsErrSrch() (690039309, Yousong Zhou) route: prepare for route del (a5c253e12, Yousong Zhou)  Keystone (3)  passwords: SetModelManager (f1dfcd5e0, Yousong Zhou) config: SetModelManager for whitelisted config (7d47ac4dd, Yousong Zhou) fix db not sync (9a6065fbf, Zexi Li)  Lb (4)  include cluster name info in details (5f49670e1, Yousong Zhou) onecloud: allow empty string for redirect_{scheme,host,path} (3fe10a738, Yousong Zhou) onecloud: disallow creating lb with vpc network (ce741a24c, Yousong Zhou) allow update cluster_id with PUT request (539521087, Yousong Zhou)  Lbagent (6)  default-params: default vrrp params from peer lbagents (71e9f99b6, Yousong Zhou) new API: GET /loadbalanceragents/default-params (2b98f75c7, Yousong Zhou) fix condition for “nothing to serve” (3ae45d55e, Yousong Zhou) standalone rate control between listener and its rules (7e2273bfb, Yousong Zhou) decouple rule redirect from listener redirect (3d58d51ab, Yousong Zhou) fend off unexpected resources just in case (7f982d5b2, Yousong Zhou)  Lbagents (2)  add check on vrrp.advert_int (258aba250, Yousong Zhou) params: add needsUpdatePeer() and updateBy() methods (57e29330b, Yousong Zhou)  Lbbackend (2)  kvm: allow adding ‘host’,“ip” backend type (b6110fd3a, Yousong Zhou) ValidateCreateLoadbalancerBackendData: use httperrors (97c5afda5, Yousong Zhou)  Lbbackends (1)  allow backends of the same region (vs. zone) (1dc312303, Yousong Zhou)  Lblistener (5)  rename filter name certificate{,_id} (0f953b8b2, Yousong Zhou) allow turning on/off redirect (471755103, Yousong Zhou) redirect: try avoid endless redirect (d3313eba4, Yousong Zhou) make scheduler an optional arg on creation (473932311, Yousong Zhou) fix updating lblistener without backend_group field (1224cd819, Yousong Zhou)  Lblistenerrule (3)  allow turning on/off redirect (856310331, Yousong Zhou) redirect: try avoid endless redirect (2cd6c8588, Yousong Zhou) allow creation even for redirect listener (d55af7af2, Yousong Zhou)  Lblisteners (4)  remove unused acl_name field (5833f1a90, Yousong Zhou) list: show acl name (04abe448f, Yousong Zhou) list: show certificate name (ab71f5e6c, Yousong Zhou) list: filter with certificate ids (07ae9c12e, Yousong Zhou)  Mcclient (5)  options: loadbalanceragents: yum as the default deploy method (5218f8aab, Yousong Zhou) lb: allow empty string as arg for –redirect-{scheme,host,path} (003884860, Yousong Zhou) options: lb: arg rename cluster{,_id} (b4ce65109, Yousong Zhou) options: add EmptyOption (d4416f614, Yousong Zhou) options: remove implied details=true for pending_delete=all (9a47116a1, Yousong Zhou)  Monitor (2)  reduce subscription mysql usage (de889ec6c, Zexi Li) refactor suggest code (995e5859e, Zexi Li)  Multicloud (4)  speed up objectstore test (d4f54af5a, Yousong Zhou) huawei: rework responses_test (020831407, Yousong Zhou) loader: guard against changing proxyFunc of default client (e711ae764, Yousong Zhou) avoid changing transport of global default http client (fd3c9e5cd, Yousong Zhou)  Networks (7)  validate that start, end, gateway ip are in the same subnet (0280b6aa5, Yousong Zhou) validateUpdateData: eliminate intermediate vars (f4a001ad6, Yousong Zhou) decrease indent (927cbd415, Yousong Zhou) sep check of masklen only for start,end type creation (f27e17727, Yousong Zhou) create eip network only in default vpc (772038024, Yousong Zhou) return HTTP 404 for sql.ErrNoRows (72c23e877, Yousong Zhou) eliminate a variable (1d78510fa, Yousong Zhou)  Opslog (4)  remove unneeded nil check (4bbf7c048, Yousong Zhou) group literal fields (50449ca01, Yousong Zhou) readability change (fbc48c792, Yousong Zhou) LogEvent: set model manager (be46546ba, Yousong Zhou)  Opt (1)  scheduler: better sort for hosts when selectHost (49b0a01b0, rainzm)  Optimized (1)  支持ip和端口过滤安全组 (f12192f1c, Qu Xuan)  Others (199)  update apis generate model (042cd597f, Zexi Li) fix reauth condition on influxdb not found (#7457) (8172a551b, wanyaoqi) fix cache non lvm disks (#7460) (381a2796b, wanyaoqi) aws elb listener\u0026rule name too long fix (38e02db07, tangbin) fix redis reset account password action log (bb500edc8, tangbin) loadblancer listener modify name fix (d9488f552, tangbin) fix deploy admin auth key (7ad7774f8, wanyaoqi) fix panic on storage failed get host (#7391) (a2d562cca, wanyaoqi) adjust schedule resource condition width (7103f4e71, Zexi Li) fix schedtag list output (2ac39e704, wanyaoqi) Add metadata for GuestTempalte details (a66ba3f39, rainzm) Add network info when list scalingGroup details (02b30326f, rainzm) 修改报警消息模版： (619322176, zhaoxiangchun) 修复统一报警bug (bb66e2d19, zhaoxiangchun) go fmt (92fbc44b6, tangbin) go fmt (d93edbe42, tangbin) host upload template check (a4d89b1f6, tangbin) huawei fetch regions\u0026projects fix (5255df021, tangbin) rename vgname centos (7ef340fb6, wanyaoqi) fix clone clean pending usage (a329cd536, wanyaoqi) capabilites add available host count (32b36ee10, wanyaoqi) fix snapshot clean pending usage (2c27db42c, wanyaoqi)   add precheck for perform action (ec933e480, wanyaoqi)   format fix (2ff5d2aaf, tangbin) fix empty else (b5aceb67f, tangbin) fix host import (2794c84ac, tangbin) fix huawei delete resource (ce9646f9e, tangbin) fix huawei elb disable healthcheck (be8da39ce, tangbin) lb sync project fix (dacc8adce, tangbin) add more log (b79c410b0, tangbin) apigateway host imports data validate (b5754d2e3, tangbin) fix GetOrCreateVpcForClassicNetwork (f9c422112, tangbin) huawei eip delete fix (fdcaa1c8e, tangbin) 修复监控报警规则删除的问题 (c65fc0f1d, zhaoxiangchun) fix error output (18bae1849, wanyaoqi) acl delete condition fix (3e5eceeef, tangbin) fix server sync status (0e617ec13, wanyaoqi) sync classic redis fix (30aa75e04, tangbin) add params auto_migrate_on_host_down (b806e536f, wanyaoqi) misc ha guest fix (65408519a, wanyaoqi) disable procutils print error info (4831aee2d, wanyaoqi) fix list guests on host (f09eb6690, wanyaoqi) cloudprovider usable filter with zone (26757cb8d, tangbin) fix guest template health check (550883197, rainzm) remove informer code for release/3.3 (a365a0f45, Zexi Li) user batch register bugfix (b52eb8491, tangbin) vendor update: update jsonutils (d335c570c, wanyaoqi)   fix local storage init local man (fe472cbf4, wanyaoqi)   misc fix (5070775cd, wanyaoqi) fix set storage info bind mount (18a023f2f, wanyaoqi) update vendor (13f44debc, tangbin) Update docker image onecloud-base and its references (eb7b055ca, rainzm) 增加influxdb的tag 的一些filter (5db35871e, zhaoxiangchun) Update Dockerfile.ansibleserver (69a4b1272, rainzm) bind mount nfs storage path (5db73a667, wanyaoqi) cluster_d required-\u003eoptional (87cf251d2, tangbin) copyright api update (a3245195a, tangbin) fix the bug introduced in #6643 (968568487, rainzm) update jsonutils (b4884e3dd, rainzm) fix deploy backup server order (207cd93fe, wanyaoqi)   add server pending deleted for host details (875108248, wanyaoqi)   include system usage (89ec83fec, wanyaoqi) server name enable upper case (6f20638f8, wanyaoqi) fix get storage capabilities with null field (615fe1da8, wanyaoqi) disable dhclient (9a6c26de1, wanyaoqi) Modify alert structure and inherit scoperesource (f20a87a5d, zhaoxiangchun) 统一报警模块 (6c66185bd, zhaoxiangchun) ignore common etcd endpoint not found error (e9da1022b, Zexi Li) support filter by cloudaccounts (561d7b0cc, wanyaoqi) fix reserved ip export keys (6af753c81, wanyaoqi) replace err with errors.cause (6b8e37c88, tangbin) shuzhou to suzhou (8514e1910, tangbin) rds postpaid instance create fix (6ecebc5f2, tangbin) fix cpu usage metrics (25310ed92, wanyaoqi) configureable reload telegraf config (714b87aa3, wanyaoqi) scripts/coverage.sh: ignore packages without test files (200029dfd, Yousong Zhou) .circleci: run tests parallelly (bf1b1f48b, Yousong Zhou) fix windows install regedit record (9372a7b9c, wanyaoqi) fix host set reserved resource func name (413d292c2, wanyaoqi) fix informer worker heap large usage (cc5f731fc, Zexi Li) fix the tag filter and result record for scheduledtask (5f2a91f2a, rainzm) fix host list servers filter (1b055f24a, wanyaoqi) Add ‘trigger’ for ScheduledTask (8a69558c8, rainzm) refactor ITableSpec signature with context (9f4d4a450, Zexi Li) image support generate name (a3043520e, wanyaoqi) 修改框架查询influxdb的时间单位 (86e687015, zhaoxiangchun) climc:allow disable term line width (0a0af5cfa, root) cancel condition release (7e9575040, tangbin) ctyun sync host wire fix (f58a9305e, tangbin) bind mount local image path to container path (8e4668213, wanyaoqi) isolated device manager: (44cbdd07a, wanyaoqi) add-enterprise-info-update-climc (bb808bd8a, tangbin) 监控数据查询增加对任意时间范围的支持 (ecd4a9407, zhaoxiangchun) 统一监控接口 (3f63e4737, zhaoxiangchun) get snapshots order by created at asc (6e0f4a494, wanyaoqi) implement generic service informer (95a58cc60, Zexi Li) 在优化建议资源列表中增加费用信息 (585385f0c, zhaoxiangchun) fix migrate with multi local storage (4d404e09d, wanyaoqi) redis\u0026rds add postpaid duration (346d55850, tangbin) declear variable and define (8fde0c62a, wanyaoqi) 修复优化建议资源列表cloudenv过滤失效的问题 (00fb77e0c, zhaoxiangchun) 类型是onecloud的notifier增加webconsole的alert (0a7b381cf, zhaoxiangchun) clean network scripts on init (73297de60, wanyaoqi) host storage misc fix: (690a5f2fc, wanyaoqi) .circleci: run with parallel level 3 (e80c938ba, Yousong Zhou) fix host name validator (ec2cb3113, wanyaoqi) fix remotefile fetch image propertites (810de8a7e, wanyaoqi) isolated device add attribute reserved resource (91ff1d7d8, wanyaoqi) zstack宿主机监控中增加参数信息进行Unmarshal (47cac3c7b, zhaoxiangchun) update for doc-gen (8a7703082, Qiu Jian) Fix the problem of field duplication when exporting fields (849628fe9, rainzm) aws lbbg cache bugfix (d99ec5771, tangbin) fix list disk attachable servers (df2e05b5b, wanyaoqi) bugfix-优化建议 (c8a0d7736, zhaoxiangchun) 优化建议增加时间筛选范围 (42ed0b1c5, zhaoxiangchun) 修复当prestate=alerting，newstate=alerting的情况无法触发notify的问题 (4a784c1d7, zhaoxiangchun) Kill processes in time \u0026 Add debug info (ff2fc7440, rainzm) image cache use lockman (127bd0ff1, wanyaoqi) add sys usage (844b865e2, wanyaoqi) README.md: use travis-ci.com as badge target link (ea373821d, Yousong Zhou) redis\u0026dbinstance add clean expired postpaids resources (0029b25f9, tangbin) host convert inject dockerd config (04b4e5713, Zexi Li) add fuzzy ip matching (f602979a2, tangbin) sync storage shared info when syncing local storage (14abf05cf, Qiu Jian) update lisDescendent scope params (6037f1514, Qiu Jian) 根据调度标签过滤网络和存储资源 (888a5463a, Qu Xuan) 可根据代理过滤云账号 (6ea25e6fc, Qu Xuan) 修复无法获取vmware宿主机监控数据的问题 (6ffb3653a, zhaoxiangchun) update vendor (d98b2b405, rainzm) modify the logic of queryCondition save the evalMatch (387880164, zhaoxiangchun) allow delete paramter config (cbe5e8890, tangbin) 修改规则执行时间 (e8a61b035, zhaoxiangchun) fix esxi disk disconnect (a5d2651fb, wanyaoqi) remove statefile in start script (0fe396d5c, wanyaoqi) clear yunionauth cookie (75328cf08, tangbin) 基于监控数据的优化建议 (cc3f5ed19, zhaoxiangchun) 在monitor的package中新增influxdb相关的功能 (6251d2da3, zhaoxiangchun) do not close worker chan (7bcedd41e, wanyaoqi) detect bmagent and hostagent service (108613bd3, Qiu Jian) guest set login account (8144d2d2f, wanyaoqi) fix import from libvirt (1ba2d92e6, wanyaoqi) huawei network id fix (002a618e7, tangbin) new local lb backend fix (8c06b50ed, tangbin) feat/ansibleserver: Install git in Dockerfile.ansibleserver-base (1fbfc7f22, Rain) feat/ansible_pb: Add climc operator for ansibleplaybooks_v2 (cf514364e, Rain) feat/ansible_pb: Add IncludeRole implments ‘ITask’ in pkg/util/ansiblev2 (faf32415f, Rain) lb acl cache add acl filter (4882a6bb2, tangbin) bm register use domain token (4f23ffb90, wanyaoqi) set cookie domain (f25bbee90, tangbin) feat/ansible_pb: Add support for requirements (331ba9bb3, Rain) 修复规则无法禁用的问题 (cb13b2241, zhaoxiangchun) bugfix mem paginate (d874b52b0, zhaoxiangchun) set host list scope system (6779db23f, wanyaoqi) apigateway-yunionauth-domain-setting (4e9264cb2, tangbin) 修复谷歌监控无法获取的问题 (d4531972d, zhaoxiangchun) support custom service url (26780e2c8, wanyaoqi) bugfix mem paginate (7c0d70414, zhaoxiangchun) fix host init without etcd (9652c97dc, wanyaoqi) fix host details output (db2d02fe0, wanyaoqi) fix update input (7353622d2, wanyaoqi) fix host health (d72724892, wanyaoqi) fix/monitor: AutoScalingNotifier.ShouldNotify should call NotifierBase.ShouldNotify (e67effaf3, Rain) add cookie domain setting option (849d1d669, tangbin) monitor,对于监控数据nodata，默认不发送邮件 (e81334c0a, zhaoxiangchun) fix/as: Set ScalingPolicy’s project as its ScalingGroup’s project (352e912c2, Rain) enable etcd lock (5158a509e, wanyaoqi) host health check (38c1c70a2, wanyaoqi) gpu host enable huge page (98377116f, wanyaoqi) fix/autoscaling: Chang the format of CoolingTime (be5c539e9, Rain) fix exsi convert disk path (9c4d3c62b, wanyaoqi) fix/notify: remove ‘v2’ from email verify url (9aa132cf3, Rain) fix/notify: Add deadline for rpc client (e1c63729d, Rain) host health check (af6c6fee8, wanyaoqi) yunionapi reset password fix (32e4ae98c, tangbin) fix/autoscaling: Change Sunday as 7 from 0 (09d7aaf39, Rain) fix/guesttemplate: Change ResetPassword as true default (203bdb2df, Rain) fix/autoscaling: fix some problem (4d8e0ba1b, Rain) host fix cmt bound, minor fix (b05d22834, wanyaoqi) aws elb health check type fix (7b6f45789, tangbin) huawei elb cookie timeout fix (b62727ae0, tangbin) ctyun subnet create bugfix (8618be1fd, tangbin) misc bugfix: (9a7c7623c, wanyaoqi) make DIRECT proxysettting default share to system (6faa4d91a, Qiu Jian) lb 负载均衡优化建议 (fc05c2d0e, zhaoxiangchun) fix/autoscaling: Add ‘scaling_group_id’ for server-list result (16226becf, Rain) fix/autoscaling: Add status ‘pending_remove’ for ScalingGroup_Guest (32280e214, Rain) guestnetworks,hosts: add alloc mapped ip addr for use in onecloud vpc (3142957f5, Yousong Zhou) fix/autoscaling: Change ScalingPolicy as VirtualResource (39d5603af, Rain) fix/autoscaling: Use UserCred’s session but AdminSession to request monitor (acb4d1cab, Rain) aliyun create elb listener fix (a06f7e7b5, tangbin) supermicro redfish support (98cec09a6, Qiu Jian) fix check ca cert (cf0cf484a, wanyaoqi) support sync disk snapshot status (54596fc42, wanyaoqi) huawei elb sync vpc (bd0a8f709, tangbin) remove aws invalid backendgroup (674764208, tangbin) keystone store service cert (b682e1b44, wanyaoqi) VMware resource pool同步 (1ef9a481c, Qu Xuan) 优化邮件格式 (6c3daec4c, zhaoxiangchun) lblis \u0026 lbbg \u0026 lbr \u0026 lbb create add fetch owner id (c977fd02c, tangbin)  Region (15)  schedtag list support resource_types (65562c25f, Zexi Li) lbagents: skip tls check for default influxdb endpoint url (7f7aef031, Yousong Zhou) lbagents: turn off guest src check (f30b191d0, Yousong Zhou) loadbalanceragents: yum as the default method (4a0d019b6, Yousong Zhou) retry set influxdb policy until completed (8e51f627a, Zexi Li) fix get resource details panic (0b70491ea, Zexi Li) fix server create params not include specified resource (4713312b3, Zexi Li) fix baremetal can’t enable public baremetal type network (80a405a8a, Zexi Li) server create prefer resource fetch by name or id (536be2ead, Zexi Li) guests: include secgroup ids in listing (e8cbaee90, Yousong Zhou) lbagent: undeploy: make it idempotent (f226d342e, Yousong Zhou) lbagents: fix deleting pending_deleted objects (f890b2b18, Yousong Zhou) cloudaccounts: re-validate only when proxysetting changed (d716405eb, Yousong Zhou) vpcs_mapped_address: fix locking (25d1c3693, Yousong Zhou) vpcs_mapped_address: alloc guestnic mapped addr backwards (138b596ec, Yousong Zhou)  Scheduler (7)  fix storage filter duplicate error message (d6b1fa02d, Zexi Li) fix memory over committed (d8d6e8c5b, Zexi Li) fix min counter get count not correct (db65bf4ef, Zexi Li) filter disabled cloudprovider (2e9307269, Zexi Li) set schedtag default strategy if input empty (e00b1fdc3, Zexi Li) get region nil panic (d049ac936, Zexi Li) fix network predicate get wrong free port (f39c82959, Zexi Li)  Sysutils (1)  rework test (458bd0c7f, Yousong Zhou)  Tasks (2)  onecloud: support disassociate eip (74920a37e, Yousong Zhou) EipDissociateTask: lock associated model (02ea7b462, Yousong Zhou)  Vendor (7)  update yunion.io/x/structarg (4ce404dd8, Yousong Zhou) update yunion.io/x/{jsonutils.pkg} (a2fda726d, Yousong Zhou) update yunion.io/x/sqlchemy (2e687997a, Yousong Zhou) update yunion.io/x/ovsdb (5ad06097c, Yousong Zhou) update yunion.io/x/ovsdb (4f68026b8, Yousong Zhou) import yunion.io/x/ovsdb (7c3d9d7f8, Yousong Zhou) tidy and vendoring (ffadb30c6, Yousong Zhou)  Vet (5)  composite literal uses unkeyed fields (fb26b0c38, Yousong Zhou) bad syntax for struct tag value (d25f92af8, Yousong Zhou) pairs not separated by spaces (b99157f64, Yousong Zhou) bad syntax for struct tag pair (c18d347b0, Yousong Zhou) unreachable code (85d238cb5, Yousong Zhou)  Vpcagent (55)  ClaimVpcGuestDnsRecords: guard against pending_deleted guests (821283952, Yousong Zhou) different direction for l3 and l4 match (97251c7cc, Yousong Zhou) ovn: claim dnsrecords for all vpcs (ba0e41d99, Yousong Zhou) models: include dnsrecords (583718014, Yousong Zhou) ovn: dns records for guest names (88095c6d8, Yousong Zhou) ovn: mark and sweep dns records (d51791396, Yousong Zhou) ovn: apply qos on eip (e442e7a25, Yousong Zhou) ovn: apply guestnetwork bw_limit (4b44f21ab, Yousong Zhou) ovn: use FindXxxReferrer_yyy (4b299846d, Yousong Zhou) ovn: set underlay mtu size in config file (2841e245e, Yousong Zhou) ovn: mix eipgw and distgw (83a44ce94, Yousong Zhou) models: include elasticip (822ba5875, Yousong Zhou) ovn: add and use mac.HashVpcHostDistgwMac() (22090a379, Yousong Zhou) models: separate Copy() and CopyJoined() (146ab44fb, Yousong Zhou) apihelper: use CopyJoined() (cb27b1805, Yousong Zhou) models: add CopyJoined() (c4b308489, Yousong Zhou) remove unused code (8873c8905, Yousong Zhou) apihelper: use its own options (230f004f3, Yousong Zhou) models: remove now boilerplate code (3e09d4920, Yousong Zhou) apihelper: add interface IModelSetListOptionProvider (c7fee7c76, Yousong Zhou) models: modelset: details=false for networks (f5360264f, Yousong Zhou) models: include wires (3a51985fc, Yousong Zhou) ovn: preparation: skip default vpc (5fdd534f7, Yousong Zhou) ovn: preparation: use network.Vpc.Id (a7a3beae2, Yousong Zhou) apihelper: use IModelSet.IncludeEmulated() (e0349f92b, Yousong Zhou) models: modelset: add IncludeEmulated() method (5bf45ad65, Yousong Zhou) apihelper: use IModelSet.IncludeDetails() (39a19d1c6, Yousong Zhou) models: modelset: add IncludeDetails() method (2a0cac9d4, Yousong Zhou) ovnutil: destroy non root obj first (4d54972a9, Yousong Zhou) ovn: cmp: generate clean args in a single batch (6d788e052, Yousong Zhou) ovn: use db.FindOneMatchByAnyIndex (4962bdc7e, Yousong Zhou) ovn: configure acl for lport (579641a26, Yousong Zhou) ovnutil: OvnNbctlArgsDestroy: take into account ACL (53f354612, Yousong Zhou) ovn: secgrouprules_acl (9f4daafee, Yousong Zhou) models: sort security group rules (1abdb4f13, Yousong Zhou) models: include secgroup and rules (7ba46e928, Yousong Zhou) apihelper: do not set details=true by default (f33a2e177, Yousong Zhou) ovnutil: remove old generated code (654845fd4, Yousong Zhou) ovn: use yunion.io/x/ovsdb (cae9594da, Yousong Zhou) ignore possible external subnets (218df2416, Yousong Zhou) ovn: explicitly include gateway route in classless routes (5caaccd43, Yousong Zhou) models: ignore possible external guests (4496a7bbc, Yousong Zhou) ad-hoc replacement for db.FindByIndex() (503735ebf, Yousong Zhou) models: allow guest to have multiple vpc nics (09cc38f96, Yousong Zhou) work around nics of pending deleted guest (11835889c, Yousong Zhou) fend off non-onecloud-vpc guest nics (16ced399a, Yousong Zhou) ovn: use network.GuestDns when available (d2c0ba4d5, Yousong Zhou) ovn: manage static routes (05c38c813, Yousong Zhou) ovn: guestnetwork: guard against empty dhcpopt (0578d6c49, Yousong Zhou) ovn: rename subnet, guestnetwork ovn obj names (1c50ffb21, Yousong Zhou) ovn: use cmp() when claimVpc (38354229b, Yousong Zhou) ovn: use cmp() (d8e419cfa, Yousong Zhou) add cmp() for search and pre-cleanup (4d3eba9ba, Yousong Zhou) ovn: make host ls when claimVpc (e6bb3397d, Yousong Zhou) models: include guest, host (e4ad3f419, Yousong Zhou)  Vpcs (1)  add ExternalAccessMode field (eebd15e0d, Yousong Zhou)  Webconsole (2)  fix old session make new session closed (37ee6f844, Zexi Li) fix version and others handler not handle (e56152aa4, Zexi Li)  Wires (1)  default to “default” vpc on creation (d83a7dade, Yousong Zhou)   ocadm 仓库地址: https://github.com/yunionio/ocadm\n28 commits to ocadm - v3.3.0 since this release.\nAddon (1)  add metrics server and remove itsm server (6e8ffa2, Zexi Li)  Others (27)  ocadm create cluster, 延时等待容错 (3269146, Zhang Dongliang) 高可用部署主备选取应将kube-apiserver是否工作考虑进去 (dd775ca, Zhang Dongliang) fix longhron template (6d28362, wanyaoqi) 修复 keepalived master state bug (3d452ac, Zhang Dongliang) longhorn deploy misc fix (53cbebc, wanyaoqi) update vendor for release/3.3 (ec96e95, Zexi Li) update vendor for 3.3 (bd902c2, Zhang Dongliang) fix create region zone where upgrade from v2 (b581b3d, wanyaoqi) update vendor for 3.3 (ec2d04c, Zhang Dongliang) ocadm 接入 keepalived，支持高可用 (08d74c0, Zhang Dongliang) update DefaultCalicoVersion to 3.12.1 (f82dd55, Zhang Dongliang) migrate data to longhorn (9dda325, wanyaoqi) addon longhorn (737c7c3, wanyaoqi) fetch itsm config from globalrc (0eabd9a, wanyaoqi) sync vendor with operator (d6eb026, Zexi Li) fix upgrade from v2 (442f19e, wanyaoqi) add operator priority schedule class (0c22cef, Zexi Li) 修改itsm镜像仓库信息，和项目信息对应 (eb07ee0, zhaoxiangchun) set node override name (1a51fda, wanyaoqi) set default control plane endpoint (a8f7a53, wanyaoqi) 多网卡环境下 calico 网卡选择策略 (4fbd02d, Zhang Dongliang) disable loki stack (f089a4c, Zexi Li) 修改itsm的template (3f50a3c, zhaoxiangchun) support upgrade (3ccb7eb, wanyaoqi) join args (faa9e3f, Zhang Dongliang) inherit print addon yaml opt (a4ea4d1, Zexi Li) custom csi dependent image (f0bfd56, wanyaoqi)   onecloud-operator 仓库地址: https://github.com/yunionio/onecloud-operator\n64 commits to onecloud-operator - v3.3.0 since this release.\nBug Fixes (5)  apigateway totp should default on (0520f4e, Qiu Jian) member policy requires member role (3d85738, Qiu Jian) Change xxIntervalxx type from ‘int’ to ‘*int’ (0cc2996, rainzm) Change api prefix ‘/api/v1’ as ‘api/v1’ (5fcceb2, rainzm) change command of init container for oso (019c5b0, rainzm)  Defaults (1)  using openvswitch image of tag 2.10.4-0 (cbbaa01, Yousong Zhou)  Feature (1)  add cloudid service (525f310, Qu Xuan)  Features (1)  Add support for onecloud-resource-operator (b5b9181, rainzm)  Host (1)  tell sdnagent to use common.conf (a260f9c, Yousong Zhou)  Itsm (1)  limit memory to 1G (83c05e9, Zexi Li)  Others (52)  调整统一监控 系统报警规则的注入配置 (7dc8266, zhaoxiangchun) fix etcd member count (8f5c7b5, wanyaoqi) recreate pods on pvc not local path (03b924e, wanyaoqi) 修复系统报警规则重复创建的问题 (6576384, zhaoxiangchun) fix set pvc name (821875d, wanyaoqi) fix glance pvc name (54bffda, wanyaoqi) update vendor for release/3.3 (0d99429, Zexi Li) cloudmon deployment increase [rds redis oss] monitor information collectiona (5dbf86e, zhaoxiangchun) add check if cronjob exist (5862b3b, wanyaoqi) service etcd client disable unready client (052dca4, wanyaoqi) cloudmon as deployment (d5f78cd, wanyaoqi) host image component set default toleration (6f564a2, wanyaoqi) check etcd dbsize, do compact and defrag (9ec773c, wanyaoqi) system alert init info create in operator (61f9c09, zhaoxiangchun) host image as daemonset (dcf7299, wanyaoqi) fix etcd defrag (e947444, wanyaoqi) add daemonset telegraf (78e082e, wanyaoqi) telegraf init tool (ca58141, wanyaoqi) fix:优化manifest example (4c7e1fe, lvyangyang) new pvc name with storage class (6b300f5, wanyaoqi) itsm endpoint注册为http请求 (14fcbe1, zhaoxiangchun) not register azure classic host data (e345786, Zexi Li) operator增加itsm服务 (9739e8a, zhaoxiangchun) remove put/del key on liveness probe (ffdf0eb, wanyaoqi) set cronjob default attributes (292f37a, Zexi Li) etcd cluster default use version 3.4.6 (2b293d6, wanyaoqi) bugfix：宿主机监控没有默认值注入的函数 (e48997d, zhaoxiangchun) etcd operator fix (f71a98e, wanyaoqi) fix etcd liveness probe (a7d57db, wanyaoqi) first create policy (5eae948, wanyaoqi) add max wal file (cfc762a, wanyaoqi) fix etcd arguments (d661676, wanyaoqi) 增加宿主机的监控查询的cronjob (011ae7d, zhaoxiangchun) report-server 监控间隔调整 (fba6be1, zhaoxiangchun) 修改reportserver cronjob采集监控数据的间隔 (fb88568, zhaoxiangchun) set keystone url (2bd2d63, wanyaoqi) kubeserver add service account (4cbff0a, Zexi Li) onecloud culster fix: (8a61750, wanyaoqi) mount etcd tls (6391bf8, wanyaoqi) web nginx config (0649323, Zexi Li) fix api_server url (8bc9f6c, wanyaoqi) fix cronjob update (28ca0af, wanyaoqi) etcd use tempfs (23c8a3e, wanyaoqi) adjust web nginx config (b770851, Zexi Li) create etcd service (91b75cc, wanyaoqi) do not always sync configmap (437091a, wanyaoqi) create etcd service (00127da, wanyaoqi) etcd tls endpoint (69f02e3, wanyaoqi) create etcd cluster (e25a2f7, wanyaoqi)   sync config api_server to common service (2ce9c33, wanyaoqi)   添加cronjob StartingDeadlineSeconds 参数 (daed9d9, zhaoxiangchun) add sockio web location (a0b437e, Zexi Li)  Web (1)  remove unused nginx config (6f37389, Zexi Li)  Yunionagent (1)  update content (87badd5, Zexi Li)   onecloud-service-operator 仓库地址: https://github.com/yunionio/onecloud-service-operator\n36 commits to onecloud-service-operator - v3.3.0 since this release.\nCode Refactoring (1)  Abstract the same logic and abstract interface (178b33b, rainzm)  Features (3)  init docs (1b18737, rainzm) Change field of IntOrStringStore (655cf96, rainzm) Normalize options \u0026 Add ‘dense’ options (6ec0326, rainzm)  Others (32)  Add Endpoint document (3696dc6, rainzm) Add CRD Endpoint (8e7de75, rainzm) support yaml string (e1ac25c, rainzm) fix about field reference (1341f22, rainzm) fix the reference of option’s field (368fcf2, rainzm) update README.md and CONTRIBUTING.md (2bdd574, rainzm) modify Dockerfile (454c20c, rainzm) Modify the code structure in the pkg directory (0c4466a, rainzm) Add README.md and CONTRIBUTING.md (01cff42, rainzm) modify the image name in Makefile (2fd0ec9, rainzm) add LICENSE (4c79f85, rainzm) modify copyright (758336b, rainzm) Reduce the dependence on executing ‘make image’ (a235dba, rainzm) change module name: onecloud-resource-operator=\u003eonecloud-service-operator (d4a574e, rainzm) remove ‘MetricsAddr’ and add ‘WebhookPort’ for Options (6b58d3c, rainzm) Modify Makefile and Dockerfile for vendor (b1885e7, rainzm) init vendor (be4e55a, rainzm) change module name: onecloud-service-operator=\u003eonecloud-resource-operator (6baefaa, rainzm) Modify Dockerfile and Makefile (4a14009, rainzm) Adjust the project’s directory structure (958333e, rainzm) Improve value abstraction (8abac21, rainzm) fix some problem in provider/virtualmachine.go (8b812fb, rainzm) Set the ansible_user as ‘cloudroot’ when hypervisor is not ‘kvm’ (6b12bdc, rainzm) fix IsServerErr: code ‘500’ is also ServerErr (403c3bc, rainzm) Modify the json desc about ‘Bw’ in VMNewEipSpec (c794687, rainzm) fix some comment (29ce124, rainzm) fix ‘dealErr’ and update Dockerfile, kustomization.yaml (6c0c072, rainzm) clear external ansibleplaybook which is finished (dbe77e4, rainzm) fix and update (7f60c79, rainzm) change module name ‘onecloud-service-operator’ to ‘yunion.io/x/onecloud-service-operator’ (2430e12, rainzm) fix and update (45c9033, rainzm) init (0e138d9, rainzm)   sdnagent 仓库地址: https://github.com/yunionio/sdnagent\n39 commits to sdnagent - v3.3.0 since this release.\nAgent (18)  ovn: no error log if the mapped bridge does not exist (eec5b58, Yousong Zhou) add eip man (24c7338, Yousong Zhou) parse/watch config from main (616a4e5, Yousong Zhou) server: use sdn_enable_guest_man (d6452ef, Yousong Zhou) server: move hostConfig watch to AgentServer (2bee515, Yousong Zhou) server: shuffle lines to prepare for conditionals (d778a93, Yousong Zhou) drop support for k8s_cluster_cidr (cf5b8bf, Yousong Zhou) use hostman options (0856fcc, Yousong Zhou) server: guest: do region api sync when needed (0b22e05, Yousong Zhou) utils: add g.NeedsSync method (e87a9e8, Yousong Zhou) server: guest: guard against emtpy g.HostId (36f6603, Yousong Zhou) server: guest: clear up classic and vpc nics handling (b56d74d, Yousong Zhou) server: guest: rename flow update/clear method names (e118828, Yousong Zhou) add ovn distgw manager (5d16d37, Yousong Zhou) utils: add mapped ip addr info (5c4a41d, Yousong Zhou) flowman: log also bridge name (bc2f5ea, Yousong Zhou) fix log level (4d985a4, Yousong Zhou) export guest.IsPending method (dc7f907, Yousong Zhou)  Build (10)  systemd: add keepalived reload command (1fd0c9d, Yousong Zhou) eipgw: use 8 byte char for auth_pass (1084304, Yousong Zhou) eipgw: let keepalived use detail log (7d8f62d, Yousong Zhou) add ansible playbook README (9263c95, Yousong Zhou) separate artifact and docker image build (c5cae93, Yousong Zhou) docker: use openvswitch 2.10.4-0 as base (86e8bc1, Yousong Zhou) add example ansible playbook for ha deployment (124d8ea, Yousong Zhou) Makefile: add mod target (a4ced7e, Yousong Zhou) remove python2 dependency (0d0b7b4, Yousong Zhou) build binaries parallelly (6239ea3, Yousong Zhou)  Hostconfig (3)  add GetOverlayMTU() (1d2f96a, Yousong Zhou) add option ovn_mapped_bridge (3e4fa32, Yousong Zhou) import auth info (02f5657, Yousong Zhou)  OWNERS (1)  add wanyaoqi (89aacb7, Yousong Zhou)  Others (1)  go.mod: vendoring onecloud v0.0.0-20200603092502-73bcfb4bb731 (a6dfd5b, Yousong Zhou)  Ovn (1)  use yunion.io/x/onecloud/pkg/vpcagent/ovn/mac (8c2d6cd, Yousong Zhou)  Utils (2)  add Empty (f3e1069, Yousong Zhou) guest: reset VpcNICs on LoadDesc (44598a7, Yousong Zhou)  Vendor (3)  use tip of onecloud release 3.2 (3cef7d3, Yousong Zhou) update yunion.io/x/onecloud (dd77171, Yousong Zhou) go mod vendor (6af0f56, Yousong Zhou)  ","excerpt":"发布时间 2020-08-02 19:03:34\n onecloud 仓库地址: …","ref":"/v3.6/zh/docs/changelog/release-3.3/3-3-0/","title":"v3.3.0"},{"body":"","excerpt":"","ref":"/v3.6/en/docs/changelog/release-3.6/","title":"release/3.6"},{"body":"","excerpt":"","ref":"/v3.6/zh/docs/changelog/release-3.6/","title":"release/3.6"},{"body":"","excerpt":"","ref":"/v3.6/en/docs/changelog/release-3.4/","title":"release/3.4"},{"body":"","excerpt":"","ref":"/v3.6/zh/docs/changelog/release-3.4/","title":"release/3.4"},{"body":"","excerpt":"","ref":"/v3.6/en/docs/changelog/release-3.3/","title":"release/3.3"},{"body":"","excerpt":"","ref":"/v3.6/zh/docs/changelog/release-3.3/","title":"release/3.3"},{"body":"","excerpt":"","ref":"/v3.6/en/docs/quickstart/","title":"Quick Start"},{"body":"","excerpt":"","ref":"/v3.6/zh/docs/quickstart/","title":"快速开始"},{"body":"功能介绍 云平台支持 Baremetal(物理机) 管理，提供的功能如下:\n  自动化上架: 物理机上架加电启动后，自动注册到云管平台，自动分配BMC IP地址，初始化IPMI账号密码，自动上报物理机硬件配置（CPU、内存、序列号、网卡、磁盘等）\n  自动化装机: 根据配置要求自动配置 RAID，自动分区格式化磁盘，自动部署操作系统镜像，自动初始化操作系统账号密码，自动分配IP地址，可以植入配置文件\n  生命周期管理: 支持物理机自动化开机，关机，重装系统，远程带外管理，卸载操作系统等操作\n  与虚拟机共享镜像: 使用虚拟机镜像部署物理机，便于虚拟机和物理机统一操作系统运行环境\n  API 支持: 以上操作均支持API操作，便于与其他系统的自动化流程集成\n  服务器型号支持: 支持Dell、HP、华为、浪潮、联想、超微等主流x86服务器厂商和机型\n  RAID 控制器支持: LSI MegaRaid, HP Smart Array, LSI MPT2SAS, LSI MPT3SAS, Mrarvell RAID等\n  转换为宿主机: 直接将物理机转换为运行虚拟机的宿主机\n  托管已有服务器： 托管已有并装好系统的物理机\n  服务架构 物理机管理服务架构如下:\n  Baremetal \u003c-\u003e DHCP Relay： 处理 PXE 网络启动\n  DHCP Relay \u003c-\u003e Baremetal Agent:\n 转发 PXE Boot 请求，获取网络启动相关的信息 通过 DHCP 和 TFTP 服务下发 PXE 配置  云平台定制的网络启动小系统(yunionos) kernel 和 initramfs: 运行 SSH 服务，制作 RAID，收集硬件信息等      Baremetal Agent \u003c-\u003e Region Server:\n 通过 Region Server 注册物理机记录 获取网络 IP 地址    Baremetal Agent \u003c-\u003e Baremetal:\n Baremetal 通知 Agent SSH 相关的登录信息 Agent 通过 SSH 配置 Baremetal 的 IPMI Agent 通过 IPMI 控制 Baremetal 开关机等操作 Agent 通过 SSH 执行做 RAID，装机，销毁等操作    Glance Server -\u003e Baremetal: Baremetal 从 Glance server 下载装机镜像\n  在交换机上开启 DHCP Relay 功能(或者使用 DHCP Relay软件)，relay 指向 Baremetal Agent\n 物理机上架通电后，设置 PXE 网络启动，DHCP Relay 会将 PXE Boot 请求转发到 Baremetal Agent，Baremetal Agent 收到 PXE Boot 请求，向 Region Server 注册物理机记录    技术细节 注册物理机 注册物理机有自动注册和手动注册两种方式，如果 Baremetal Agent 开启了自动注册功能，就会自动在云平台创建 baremetal 记录；如果为手动注册方式，就需要先调用物理机创建接口把对应的 PXE 网卡对应的 MAC 地址注册到平台。\n注册的流程如下:\n 物理机 PXE 启动时会发送 DHCP PXE boot 的请求，通过 DHCP Relay 请求会到 Baremetal Agent; Baremetal Agent 从 DHCP 请求中取出网卡 MAC 地址，拿 MAC 地址向 Region Server 过滤物理机记录; Region Server 告诉 Baremetal Agent 改 MAC 地址没有物理机，Baremetal Agent 就会新建记录，并从 Region Server 获取分配对应网段的 IP 地址, 通过内置 DHCP 服务回包给物理机; 物理机 PXE DHCP 请求获得分配的 IP 地址后，会通过 TFTP 从 Baremetal Agent 下载启动引导文件(kernel 和 initramfs)，然后使用 ramdisk 机制进入我们定制的 initramfs 小系统; initramfs 小系统启动后，会启动 sshd 服务，然后修改 root 用户密码，将这些登录信息通知回 Baremetal Agent; Baremetal Agent 收到通知后，记录 ssh 登录的信息，开始进行准备工作; 准备工作包括配置 IPMI，收集硬件信息等，当这些操作完成后，将所有信息上报给 Region Server 完成注册  yunionos 网络启动小系统 yunionos(https://github.com/yunionio/yunionos) 是我们使用 Buildroot 工具定制的用于 PXE 启动和管理物理机的小型 Linux 系统，作用如下:\n 运行 sshd 服务，提供 Baremetal Agent 远程执行命令 包含 LSI MegaRaid, HP Smart Array, LSI MPT2SAS, LSI MPT3SAS, Mrarvell RAID等驱动和工具，用于制作 RAID 包含 ipmitool 和相关 driver，用于配置和调用 IPMI BMC 管理物理机 包含 qemu-img, sgdisk, parted 等磁盘分区工具，用于创建操作系统  SSH 管理 当物理机通过 PXE 进入 yunionos 小系统后会启动 sshd 服务，并将 ssh login 信息通知给 Baremetal Agent，Baremetal Agent 会更新 ssh 相关的登录信息\nRAID 配置 RAID 配置由 Baremetal Agent 根据用户的配置，生成 raid 配置命令，通过 ssh 远程控制 yunionos 在物理机上制作 RAID\n安装操作系统 RAID 做完后，Baremetal Agent 会通过 ssh 远程控制 yunionos 安装操作系统和分区，流程如下:\n 调用 /lib/mos/rootcreate.sh 将系统创建到磁盘:   通过 wget 从 Glance Server 下载用户指定的 image 镜像 通过 qemu-img convert 命名将 image 写入到磁盘  创建好系统后，会根据用户的配置将系统盘 resize 分区 创建其它分区并格式化 Baremetal Agent 进行一些网络，磁盘配置的设置：比如 bonding，ip 设置, /etc/fstab, 改变 hostname 等  开关机 注册好的的物理机会配置好 IPMI, IPMI 相关的信息会记录在数据库，Baremetal Agent 通过 ipmitool 控制开关机\n重装操作系统 类似于安装操作系统，流程上会让安装了操作系统的物理机重新进入 yunionos 小系统，然后重新安装操作系统\n远程访问 Baremetal Agent 通过 ipmitool sol 接口提供串口控制界面\n删除操作系统 对正在运行操作系统的物理机重启进入 PXE 网络启动，进入 yunionos 小系统，调用 /lib/mos/partdestory.sh 销毁磁盘分区和相应的 raid 命令销毁 raid 配置\n","excerpt":"功能介绍 云平台支持 Baremetal(物理机) 管理，提供的功能如下:\n  自动化上架: 物理机上架加电启动后，自动注册到云管平台，自动 …","ref":"/v3.6/zh/docs/howto/baremetal/intro/","title":"介绍"},{"body":"云联壹云 原生提供基于 kvm 的私有云虚拟机管理功能，运行 kvm 虚拟机的机器叫做宿主机，这种宿主机也叫作 “计算节点”，上面会运行管理虚拟机、网络和存储的一系列服务，如何部署并上线宿主机请参考: 安装部署/计算节点。\n宿主机操作 查询 通过 host-list 查询宿主机列表，host-show 查询宿主机详情。\n# 查询 kvm 这种类型的宿主机 $ climc host-list --hypervisor kvm # 查询被禁用的 kvm 宿主机 $ climc host-list --hypervisor kvm --disabled # 查询启用的 kvm 宿主机 $ climc host-list --hypervisor kvm --enabled 启用 kvm 宿主机上线后，默认是禁用的状态，需要启用才能创建虚拟机。\n# 找到禁用的宿主机 $ climc host-list --disabled # 启用 $ climc host-enable \u003chost_id\u003e 禁用 如果完全不想让宿主机创建虚拟机，可以禁用它。\n$ climc host-disable \u003chost_id\u003e host 服务启动失败或者页面有 warning 如何处理 禁用 dhcp 服务 如果你看到了这样的提示：dhcp: dhcp client is enabled before host agent start, please disable it.\n说明你的机器之前启用过dhcp client.\n如何禁用 dhcp client：\n# 一般 centos7 的 dhcp client 都是由 NetworkManager 启动的 $ systemctl disable NetworkManager --now # 我们会检查 /var/run/dhclient-\u003cnic\u003e.pid 下是否有dhclient的pid文件来决定是否要输出 warning # 所以同时你需要清除 /var/run 下的 dhclient-\u003cnic\u003e.pid 文件, nic 需要替换成自己的网卡名，如 eth0 $ rm -f /var/run/dhclient-\u003cnic\u003e.pid 内核模块不匹配 使用我们的平台的 host 服务需要用我们的内核，如果你看到了这样的提示：\nopenvswitch: kernel module openvswitch paramters version not found, is kernel version correct ??\n或者 uname -r 输出结果中字段不包含 yn. 正确的：3.10.0-514.26.2.el7.yn20180608.x86_64\n说明你的机器使用的不是我们的内核， 需要安装我们的内核然后重启。\n如何安装我们的内核可以参考安装部署流程\n","excerpt":"云联壹云 原生提供基于 kvm 的私有云虚拟机管理功能，运行 kvm 虚拟机的机器叫做宿主机，这种宿主机也叫作 “计算节点”，上面会运行管理 …","ref":"/v3.6/zh/docs/howto/host/kvm/","title":"KVM 宿主机"},{"body":"获取镜像 上传镜像之前需要先获取镜像，途径有多种，比如从发行版官网下载用于云平台的镜像，或者自己制作。\n发行版镜像 根据自己对发行版的需要下载发行版镜像，常用的 Linux 发行版会提供云平台虚拟机使用的镜像，地址如下:\n centos: http://cloud.centos.org/centos/7/images/ ubuntu: https://cloud-images.ubuntu.com/  制作镜像 参考: 制作镜像\n上传 下载或者制作完镜像后，使用 climc image-upload 上传到云平台的 glance 服务，下面以下载 CentOS 提供的 CentOS-7-x86_64-GenericCloud-1711 举例:\n# 下载 CentOS-7-x86_64-GenericCloud-1711.qcow2  $ wget http://cloud.centos.org/centos/7/images/CentOS-7-x86_64-GenericCloud-1711.qcow2 # 上传镜像到云平台并名为 CentOS-7-x86_64-GenericCloud-1711.qcow2 $ climc image-upload --format qcow2 --os-type Linux --os-arch x86_64 --standard CentOS-7-x86_64-GenericCloud-1711.qcow2 ./CentOS-7-x86_64-GenericCloud-1711.qcow2 上传时间长短取决于网络环境和镜像大小，上传完成后需要查询镜像的状态，当状态变为 ‘active’ 时，就可以拿来使用了。( 更多的关于镜像的查询参考: 镜像查询 )\n$ climc image-show CentOS-7-x86_64-GenericCloud-1711.qcow2 | grep status | status | active | 上传参数 使用 climc help image-upload 获取各个参数解释。\n","excerpt":"获取镜像 上传镜像之前需要先获取镜像，途径有多种，比如从发行版官网下载用于云平台的镜像，或者自己制作。\n发行版镜像 根据自己对发行版的需要下 …","ref":"/v3.6/zh/docs/howto/image/upload/","title":"上传镜像"},{"body":"云平台的命令行管理工具是 climc, 可以通过该工具向后端各个服务发送API请求, 实现对资源的操控。\n通过快速开始的All in One安装或安装部署章节搭建开源版云联壹云环境时，控制节点都会安装climc，可直接跳过安装climc章节直接查看使用climc章节。\n下面介绍如何在非控制节点上安装climc。\n安装 可以通过 yum 或者源码编译的方式安装climc。\nRPM 安装 添加 yunion 的 yum 源，如果已经添加可以忽略这一步。\n$ cat \u003c\u003cEOF \u003e/etc/yum.repos.d/yunion.repo [yunion] name=Packages for Yunion Multi-Cloud Platform baseurl=https://iso.yunion.cn/yumrepo-3.2 sslverify=0 failovermethod=priority enabled=1 gpgcheck=0 EOF 安装 climc\n$ sudo yum install -y yunion-climc $ ls -alh /opt/yunion/bin/climc -rwxr-xr-x 1 root root 24M Jul 18 19:04 /opt/yunion/bin/climc 源码编译安装 首先需要搭建 go 的开发环境，然后 clone 代码，参考: 开发贡献\n# 编译 climc $ cd $GOPATH/src/yunion.io/x/onecloud $ make cmd/climc # 等待编译完成后，climc 在 _output/bin 目录下 $ ls -alh _output/bin/climc -rwxr-xr-x 1 lzx lzx 25M Jul 15 17:10 _output/bin/climc 可以根据自己的需要，将编译好的 climc 放到对应的目录，或者直接写 alias 对应到 $GOPATH/src/yunion.io/x/onecloud/_output/bin/climc 。\n使用 安装好 climc 后，可以将对应的可执行目录加入到 PATH 环境变量，下面假设 climc 所在的目录是 /opt/yunion/bin 。\n# 根据自己的需要加到 bash 或者 zsh 配置文件里面 $ echo 'export PATH=$PATH:/opt/yunion/bin' \u003e\u003e ~/.bashrc \u0026\u0026 source ~/.bashrc $ climc --help 认证配置 climc 请求云平台后端服务的流程如下:\n 通过配置信息，使用用户名密码从 keystone 获取 token token 中包含了后端服务的 endpoint 地址 climc 将对应资源的 CURD 请求发往所属的后端服务  所以在操作资源前，我们需要通过环境变量告诉 climc 想要操作的云平台和认证信息。\n目前climc支持两种认证方式：\n 通过用户名／密码认证 通过Access Key／Secret认证（从2.11开始支持）  控制节点认证配置 在控制节点上可直接通过以下命令认证配置。\n# 获取环境变量 $ ocadm cluster rcadmin export OS_AUTH_URL=https://192.168.0.246:5000/v3 export OS_USERNAME=sysadmin export OS_PASSWORD=3hV3***84srk export OS_PROJECT_NAME=system export YUNION_INSECURE=true export OS_REGION_NAME=region0 export OS_ENDPOINT_TYPE=publicURL # 认证环境变量 $ source \u003c(ocadm cluster rcadmin) 注意: 如果执行 climc 时出现 Error: Missing OS_AUTH_URL 的错误提示时，请重新执行 source \u003c(ocadm cluster rcadmin) 命令。\n非控制节点认证配置 在非控制节点做认证配置上首先需要在对应的控制节点上执行ocadm cluster rcadmin； 将输出的认证信息保存到本地的文件中，通过source命令认证配置。\n以下为用户名／密码认证的配置文件模板，通过OS_USERNAME, OS_DOMAIN_NAME, OS_PASSWORD, OS_PROJECT_NAME, OS_PROJECT_DOMAIN等字段指定用户的信息和项目的信息。\n# 在控制节点上获取认证所需要的配置信息。 $ ocadm cluster rcadmin export OS_AUTH_URL=https://192.168.0.246:5000/v3 export OS_USERNAME=sysadmin export OS_PASSWORD=3hV3***84srk export OS_PROJECT_NAME=system export YUNION_INSECURE=true export OS_REGION_NAME=region0 export OS_ENDPOINT_TYPE=publicURL # 将上述认证信息保存到文件中，方便 source 使用 $ cat \u003c\u003cEOF \u003e ~/test_rc_admin # keystone 认证地址 export OS_AUTH_URL=https://192.168.0.246:5000/v3 # 用户名 export OS_USERNAME=sysadmin # 用户密码 export OS_PASSWORD=3hV3***84srk # 用户所属项目名称 export OS_PROJECT_NAME=system # 允许 insecure https 连接 export YUNION_INSECURE=true # 对应的 region export OS_REGION_NAME=region0 # endpoint 类型为 public export OS_ENDPOINT_TYPE=publicURL EOF 以下为Access Key/Secret认证的配置文件模板，通过OS_ACCESS_KEY, OS_SECRET_KEY等两个字段指定用户的Access Key/secret。\n# 在控制节点上获取用户在一个项目中的Access Key/Secret # 生成 Secret Key $ climc credential-create-aksk +--------+----------------------------------------------+ | Field | Value | +--------+----------------------------------------------+ | expire | 0 | | secret | VGFxZkE3QTd2MmhCbmZkVkJDcFZFaGJYdUQ2c05mUXM= | +--------+----------------------------------------------+ # ID为 Access Key $ climc credential-list +-----------------------+------------+------------+-----------------------+---------+---------+-----------+---------+-----------------------+-------------+--------------+-----------------------+------+-----------------------+----------------------+----------+----------------------+ | blob | can_delete | can_update | created_at | deleted | domain | domain_id | enabled | id | is_emulated | name | project_id | type | update_version | updated_at | user | user_id | +-----------------------+------------+------------+-----------------------+---------+---------+-----------+---------+-----------------------+-------------+--------------+-----------------------+------+-----------------------+----------------------+----------+----------------------+ | {\"expire\":0,\"secret\": | true | true | 2020-06-15T11:43:32.0 | false | Default | default | true | 0d184a3c9c484e4c892f4 | false | --1592221412 | d53ea650bfe144da8ee8f | aksk | 0 | 2020-06-15T11:43:32. | sysadmin | a063d8e2cd584cc48194 | | \"VGFxZkE3QTd2MmhCbmZk | | | 00000Z | | | | | 855935e37e7 | | | 3fba417b904 | | | 000000Z | | 5e7169280435 | | VkJDcFZFaGJYdUQ2c05mU | | | | | | | | | | | | | | | | | | XM=\"} | | | | | | | | | | | | | | | | | +-----------------------+------------+------------+-----------------------+---------+---------+-----------+---------+-----------------------+-------------+--------------+-----------------------+------+-----------------------+----------------------+----------+----------------------+ *** Total: 1 Pages: 1 Limit: 2048 Offset: 0 Page: 1 *** # 将认证信息保存到文件中，方便 source 使用 $ cat \u003c\u003cEOF \u003e ~/test_rc_aksk # Access Key export OS_ACCESS_KEY=0d184a3c9c484e4c892f4855935e37e7 # Secret export OS_SECRET_KEY=VG***5mUXM= # 允许 insecure https 连接 export YUNION_INSECURE=true # keystone 认证地址 export OS_AUTH_URL=https://192.168.0.246:5000/v3 # 对应的 region export OS_REGION_NAME=region0 EOF 模板配置完成后，通过以下名称认证环境变量。\n# source 认证环境变量 $ source ~/test_rc_admin # 或者想要使用 Access Key/Secret 登陆 # source ~/test_rc_aksk # 执行climc。例如，查看虚拟机列表 $ climc server-list 注意: 如果执行 climc 时出现 Error: Missing OS_AUTH_URL 的错误提示时，请 source 或设置认证云平台的环境变量。\n可以通过查看 climc 的版本号来获取构建的信息。\n$ climc --version Yunion API client version: { \"major\": \"0\", \"minor\": \"0\", \"gitVersion\": \"v3.1.9-20200609.1\", \"gitBranch\": \"tags/v3.1.8^0\", \"gitCommit\": \"5591bbec4\", \"gitTreeState\": \"clean\", \"buildDate\": \"2020-06-09T12:00:48Z\", \"goVersion\": \"go1.13.9\", \"compiler\": \"gc\", \"platform\": \"linux/amd64\" } 运行模式 climc 有命令行运行和交互两种运行模式。\n 命令行运行: 执行完对应的资源操作命令就退出，这种模式你知道自己在做什么，并且可以作为 bash function/script 的一部分。  # 删除 server1, server2, server3 for id in server1 server2 server3; do climc server-update --delete enable $id climc server-delete $id done  交互模式: 在 shell 输入 climc，就会进入交互模式，这种模式下有自动补全和参数提示。   子命令语法 云平台有很多资源，对应 climc 的子命令, 比如 climc server-list 中的 server-list 就是子命令，可以查询虚拟机的列表。通用格式如下:\n\u003cResource\u003e-\u003cAction\u003e: Resource 表示资源, Action 表示行为 语法举例:\n server-delete: 删除虚拟机  server 是资源, delete 是行为   host-list: 查询宿主机列表  host 是资源, list 是行为    CRUD 举例:\n C: server-create, disk-create 创建资源 R: server-show, disk-list 查询资源 U: server-update, host-update 更新资源 D: server-delete, image-delete 删除资源  行为举例:\n- 中的 Action 会对应资源的操作，不同的资源会根据可进行的操作进行命名。\n server-migrate: migrate 表示迁移虚拟机 server-change-config: change-config 表示调整虚拟机配置 host-ipmi: ipmi 表示查询宿主机的 IPMI 信息  想要知道资源有哪些操作，可以进入交互模式补全查询。\n使用帮助 help climc 的子命令有很多参数，参数分为必填参数和可选参数，使用 climc help \u003csubcommand\u003e 这种格式，help 子命令会获取  提供的参数和各个参数的解释。\n比如我要查看 image-upload 命令的参数和解释:\n$ climc help image-upload ... Upload a local image Positional arguments: \u003cNAME\u003e Image Name \u003cFILE\u003e The local image filename to Upload Optional arguments: [--private] Make image private [--format {raw,qcow2,iso,vmdk,docker,vhd}] Image format [--protected] ... 高级过滤 filter TODO\nDebug 模式 如果想要知道 climc 操作资源时究竟和服务端发生了哪些请求，可以在子命令前面使用 –debug 参数，使用方式如下:\nclimc --debug \u003cResource\u003e-\u003cAction\u003e 加上 –debug 参数后，终端会有彩色的输出提示，比如 climc --debug server-list 输出如下:\n其中 CURL 部分是可以直接粘贴出来在命令行执行的。\n颜色约定  Request 使用黄色 CURL 使用蓝绿色 根据状态码显示不同颜色，可参考代码: https://github.com/yunionio/onecloud/blob/master/pkg/util/httputils/httputils.go#L234  在bash或zsh下的命令行参数提示补全 climc支持bash或zsh的命令行参数自动提示补全。\n下面以bash为例说明，在使用climc之前，执行如下命令初始化环境。\n# 启用bash命令行参数自动补全 source \u003c(climc --completion bash) 之后在bash中可以在输入climc命令后，通过tab获得命令行参数的提示。\n为了方便使用，推荐将该命令放到$HOME/.bashrc或$HOME/.bash_profile中自动初始化环境。\n","excerpt":"云平台的命令行管理工具是 climc, 可以通过该工具向后端各个服务发送API请求, 实现对资源的操控。\n通过快速开始的All in One …","ref":"/v3.6/zh/docs/howto/climc/","title":"命令行工具"},{"body":"Environmental Preparation Configuration Requirements  OS: CentOS 7.6 Minimum Configuration Requirements: CPU 4 cores, Memory 8G, Storage 100G  The following is the environment of the machine to be deployed:\n   IP Login User OS     10.168.26.216 root CentOS 7.6    Tips  10.168.26.216 is the IP of this test environment, please modify accordingly according to your own environment.\n  Related Software Dependencies  database: mariadb Ver 15.1 Distrib 5.5.56-MariaDB docker: ce-19.03.9 kubernetes: v1.15.8  Local environment requirements The local environment is the environment where the user performs the actual operation and deployment. The local environment for this installation is executing on a MAC OS laptop, which can also be operated on the machine to be deployed.\nConfigure SSH unencrypted login # Generate the local ssh keypair # (SKIP this stekp if you already have ~/.ssh/id_rsa.pub locally) $ ssh-keygen # Copy the generated ~/.ssh/id_rsa.pub public key to the machine to be deployed $ ssh-copy-id -i ~/.ssh/id_rsa.pub root@10.168.26.216 # Try to login to the machine to be deployed without password, # should be able to get the hostname of the deployed machine # without entering the login password $ ssh root@10.168.26.216 \"hostname\" Start Installation The installation tool is https://github.com/yunionio/ocboot , then according to the configuration of the machine to be deployed, use ansbile playbook to install and configure the Yunion OneCloud platform. The following operations are performed on the local environment and steps are as follows:\nDownload ocboot CentOS 7 Others # Install ansible locally $ yum install -y epel-release ansible # Git clone the ocboot installation tool locally $ git clone -b release/3.6 https://github.com/yunionio/ocboot \u0026\u0026 cd ./ocboot  # Install ansible locally $ pip install ansible # Git clone the ocboot installation tool locally $ git clone -b release/3.6 https://github.com/yunionio/ocboot \u0026\u0026 cd ./ocboot  Write deployment configuration # Write config-allinone.yml configuration file $ cat \u003c\u003cEOF \u003e./config-allinone.yml # mariadb_node indicates the node where the mariadb service needs to be deployed mariadb_node: # IP of the machine to be deployed hostname: 10.168.26.216 # SSH Login username of the machine to be deployed user: root # Username of mariadb db_user: root # Password of mariadb db_password: your-sql-password # primary_master_node indicates the machine running Kubernetes and OneCloud Platform primary_master_node: hostname: 10.168.26.216 user: root # Database connection address db_host: 10.168.26.216 # Database connection username db_user: root # Database connection password db_password: your-sql-password # IP of Kubernetes controlplane controlplane_host: 10.168.26.216 # Port of Kubernetes controlplane controlplane_port: \"6443\" # Yunion OneCloud version onecloud_version: 'v3.6.15' # Yunion OneCloud login username onecloud_user: admin # Yunion OneCloud login user's password onecloud_user_password: admin@123 # This machine serves as a Yunion OneCloud private cloud computing node as_host: true EOF Start Deployment Once the config-allinone.yml deployment configuration file is filled in, you can execute the ocboot file . /run.py . /config-allinone.yml to deploy the cluster.\n# Start deployment $ ./run.py ./config-allinone.yml .... # The following output will be displayed when the deployment is completed, # indicating successful operation # Open with your browser at https://10.168.26.216 # Login with admin/admin@123 user password to access the Web UI Initialized successfully! Web page: https://10.168.26.216 User: admin Password: admin@123 Then use your browser to visit https://10.168.26.216, enter admin for username and admin@123 for password and you will see the Web UI.\nCreate the first virtual machine The first virtual machine is created in three steps as follows.\n1. Import Images Browse to CentOS 7 cloud hosting image, select a GenericCloud image, and copy the image URL.\nIn the Compute menu, select Images then select Upload menu. Enter the image name, select Enter the image URL, paste the above CentOS 7 image URL and select OK.\nAdditional virtual machine images can be obtained by visiting https://docs.openstack.org/image-guide/obtain-images.html.\n2. Create networks (VPC and IP subnets)  Create VPC  In the Network menu, select the VPC submenu and choose Create. Enter a name, e.g. vpc0, and select the target segment, e.g. 192.168.0.0/16. Click Create.\n Create IP Subnetes  After the VPC is created, select the IP Subnets submenu and choose Create. Enter a name, for example vnet0, select VPC as the VPC you just created vpc0, select the available zone. Enter subnet segment, e.g. 192.168.100.0/24. Click Create.\n3. Create Virtual Machine In the Compute menu, select Servers and choose Create. In this UI, enter the hostname, select the mirror and IP subnet, and create the virtual machine.\nImport public cloud or other private cloud platform resources Yunion OneCloud itself is a complete private cloud, and can also unify and manage resources from other cloud platforms.\nIn the Multicloud menu, select Accounts and create a new one, fill in the authentication information of the corresponding cloud platform according to your needs, and after configuring the cloud account, the Yunion OneCloud service will synchronize the resources of the corresponding cloud platform, and you can view them in the Web UI after the synchronization is completed.\nFAQ 1. Can’t find the virtual machine menu in Web UI? Machine deployed using the All in One way is treated as Yunion OneCloud private cloud computing node by default, which has the ability to create and manage virtual machines.\nIf there is no virtual machine creation button it should be that the private cloud computing node is not enabled.\nPlease go to the Web UI, click Compute/Physical Resources/Hosts to view the list of hosts, enable the corresponding hosts, refresh the interface and the virtual machine creation button will appear.\nAttention If you want to use Yunion OneCloud private cloud, you need ensure the computing machine use the kernel compiled by us. You can use the following command to check whether the host uses the kernel including the yn keyword.\n# Check if yn keyword kernel is used $ uname -a | grep yn Linux office-controller 3.10.0-1062.4.3.el7.yn20191203.x86_64 # If the kernel is not the version with the yn keyword, # it may be the first time you install it using ocboot, # and you can reboot into the yn kernel $ reboot   2. Change the hostname of the node, some services fail to start Yunion OneCloud uses Kubernetes management node, depends on hostname, please change it back.\n3. How to reinstall   SSH login the remote machine, execute the command ocadm reset -f.\n  Rerun ocboot run.py script.\n  Waiting for the run to finish，use command kubectl edit deployment onecloud-operator -n onecloud. Add the following parameters, then save to close.\n  The modification in step 3 will affect the performance of onecloud-operator, so you can restore the parameters in step 3 when all services are started.  4. Other questions？ Other questions are welcome to submit Yunion OneCloud github issues: https://github.com/yunionio/onecloud/issues , we will reply as soon as possible.\n","excerpt":"Environmental Preparation Configuration Requirements  OS: CentOS 7.6 …","ref":"/v3.6/en/docs/quickstart/allinone/","title":"All in One Installation"},{"body":"前提 注意 本章内容是通过部署工具快速搭建 云联壹云 服务，如果想了解部署的细节或者部署高可用环境请参考: 安装部署 。  环境准备 机器配置要求  操作系统: 根据 CPU 架构不同，支持的发行版也不一样  X86_64: CentOS 7 ARM64: Debian 10(buster) 或者 统信 UOS   最低配置要求: CPU 4核, 内存 8G, 存储 100G  以下为待部署机器的环境:\n   IP 登录用户     10.168.26.216 root    提示  10.168.26.216 是本次测试环境的 IP，请根据自己的环境做相应修改。\n  本地环境配置要求 本地环境即用户进行实际操作部署的环境。本次测试的本地环境为 MAC 操作系统的笔记本，也可在待部署机器上进行操作。\n ssh: 开启 ssh 免密登录 本地环境安装部署 ansbile，Windows操作系统不支持安装 ansible  配置 ssh 免密登录 # 生成本机的 ssh 秘钥 (如果本地已有 ~/.ssh/id_rsa.pub 则跳过此步骤) $ ssh-keygen # 将生成的 ~/.ssh/id_rsa.pub 公钥拷贝到待部署机器 $ ssh-copy-id -i ~/.ssh/id_rsa.pub root@10.168.26.216 # 尝试免密登录待部署机器，应该不需要输入登录密码即可拿到部署机器的 hostname $ ssh root@10.168.26.216 \"hostname\" 开始安装 部署的工具是 https://github.com/yunionio/ocboot , 然后根据需要部署机器的配置， 利用 ansbile 远程登录到待部署的机器安装配置 云联壹云 服务，以下操作都在本地环境上进行操作。操作步骤如下:\n下载 ocboot CentOS 7 Debian 10 其它操作系统 # 本地安装 ansible $ yum install -y epel-release ansible # 下载 ocboot 工具到本地 $ git clone -b release/3.6 https://github.com/yunionio/ocboot \u0026\u0026 cd ./ocboot  # 本地安装 ansible $ apt install -y ansible # 下载 ocboot 工具到本地 $ git clone -b release/3.6 https://github.com/yunionio/ocboot \u0026\u0026 cd ./ocboot  # 本地安装 ansible $ pip install ansible # 下载 ocboot 工具到本地 $ git clone -b release/3.6 https://github.com/yunionio/ocboot \u0026\u0026 cd ./ocboot  编写部署配置 # 编写 config-allinone.yml 文件 $ cat \u003c\u003cEOF \u003e./config-allinone.yml # mariadb_node 表示需要部署 mariadb 服务的节点 mariadb_node: # 待部署节点 ip hostname: 10.168.26.216 # 待部署节点登录用户 user: root # mariadb 的用户 db_user: root # mariadb 用户密码 db_password: your-sql-password # primary_master_node 表示运行 k8s 和 云联壹云 服务的节点 primary_master_node: hostname: 10.168.26.216 user: root # 数据库连接地址 db_host: 10.168.26.216 # 数据库用户 db_user: root # 数据库密码 db_password: your-sql-password # k8s 控制节点的 ip controlplane_host: 10.168.26.216 # k8s 控制节点的端口 controlplane_port: \"6443\" # 云联壹云 版本 onecloud_version: 'v3.6.15' # 云联壹云 登录用户 onecloud_user: admin # 云联壹云 登录用户密码 onecloud_user_password: admin@123 # 该节点作为 云联壹云 私有云计算节点 as_host: true EOF 开始部署 当填写完 config-allinone.yml 部署配置文件后，便可以执行 ocboot 里面的 ./run.py ./config-allinone.yml 部署集群了。\n# 开始部署 $ ./run.py ./config-allinone.yml .... # 部署完成后会有如下输出，表示运行成功 # 浏览器打开 https://10.168.26.216 # 使用 admin/admin@123 用户密码登录就能访问前端界面 Initialized successfully! Web page: https://10.168.26.216 User: admin Password: admin@123 然后用浏览器访问 https://10.168.26.216 ，用户名输入 admin，密码输入 admin@123 就会进入 云联壹云 的界面。\n创建第一台虚拟机 通过如下三步创建出第一台虚拟机：\n1. 导入镜像 浏览位于 CentOS 7云主机镜像 ，选择一个GenericCloud 镜像，拷贝镜像URL。\n在 主机 菜单，选择 系统镜像，选择 上传。输入镜像名称，选择 输入镜像URL，粘贴上述CentOS 7镜像URL，选择 确定。\n可以访问 https://docs.openstack.org/image-guide/obtain-images.html 获得更多的虚拟机镜像。\n2. 创建网络（VPC和IP子网） [新建VPC] 在 网络 菜单，选择 VPC 子菜单，选择 新建。输入名称，例如 vpc0，选择目标网段，例如 192.168.0.0/16。点击 新建。\n[新建IP子网] VPC创建完成后，选择 IP子网 子菜单，选择 新建。输入名称，例如 vnet0，选择VPC为刚才创建的VPC vpc0，选择可用区，输入 子网网段，例如 192.168.100.0/24。点击 新建。\n3. 创建虚拟机 在 主机 菜单，选择 虚拟机，选择 新建。在此界面输入主机名，选择镜像和IP子网，创建虚拟机。\n导入公有云或者其它私有云平台资源 云联壹云自身是一个完整的私有云，同时也可以统一纳管其他云平台的资源。\n在 多云管理 菜单，选择 云账号 并新建，根据自己的需求填写对应云平台的认证信息，配置完云账号后 云联壹云 服务就会同步相应云平台的资源，同步完成后即可在前端查看。\nFAQ 1. 在 All in One 中找不到虚拟机界面？ All in One 部署的节点会部署 云联壹云 host 计算服务，作为宿主机，具有创建和管理私有云虚拟机的能力。没有虚拟机界面应该是 云联壹云 环境中没有启用宿主机。\n请到 管理后台 界面，点击 主机/基础资源/宿主机 查看宿主机列表，启用相应的宿主机，刷新界面就会出现虚拟机界面。\n注意 如果要使用 云联壹云 私有云虚拟机，需要宿主机使用 云联壹云 编译的内核，可使用以下命令查看宿主机是否使用 云联壹云 内核(包含 yn 关键字)。\n# 查看是否使用 yn 内核 $ uname -a | grep yn Linux office-controller 3.10.0-1062.4.3.el7.yn20191203.x86_64 # 如果内核不是带有 yn 关键字的版本，可能是第一次使用 ocboot 安装，重启即可进入 yn 内核 $ reboot   2. 修改节点的 hostname ，有些服务启动失败 k8s 管理节点，依赖于 hostname，请改回去。\n3. 如何重装   重新运行 ocboot 的脚本\n  等待运行完毕，使用kubectl edit deployment onecloud-operator -n onecloud加入下列参数，然后保存关闭。\n  第2步的修改，会影响 onecloud-operator 的性能，所以等所有服务启动，可以将第2步的参数恢复。  4. 其它问题？ 其它问题欢迎在 云联壹云 github issues 界面提交: https://github.com/yunionio/onecloud/issues , 我们会尽快回复。\n","excerpt":"前提 注意 本章内容是通过部署工具快速搭建 云联壹云 服务，如果想了解部署的细节或者部署高可用环境请参考: 安装部署 。  环境准备 机器配 …","ref":"/v3.6/zh/docs/quickstart/allinone/","title":"All in One 安装"},{"body":"云管平台通过云账号与不同平台建立连接，并同步平台上的资源到云管平台上管理。一个账户对应的云资源归属域，不同域内资源隔离，可通过共享功能让其他域使用云账号资源。当系统未启用三级权限时，所有云资源都默认属于default域。\n目前 云联壹云 平台支持纳管的平台如下：\n 公有云：阿里云（公共云和金融云）、Azure、腾讯云、AWS、华为云、UCloud、谷歌云、天翼云等，后续还将陆续支持更多云平台以满足用户的需求。 私有云：VMware、ZStack、DStack、OpenStack、阿里飞天私有云等；  入口：在云管平台左侧菜单栏中单击 “多云管理/云账号/云账号” 菜单项，进入云账号页面。\n新建云账号 说明  如需在 云联壹云 平台上管理公有云平台，至少要求云账号拥有所操作资源的管理权限。建议授予云账号平台所有功能的管理权限。 已添加的云账号不支持更改域，如用户需要将云账号上的资源同步到其他域，可以在 云联壹云 上删除云账号，再重新添加云账号到指定域。在 云联壹云 平台上删除云账号操作仅为取消纳管云账号资源，不会影响云账号上的资源。   新建阿里云账号  在云账号页面单击列表上方 “新建” 按钮，进入新建云账号页面。 选择云平台为阿里云，单击 “下一步：配置云账号” 按钮，进入配置云账号页面。 设置以下参数：  名称：阿里云账号的名称。 账号类型：目前支持对接公共云和金融云的阿里云账号。 密钥ID/密码：通过Access Key验证方式对接阿里云平台，Access Key由密钥ID（Access Key ID）和密码（Access Key Secret）组成。具体请参考：阿里云相关参数获取方式。 域：选择云账号所属的域。当云账号私有状态下，域下所有项目用户都可以使用云账号创建资源。 资源归属项目：选择将云账号上的资源同步到 云联壹云 平台的本地项目。如需将云账号上的资源按照云上项目归类，请先指定默认资源归属项目，并勾选自动创建项目。勾选后，将会在 云联壹云 平台创建与云上项目同名的本地项目，并将资源同步到对应项目中。云上没有项目归属的资源将会同步到默认资源归属项目。 代理：当云账号需要代理才可以正常访问时设置该项，留空代表直连。如没有合适的代理，直接单击“新建”超链接，在弹出的新建代理对话框中设置相关参数，创建代理。 自动同步：设置是否自动同步阿里云平台上的信息，并设置自动同步的时间。   单击 “连接测试” 按钮，测试输入的参数是否正确。 测试成功后，单击 “确定” 按钮，创建阿里云账号。  阿里云相关参数获取方式 主账号获取AccessKey   使用主账号登录阿里云控制台，单击页面右上角个人信息，展开下拉菜单，单击 _“accesskeys “_** 菜单项进入安全信息管理页面。   在安全信息管理页面，可以查看已存在的AccessKey信息，也可以单击 “创建AccessKey” 按钮新建用户AccessKey，新建AccessKey时阿里云会向账号联系人手机发送验证码，验证通过后才可以创建AccessKey。   Access Key Secret默认不显示，单击”显示 “链接，阿里云将向账号所属的联系人手机发送一个验证码，验证通过后，才会显示Access Key Secret。   RAM子账号如何获取Access Key   使用子账号登录阿里云控制台，单击页面右上角个人信息，展开下拉菜单，单击 “accesskey…” 进入安全信息管理页面。   在安全信息管理页面，单击 “创建AccessKey” 按钮，创建AccessKey。   创建成功后，AccessKeySecret信息只会展示一次，请及时保存。   注意 已创建的AccessKey，无法再查看AccessKeySecret。  通过平台管理阿里云资源，需要云账号拥有哪些权限 使用云联壹云管理阿里云资源，需要接入云账号的有足够的权限，下面列出管理云资源所用到的权限策略，如果由于接入账号未被授权导致的错误提示，请按照以下说明对接入账号进行授权：\n   权限策略 策略说明     AliyunRAMFullAccess 管理访问控制（RAM）的权限，即管理用户以及授权的权限。如果您需要CloudID功能，以及需要为子账号创建Access key时，请开启该权限   AliyunECSFullAccess 管理虚拟机服务(ECS)的权限，如果您需要管理虚拟机，请开启该权限。   AliyunCloudMonitorFullAccess 管理云监控(CloudMonitor)的权限，此权限为必须权限。   AliyunOSSFullAccess 管理对象存储(OSS)的权限，如果您需要对象存储或账单功能，请开启该权限   AliyunBSSReadOnlyAccess 只读访问费用中心(BSS)的权限，如果你需要账单或查看账户余额功能，请开启该权限    如何给子账号授权   使用主账号登录阿里云控制台，单击页面右上角个人信息，展开下拉菜单，单击 “访问控制” 菜单项 ，进入访问控制页面。   单击左侧菜单栏 “用户管理” 菜单项，进入用户管理页面。   在用户管理页面，单击指定用户操作列 “授权” 按钮，进行授权操作。   新建AWS账号  在公有云账号页面单击列表上方 “新建” 按钮，选择下拉菜单 “AWS” 菜单项，弹出新建对话框。 设置以下参数：  名称：AWS账号的名称。 账号类型：目前支持对接全球区和中国区的AWS云账号。 密钥ID/密码：对接AWS平台的密钥ID和密码信息。具体请参考AWS相关参数获取方式。 域：选择云账号所属的域。当云账号私有状态下，域下所有项目用户都可以使用云账号创建资源。 资源归属项目：选择将云账号上的资源同步到云联壹云平台的本地项目。如需将云账号上的资源按照云上项目归类，请先指定默认资源归属项目，并勾选自动创建项目。勾选后，将会在云联壹云平台创建与云上项目同名的本地项目，并将资源同步到对应项目中。云上没有项目归属的资源将会同步到默认资源归属项目。 代理：当云账号需要代理才可以正常访问时设置该项，留空代表直连。如没有合适的代理，直接单击“新建”超链接，在弹出的新建代理对话框中设置相关参数，创建代理。 开启免密登录：启用该项后，会自动将系统的SAML信息同步到云账号上，并成为云上登录的身份提供商。实现通过本系统单点登录到公有云平台。 说明 目前仅支持在创建云账号时，开启免密登录功能，将系统的saml源上传到对应的公有云云账号。如在创建云账号时，未开启免密登录，仍想使用免密登录功能，可通过Climc命令行在控制节点操作。\nclimc cloud-account-update-aws --saml-auth true \u003caccount_id\u003e\n  自动同步：设置是否自动同步AWS平台上的信息，并设置自动同步的时间间隔。   单击 “连接测试” 按钮，测试输入的参数是否正确。 单击 “确定” 按钮，创建AWS账号。  AWS相关参数获取方式 获取AWS的访问密钥   使用AWS主账号（或拥有Administrator Access管理权限的子账号）登录AWS管理控制台，单击 “IAM” 菜单项，进入IAM控制面板页面。   单击左侧菜单栏 “用户” 菜单项，进入用户管理列表，单击用户名名称项，进入指定用户详情页面。注意需要选择有足够管理权限的用户。   单击“安全证书”页签。   单击 “创建访问密钥” 按钮，在弹出的创建访问密钥对话框中即可看到密钥信息，即密钥ID（Access Key ID）、密码（Access Key Secret）。   注意 私有访问密钥仅创建时可见，请复制另存，如果不慎丢失，重新创建即可。  通过平台管理AWS资源，需要云账号具备哪些权限？    策略名称 策略说明     AdministratorAccess 完全的云资源访问权限，如果拥有此权限，您便拥有了管理所有资源的权限，无需再关注其它策略。   AmazonEC2FullAccess 如果没有AdministratorAccess策略而又需要管理虚拟机（EC2），请开启该权限。    新建Azure账号  在公有云账号页面单击列表上方 “新建” 按钮，选择下拉菜单 “Azure” 菜单项，弹出新建对话框。 设置以下参数：  名称：Azure账号的名称 账号类型：目前支持对接全球区、中国区、美国政务区、德国区的Azure云账号。 租户（Tenant）ID/客户端ID/客户端密码请参考Azure相关参数获取方式。 域：选择云账号所属的域。当云账号私有状态下，域下所有项目用户都可以使用云账号创建资源。 资源归属项目：选择将云账号上的资源同步到云联壹云平台的本地项目。如需将云账号上的资源按照云上项目归类，请先指定默认资源归属项目，并勾选自动创建项目。勾选后，将会在云联壹云平台创建与云上项目同名的本地项目，并将资源同步到对应项目中。云上没有项目归属的资源将会同步到默认资源归属项目。 代理：当云账号需要代理才可以正常访问时设置该项，留空代表直连。如没有合适的代理，直接单击“新建”超链接，在弹出的新建代理对话框中设置相关参数，创建代理。 自动同步：设置是否自动同步Azure平台上的信息，并设置自动同步的时间间隔。   单击 “连接测试” 按钮，测试输入的参数是否正确。 单击 “确定” 按钮，创建Azure云账号。  Azure相关参数获取方式 获取Azure的租户（Tenant）ID和Client信息   登录Azure控制台，单击左侧导航栏 “Azure Active Directory/应用注册” 菜单项，进入应用注册页面。建议新建一个专门的应用程序供云管平台调用Azure API。   单击 新注册 按钮，在进入的注册应用程序页面，设置名称为任意值、设置受支持的账户类型为“仅此目录中的账户”，重定向URI设置为web，并输入以”https://“或”http://localhost“开头的URL地址，单击 “注册” 按钮。   创建成功后，系统自动显示刚创建的应用程序详情页面。该页面的应用程序（客户端）ID即为所需的客户端ID、目录（租户）ID即为所需的租户ID。   在应用程序详情页面单击 “证书和密码” 菜单项。进入证书和密码页面。单击 “新客户端密码” 按钮。   在弹出的添加客户端对话框输入密码说明、截止日期为“从不”，单击 “添加” 按钮新建客户端密码。   保存成功后，页面密码的值即为需要的客户端密码信息。   如何把资源组的权限授权给应用程序   登录Azure控制台，单击左侧导航栏 “资源组” 菜单项，查看资源组列表，单击需要被授权的资源组名称项，进入资源组管理页面。单击 “访问控制(标识和访问管理)\" 菜单项，进入访问控制页面。   在访问控制页面单击 添加角色分配 按钮，在进入的添加角色分配页面中设置角色为“所有者”，将访问权限分配到对话框为“用户、组或服务主体”、在选择搜索框中搜索上一步骤创建的应用程序的名称，并选中应用程序，单击 “保存” 按钮。   在角色分配页面，查看资源组的权限已授权给了应用程序。\n  如何把订阅的权限授权给应用程序   登录Azure控制台，单击左侧导航栏 “所有服务” 菜单项，在所有服务列表中选择并单击 “订阅” 菜单项，进入订阅列表。   单击需要被授权的订阅，进入订阅的详情页面；   单击[访问控制(标识和访问管理)]，在进入的访问控制页面中单击 “添加角色分配” 按钮，进入添加角色分配页面。   设置角色为“所有”、选择为上面步骤创建的应用程序关键字，并选中应用程序，单击 “保存” 按钮。   在角色分配页面，查看订阅的权限已授权给应用程序。   应用程序API权限设置 请确保应用程序拥有Azure Active Directory API下的以下权限。\n   区域 API权限     Azure中国 Dictionary: Dictionary.Read.All, Dictionary.ReadWrite.All Domain: Domain.Read.All   Azure国际区 Dictionary: Dictionary.Read.All, Dictionary.ReadWrite.All Domain: Domain.Read.All, Domain.ReadWrite.All); Member: Member.Read.Hidden; Policy: Policy.Read.All;    查看及设置步骤\n以Azure国内区为例。\n  在Azure控制台，单击左侧导航栏 “Azure Active Directory/应用注册” 菜单项，进入应用注册页面。\n  在新注册的应用程序详情页面，单击 “API权限” 菜单项，进入API权限页面，查看API权限。\n  检查应用程序的API权限是否满足上面的要求，如不满足，单击 “添加权限” 按钮，弹出请求获取API权限对话框。\n  选择“Azure Active Directory”，应用程序选择“应用程序权限”，并勾选Dictionary和Domian下的所有权限，单击 “添加权限” 按钮，完成配置。\n  新建华为云账号  在云账号页面单击列表上方 “新建” 按钮，进入新建云账号页面。 选择云平台为华为云，单击 “下一步：配置云账号” 按钮，进入配置云账号页面。 设置以下参数：  名称：华为云账号的名称。 账号类型：目前支持对接全球区和中国区的华为云账号。 密钥ID/密码：对接华为云平台的密钥ID和密码信息。具体请参考华为云相关参数获取方式。 域：选择云账号所属的域。当云账号私有状态下，域下所有项目用户都可以使用云账号创建资源。 资源归属项目：选择将云账号上的资源同步到云联壹云平台的本地项目。如需将云账号上的资源按照云上项目归类，请先指定默认资源归属项目，并勾选自动创建项目。勾选后，将会在云联壹云平台创建与云上项目同名的本地项目，并将资源同步到对应项目中。云上没有项目归属的资源将会同步到默认资源归属项目。 代理：当云账号需要代理才可以正常访问时设置该项，留空代表直连。如没有合适的代理，直接单击“新建”超链接，在弹出的新建代理对话框中设置相关参数，创建代理。 开启免密登录：启用该项后，会自动将系统的SAML信息同步到云账号上，并成为云上登录的身份提供商。实现通过本系统单点登录到公有云平台。 说明 目前仅支持在创建云账号时，开启免密登录功能，将系统的saml源上传到对应的公有云云账号。如在创建云账号时，未开启免密登录，仍想使用免密登录功能，可通过Climc命令行在控制节点操作。\nclimc cloud-account-update-huawei --saml-auth true \u003caccount_id\u003e\n  自动同步：设置是否自动同步腾讯云平台上的信息，并设置自动同步的时间间隔。   单击 “连接测试” 按钮，测试输入的参数是否正确。 单击 “确定” 按钮，创建华为云账号。  华为云相关参数获取方式 如何获取华为云的API密钥 新版\n  登录华为云控制台，鼠标悬停在右上角用户名处，选择下拉菜单 “我的凭证” 菜单项，进入我的凭证页面。\n  单击左侧[访问密钥]菜单，在访问密钥页面单击 “新增访问密钥” 按钮。\n  通过验证后，会下载credentials名称的Excel表格，打开表格后即可获取密钥ID（Access Key ID）和密码（Secret Access Key）。   旧版\n 登录华为云控制台，鼠标悬停在右上角用户名处，选择下拉菜单 “我的凭证” 菜单项，进入我的凭证页面。  单击“管理访问密钥”页签，在管理访问密钥页面单击 “新增访问密钥” 按钮。  通过验证后，会下载credentials名称的Excel表格，打开表格后即可获取密钥ID（Access Key ID）和密码（Secret Access Key）。   通过平台管理华为云资源，需要云账号具备哪些权限    权限策略 策略说明     Tenant Administrator 全部云服务管理员（除IAM管理权限）    新建腾讯云账号  在云账号页面单击列表上方 “新建” 按钮，进入新建云账号页面。 选择云平台为腾讯云，单击 “下一步：配置云账号” 按钮，进入配置云账号页面。 设置以下参数：  名称：腾讯云平台的名称。 APP ID/密钥ID/密码：腾讯云账号的APP ID与账号ID有唯一对应关系。对接腾讯云平台的APP ID/密钥ID/密码。具体请参考腾讯云相关参数获取方式。 域：选择云账号所属的域。当云账号私有状态下，域下所有项目用户都可以使用云账号创建资源。 资源归属项目：选择将云账号上的资源同步到云联壹云平台的本地项目。如需将云账号上的资源按照云上项目归类，请先指定默认资源归属项目，并勾选自动创建项目。勾选后，将会在云联壹云平台创建与云上项目同名的本地项目，并将资源同步到对应项目中。云上没有项目归属的资源将会同步到默认资源归属项目。 代理：当云账号需要代理才可以正常访问时设置该项，留空代表直连。如没有合适的代理，直接单击“新建”超链接，在弹出的新建代理对话框中设置相关参数，创建代理。 开启免密登录：启用该项后，会自动将系统的SAML信息同步到云账号上，并成为云上登录的身份提供商。实现通过本系统单点登录到公有云平台。 说明 目前仅支持在创建云账号时，开启免密登录功能，将系统的saml源上传到对应的公有云云账号。如在创建云账号时，未开启免密登录，仍想使用免密登录功能，可通过Climc命令行在控制节点操作。\nclimc cloud-account-update-qcloud --saml-auth true \u003caccount_id\u003e\n  自动同步：设置是否自动同步腾讯云平台上的信息，并设置自动同步的时间间隔。   单击 “连接测试” 按钮，测试输入的参数是否正确。 单击 “确定” 按钮，创建腾讯云账号。  腾讯云相关参数获取方式 如何获取腾讯云API密钥   登录腾讯云控制台，单击右上角 “云产品” 菜单项，在展开的菜单中搜索 “云API密钥” 菜单项，单击进入API密钥管理页面。   在API密钥管理页面获取APP ID、密钥ID（SecretId）、密码（SecretKey）对应的值。   通过平台管理腾讯云资源，需要云账号具备哪些权限    权限策略 策略说明     AdministratorAccess 该策略允许您管理账户内所有用户及其权限、财务相关的信息、云服务资产。    新建UCloud账号  在公有云账号页面单击列表上方 “新建” 按钮，选择下拉菜单 “UCloud” 菜单项，弹出新建对话框。 设置以下参数：  名称：UCloud平台的名称。 公钥/私钥：获取方式具体请参考UCloud相关参数获取方式。 域：选择云账号所属的域。当云账号私有状态下，域下所有项目用户都可以使用云账号创建资源。 资源归属项目：选择将云账号上的资源同步到云联壹云平台的本地项目。如需将云账号上的资源按照云上项目归类，请先指定默认资源归属项目，并勾选自动创建项目。勾选后，将会在云联壹云平台创建与云上项目同名的本地项目，并将资源同步到对应项目中。云上没有项目归属的资源将会同步到默认资源归属项目。 代理：当云账号需要代理才可以正常访问时设置该项，留空代表直连。如没有合适的代理，直接单击“新建”超链接，在弹出的新建代理对话框中设置相关参数，创建代理。 自动同步：设置是否自动同步UCloud平台上的信息，并设置自动同步的时间间隔。   单击 “连接测试” 按钮，测试输入的参数是否正确。 单击 “确定” 按钮，创建UCloud账号。  UCloud相关参数获取方式 如何获取 UCloud API 密钥   登录 UCloud 控制台，单击顶部 “全部产品” ，搜索或选择 “开放API UAPI” 菜单项 ，进入 API 产品页面；\n  单击“API密钥”页签，进入API 密钥页面。单击 “显示” 按钮，进行手机短信二次验证；\n  通过手机验证后获取公钥和私钥值。\n  使用平台管理UCloud资源，需要云账号具备哪些权限    权限策略 策略说明     AdministratorAccess 超级管理员权限    新建Google账号 注意  请确保云联壹云平台与谷歌云网络互通。 如云联壹云平台与谷歌云网络不通，可通过配置代理访问谷歌云。    在云账号页面单击列表上方 “新建” 按钮，进入新建云账号页面。 选择云平台为“Google”，单击 “下一步：配置云账号” 按钮，进入配置云账号页面。 设置以下参数：  名称：谷歌云的云账号名称。 project_id、private_key_id、private_key、client_email等参数具体可参考Google相关参数获取方式。 域：选择云账号所属的域。当云账号私有状态下，域下所有项目用户都可以使用云账号创建资源。 资源归属项目：选择将云账号上的资源同步到云联壹云平台的本地项目。如需将云账号上的资源按照云上项目归类，请先指定默认资源归属项目，并勾选自动创建项目。勾选后，将会在云联壹云平台创建与云上项目同名的本地项目，并将资源同步到对应项目中。云上没有项目归属的资源将会同步到默认资源归属项目。 代理：当云账号需要代理才可以正常访问时设置该项，留空代表直连。如没有合适的代理，直接单击“新建”超链接，在弹出的新建代理对话框中设置相关参数，创建代理。 自动同步：设置是否自动同步Google平台上的信息，并设置自动同步的时间间隔。   单击 “连接测试” 按钮，测试输入的参数是否正确。 单击 “确定” 按钮，创建Google账号。  Google相关参数获取方式 如何获取谷歌云服务帐号密钥信息？ 纳管指定项目\n  打开“GCP Console中的IAM和管理-IAM页面”页面并登录。\n  单击顶部“选择项目”，选择需要授权的项目。\n  在左侧导航栏中选择“服务账号”，进入指定项目的服务账号页面。\n  单击 “创建服务账号” 按钮，进入创建服务账号页面。\n  配置服务账号名称、服务账号ID、服务账号说明等，单击 “创建” 按钮，创建服务账号并向此服务帐号授予对项目的访问权限。\n  选择Project-Owner或Project-Viewer角色，Owner代表对项目的管理权限，Viewer代表对项目的只读权限，如需云管平台对Google云账号资源进行管理操作，请选择Project-Owner角色，单击 “继续” 按钮。\n  向用户授予访问此服务帐号的权限 (可选)步骤对云管平台无影响，请用户根据需求设置，配置完成后，单击 “继续” 按钮。\n  在服务账号页面，单击新创建的服务账号右侧操作列按钮，单击 “创建密钥” 菜单项。\n  选择密钥类型为“JSON”，单击 “创建” 按钮，下载json格式的密钥文件，内容如下，分别获取project_id、private_key_id、private_key、client_email等内容。\n{ \"type\": \"service_account\", \"project_id\": \"[PROJECT-ID]\", \"private_key_id\": \"[KEY-ID]\", \"private_key\": \"-----BEGIN PRIVATE KEY-----\\n[PRIVATE-KEY]\\n-----END PRIVATE KEY-----\\n\", \"client_email\": \"[SERVICE-ACCOUNT-EMAIL]\", \"client_id\": \"[CLIENT-ID]\", \"auth_uri\": \"https://accounts.google.com/o/oauth2/auth\", \"token_uri\": \"https://accounts.google.com/o/oauth2/token\", \"auth_provider_x509_cert_url\": \"https://www.googleapis.com/oauth2/v1/certs\", \"client_x509_cert_url\": \"https://www.googleapis.com/robot/v1/metadata/x509/[SERVICE-ACCOUNT-EMAIL]\" }   纳管多个项目\n如需要使用上面获取的服务账户的密钥纳管多个项目，可按照以下步骤进行设置。\n  打开“GCP Console中的IAM和管理-IAM页面”页面，选择其他需要纳管的项目。\n  单击顶部 “添加” 按钮，在新成员中添加上面步骤创建的服务账号，并设置角色为Project-Owner或Project-Viewer，Owner代表对项目的管理权限，Viewer代表对项目的只读权限，如需云管平台对Google云账号资源进行管理操作，请选择Project-Owner角色，单击 “保存” 按钮。\n  重复上面的步骤，纳管更多项目。\n  启用相关API 说明 谷歌云的API具有项目属性，当需要纳管谷歌云上多个项目时，需要分别在每个项目中启用相关API。  管理谷歌云需要启用API：\n获取密钥文件后，还需要在Google API库中启用授权项目中的项目资源管理API（Cloud Resource Manager API）和自定义镜像创建机器API（Cloud Build API）。启用API后，用户可在平台管理使用谷歌云。\n  在API库的Cloud Resource Manager API页面中启用授权项目的Cloud Resource Manager API。可通过顶部切换授权项目。   在API库的Cloud Build API页面中启用授权项目的Cloud Build API。可通过顶部切换授权项目。   管理谷歌云RDS需要启用API：\n 在API库的Cloud SQL Admin API页面中启用Cloud SQL Admin API。可通过顶部切换授权项目。   新建天翼云账号  在云账号页面单击列表上方 “新建” 按钮，进入新建云账号页面。 选择云平台为“天翼云”，单击 “下一步：配置云账号” 按钮，进入配置云账号页面。 设置以下参数：  名称：天翼云的云账号名称。 账号类型：目前支持对接全球区和中国区的天翼云账号。 密钥ID、密码获取方式：目前无法直接使用天翼云官网界面上申请的密钥信息，需要用户联系天翼云技术支持获取Access Key Id和Secret Access Key信息，并需要在天翼云上配置ip白名单。如用户不清楚如何获取，可直接联系运维人员寻求帮助。 域：选择云账号所属的域。当云账号私有状态下，域下所有项目用户都可以使用云账号创建资源。 资源归属项目：选择将云账号上的资源同步到平台的本地项目。如需将云账号上的资源按照云上项目归类，请先指定默认资源归属项目，并勾选自动创建项目。勾选后，将会在平台创建与云上项目同名的本地项目，并将资源同步到对应项目中。云上没有项目归属的资源将会同步到默认资源归属项目。 代理：当云账号需要代理才可以正常访问时设置该项，留空代表直连。如没有合适的代理，直接单击“新建”超链接，在弹出的新建代理对话框中设置相关参数，创建代理。 自动同步：设置是否自动同步天翼云平台上的信息，并设置自动同步的时间间隔。   单击 “连接测试” 按钮，测试输入的参数是否正确。 测试通过后，单击 “确定” 按钮，创建天翼云账号。  新建VMware账号 支持版本\n支持纳管VMware 5.0~7.0版本。\nVMware资源纳管流程\n 新建VMware云账号并为Exsi宿主机配置IP子网，若无保护宿主机IP的IP子网，将无法同步VMware宿主机下的资源。建议为每个VMware账号单独配置一个二层网络。 全量同步即可使用VMware资源创建VMware平台的虚拟机。  操作步骤\n 在云账号页面单击列表上方 “新建” 按钮，进入新建云账号页面。 选择云平台为VMware，单击 “下一步：配置云账号” 按钮，进入配置云账号页面。 设置以下参数：  名称：VMware账号的名称。 vCenter地址：vCenter服务器的域名或IP地址。 端口号：默认为443。 账号：vCenter的管理员用户名。 密码：vCenter管理员用户的密码。 域：选择云账号所属的域。当云账号私有状态下，域下所有项目用户都可以使用云账号创建资源。 资源归属项目：选择将云账号上的资源同步到平台的本地项目。如需将云账号上的资源按照云上项目归类，请先指定默认资源归属项目，并勾选自动创建项目。勾选后，将会在平台创建与云上项目同名的本地项目，并将资源同步到对应项目中。云上没有项目归属的资源将会同步到默认资源归属项目。 代理：当云账号需要代理才可以正常访问时设置该项，留空代表直连。如没有合适的代理，直接单击“新建”超链接，在弹出的新建代理对话框中设置相关参数，创建代理。 自动同步：设置是否自动同步vCenter上信息，若启用需要设置自动同步的时间间隔。   单击 “连接测试” 按钮，测试输入的参数是否正确。 测试通过后，单击 “下一步：配置物理机IP” 按钮，进入配置物理机IP页面。 上方列表中显示账号下的宿主机的IP信息，并自动检测平台中该域下已有的IP子网是否包含宿主机IP；如不满足，则在配置物理机IP中自动创建包含宿主机IP的IP子网，用户可根据需求更改相关参数。 单击 “下一步：配置虚拟机IP” 按钮，进入配置虚拟机IP页面。 上方列表中显示账号下的虚拟机的IP信息，并自动检测平台中该域下已有的IP子网是否包含所有虚拟机IP；如不满足，则在配置虚拟机IP中自动创建包含虚拟机IP的IP子网，用户可根据需求更改相关参数。 配置完成后，单击 “确定” 按钮，创建VMware云账号、相关IP子网，并开始同步云账号上的资源。  新建OpenStack账号 支持版本\n支持纳管OpenStack M版及之后版本。\n注意事项\n如果纳管的OpenStack平台认证地址是域名时，还需要在控制节点上配置域名解析，否则会因为无法解析域名导致无法同步OpenStack平台的资源。\n步骤如下：\n# 修改coredns的configmap $ kubectl edit cm -n kube-system coredns Corefile: | .:53 { errors health kubernetes cluster.local in-addr.arpa ip6.arpa { pods insecure upstream fallthrough in-addr.arpa ip6.arpa ttl 30 } hosts { 192.168.1.2 domain fallthrough } prometheus :9153 forward . /etc/resolv.conf cache 30 loop reload loadbalance } # 在“prometheus :9153”上方添加hosts相关信息，配置IP地址和域名。 hosts { 192.168.1.2 domain fallthrough } # 配置完成后，重启coredns $ kubectl rollout restart deployment -n kube-system coredns 操作步骤\n说明 成功创建OpenStack账号后，由于云管平台获取不到OpenStack平台上存储的真正容量，所以需要在存储-块存储页面设置OpenStack存储容量，请尽量将存储容量设置为存储的真实容量以尽可能的使用存储，避免由于设置的容量超出存储的真实容量而导致磁盘创建失败   在云账号页面单击列表上方 “新建” 按钮，进入新建云账号页面。 选择云平台为OpenStack，单击 “下一步：配置云账号” 按钮，进入配置云账号页面。 设置以下参数：  名称：OpenStack账号的名称。 认证地址：OpenStack管理平台的认证地址，如http://host:port/v3。 账号：OpenStack平台的管理员用户名，如admin。 密码：OpenStack平台管理员用户的密码。 项目：OpenStack平台上的项目，如admin项目。 Domain Name：OpenStack平台上的Domain name，如default。 域：选择云账号所属的域。当云账号私有状态下，域下所有项目用户都可以使用云账号创建资源。 资源归属项目：OpenStack平台只支持将云账号上的资源按照云上项目归类且默认资源归属项目不能手动指定，如需更改默认资源归属项目，请在订阅列表中更改项目。勾选自动创建项目将会在平台创建与云上项目同名的本地项目，并将资源同步到对应项目中。云上没有项目归属的资源将会同步到默认资源归属项目。 代理：当云账号需要代理才可以正常访问时设置该项，留空代表直连。如没有合适的代理，直接单击“新建”超链接，在弹出的新建代理对话框中设置相关参数，创建代理。 自动同步：设置是否自动同步OpenStack平台上的信息，并设置自动同步的时间间隔，最低为30分钟。   单击 “连接测试” 按钮，测试输入的参数是否正确。 测试通过后，单击 “确定” 按钮，创建OpenStack账号。  新建ZStack/DStack账号 支持版本\n支持纳管ZStack 3.5.0版本及之后版本。\n操作步骤\n  在云账号页面单击列表上方 “新建” 按钮，进入新建云账号页面。\n  选择云平台为ZStack或DStack，单击 “下一步：配置云账号” 按钮，进入配置云账号页面。\n  设置以下参数：\n 名称：ZStack或DStack账号的名称。 认证地址：ZStack或DStack平台的认证地址，一般为http://host:8080/，host为ZStack或DStack控制节点的IP地址。 密钥ID：即ZStack或DStack平台上的Access Key ID。 密码：即ZStack或DStack平台上的Access Key Secret。 说明 用户可在ZStack管理平台的[平台管理-Access Key]页面中生成新的Access Key信息或使用已有的Access Key。   域：选择云账号所属的域。当云账号私有状态下，域下所有项目用户都可以使用云账号创建资源。 资源归属项目：选择将云账号上的资源同步到平台的本地项目。如需将云账号上的资源按照云上项目归类，请先指定默认资源归属项目，并勾选自动创建项目。勾选后，将会在平台创建与云上项目同名的本地项目，并将资源同步到对应项目中。云上没有项目归属的资源将会同步到默认资源归属项目。 代理：当云账号需要代理才可以正常访问时设置该项，留空代表直连。如没有合适的代理，直接单击“新建”超链接，在弹出的新建代理对话框中设置相关参数，创建代理。 自动同步：设置是否自动同步ZStack/DStack平台上的信息，并设置自动同步的时间间隔。    单击 “连接测试” 按钮，测试输入的参数是否正确。\n  测试通过后，单击 “确定” 按钮，创建ZStack/DStack账号。\n  新建阿里飞天云 该功能用于纳管阿里飞天私有云，目前仅支持同步飞天私有云上的资源。\n 在云账号页面单击列表上方 “新建” 按钮，进入新建云账号页面。 选择云平台为飞天，单击 “下一步：配置云账号” 按钮，进入配置云账号页面。 配置以下信息：  名称：飞天云账号的名称。 密钥ID/密码：通过Access Key验证方式对接阿里云平台，Access Key由密钥ID（Access Key ID）和密码（Access Key Secret）组成。具体请参考飞天云相关参数获取方式 虚拟机端点：必填，通过飞天API的ESC Endpoint信息对接飞天云的虚拟机资源。 VPC端点：必填，通过飞天API的VPC Endpoint信息对接飞天云的VPC资源。 负载均衡端点：选填，通过飞天API的SLB Endpoint信息对接飞天云的负载均衡资源。 对象存储端点：选填，通过飞天API的OSS Endpoint信息对接飞天云的对象存储资源。 RDS端点：选填，通过飞天API的RDS Endpoint信息对接飞天云的RDS资源。 Redis端点：选填，通过飞天API的Redis Endpoint信息对接飞天云的Redis资源。 操作日志端点：选填，通过飞天API的ActionTrai Endpoint信息对接飞天云的操作日志。 监控端点：选填，通过飞天API的Metrics Endpoint信息对接飞天云的监控。 域：选择云账号所属的域。当云账号私有状态下，域下所有项目用户都可以使用云账号创建资源。 资源归属项目：选择将云账号上的资源同步到平台的本地项目。 代理：当云账号需要代理才可以正常访问时设置该项，留空代表直连。如没有合适的代理，直接单击“新建”超链接，在弹出的新建代理对话框中设置相关参数，创建代理。 自动同步：设置是否自动同步ZStack/DStack平台上的信息，并设置自动同步的时间间隔。   单击 “连接测试” 按钮，测试输入的参数是否正确。 测试通过后，单击 “确定” 按钮，创建阿里飞天私有云账号。  飞天云相关参数获取方式 飞天云获取Accesskey 只有运营管理员和一级组织管理员可以获取组织AccessKey。\n 管理员登录ASCM控制台。 在页面顶部菜单栏上，单击 “企业” 。 在 “企业” 页面的左侧导航栏中，单击 “组织管理” 。 在组织结构中，单击要添加的上级组织后面的设置图标。 在弹出的下拉菜单中，选择 “获取AccessKey” 。 在弹出的对话框中，查看组织Accesskey信息。  飞天云获取Endpoint  在地址栏中，输入ASO的访问地址region-id.aso.intranet-domain-id.com，按回车键。 输入正确的用户名及密码，单击 “登录” ，进入ASO页面。 在页面左侧导航栏中，单击 “产品运维管理 \u003e 产品列表 \u003e 天基” ，跳转到天基控制台页面。 在天基控制台左侧导航栏中选择 “报表” 。 在 “全部报表” 页面搜索 “服务注册变量” 。单击 “服务注册变量” 。 在服务注册变量页面，单击Service旁边的图标，搜索对应产品服务。 在服务的Service Registration列中，单击鼠标右键，选择 “选择更多” 。 在 “详情” 页面查看产品服务的Endpoint地址。  新建S3账号 S3即Simple Storage service。在创建S3账号之前需要先部署基于S3协议的对象存储服务器，如MinIO等，MinIO的安装部署参考链接。\n  在云账号页面单击列表上方 “新建” 按钮，进入新建云账号页面。\n  选择云平台为S3，单击 “下一步：配置云账号” 按钮，进入配置云账号页面。\n  设置以下参数：\n 名称：S3对象存储服务器的名称。 接入地址：S3对象存储服务器的接入地址。若部署MinIO服务器，接入地址格式为http://IP地址:9000。 密钥ID：即Access Key。 密码：即Secret Key。  #在MinIO存储服务器上执行以下命令，即可获取到接入地址(Endpoint)、密钥ID(Access Key)、密码（Secret Key）信息# $ ./minio server /mnt/data Endpoint: http://10.127.10.201:9000 http://127.0.0.1:9000 AccessKey: XRSN7GL67M70AM342UGV SecretKey: mUd+e+h0DS3oIDEvF27b2EE4l+WN5MuZ2ZI+VOag  域：选择云账号所属的域。当云账号私有状态下，域下所有项目用户都可以使用云账号创建资源。 资源归属项目：选择将云账号上的资源同步到平台的本地项目。如需将云账号上的资源按照云上项目归类，请先指定默认资源归属项目，并勾选自动创建项目。勾选后，将会在平台创建与云上项目同名的本地项目，并将资源同步到对应项目中。云上没有项目归属的资源将会同步到默认资源归属项目。 代理：当云账号需要代理才可以正常访问时设置该项，留空代表直连。如没有合适的代理，直接单击“新建”超链接，在弹出的新建代理对话框中设置相关参数，创建代理。 自动同步：设置是否自动同步S3对象存储服务器上的信息，并设置自动同步的时间间隔。    单击 “连接测试” 按钮，测试输入的参数是否正确。\n  测试通过后，单击 “确定” 按钮，创建S3账号。\n  新建Ceph账号 该功能用于对接并导入ceph对象存储资源。\n 在云账号页面单击列表上方 “新建” 按钮，进入新建云账号页面。 选择云平台为Ceph，单击 “下一步：配置云账号” 按钮，进入配置云账号页面。 设置以下参数：  名称：ceph对象存储服务器的名称。 接入地址：ceph对象存储服务器的接入地址。 密钥ID：ceph对象存储服务器的密钥ID。 密码：密钥ID对应的密码信息。 域：选择云账号所属的域。当云账号私有状态下，域下所有项目用户都可以使用云账号创建资源。 资源归属项目：选择将云账号上的资源同步到平台的本地项目。如需将云账号上的资源按照云上项目归类，请先指定默认资源归属项目，并勾选自动创建项目。勾选后，将会在平台创建与云上项目同名的本地项目，并将资源同步到对应项目中。云上没有项目归属的资源将会同步到默认资源归属项目。 代理：当云账号需要代理才可以正常访问时设置该项，留空代表直连。如没有合适的代理，直接单击“新建”超链接，在弹出的新建代理对话框中设置相关参数，创建代理。 自动同步：设置是否自动同步Ceph对象存储上的信息，并设置自动同步的时间间隔。   单击 “连接测试” 按钮，测试输入的参数是否正确。 测试通过后，单击 “确定” 按钮，创建Ceph账号。  新建XSKY账号 该功能用于对接并导入XSKY存储资源，要求用户环境中存在XSKY对象存储。\n 在云账号页面单击列表上方 “新建” 按钮，进入新建云账号页面。 选择云平台为XSKY，单击 “下一步：配置云账号” 按钮，进入配置云账号页面。 设置以下参数：  名称：XSKY存储服务器的名称。 接入地址：XSKY存储服务器的接入地址。 密钥ID：XSKY对象存储服务器的密钥ID。 密码：密钥ID对应的密码信息。 域：选择云账号所属的域。当云账号私有状态下，域下所有项目用户都可以使用云账号创建资源。 资源归属项目：选择将云账号上的资源同步到平台的本地项目。如需将云账号上的资源按照云上项目归类，请先指定默认资源归属项目，并勾选自动创建项目。勾选后，将会在平台创建与云上项目同名的本地项目，并将资源同步到对应项目中。云上没有项目归属的资源将会同步到默认资源归属项目。 代理：当云账号需要代理才可以正常访问时设置该项，留空代表直连。如没有合适的代理，直接单击“新建”超链接，在弹出的新建代理对话框中设置相关参数，创建代理。 自动同步：设置是否自动同步XSKY对象存储上的信息，并设置自动同步的时间间隔。   单击 “连接测试” 按钮，测试输入的参数是否正确。 测试通过后，单击 “确定” 按钮，创建XSKY账号。  全量同步 该功能用于全量同步账号上的资源信息。\n注意  禁用状态的云账号不支持全量同步； 当云账号设置了自动同步也不支持全量同步。   单个云账号全量同步\n 在云账号页面，单击云账号右侧操作列 “全量同步” 按钮，全量同步云账号上的资源信息。  批量全量同步\n 在云账号列表勾选一个或多个云账号，单击列表上方 “批量操作” 按钮，选择下拉菜单 “全量同步” 菜单项，全量同步云账号上的资源信息。  设置自动同步 该功能用于设置云账号是否开启自动同步，并设置自动同步间隔时间。自动同步即增量同步云账号上的资源。\n单个云账号设置自动同步\n 在云账号页面，单击云账号右侧操作列 “更多” 按钮，选择下拉菜单 “设置自动同步” 菜单项，弹出设置自动同步对话框。 勾选是否启用自动同步，若启用自动同步，设置自动同步的时间间隔（间隔大于30分钟），单击 “确定” 按钮。  批量设置自动同步\n 在云账号列表勾选一个或多个云账号，单击列表上方 “批量操作” 按钮，选择下拉菜单 “设置自动同步” 菜单项，弹出设置自动同步对话框。 勾选是否启用自动同步，若启用自动同步，设置自动同步的时间间隔（间隔大于30分钟），单击 “确定” 按钮。  更新账号密码 该功能用于更新云账号的账号和密码信息。不同平台的云账号参数不同。不同平台账号密码获取方式请参考对应的新建云账号章节。禁用状态的云账号不支持该操作。\n注意 VMware云账号暂不支持更新账号。   在云账号列表中，分别单击不同平台云账号操作列 “更多” 按钮，选择下拉菜单 “更新账号密码” 菜单项，弹出更新账号密码对话框。 修改不同平台的账号密码信息，修改完成后，单击 “确定” 按钮。  更新账单文件 该功能用于更新云账号的账单文件，仅阿里云、华为云、AWS、Azure、Google支持。不同平台的账单文件参数不同，不同平台账号密码获取方式请参考对应的新建云账号章节。\n 在云账号列表中，分别单击不同平台云账号操作列 “更多” 按钮，选择下拉菜单 “更新账单文件” 菜单项，进入更新账单文件页面。 修改不同平台的账单文件参数，修改完成后，单击 “确定” 按钮。  连接测试 该功能用于测试账号的连接状态并同步云账号上的资源信息。禁用状态的云账号不支持该操作。\n单个云账号连接测试\n 在云账号页面，单击云账号右侧操作列 “更多” 按钮，选择下拉菜单 “连接测试” 菜单项，测试账号连接状态，若处于云账号连接状态则同步云账号上资源信息。  批量连接测试\n 在云账号列表勾选一个或多个云账号，单击列表上方 “批量操作” 按钮，选择下拉菜单 “连接测试” 菜单项，测试账号连接状态，若处于云账号连接状态则同步云账号上资源信息。  设置共享 该功能用于设置云账号的共享状态。\n云账号不同与其它域资源，有5种共享情况。\n 不共享（私有）：即云账号上的资源仅云账号所属域可用。 共享云订阅-部分（多域共享云订阅）：当共享云订阅，并指定部分域后，管理员可以在订阅页面更改项目，只能选择订阅共享的域下的项目。设置完成后，云账号资源只有项目所在域中的用户使用。 共享云订阅-全部（全局共享云订阅）：当共享云订阅选择全部域后，管理员以在订阅页面更改项目，可以选择任意域下的项目。设置完成后，云账号资源只有项目所在域中的用户使用。 共享云账号-部分（多域共享云账号）：即云账号可以共享到指定域（一个或多个），只有云账号所在域和共享域下的用户可以使用云账号。 共享云账号-全部（全局共享云账号）：即云账号可以共享给全部域使用，即系统中所有用户都可以使用云账号。  说明 设置共享的条件：需同时满足\n 当前用户在系统后台。 已开启三级权限。   注意 通过云账号同步下来的资源（除安全组外）的共享范围都受云账号的共享范围影响。云账号上的资源其他域是否可用需要看资源的具体共享范围。   在云账号页面，单击云账号右侧操作列 “更多” 按钮，选择下拉菜单 “设置共享” 菜单项，弹出设置共享对话框。 配置以下参数：  当共享范围选择为“不共享”时，即云账号的共享范围为私有，仅云账号所属域可以使用云账号的资源。 当共享范围选择为“共享云订阅”时，需要选择共享的域。  当域选择其中一个或多个域时，即云账号的共享范围为共享云订阅-部分，后续订阅更改项目时的选择范围为共享域下的任意项目。更改项目后，仅项目所属域可以使用云账号的资源。 当域选择全部时，即云账号的共享范围为共享云订阅-全部，后续订阅更改项目时的可选范围为任意域下的任意项目。更改项目后，仅项目所属域可以使用云账号的资源。   当共享范围选择为“共享云账号”是，需要选择共享的域。  当域选择其中一个或多个域时，即云账号的共享范围为共享云账号-部分，只有云账号所在域和共享域下的用户可以使用云账号的资源。 当域选择全部时，即云账号的共享范围为共享云账号-全部，系统中的所有用户都可以使用云账号资源。     单击 “确定” 按钮，完成操作。  设置代理 该功能用于帮助已创建好的云账号绑定代理。\n 在云账号页面，单击云账号右侧操作列 “更多” 按钮，选择下拉菜单 “设置代理” 菜单项，弹出设置代理对话框。 选择代理，单击 “确定” 按钮。  启用 该功能用于启用\"禁用\"状态的云账号，禁用状态的云账号的资源不能被使用。\n单个启用\n 在云账号页面，单击\"禁用\"状态的云账号右侧操作列 “更多” 按钮，选择下拉菜单 “启用” 菜单项，弹出操作确认对话框。 单击 “确定” 按钮，启用云账号。  批量启用\n 在云账号列表中勾选一个或多个\"禁用\"状态的云账号，单击列表上方 “批量操作” 按钮，选择下拉菜单 “启用” 菜单项，弹出操作确认对话框。 单击 “确定” 按钮，启用云账号。  禁用 该功能用于禁用\"启用\"状态的云账号。删除之前需要先禁用云账号。\n单个禁用\n 在云账号页面，单击\"启用\"状态的云账号右侧操作列 “更多” 按钮，选择下拉菜单 “禁用” 菜单项，弹出操作确认对话框。 单击 “确定” 按钮，禁用云账号。  批量禁用\n 在云账号列表中勾选一个或多个\"启用\"状态的云账号，单击列表上方 “批量操作” 按钮，选择下拉菜单 “禁用” 菜单项，弹出操作确认对话框。 单击 “确定” 按钮，禁用云账号。  删除 该功能用于删除云账号。删除之前需要先禁用云账号。在云联壹云平台上删除云账号不会影响到云账号上的资源。\n单个删除\n 在云账号页面，单击\"禁用\"状态的云账号右侧操作列 “更多” 按钮，选择下拉菜单 “删除” 菜单项，弹出操作确认对话框。 单击 “确定” 按钮，完成操作。  批量删除\n 在云账号列表中勾选一个或多个\"禁用\"状态的云账号，单击列表上方 “批量操作” 按钮，选择下拉菜单 “删除” 菜单项，弹出操作确认对话框。 单击 “确定” 按钮，完成操作。  查看云账号详情 该功能用于查看云账号的详细信息。\n 在云账号页面，单击指定云账号名称项，进入云账号详情页面。 详情页面顶部菜单项支持对云账号进行更新账号密码、全量同步、设置自动同步、连接测试、设置为共享、设置为私有、启用、禁用、删除等操作。 查看以下信息：  基本信息：包括ID、名称、状态、域、项目、共享范围、平台、账号、代理、启用状态、同步时间、创建时间、更新时间、备注等。 账号信息：包括环境、健康状态、余额、虚拟机数量、宿主机数量。    查看宿主机信息 该功能用于查看私有云平台以及VMware平台的宿主机信息。公有云账号无该页面。\n 在云账号页面，单击“宿主机”页签，进入宿主机页面。 查看宿主机信息，并支持对宿主机进行管理操作。  订阅管理 订阅类似于子账号。通过云账号和订阅确定公有云上的可用资源。云管平台实际通过订阅在对应的公有云平台上购买资源。 订阅和云账号一样都是域资源，订阅同步下来的资源归属与云账号相同的项目，表示项目所在域下的用户都有权限使用订阅创建资源。\n VMware、OpenStack、ZStack、DStack、AWS、阿里云、腾讯云平台的云账号下只有一个订阅。 Azure、华为云、UCloud平台的云账号下支持多个订阅，其中华为云一个订阅属于一个区域。  更改项目 该功能用于更改订阅所属项目，实质为更改订阅的所属域。当云账号设置共享云订阅并指定共享范围后，管理员可通过更改项目功能修改订阅所属域，可选域为云订阅的共享范围，修改完成后仅订阅所属域中的用户有权限使用订阅资源。\n单个订阅更改项目\n 在云账号详情页面，单击“订阅”页签，进入订阅页面。 单击订阅右侧操作列 “更改项目” 按钮，弹出更改项目对话框。 单击 “确定” 按钮，完成操作。  批量更改项目\n 在云账号详情页面，单击“订阅”页签，进入订阅页面。 在列表勾选一个或多个订阅，单击列表上方 “更改项目” 按钮，弹出更改项目对话框。 单击 “确定” 按钮，完成操作。  全量同步 该功能用于全量同步订阅信息。\n说明  当云账号只有一个订阅，全量同步订阅等同于全量同步云账号。 当云账号有多个订阅，如华为云，全量同步订阅仅同步订阅下的区域信息。    在云账号详情页面，单击“订阅”页签，进入订阅页面。 单击订阅右侧操作列 “全量同步” 按钮，同步订阅信息。  启用订阅 当订阅处于”启用“状态，且状态处于“已连接”时，用户可以正常使用订阅在对应的公有云平台的区域中创建资源。\n单个启用\n 在云账号详情页面，单击“订阅”页签，进入订阅页面。 单击\"禁用\"状态的订阅右侧操作列 “更多” 按钮，选择下拉菜单 “启用” 菜单项，启用订阅。  批量启用\n 在云账号详情页面，单击“订阅”页签，进入订阅页面。 在列表中选择一个或多个\"禁用\"状态的订阅，单击列表上方 “启用” 按钮，批量启用订阅。  禁用订阅 当订阅处于\"禁用\"状态，用户无法使用订阅在对应的公有云平台的区域中创建资源。\n单个禁用\n 在云账号详情页面，单击“订阅”页签，进入订阅页面。 单击\"启用\"状态的订阅右侧操作列 “更多” 按钮，选择下拉菜单 “禁用” 菜单项，禁用订阅。  批量禁用\n 在云账号详情页面，单击“订阅”页签，进入订阅页面。 在列表中选择一个或多个\"启用\"状态的订阅，单击列表上方 “禁用” 按钮，批量禁用订阅。  查看订阅详情页面  在云账号详情页面，单击“订阅”页签，进入订阅页面。 单击订阅名称项，进入订阅详情页面。 查看以下信息。  基本信息：包括ID、名称、状态、域、项目、平台、账号、启用状态、同步时间、创建时间、更新时间、备注。 其他信息：包括健康状态等。    查看订阅下的区域 该功能用于查看订阅下的区域信息，不同平台下的订阅支持的区域不同，其中除华为云外的公有云平台，一个订阅下支持多个区域，华为云一个订阅支持一个区域，用户在公有云平台创建虚拟机时需要根据地理位置选择对应平台可用区等。\n设置同步 用户可根据使用情况设置是否同步该区域的资源，例如用户不使用阿里云国外区域的资源，可通过批量设置同步功能关闭阿里云国外区域的同步功能，后续用户全量同步云账号或订阅时，将不会同步阿里云国外区域的资源，节省全量同步的时间。\n单个区域设置同步\n 在订阅详情页面，单击“区域”页签，进入区域页面。 单击区域右侧操作列 “设置同步” 按钮，弹出设置同步对话框。 选择是否同步该区域的资源，单击 “确定” 按钮。  批量设置同步\n 在订阅详情页面，单击“区域”页签，进入区域页面。 在列表中勾选一个或多个区域，单击列表上方 “设置同步” 按钮，弹出设置同步对话框。 选择是否同步该区域的资源，单击 “确定” 按钮。  全量同步 该功能用于全量同步订阅下指定区域的资源。\n 在订阅详情页面，单击“区域”页签，进入区域页面。 单击区域右侧操作列 “全量同步” 按钮，全量同步该区域的资源。  查看订阅的云上配额 该功能用于查看公有云平台上的配额信息。\n 在订阅详情页面，单击“云上配额”页签，进入云上配额页面。 查看不同资源的配额使用情况。  查看订阅下的资源统计信息 该功能用于统计订阅下的资源信息，云账号下有多个订阅时，所有订阅的资源统计相加等于云账号下的资源统计。\n 在订阅详情页面，单击“资源统计”页签，进入资源统计页面。 查看以下信息：  基本信息：对象存储容量、对象存储文件数量、存储桶数量、磁盘容量、已挂载磁盘的容量、未挂载磁盘的容量、异常状态的磁盘的容量、弹性公网IP和公网总数、弹性IP总量、已使用的弹性公网IP总量、公网IP总量、已使用弹性公网IP和公网总数、启用的宿主机数量、启用的宿主机CPU数量、启用的宿主机CPU虚拟数量、启用的宿主机内存容量、启用的宿主机内存虚拟容量、宿主机总量、宿主机CPU总量、宿主机CPU虚拟数量、宿主机内存容量、宿主机内存虚拟容量、GPU卡总量、IP子网总量、当前项目网卡数量、虚拟机网卡数量、负载均衡网卡数量、回收站虚拟机数量、回收站虚拟机CPU的数量、回收站虚拟机磁盘容量、回收站虚拟机GPU卡数量、回收站虚拟机内存容量、IP总量、外网IP数量、关机状态虚拟机数量、关机状态虚拟机CPU数量、关机状态虚拟机磁盘容量、关机状态的虚拟机GPU卡数量、关机状态的虚拟机内存容量、区域总数量、运行状态的虚拟机数量、运行状态的虚拟机CPU数量、运行状态的虚拟机磁盘容量、运行状态的虚拟机GPU卡数量、运行状态的虚拟机内存容量、虚拟机数量、虚拟机CPU数量、虚拟机磁盘容量、虚拟机GPU卡数量、虚拟机内存容量、快照数量、存储总容量、存储总虚拟容量、VPC数量、二层网络数量、可用区的数量。    查看云账号下的项目 该功能用于查看云平台上的项目与本地项目的映射。其中VMware、OpenStack、阿里云、华为云、腾讯云、Azure平台上的项目与本地项目支持双向同步。\n说明  在云上项目的对应项目中创建资源，将会同步到对应的云上项目； 在没有对应云上项目的项目中创建资源，如果云平台上有同名项目，将会同步到同名项目上；若没有同名项目，则会在云上创建同名项目，并将资源同步到同名项目中。   切换本地项目 该功能用于更改本地项目与云上项目的映射关系。切换本地项目后，云账号的资源也将同步至新项目。\n说明  如云账号的资源在云联壹云平台上已更改项目，切换本地项目将不会影响已更改项目的资源。 切换本地项目后，计费也将同步到新项目。 域的可选范围与云帐号的共享范围有关；云账号私有时，只能选择云账号所属域；云账号共享云订阅时，只能选择云订阅所属域，云账号多域共享时，可以选择云帐号所属域和共享域。   切换本地项目\n 在订阅详情页面，单击“项目”页签，进入项目页面。 单击项目对应操作列 “切换本地项目” 按钮，弹出切换本地对话框。 选择域和项目，单击 “确定” 按钮。  批量切换本地项目\n 在订阅详情页面，单击“项目”页签，进入项目页面。 在列表中选择一个或多个项目，单击列表上方 “切换本地项目” 按钮，弹出切换本地对话框。 选择域和项目，单击 “确定” 按钮。  查看资源统计信息 该功能用于统计云账号下的资源信息。\n 在云账号详情页面，单击“资源统计”页签，进入资源统计页面。 查看以下信息：  基本信息：对象存储容量、对象存储文件数量、存储桶数量、磁盘容量、已挂载磁盘的容量、未挂载磁盘的容量、异常状态的磁盘的容量、弹性公网IP和公网总数、弹性IP总量、已使用的弹性公网IP总量、公网IP总量、已使用弹性公网IP和公网总数、启用的宿主机数量、启用的宿主机CPU数量、启用的宿主机CPU虚拟数量、启用的宿主机内存容量、启用的宿主机内存虚拟容量、宿主机总量、宿主机CPU总量、宿主机CPU虚拟数量、宿主机内存容量、宿主机内存虚拟容量、GPU卡总量、IP子网总量、当前项目网卡数量、虚拟机网卡数量、负载均衡网卡数量、回收站虚拟机数量、回收站虚拟机CPU的数量、回收站虚拟机磁盘容量、回收站虚拟机GPU卡数量、回收站虚拟机内存容量、IP总量、外网IP数量、关机状态虚拟机数量、关机状态虚拟机CPU数量、关机状态虚拟机磁盘容量、关机状态的虚拟机GPU卡数量、关机状态的虚拟机内存容量、区域总数量、运行状态的虚拟机数量、运行状态的虚拟机CPU数量、运行状态的虚拟机磁盘容量、运行状态的虚拟机GPU卡数量、运行状态的虚拟机内存容量、虚拟机数量、虚拟机CPU数量、虚拟机磁盘容量、虚拟机GPU卡数量、虚拟机内存容量、快照数量、存储总容量、存储总虚拟容量、VPC数量、二层网络数量、可用区的数量。    云用户管理 云用户即公有云平台（不支持天翼云和UCloud）上的用户，该功能用于管理公有云云账号下的云用户信息。\n云用户来源\n 当云管平台对接公有云平台云账号时，将会同步公有云平台上子账号和协作者到云管平台。 新建云用户。  说明  系统管理员可以在任意域的云账号管理云用户。 域管理员只能在本域下的云账号管理云用户。   新建云用户 该功能用于新建云用户，即在对应公有云平台上新建用户，并支持将该用户关联云联壹云平台的本地用户。关联本地用户后，本地用户可以在用户信息处的云上用户查看关联的云用户信息，并支持便捷的使用云用户登录公有云平台。\n 在云账号页面，单击公有云平台云账号名称项，进入云账号详情页面。 单击“云用户”页签，进入云用户页面。 单击列表上方 “新建” 按钮，弹性新建云用户对话框。 配置以下参数：  云订阅：仅谷歌云需要设置该参数，谷歌云的订阅对应谷歌云的项目。指定云订阅即为指定的谷歌云账号添加对应项目。 用户名：设置云用户的名称，将会使用该名称在对应公有云平台（除谷歌云外）创建用户。谷歌云必须填入已存在的账号。 说明 对于谷歌云来说，新建云用户操作即将谷歌云的已有账号与平台对接的谷歌云账号通过项目关联起来。   云用户组：将云用户加入云用户组，云用户将拥有该云用户组的所有权限。 关联本地用户：选择已加入项目的本地用户。 说明 管理后台\n 当云账号共享范围是私有或共享云订阅时，仅可以选择加入云账号所在域下项目的用户。 当云账号共享范围是全局共享时，可以选择加入加入任意域下的项目的用户。  域管理后台\n 无论云账号共享范围如何，仅可以选择加入本域下项目的用户。    邮箱：配置接收创建云用户信息的邮箱。当勾选“发送创建云用户邮件时”，将会发送创建信息到该邮箱。 说明 请确保已经在通知渠道中配置了邮箱服务。     单击 “确定” 按钮，完成操作。  同步状态 该功能用于获取云用户的当前状态。\n 在云账号页面，单击公有云平台云账号名称项，进入云账号详情页面。 单击“云用户”页签，进入云用户页面。 单击云用户右侧操作列 “同步状态” 按钮，同步云用户状态。  修改本地用户 该功能用于修改云用户关联的本地用户。修改本地用户操作将会重置云用户的密码。\n注意 谷歌云平台的云用户关联本地用户时不会重置密码。   在云账号页面，单击公有云平台云账号名称项，进入云账号详情页面。 单击“云用户”页签，进入云用户页面。 单击云用户右侧操作列 “更多” 按钮，选择下拉菜单 “修改本地用户” 菜单项，弹出修改本地用户对话框。 选择本地用户，单击 “确定” 按钮。  说明 管理后台\n 当云账号共享范围是私有或共享云订阅时，仅可以选择加入云账号所在域下项目的用户。 当云账号共享范围是全局共享时，可以选择加入加入任意域下的项目的用户。  域管理后台\n 无论云账号共享范围如何，仅可以选择加入本域下项目的用户。   关联云用户组 该功能用于将云用户加入云用户组。云用户将拥有该云用户组的所有权限。\n 在云账号页面，单击公有云平台云账号名称项，进入云账号详情页面。 单击“云用户”页签，进入云用户页面。 单击云用户右侧操作列 “更多” 按钮，选择下拉菜单 “关联云用户组” 菜单项，弹出关联云用户组对话框。 选择云用户组，单击 “确定” 按钮，完成操作。  删除 该功能用于删除云用户，删除操作将会在对应公有云平台上删除对应用户。\n单个删除\n 在云账号页面，单击公有云平台云账号名称项，进入云账号详情页面。 单击“云用户”页签，进入云用户页面。 单击云用户右侧操作列 “更多” 按钮，选择下拉菜单 “删除” 菜单项，弹出操作确认对话框。 单击 “确定” 按钮，完成操作。  批量删除\n 在云账号页面，单击公有云平台云账号名称项，进入云账号详情页面。 单击“云用户”页签，进入云用户页面。 在列表中选择一个或多个云用户，单击列表上方 “批量操作” 按钮，选择下拉菜单 “删除” 菜单项，弹出操作确认对话框。 单击 “确定” 按钮，完成操作。  查看云用户详情 该功能用于查看云用户详细信息。\n 在云账号页面，单击公有云平台云账号名称项，进入云账号详情页面。 单击“云用户”页签，进入云用户页面。 单击云用户名称项，进入云用户详情页面。 查看以下信息：包括ID、名称、状态、域、项目、平台、登录地址、关联本地用户、控制台登录、创建时间、更新时间、备注。  查看云用户关联的云用户组 该功能用于查看云用户关联的云用户组，支持将云用户从云用户组移除操作。\n移除云用户组 该功能用于将云用户从云用户组移除。\n单个移除\n 在云账号页面，单击公有云平台云账号名称项，进入云账号详情页面。 单击“云用户”页签，进入云用户页面。 单击云用户名称项，进入云用户详情页面。 单击“云用户组”页签，进入云用户组页面。 单击云用户组右侧操作列 “删除” 按钮，弹出操作确认对话框。 单击 “确定” 按钮，完成操作。  批量移除\n 在云账号页面，单击公有云平台云账号名称项，进入云账号详情页面。 单击“云用户”页签，进入云用户页面。 单击云用户名称项，进入云用户详情页面。 单击“云用户组”页签，进入云用户组页面。 在列表中选择一个或多个云用户组，单击列表上方 “删除” 按钮，弹出操作确认对话框。 单击 “确定” 按钮，完成操作。  查看云用户的操作日志 该功能用于查看云用户相关操作的操作日志。\n 在云账号页面，单击公有云平台云账号名称项，进入云账号详情页面。 单击“云用户”页签，进入云用户页面。 单击云用户名称项，进入云用户详情页面。 单击“操作日志”页签，进入操作日志页面。  加载更多日志：在操作日志页面，列表默认显示20条操作日志信息，如需查看更多操作日志，请单击 “加载更多” 按钮，获取更多日志信息。 查看日志详情：单击操作日志右侧操作列 “查看” 按钮，查看日志的详情信息。支持复制详情内容。 查看指定时间段的日志：如需查看某个时间段的操作日志，在列表右上方的开始日期和结束日期中设置具体的日期，查询指定时间段的日志信息。 导出日志：目前仅支持导出本页显示的日志。单击右上角图标，在弹出的导出数据对话框中，设置导出数据列，单击 “确定” 按钮，导出日志。    云用户组管理 该功能用于查看云账号对应的公有云平台中可用的云用户组。如当前云用户组不满足需求，可新建云用户组。\n 在云账号页面，单击公有云平台云账号名称项，进入云账号详情页面。 单击“云用户组”页签，进入云用户组页面。 对云用户组支持进行管理操作，详细请参考云用户组内容。  免密登录用户管理 该功能用于管理可以免密登录公有云平台的系统内用户。\n新建免密登录用户 该功能用于将系统内的本地用户设置为公有云平台的免密登录用户。\n 在云账号页面，单击公有云平台云账号名称项，进入云账号详情页面。 单击“免密登录用户”页签，进入免密登录用户页面。 单击 “新建” 按钮，弹出新建免密登录用户。 关联本地用户，并选择对应云用户组。 单击\u003c确定\u003e按钮，完成操作。  删除免密登录用户 该功能用于删除免密登录用户，删除后，系统内用户将无法再免密登录到公有云。\n删除免密登录用户  在云账号页面，单击公有云平台云账号名称项，进入云账号详情页面。 单击“免密登录用户”页签，进入免密登录用户页面。 单击用户右侧操作列 “删除” 按钮，弹出操作确认对话框。 单击 “确定” 按钮，完成操作。  批量删除免密登录用户  在云账号页面，单击公有云平台云账号名称项，进入云账号详情页面。 单击“免密登录用户”页签，进入免密登录用户页面。 在列表中选择一个或多个用户，单击 “删除” 按钮，弹出操作确认对话框。 单击 “确定” 按钮，完成操作。  查看操作日志 该功能用于查看云账号相关操作的日志信息\n 在云账号页面，单击指定云账号名称项，进入云账号详情页面。 单击“操作日志”页签，进入操作日志页面。  加载更多日志：在操作日志页面，列表默认显示20条操作日志信息，如需查看更多操作日志，请单击 “加载更多” 按钮，获取更多日志信息。 查看日志详情：单击操作日志右侧操作列 “查看” 按钮，查看日志的详情信息。支持复制详情内容。 查看指定时间段的日志：如需查看某个时间段的操作日志，在列表右上方的开始日期和结束日期中设置具体的日期，查询指定时间段的日志信息。 导出日志：目前仅支持导出本页显示的日志。单击右上角图标，在弹出的导出数据对话框中，设置导出数据列，单击 “确定” 按钮，导出日志。    如何通过本系统免密登录公有云平台？ 目前仅支持腾讯云。\n公有云平台支持基于SAML协议的单点登录功能，通过身份提供商功能，可以实现企业用户通过自己的账号体系单点登录公有云平台，并管理公有云平台的资源。\n身份提供商 身份提供商（Identity Provider，简称IdP）用于提供身份验证，外部用户通过已知的身份提供商身份验证后，将使用角色登录公有云平台。外部用户将在角色的有限权限范围内进行资源访问。因外部身份用户登录腾讯云所用的是角色，而角色使用的是临时密钥，您可避免因长期使用密钥（例如云 API 密钥），导致难以轮换密钥以及被截取后泄露导致的安全问题。\n使用流程  在云联壹云平台上创建云账号时，开启免密登录功能，此时将会把系统的SAML信息上传到公有云平台，使系统作为公有云平台的身份提供商。 在云用户组页面，创建对应平台云用户组，并选择对应权限。 在云账号详情-免密登录用户页面，新建免密登录用户，关联本地用户并指定用户所属的云用户组。该操作用于授予系统内用户免密登录公有云的权限。 后续关联云上SAML用户的本地用户，可在 “用户信息-云上用户-免密登录用户” 中单击 “免密登录” 按钮，将会以指定的权限免密登录公有云平台。  ","excerpt":"云管平台通过云账号与不同平台建立连接，并同步平台上的资源到云管平台上管理。一个账户对应的云资源归属域，不同域内资源隔离，可通过共享功能让其他 …","ref":"/v3.6/zh/docs/howto/multicloud/cloudaccount/","title":"云账号"},{"body":"多节点安装和 All in One 安装 一样，都使用 https://github.com/yunionio/ocboot 这个部署工具，根据配置执行 ansible playbook 部署节点。\n环境准备 关于环境的准备和不同架构 CPU 操作系统的要求，请参考 All in One 安装/机器配置要求。\n以下为待部署机器的环境，假设已经准备好了 5 台机器，IP 分别是 10.127.10.156-160 ，各个节点做出以下角色规划：\n mariadb_node: 这个角色表示该节点上部署并运行 mariadb 数据库服务，该角色不一定要写在配置中，如果环境中有准备好的数据库，也可以不部署  节点: 10.127.10.156   primary_master_node: 这个角色表示该节点是第一个部署并运行 k8s master 组件的节点，该角色必须存在于配置中，该角色运行 onecloud 控制服务  节点: 10.127.10.156   master_nodes: 这个角色表示这些节点运行控制服务，该角色可选，主要作用是和 primary_master_node 一起组成 Kubernetes 的 etcd 3 节点高可用  节点: 10.127.10.157-158   worker_nodes: 这个角色表示这些节点运行私有云计算服务，该角色可选，如果需要内置的私有云功能，可以不配置  节点: 10.127.10.159-160       IP 登录用户 角色     10.127.10.156 root mariadb_node \u0026 primary_master_node   10.127.10.157-158 root master_nodes   10.127.10.159-160 root worker_nodes    开始部署 下载 ocboot 参考 All in One 安装/下载 ocboot。\n编写部署配置 # 编写 config-allinone.yml 文件 $ cat \u003c\u003cEOF \u003e./config-nodes.yml mariadb_node: hostname: 10.127.10.156 user: root db_user: root db_password: your-sql-password primary_master_node: onecloud_version: v3.6.15 hostname: 10.127.10.156 user: root db_host: 10.127.10.156 db_user: root db_password: your-sql-password controlplane_host: 10.127.10.156 controlplane_port: \"6443\" master_nodes: hosts: - hostname: 10.127.10.157 user: root - hostname: 10.127.10.158 user: root controlplane_host: 10.127.10.156 controlplane_port: \"6443\" worker_nodes: hosts: - hostname: 10.127.10.159 user: root - hostname: 10.127.10.160 user: root controlplane_host: 10.127.10.156 controlplane_port: \"6443\" EOF 开始部署 当填写完 config-allinone.yml 部署配置文件后，便可以执行 ocboot 里面的 ./run.py ./config-allinone.yml 部署集群了。\n# 开始部署 $ ./run.py ./config-nodes.yml ","excerpt":"多节点安装和 All in One 安装 一样，都使用 https://github.com/yunionio/ocboot 这个部署工具， …","ref":"/v3.6/zh/docs/quickstart/nodes/","title":"多节点安装"},{"body":"","excerpt":"","ref":"/v3.6/zh/docs/setup/","title":"安装部署"},{"body":" 说明  服务是以容器的方式运行在 Kubernetes(K8S) 集群里面的，所以开发调试需要部署一个 Kubernetes 集群 后端服务都是用 Golang 编写，所以需要在开发环境安装 Golang 为了把开发的服务发布到 Kubernetes 集群，需要在本地把相关服务构建成 docker 镜像 开发环境最好都是在 Linux 上进行，安装使用 docker 和编译源码都很方便   接下来介绍如何搭建开发环境。\n部署云联壹云服务 在开始开发之前，请先参考 All in One 安装 或者 MiniKube 安装 部署云联壹云服务。我们的服务全部使用容器的方式运行在 Kubernetes 集群里面，所以需要先搭建好我们的服务，把这个环境作为自己的开发环境。\n这里建议使用一个单独的 CentOS 7 虚拟机，配置(至少 4C8G + 100G 系统盘)，安装部署我们的服务。\n安装 Go Golang 版本要求 1.15 以上\n安装 Golang 环境请参考： Install Golang\n安装配置 Docker 因为要把服务打包成容器镜像，所以需要先安装 docker，这里的 docker 版本需要是 docker-ce 19.03 以上的版本。\n下面是不同操作系统和 Linux 发行版的安装方式，这里还是建议开发环境是 Linux 。\n安装 Docker CentOS 7  # 1. 安装必要的一些系统工具 sudo yum install -y yum-utils # 2. 添加软件源信息 sudo yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo # 3. 更新并安装 Docker CE sudo yum -y install docker-ce  配置 Docker 后续的代码编译和打包使用了 docker buildx 的功能，需要做在让 docker daemon 开启 experimental 特性。\n# 在 docker daemon 的配置里面打开 experimental 特性 $ cat /etc/docker/daemon.json { \"experimental\": true } # 重启 docker 服务 $ systemctl restart docker # 创建 buildx context $ docker buildx create --use --name build --node build --driver-opt network=host 编译 云联壹云 组件 Fork 仓库 访问 https://github.com/yunionio/onecloud ，将仓库 fork 到自己的 github 用户下。\nClone 源码 git clone 前确保 GOPATH 等环境变量已经设置好，clone 你自己 fork 的仓库\n$ git clone https://github.com/\u003cyour_name\u003e/onecloud $GOPATH/src/yunion.io/x/onecloud $ cd $GOPATH/src/yunion.io/x/onecloud $ git remote add upstream https://github.com/yunionio/onecloud 二进制编译 编译是直接调用 go 编译器在本地编译出二进制，对应的 Makefile 规则为 make cmd/% ，% 对应的是 cmd 目录里面的组件名称。\n# cmd 目录下面存放着所有的组件: $ ls cmd ... ansibleserver climc glance keystone qcloudcli ucloudcli awscli cloudir host lbagent region webconsole # 可以编译cmd下指定的组件，比如：编译 climc 和 region 组件 $ make cmd/climc cmd/region # 编译好的二进制会直接在 _output/bin 目录下面，查看编译好的二进制文件 $ ls _output/bin climc region # 编译所有组件 $ make Docker 镜像编译上传 通常我们的开发流程是写完代码，把相应服务打包生成 docker 镜像，然后发布到自己搭建的 Kubernetes 集群里面测试。 下面说明如何生成 docker 镜像。\n生成好的 docker 镜像需要上传的镜像仓库，这里以 Aliyun 的容器镜像服务 为例，比如我在 aliyun 创建了一个公开的命令空间，仓库地址为: registry.cn-beijing.aliyuncs.com/zexi 。\n# 在本地登录镜像仓库，这里以你自己的镜像仓库为准 # 需要先用自己的 aliyun 帐号登录下，后面容器镜像的上传就不需要密码了 $ docker login registry.cn-beijing.aliyuncs.com/zexi ...... Login Succeeded 准备好镜像仓库后，就可以开始打包上传镜像了，这些步骤是通过 Makefile 的 image 规则来执行的。\n这里有以下环境变量用来控制制作镜像的内容：\n REGISTRY: 对应镜像上传的仓库 VERSION: 用于生成镜像的 tag ARCH: 对应 docker 镜像的 arch，可设置成 ‘arm64’ 或者 ‘all’  arm64: 编译打包制作 arm64 的 docker 镜像 all: 编译打包制作 amd64 和 arm64 的镜像   DEBUG: 如果设置为 true 会显示打包步骤  根据 REGISTRY 和 VERSION 这两个环境变量，会生成各个组件的镜像地址，格式是: $(REGISTRY)/$(component):$VERSION\n# 将 region 服务编译并制作成 docker 镜像 # 然后上传到 registry.cn-beijing.aliyuncs.com/zexi/region:dev $ VERSION=dev REGISTRY=registry.cn-beijing.aliyuncs.com/zexi make image region # 编译多个组件，并上传，以下命令会上传以下的组件 # - registry.cn-beijing.aliyuncs.com/zexi/ansibleserver:dev # - registry.cn-beijing.aliyuncs.com/zexi/apigateway:dev # - registry.cn-beijing.aliyuncs.com/zexi/region:dev $ VERSION=dev REGISTRY=registry.cn-beijing.aliyuncs.com/zexi make image \\  ansibleserver apigateway region # 编译 arm64 的镜像，如果指定了 ARCH=arm64 ，则会在对应镜像的末尾加上 '-arm64' 的后缀 # - registry.cn-beijing.aliyuncs.com/yunionio/scheduler:dev-arm64 $ VERSION=dev REGISTRY=registry.cn-beijing.aliyuncs.com/zexi ARCH=arm64 make image scheduler # 编译 amd64 + arm64 的镜像，指定 ARCH=all，这里不会添加后缀，会在镜像名里面包含两个架构的版本 # - registry.cn-beijing.aliyuncs.com/yunionio/cloudid:dev $ VERSION=dev REGISTRY=registry.cn-beijing.aliyuncs.com/zexi ARCH=all make image cloudid # 同时编译多个多架构的组件，并上传 $ VERSION=dev ARCH=all REGISTRY=registry.cn-beijing.aliyuncs.com/zexi make image \\  ansibleserver apigateway baremetal-agent climc cloudevent \\  cloudnet devtool esxi-agent glance host host-deployer keystone \\  logger notify region s3gateway scheduler webconsole yunionconf \\  vpcagent monitor region-dns cloudid 开发调试 开发调试的通常步骤是，写好代码后，使用之前说的 make image 规则打包上传对应服务的 docker 镜像，然后将镜像发布到自己的 Kubernetes 集群进行测试。\n将镜像发布到 Kubernetes 集群 后端的服务都运行在 Kubernetes 的 onecloud namespace 里面，可以通过以下命令查看对应的 Kubernetes 资源。我们的服务使用以下的 Kubernetes 资源进行服务的管理。\n deployment: 管理大部分的服务，这种服务会在 Kubernetes 的任意一个 master 节点启动，比如: region, apigateway 服务等 daemonset: 管理需要在每个 Kubernetes 节点都启动的服务，比如: host 服务(私有云计算节点服务)  说明 另外需要简单了解下 Kubernetes pod 这种资源，pod 是实际运行容器的集合，是 Kubernetes 里面运行容器化服务的最小单元，一个 pod 里面可以运行多个容器，每个容器都有自己对应的镜像。\n其它 Kubernetes 资源介绍可参考官方的 工作负载介绍。\n 下面是使用 kubectl(Kubernetes 命令行工具) 查看各个服务对应资源的命令：\n# 查看 onecloud 命令空间下面的 deployment $ kubectl -n onecloud get deployment # 查看 onecloud 命令空间下面的 daemonset $ kubectl -n onecloud get daemonset # 查看 onecloud 命名空间下面的 pods $ kubectl -n onecloud get pod 对 Kubernetes 资源有了大概了解后，接下来的步骤就是把刚才打包的服务镜像发布到集群里面对应的服务，这里以 region 这个服务为例。\n# 先在本地编译打包 region 镜像 # 会在 aliyun 生成镜像: registry.cn-beijing.aliyuncs.com/zexi/region:dev-test $ VERSION=dev-test REGISTRY=registry.cn-beijing.aliyuncs.com/zexi make image region # 找到 region 服务对应的 kubernetes 资源名称 $ kubectl get deployment -n onecloud | grep region default-region 1/1 1 1 90d # 更新 default-region deployment 资源里面 image 属性 # 然后对应的 default-region 的 pod 就会自动拉取镜像重启 $ kubectl -n onecloud edit deployment default-region 使用 kubectl -n onecloud edit deployment default-region 命令后，进入编辑资源 YAML 属性的步骤，只需要将里面的 image 属性修改成 aliyun 对应镜像地址，截图如下：\n修改完后保存退出，就会拉取刚才指定的镜像创建新的 region pod，删除旧的。可以再次查看 region pod 的当前状态。\n查看服务输出日志 可以使用 kubectl log 命令查看对应 pod 的输出日志，这里以刚才发布的 region pod 为例。\n# 先找到 region 服务对应的 pod $ kubectl get pods -n onecloud | grep region default-region-6bd8c54d68-sq4gq 1/1 Running 0 101m # 查看日志 $ kubectl logs -n onecloud default-region-6bd8c54d68-sq4gq # 把日志重定向到文件 /tmp/region.log $ kubectl logs -n onecloud default-region-6bd8c54d68-sq4gq \u003e /tmp/region.log # 流式查看日志，类似于 'tail -f' $ kubectl logs -n onecloud default-region-6bd8c54d68-sq4gq -f # 查看 5 分钟前的日志 $ kubectl logs -n onecloud default-region-6bd8c54d68-sq4gq -f --since 5m 安装配置 climc climc 是访问后端的命令行工具，可以通过该工具向后端各个服务发送API请求，日常开发中会使用改命令行工具进行功能验证和调试，安装和使用方法参考下面的连接。\nclimc 的本地安装参考: 源码编译安装\nclimc 的本地配置参考: 非控制节点认证配置\nclimc 的使用简介参考: climc 使用\n快速开发调试 我们的服务都已经容器化运行在 Kubernetes 集群中，使用上面说的 “制作docker镜像-\u003e发布到集群” 的开发流程有些长，对于快速开发调试并不方便。\n通过 Telepresence 提供远程 Kubernetes 连接信息上下文，可以在本地开发调试。下面介绍使用 Telepresence 进行本地快速开发。\n安装配置 kubectl 需要在本地安装 kubectl。\n需要在本地配置好集群信息，以通过 kubectl 访问；将云联壹云控制节点上的$KUBECONFIG文件拷贝到本地~/.kube/config; 如果本地已经有此文件，参考 配置多集群访问 进行合并。\n安装 telepresence 这里介绍 CentOS 7 的本地环境安装，其他发行版可参考官方文档：Installing Telepresence。\n 不建议K8S集群的部署和开发在同一个环境，使用Telepresence会有端口冲突。\n # 安装依赖 $ yum install -y python3 sshfs conntrack iptables torsocks sshuttle sudo yum-utils # 安装 kubectl 用于连接 K8S 集群 $ cat \u003c\u003cEOF \u003e/etc/yum.repos.d/kubernetes.repo [kubernetes] name=Kubernetes baseurl=http://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64 enabled=1 gpgcheck=0 repo_gpgcheck=0 gpgkey=http://mirrors.aliyun.com/kubernetes/yum/doc/yum-key.gpg http://mirrors.aliyun.com/kubernetes/yum/doc/rpm-package-key.gpg EOF $ yum install -y kubectl-1.15.8-0 # 需要自行配置kubctl config # 测试kubctl可以访问之前部署的K8S集群 $ kubctl version # 源码安装 telepresence 到 /usr/local/bin/telepresence $ git clone https://github.com/telepresenceio/telepresence $ cd telepresence $ sudo env PREFIX=/usr/local ./install.sh 使用 利用 telepresence 本地连通远端 K8S 的特性，我们就可以做到在本地编译运行 region，keystone 等服务，同时又能访问远端 K8S 其它服务的环境。\nmacOS 或 linux 中本地编译运行 region 服务\n# 切换到 云联壹云 代码目录 $ cd $GOPATH/src/yunion.io/x/onecloud # 编译 region 服务 $ make cmd/region # 使用 telepresence 替换 K8S 里面的 default-region deployment # 该命令在 K8S 集群中启动一个 deployment 替换掉原来的 default-regoin # 然后把流量的访问导向本地 # 如果想要使用特定的 shell，比如 zsh，可以在后面加上\"--run /bin/zsh\" $ telepresence --swap-deployment default-region --namespace onecloud 到这里已经进入到 telepresence 隔离的 namespace 里面了， $TELEPRESENCE_ROOT 这个目录 是通过 sshfs 挂载的远端 K8S pod 的文件系统。 接下来我们就可以在这个 namespace 里面运行 region 服务了：\n$ sudo chmod 777 /etc # 将 $TELEPRESENCE_ROOT/etc/yunion 链接到本地的 /etc $ ln -s $TELEPRESENCE_ROOT/etc/yunion /etc # 启动 region 服务 $ ./_output/bin/region --config /etc/yunion/region.conf 这个时候如果我们在外部调用 climc 就会发现相关的请求已经被转发到本地开发机启动 region 服务了。\n$ climc network-list 调试完成后需要进行清理操作\n# 退出 telepresence $ exit # 会看到类似下面的输出 T: Your process exited with return code 127. T: Exit cleanup in progress T: Cleaning up Pod # 删除链接文件 $ rm /etc/yunion Linux系统中本地编译运行 region 服务\n这种方式相比上一种方式，更加干净；但是相对复杂\n# 切换到 云联壹云 代码目录 $ cd $GOPATH/src/yunion.io/x/onecloud # 编译 region 服务 $ make cmd/region # 使用 telepresence 替换 K8S 里面的 default-region deployment # 该命令在 K8S 集群中启动一个 deployment 替换掉原来的 default-regoin # 然后把流量的访问导向本地 # 如果想要使用特定的 shell，比如 zsh，可以在后面加上\"--run /bin/zsh\" $ telepresence --swap-deployment default-region --namespace onecloud 到这里已经进入到 telepresence 隔离的 namespace 里面了， $TELEPRESENCE_ROOT 这个目录 是通过 sshfs 挂载的远端 K8S pod 的文件系统。 接下来我们就可以在这个 namespace 里面运行 region 服务了：\n# 设置 max_user_namespaces $ cat /proc/sys/user/max_user_namespaces 0 # 如果 max_user_namespaces 为 0，需要设置下 user_namespaces $ echo 640 \u003e /proc/sys/user/max_user_namespaces # 启动一个新的 namespace , 但不共享 mount namespace，这样接下来的 mount bind 操作就不会影响到宿主机 $ unshare --map-root-user --mount # bind K8S /var/run/secrets $ mount --bind $TELEPRESENCE_ROOT/var/run /var/run $ ls /var/run/ secrets # bind 云联壹云 config $ mkdir /etc/yunion $ mount --bind $TELEPRESENCE_ROOT/etc/yunion /etc/yunion $ ls /etc/yunion/ pki region.conf # 启动 region 服务 $ ./_output/bin/region --config /etc/yunion/region.conf # 这个时候如果我们在外部调用 climc $ climc network-list # 就会发现相关的请求已经被转发到本地开发机启动 region 服务了 更多用法，以及 telepresence 的原理请参考官方文档。\nFAQ 1. 开发环境是 windows 或者 macOS，怎么开发？ 因为我们的服务最后会运行在基于 CentOS 7 搭建的 K8S 集群里面，所以日常的开发和打包中一般都是在 CentOS 7 里面做的。\n如果开发环境是 windows ，可以在 windows 里面写代码，然后创建一个 CentOS 7 的虚拟机，在虚拟机里面把开发环境搭建好，写完代码利用 rsync 等同步工具，把修改的代码增量拷贝到虚拟机中，然后进行打包发布等流程。\n对于 Mac 上的 macOS 也是类似的，可以使用和 windows 开发一样的流程。但 macOS 里开发和 Linux 里面开发差异没有很大，在 macOS 里面安装好对应的命令行工具和 docker 后，就可以直接使用 make image 相关的规则打包生成 docker 镜像了。\n2. 本地调试启动 region 服务，报以下错误 使用climc service-config-edit region2编辑 region 服务的配置，修改参数：\n fetch_etcd_service_info_and_use_etcd_lock: false enable_host_health_check: false   3. 使用 telepresence 时，上次未正常退出，再次使用一直报错 尝试手动清理:\n 使用 kubectl 删除 onecloud namespace 下除 default-region-dns-xxxxx 外，所有以 default-region 开头的Pod； 使用kubectl edit deployment default-region -n onecloud，将 spec 下的 replicas 从0改为1.  # 可以编译cmd下制定的组件，比如：编译 region 和 host 组件 $ make cmd/region cmd/host # 查看编译好的二进制文件 $ ls _output/bin region host 4. 本地直接运行 make cmd/host 会出现 ceph 依赖的报错 host 组件是私有云里面管理虚拟机的一个关键组件，依赖了 cephfs, rbd 和 rados 相关的库，如果是本地直接编译，则需要安装对应的依赖，操作如下：\nCentOS 7 Ubuntu 20.04 On rpm based systems (dnf, yum, etc):\nsudo rpm --import https://download.ceph.com/keys/release.asc sudo yum install -y https://download.ceph.com/rpm-luminous/el7/noarch/ceph-release-1-1.el7.noarch.rpm sudo yum install -y https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm sudo yum install -y libcephfs-devel librbd-devel librados-devel  On debian systems (apt):\nwget -q -O- 'https://download.ceph.com/keys/release.asc' | sudo apt-key add - echo deb https://download.ceph.com/debian-luminous/ $(lsb_release -sc) main | sudo tee /etc/apt/sources.list.d/ceph.list apt-get update \u0026\u0026 apt-get install -y libcephfs-dev librbd-dev librados-dev  ","excerpt":" 说明  服务是以容器的方式运行在 Kubernetes(K8S) 集群里面的，所以开发调试需要部署一个 Kubernetes 集群 后端服 …","ref":"/v3.6/zh/docs/contribute/dev-env/","title":"搭建开发环境"},{"body":"云联壹云私有云 如果是在云联壹云私有云上部署 kubernetes 集群，需要先导入对应的镜像，操作如下：\n 进入主机菜单，选择系统镜像的上传按钮 输入镜像名称 ‘CentOS-7.6.1810-20190430.qcow2’ 上传方式选择 ‘输入镜像URL’，镜像 URL 为: https://iso.yunion.cn/vm-images/CentOS-7.6.1810-20190430.qcow2  等待镜像导入完毕后，就可以使用该镜像创建虚拟机部署 kubernetes 集群。\n","excerpt":"云联壹云私有云 如果是在云联壹云私有云上部署 kubernetes 集群，需要先导入对应的镜像，操作如下：\n 进入主机菜单，选择系统镜像的上 …","ref":"/v3.6/zh/docs/howto/container/pre_env/","title":"环境准备"},{"body":"云联壹云 目前仅支持在 CentOS 7 上运行，待部署组件/服务如下:\n   服务组件 用途 安装方式 运行方式     mariadb 关系型数据库 rpm systemd   docker 容器运行时 rpm systemd   kubelet 管理 kubernetes pod rpm systemd   keystone 认证服务 k8s deployment container   region api 控制器 k8s deployment container   scheduler 调度服务 k8s deployment container   glance 镜像存储 k8s deployment container   webconsole 虚拟机访问界面 k8s deployment container   influxdb 监控数据库 k8s deployment container   host 管理虚拟机 k8s daemonset container   sdnagent 管理虚拟机网络 rpm systemd   baremetal-agent 管理物理机 k8s deployment container   climc 命令行工具 rpm shell   ocadm 部署服务管理工具 rpm shell    其中 host 和 baremetal-agent 可以根据需求选择性部署:\n 管理 kvm 虚拟机: 部署 host 服务 管理物理机: 部署 baremetal-agent 服务  ","excerpt":"云联壹云 目前仅支持在 CentOS 7 上运行，待部署组件/服务如下:\n   服务组件 用途 安装方式 运行方式     mariadb  …","ref":"/v3.6/zh/docs/setup/intro/","title":"组件概览"},{"body":"  镜像(image): 是用于新建云服务器(虚拟机)、裸金属(物理机)使用的模板文件，常用类型为 qcow2, vmdk, raw, vhd, iso。\n  镜像服务(glance): 云平台的镜像服务叫做 glance，用于存储转换用户上传或外部导入的镜像，提供下载功能。\n  缓存镜像(cached-image): 创建公/私有云虚拟机时，可以直接使用各个云平台已有的镜像，这些镜像不会存储在 glance，云平台只是保存元信息，创建机器时会直接使用。\n  image 和 cached-image 两种资源的区别如下：\n image: glance 管理的镜像，由用户上传或者外部导入; cached-image:  包括公有云和其他私有云的镜像，不由 glance 管理，一般在创建 云联壹云 之外的公/私有云主机的时候用到; 不提供创建接口，只能查询，刷新和删除;    ","excerpt":"  镜像(image): 是用于新建云服务器(虚拟机)、裸金属(物理机)使用的模板文件，常用类型为 qcow2, vmdk, raw, …","ref":"/v3.6/zh/docs/howto/image/","title":"镜像"},{"body":"在部署生产可用的 kubernetes 集群之前，需要先部署 LoadBalancer 环境，这里使用 keepalived + haproxy 的方式实现负载均衡和高可用。\n环境说明 单独拿两个节点部署 keepalived 和 haproxy 作为后端 kubernetes 控制平面的负载均衡器，拓扑结构如下:\n两个节点上面分别部署 keepalived 和 haproxy 组成负载均衡集群，haproxy 的 backend 为后端的 kubernetes control plane node，vip(虚ip) 在这两个节点之间漂移形成高可用。\n另外 云联壹云 服务使用 Mariadb，如果没有专门的数据库集群，可以单独拿两个节点部署 Mariadb 高可用。参考 部署 DB HA 环境 。\n部署 keepalived 的主要作用是为 haproxy 提供 vip，在2个 haproxy 实例之间提供主备，降低当其中一个haproxy失效的时对服务的影响。\n部署配置 keepalived 设置相关的环境变量，根据不同的环境自行配置。\n# keepalived vip 地址 export K8SHA_VIP=10.168.222.18 # keepalived auth toke export K8SHA_KA_AUTH=412f7dc3bfed32194d1600c483e10ad1d # keepalived network interface export K8SHA_NETIF=eth0 设置 sysctl 选项\n$ cat \u003c\u003cEOF \u003e\u003e/etc/sysctl.conf net.ipv4.ip_forward = 1 net.ipv4.ip_nonlocal_bind = 1 EOF $ sysctl -p 安装 keepalived\n$ yum install -y keepalived 添加配置\n$ cat \u003c\u003cEOF \u003e/etc/keepalived/keepalived.conf ! Configuration File for keepalived global_defs { router_id LVS_DEVEL } vrrp_script check_haproxy { script \"pidof haproxy\" interval 3 weight -2 fall 10 rise 2 } vrrp_instance VI_1 { state MASTER interface $K8SHA_NETIF virtual_router_id 51 priority 250 advert_int 1 authentication { auth_type PASS auth_pass $K8SHA_KA_AUTH } virtual_ipaddress { $K8SHA_VIP } track_script { check_haproxy } } EOF 启动 keepalived\n$ systemctl enable --now keepalived $ ip addr show $K8SHA_NETIF 2: eth0: \u003cBROADCAST,MULTICAST,UP,LOWER_UP\u003e mtu 1500 qdisc mq state UP qlen 1000 link/ether 00:22:ff:95:87:f7 brd ff:ff:ff:ff:ff:ff inet 10.168.222.189/24 brd 10.168.222.255 scope global eth0 valid_lft forever preferred_lft forever inet 10.168.222.18/32 scope global eth0 valid_lft forever preferred_lft forever inet6 fe80::222:ffff:fe95:87f7/64 scope link valid_lft forever preferred_lft forever 部署配置 haproxy 此处的 haproxy 为 apiserver 提供反向代理，haproxy 将所有请求轮询转发到每个master节点上。\n系统配置\nexport K8S_MASTER0=10.168.222.218 export K8S_MASTER1=10.168.222.197 export K8S_MASTER2=10.168.222.207 安装 haproxy\n$ yum install -y haproxy 配置 haproxy\n$ cat \u003c\u003cEOF \u003e/etc/haproxy/haproxy.cfg #--------------------------------------------------------------------- # Global settings #--------------------------------------------------------------------- global # to have these messages end up in /var/log/haproxy.log you will # need to: # # 1) configure syslog to accept network log events. This is done # by adding the '-r' option to the SYSLOGD_OPTIONS in # /etc/sysconfig/syslog # # 2) configure local2 events to go to the /var/log/haproxy.log # file. A line like the following can be added to # /etc/sysconfig/syslog # # local2.* /var/log/haproxy.log # log 127.0.0.1 local2 chroot /var/lib/haproxy pidfile /var/run/haproxy.pid maxconn 4000 user haproxy group haproxy daemon # turn on stats unix socket stats socket /var/lib/haproxy/stats #--------------------------------------------------------------------- # common defaults that all the 'listen' and 'backend' sections will # use if not designated in their block #--------------------------------------------------------------------- defaults mode http log global option httplog option dontlognull option http-server-close option forwardfor except 127.0.0.0/8 option redispatch retries 3 timeout http-request 10s timeout queue 1m timeout connect 10s timeout client 1m timeout server 1m timeout http-keep-alive 10s timeout check 10s maxconn 3000 #--------------------------------------------------------------------- # kubernetes apiserver frontend which proxys to the backends #--------------------------------------------------------------------- frontend kubernetes-apiserver mode tcp bind *:6443 option tcplog default_backend kubernetes-apiserver #--------------------------------------------------------------------- # round robin balancing between the various backends #--------------------------------------------------------------------- backend kubernetes-apiserver mode tcp balance roundrobin server master-0 $K8S_MASTER0:6443 check server master-1 $K8S_MASTER1:6443 check server master-2 $K8S_MASTER2:6443 check #--------------------------------------------------------------------- # collection haproxy statistics message #--------------------------------------------------------------------- listen stats bind *:1080 stats auth admin:awesomePassword stats refresh 5s stats realm HAProxy\\ Statistics stats uri /admin?stats EOF 启动并检测服务\n$ systemctl enable haproxy.service --now $ systemctl status haproxy.service $ netstat -tulnp | egrep '6443|1080' tcp 0 0 0.0.0.0:6443 0.0.0.0:* LISTEN 10033/haproxy tcp 0 0 0.0.0.0:1080 0.0.0.0:* LISTEN 10033/haproxy 部署 kubernetes 集群 参考 部署集群 。\n","excerpt":"在部署生产可用的 kubernetes 集群之前，需要先部署 LoadBalancer 环境，这里使用 keepalived + …","ref":"/v3.6/zh/docs/setup/controlplane-ha/","title":"部署 HA 环境"},{"body":"How to make a Pull Request?  Checkout a branch from master, either for a new feature or a bugfix  # checkout new branch $ git fetch upstream --tags $ git checkout -b feature/implement-x upstream/master  Coding on the new branch After coding is done, do the following to prepare for Pull Request  $ git fetch upstream # fetch most up-to-date upstream master $ git rebase upstream/master # resolv possible conflicts $ git push origin feature/implement-x # push your local branch to github  Submit Pull Request on GitHub   Request reviews, set labels to indicate the impact components of the codes   You may use comments to appoint reviwers and set labels. Use ‘/cc’ and @ to appoint reviwers, use ‘/area’ to indicate the impact components of the codes.  ​\tAvailable labels are listed under issues——Labels, any label prefixed with area can be used for ‘/area’ command.\n If the codes need to be merged into release branch, you should create new cherry-pick PRs to the target release branch.  # Donwload github command line tool: https://github.com/github/hub # For OSX, please execute: brew install hub # For Debian, please execute: sudo apt install hub # For other OS, please install binaries: https://github.com/github/hub/releases # Setup username of github $ export GITHUB_USER=\u003cyour_username\u003e # Use the following scripts to cherry-pick PR to release branch # For exmaple, to cherry-pick the PR with ID #8 to release/2.8.0 $ ./scripts/cherry_pick_pull.sh upstream/release/2.8.0 8 # the cherry pick may have conflicts, please open a new terminal to resolve the conflicts, then input 'Y' to continue the cherry-pick process $ git add xxx # resolve conflicts $ git am --continue # go back to the terminal of cherry-pick, and input 'Y' to continue the cherry-pick process Go to the Pull Requests of upstream PR, you will find the cherry-pick PR，the title of the chery-pick PR should look like: Automated cherry pick of #8: ..., then procedure the reviwer process and merge the PR to the release branch.\nattention Git commit should follow Git Commit Convention。  ","excerpt":"How to make a Pull Request?  Checkout a branch from master, either for …","ref":"/v3.6/en/docs/contribute/contrib/","title":"Code contribution"},{"body":"","excerpt":"","ref":"/v3.6/en/docs/contribute/","title":"Development"},{"body":"","excerpt":"","ref":"/v3.6/zh/docs/contribute/","title":"开发相关"},{"body":"Fork 仓库 访问 https://github.com/yunionio/cloudpods ，将仓库 fork 到自己的 github 用户下。\nClone 源码 clone 自己 fork 的仓库，并设置 upstream 为源仓库。\n$ git clone https://github.com/\u003cyour_name\u003e/cloudpods $ cd cloudpods $ git remote add upstream https://github.com/yunionio/cloudpods 提交代码流程  从 master checkout 出 feature 或者 bugfix 分支  # checkout 新分支 $ git fetch upstream --tags $ git checkout -b feature/implement-x upstream/master  在新的分支上进行开发 开发完成后，进行提交PR前的准备操作  $ git fetch upstream # 同步远程 upstream master 代码 $ git rebase upstream/master # 有冲突则解决冲突 $ git push origin feature/implement-x # push 分支到自己的 repo  在GitHub的Web界面完成提交PR的流程   提完 PR 后请求相关开发人员 review，并设置Labels来表明提交的代码属于哪一个模块或者哪几个模块   或者通过添加评论的方式来完成上一步；评论 “/cc” 并 @ 相关人员完成设置reviewer，评论/area 并填写label完成设置Labels  ​\t所有Label都可以在issues——Labels下查询到，带area/前缀的Label均可以使用评论\"/area\"的形式添加\n 如果是 bugfix 或者需要合并到之前 release 分支的 feature PR，需要额外使用脚本将此PR cherry-pick 到对应的 release 分支  # 自行下载安装 github 的 cli 工具：https://github.com/github/hub # OSX 使用: brew install hub # Debian: sudo apt install hub # 二进制安装: https://github.com/github/hub/releases # 设置github的用户名 $ export GITHUB_USER=\u003cyour_username\u003e # 使用脚本自动 cherry-pick PR 到 release 分支 # 比如现在有一个提交的PR的编号为18，要把它合并到 release/3.4 $ ./scripts/cherry_pick_pull.sh upstream/release/3.4 18 # cherry pick 可能会出现冲突，冲突时开另外一个 terminal，解决好冲突，再输入 'y' 进行提交 $ git add xxx # 解决完冲突后 $ git am --continue # 回到执行 cherry-pick 脚本的 terminal 输入 'y' 即可 去 upstream 的 PR 页面, 就能看到自动生成的 cherry-pick PR，上面操作的PR的标题前缀就应该为：Automated cherry pick of #18，然后重复 PR review 流程合并到 release\n注意 提交 git 代码后需要书写 commit 内容，规范请参考: Git 提交内容规范。  ","excerpt":"Fork 仓库 访问 https://github.com/yunionio/cloudpods ，将仓库 fork 到自己的 github …","ref":"/v3.6/zh/docs/contribute/contrib/","title":"提交贡献代码"},{"body":"云联壹云 服务使用 Mariadb，这里使用 keepalived 和 Mariadb 的主主复制功能来实现 DB 的高可用。\n部署 keepalived 的主要作用是为 Mariadb 提供 vip，在2个 Mariadb 实例之间切换，不间断的提供服务。\n部署配置 Mariadb 主主复制 安装并启动 Mariadb\n$ yum install -y mariadb-server $ systemctl enable --now mariadb 运行 Mariadb 安全配置向导，设置密码等\n$ mysql_secure_installation ... ... Change the root password? [Y/n] y New password: Re-enter new password: Password updated successfully! Reloading privilege tables.. ... Success! ... ... Remove anonymous users? [Y/n] y ... Success! ... ... Disallow root login remotely? [Y/n] y ... Success! ... ... Remove test database and access to it? [Y/n] y - Dropping test database... ... Success! - Removing privileges on test database... ... Success! ... ... Reload privilege tables now? [Y/n] y ... Success! ... ... 修改 Mariadb 配置文件，准备配置主主复制\n# 主节点 $ cat \u003c\u003cEOF \u003e /etc/my.cnf [mysqld] datadir=/var/lib/mysql socket=/var/lib/mysql/mysql.sock # Disabling symbolic-links is recommended to prevent assorted security risks symbolic-links=0 # Settings user and group are ignored when systemd is used. # If you need to run mysqld under a different user or group, # customize your systemd unit file for mariadb according to the # instructions in http://fedoraproject.org/wiki/Systemd # skip domain name resolve skip_name_resolve # auto delete binlog older than 30 days expire_logs_days=30 innodb_file_per_table=ON max_connections = 300 server-id = 1 auto_increment_offset = 1 auto_increment_increment = 2 log-bin = mysql-bin binlog-format = row log-slave-updates max_binlog_size = 1G replicate-ignore-db = information_schema replicate-ignore-db = performance_schema max_connections = 1000 max_connect_errors = 0 max_allowed_packet = 1G slave-net-timeout=10 master-retry-count=0 slow_query_log = 1 long_query_time = 2 slow_query_log_file = /var/log/mariadb/slow-query.log [mysql] no-auto-rehash [mysqld_safe] log-error=/var/log/mariadb/mariadb.log pid-file=/var/run/mariadb/mariadb.pid # # include all files from the config directory # !includedir /etc/my.cnf.d EOF # 备节点 $ cat \u003c\u003cEOF \u003e /etc/my.cnf [mysqld] datadir=/var/lib/mysql socket=/var/lib/mysql/mysql.sock # Disabling symbolic-links is recommended to prevent assorted security risks symbolic-links=0 # Settings user and group are ignored when systemd is used. # If you need to run mysqld under a different user or group, # customize your systemd unit file for mariadb according to the # instructions in http://fedoraproject.org/wiki/Systemd # skip domain name resolve skip_name_resolve # auto delete binlog older than 30 days expire_logs_days=30 innodb_file_per_table=ON max_connections = 300 server-id = 2 auto_increment_offset = 2 auto_increment_increment = 2 log-bin = mysql-bin binlog-format = row log-slave-updates max_binlog_size = 1G replicate-ignore-db = information_schema replicate-ignore-db = performance_schema max_connections = 1000 max_connect_errors = 0 max_allowed_packet = 1G slave-net-timeout=10 master-retry-count=0 slow_query_log = 1 long_query_time = 2 slow_query_log_file = /var/log/mariadb/slow-query.log [mysql] no-auto-rehash [mysqld_safe] log-error=/var/log/mariadb/mariadb.log pid-file=/var/run/mariadb/mariadb.pid # # include all files from the config directory # !includedir /etc/my.cnf.d EOF # 重启服务 $ systemctl restart mariadb 主节点创建只读账号，导出全部数据，导入备节点。记录binlog日志文件名和position。\n# 以下命令在主节点执行 # 此密码为上面设置的 Mariadb root 密码，为了方便，只读账号也使用此密码 $ MYSQL_PASSWD='your-sql-passwd' # 开启 Mariadb 的远程访问 $ mysql -uroot -p$MYSQL_PASSWD -e \"GRANT ALL PRIVILEGES ON *.* TO 'root'@'%' IDENTIFIED BY '$MYSQL_PASSWD' WITH GRANT OPTION;FLUSH PRIVILEGES\" # 创建只读账号 $ mysql -u root -p$MYSQL_PASSWD -e \"GRANT REPLICATION SLAVE ON *.* TO repl@'%' IDENTIFIED BY '$MYSQL_PASSWD';FLUSH PRIVILEGES\" # \u0008示例是全新安装的 Mariadb ，还没有使用。如果是正在使用的数据库做主主复制，需要锁表后再导出数据 $ mysql -uroot -p$MYSQL_PASSWD -e \"SHOW PROCESSLIST\" +----+------+-----------+------+---------+------+-------+------------------+----------+ | Id | User | Host | db | Command | Time | State | Info | Progress | +----+------+-----------+------+---------+------+-------+------------------+----------+ | 4 | root | localhost | NULL | Query | 0 | NULL | SHOW PROCESSLIST | 0.000 | +----+------+-----------+------+---------+------+-------+------------------+----------+ # 记录binlog日志文件名和position $ mysql -u root -p$MYSQL_PASSWD -e \"SHOW MASTER STATUS\\G\" *************************** 1. row *************************** File: mysql-bin.000001 Position: 2023 Binlog_Do_DB: Binlog_Ignore_DB: # 导出全部数据 $ mysqldump --all-databases -p$MYSQL_PASSWD \u003e alldb.db # 拷贝 alldb.db 到备节点 $ scp alldb.db db2:/root/ # 以下命令在备节点执行 # 此密码为上面设置的 Mariadb root 密码 $ MYSQL_PASSWD='your-sql-passwd' # 导入主节点导出的数据 mysql -u root -p$MYSQL_PASSWD \u003c alldb.db # 重载权限 mysql -u root -p$MYSQL_PASSWD -e \"FLUSH PRIVILEGES\" # 记录binlog日志文件名和position mysql -u root -p$MYSQL_PASSWD -e \"SHOW MASTER STATUS\\G\" *************************** 1. row *************************** File: mysql-bin.000001 Position: 509778 Binlog_Do_DB: Binlog_Ignore_DB: 设置主主复制\n# 以下命令在主节点执行 # 修改MASTER_HOST为备节点IP，修改MASTER_LOG_FILE和MASTER_LOG_POS为上面备节点记录的信息 mysql -u root -p$MYSQL_PASSWD -e \"CHANGE MASTER TO MASTER_HOST='192.168.199.99',MASTER_USER='repl',MASTER_PASSWORD='$MYSQL_PASSWD',MASTER_PORT=3306,MASTER_LOG_FILE='mysql-bin.000001',MASTER_LOG_POS=509778,MASTER_CONNECT_RETRY=2;START SLAVE\" # 以下命令在备节点执行 # 修改MASTER_HOST为主节点IP，修改MASTER_LOG_FILE和MASTER_LOG_POS为上面主节点记录的信息 mysql -u root -p$MYSQL_PASSWD -e \"CHANGE MASTER TO MASTER_HOST='192.168.199.98',MASTER_USER='repl',MASTER_PASSWORD='$MYSQL_PASSWD',MASTER_PORT=3306,MASTER_LOG_FILE='mysql-bin.000001',MASTER_LOG_POS=2023,MASTER_CONNECT_RETRY=2;START SLAVE\" # 主备都执行，验证同步状态，都输出2个 Yes 表示正常 mysql -u root -p$MYSQL_PASSWD -e \"SHOW SLAVE STATUS\\G\" | grep Running Slave_IO_Running: Yes Slave_SQL_Running: Yes 至此，DB 主主复制部署完成，可以测试在任一节点进行数据库操作，另一节点验证。不过对外提供服务还是需要通过 vip，不然发生切换还需要业务端切换 ip，下面配置 keepalived 对外提供服务。\n部署配置 keepalived 设置相关的环境变量，根据不同的环境自行配置。\n# keepalived vip 地址 export DB_VIP=192.168.199.97 # keepalived auth toke export DBHA_KA_AUTH=onecloud # keepalived network interface export DB_NETIF=eth0 设置 sysctl 选项\n$ cat \u003c\u003cEOF \u003e\u003e/etc/sysctl.conf net.ipv4.ip_forward = 1 net.ipv4.ip_nonlocal_bind = 1 EOF $ sysctl -p 安装 keepalived nc\n$ yum install -y keepalived nc 添加配置\n# 请确保 virtual_router_id 不会和局域网内的其他 keepalived 集群冲突 $ cat \u003c\u003cEOF \u003e/etc/keepalived/keepalived.conf global_defs { router_id onecloud } vrrp_script chk_mysql { script \"/etc/keepalived/chk_mysql\" interval 1 } vrrp_instance VI_1 { state MASTER interface $DB_NETIF virtual_router_id 99 priority 100 advert_int 1 nopreempt authentication { auth_type PASS auth_pass $DBHA_KA_AUTH } track_script { chk_mysql } virtual_ipaddress { $DB_VIP } } EOF $ cat \u003c\u003cEOF \u003e /etc/keepalived/chk_mysql #!/bin/bash echo | nc 127.0.0.1 3306 \u0026\u003e/dev/null EOF $ chmod +x /etc/keepalived/chk_mysql 启动 keepalived\n$ systemctl enable --now keepalived $ ip addr show $DB_NETIF 2: eth0: \u003cBROADCAST,MULTICAST,UP,LOWER_UP\u003e mtu 1500 qdisc pfifo_fast state UP group default qlen 1000 link/ether 00:22:cf:40:1e:29 brd ff:ff:ff:ff:ff:ff inet 192.168.199.99/24 brd 192.168.199.255 scope global dynamic eth0 valid_lft 100651906sec preferred_lft 100651906sec inet 192.168.199.97/32 scope global eth0 valid_lft forever preferred_lft forever inet6 fe80::222:cfff:fe40:1e29/64 scope link valid_lft forever preferred_lft forever 至此，DB 高可用部署完成，任一节点的 Mariadb 或 keepalived 服务异常，或者任一节点宕机，都不影响对外服务。\n","excerpt":"云联壹云 服务使用 Mariadb，这里使用 keepalived 和 Mariadb 的主主复制功能来实现 DB 的高可用。 …","ref":"/v3.6/zh/docs/setup/db-ha/","title":"部署 DB HA 环境"},{"body":"For the purpose of word-processing the code change history, and statistics, we compile the following Git Commit Message Convention to regulate the format of Git Commit Message.\nGit Commit Message Convention Conform to the following format:\n\u003ctype\u003e(\u003cscope\u003e): \u003csubject\u003e \u003cbody\u003e \u003cfooter\u003e The message is composed of three parts (part is separated by an empty line):\n Title: required, describing the type of modification and a concise summary of changes Content: optional, describing in details why the modification is need, how to change, the basic outline of codes, how to make the change take effect, etc. Notes: optional, some additional notes  The descriptions of tokens of each part are explained as following:\n  type(type of PR:\n feat: new feature fix: bug fix refactor: recode, refactoring of codes test: test cases chore: modifications of helping scripts, such as Makefile, Dockerfile, etc.    scope(components of impact): such as region, scheduler, cloudcommon, etc.，use comma ‘,’ as separator if impacting multiple components, e.g. (region,scheduler,monitor)\n  subject(concise summary of commit): no more than 50 characters\n  body(detailed description of commit, optional): can be multiple lines, each line contains no more than 72 characters\n  footer(some notes, optional): some notes, e.g. references, breaking change, upgrading suggestions or url of related tasks or issue\n  Commit Examples  fix(region): compute NextSyncTime for snapshotpolicydisk 1. If calculated NextSyncTime equals to base, increase base by 1 hour to process recusively. 2. For snapshotpolicies with effective retentionday, e.g. a snapshotpolicy takes effect on every Monday and the snapshots are kept for 3 days automatically, synchronization will be performed on every Month (for snapshoting) and Thursday (for release snapshots).  feat(scheduler): add cpu filter Added new cpu filter to scheduler: - filter host by cpu model - set host capability by request cpu count  fix(apigateway,monitor,influxdb): disable influxdb service query proxy  feat(climc): support disable wrap line Usage: export OS_TRY_TERM_WIDTH=false climc server-list Closes #6710  References   https://docs.google.com/document/d/1QrDFcIiPjSLDn3EL15IJygNPiHORgU1_OOAqWjiDU5Y/edit#heading=h.fpepsvr2gqby\n  http://www.ruanyifeng.com/blog/2016/01/commit_message_change_log.html\n  https://blog.csdn.net/noaman_wgs/article/details/103429171\n  ","excerpt":"For the purpose of word-processing the code change history, and …","ref":"/v3.6/en/docs/contribute/git-convention/","title":"Git Commit Message Convention"},{"body":"为了方便代码提交记录的查看，以及以后的统计，我们制定了以下使用 Git 书写提交内容的规范，提交代码的时候请大家遵循以下的格式。\nGit 提交记录书写规范 格式如下:\n\u003ctype\u003e(\u003cscope\u003e): \u003csubject\u003e \u003cbody\u003e \u003cfooter\u003e 通过 git commit 命令填写的提交内容应该类似如上的结构，大致分为３个部分（每个部分使用空行分割）：\n 标题行：必填，描述主要修改类型和概要内容 主题内容：选填，描述为什么修改，做了什么样的修改，以及开发的思路，使用方法等等 页脚备注：选填，一些备注  每个部分的占位符说明如下:\n  type(PR 的类型):\n feat: 新功能 fix: 修复 refactor: 代码重构 test: 测试用例相关修改 chore: 其它修改，比如Makefile,Dockerfile等    scope(影响范围，相关组件): 比如 region, scheduler, cloudcommon，如果是多个组件，用英文 ‘,’ 分割，比如: (region,scheduler,monitor)\n  subject(commit 的概述): 建议不超过 50 个字符\n  body(commit 具体修改内容): 可以分为多行，建议每行不超过 72 个字符\n  footer(一些备注，选填): 一些备注，通常是相关参考连接、BREAKING CHANGE 或修复 bug 的连接\n  Commit 举例  fix(region): compute NextSyncTime for snapshotpolicydisk 1. 如果计算出来的 NextSyncTime 和 base 相等，可以将 base 加1一个小时递归处理。 2. 对于 retentionday 有效的快照策略，比如某一个 snaphsotpolicy 是每周一生效，并且打的快照自动保留 3 天，那么，就应该在每周一（打快照） 和每周四（释放快照）进行快照的同步。  feat(scheduler): add cpu filter Added new cpu filter to scheduler: - filter host by cpu model - set host capability by request cpu count  fix(apigateway,monitor,influxdb): disable influxdb service query proxy  feat(climc): support disable wrap line Usage: export OS_TRY_TERM_WIDTH=false climc server-list Closes #6710  辅助工具 也有相应的工具帮忙生成符合要求的 Commit message，使用 commitizen-go 可以协助生成 Commit message，用法如下:\n# osx 安装 commitizen-go $ brew tap lintingzhen/tap $ brew install commitizen-go # 如果是 linux 环境，可以 clone 源码编译，这个工具是 golang 写的，编译也简单 $ git clone https://github.com/lintingzhen/commitizen-go \u0026\u0026 cd commitizen-go $ make \u0026\u0026 ./commitizen-go install # 这一部会生成 git cz 命令的配置 $ sudo commitizen-go install # 测试提交 $ git add . # 使用 git cz 命令，就会以交互式的方式帮忙输入 commit $ git cz 相关配置参考：https://github.com/lintingzhen/commitizen-go/blob/master/README.MD#configure\n当然工具并不是说强制使用，只是说有工具的帮助，生成的 commit 内容会更统一一点　;)\n当然也有 nodejs 版本的工具，可能更符合前端的使用: https://github.com/commitizen/cz-cli ，前端的同学也可以使用这个工具。\n参考   https://docs.google.com/document/d/1QrDFcIiPjSLDn3EL15IJygNPiHORgU1_OOAqWjiDU5Y/edit#heading=h.fpepsvr2gqby\n  http://www.ruanyifeng.com/blog/2016/01/commit_message_change_log.html\n  https://blog.csdn.net/noaman_wgs/article/details/103429171\n  ","excerpt":"为了方便代码提交记录的查看，以及以后的统计，我们制定了以下使用 Git 书写提交内容的规范，提交代码的时候请大家遵循以下的格式。\nGit 提 …","ref":"/v3.6/zh/docs/contribute/git-convention/","title":"Git 提交内容规范"},{"body":"前提 注意 本章内容是方便快速体验云联壹云, 通过 MiniKube 快速搭建云联壹云服务，无法在生产环境使用，也无法验证云联内置私有云相关功能(因为内置私有云需要节点上面安装配置 qemu, openvswitch 等各种虚拟化软件)。\n仅适用于多云管理功能的体验，比如管理 VMware, 公有云(aws, 阿里云, 腾讯云等)或者其它私有云(zstack, openstack 等)。\n如果想部署生产可用的环境请参考: 安装部署 。\n 环境准备 云联壹云 相关的组件运行在 MiniKube 之上，环境以及相关的软件依赖如下:\n 操作系统: CentOS 7.6 最低配置要求: CPU 4核, 内存 8G, 存储 100G  部署 启动 minikube 集群 下载 minikue/kubectl, 并启动 minikube 集群, 具体请参考： https://kubernetes.io/docs/tasks/tools/install-minikube/\n# 配置 minikube $ minikube config -p onecloud set memory 8192 # 启动 kubernetes 集群, 并且从 aliyun 拉取镜像，这样速度会快一点 $ minikube start -p onecloud --image-repository=registry.aliyuncs.com/google_containers 部署云联壹云 onecloud operator 云联壹云 k8s operator地址： https://github.com/yunionio/onecloud-operator\n# 下载 onecloud-operator 的 yaml 文件 $ wget https://raw.githubusercontent.com/yunionio/onecloud-operator/master/manifests/onecloud-operator.yaml # 部署 onecloud-operator 到集群 $ kubectl apply -f onecloud-operator.yaml # 将 kubernetes node 打上 onecloud.yunion.io/controller=enable 标签 # 如果不打标签，operator 服务就不会把对应的后端服务调度到这个节点 $ kubectl get nodes NAME STATUS ROLES AGE VERSION onecloud Ready master 20m v1.15.9-beta.0 # 加上标签，这个 node 就可以运行 onecloud 相关服务 $ kubectl label nodes onecloud onecloud.yunion.io/controller=enable # 这里需要等待 onecloud-operator 的 pod 状态变为 Running $ kubectl get pods -n onecloud NAME READY STATUS RESTARTS AGE onecloud-operator-7fd65d6489-kwdkr 1/1 Running 0 5m2s 部署云联壹云服务 # 下载 onecloud cluster 的 yaml 文件 $ wget https://raw.githubusercontent.com/yunionio/onecloud-operator/master/manifests/example-onecloud-cluster.yaml -O onecloud-cluster.yaml # 部署云联壹云服务 # 将 onecloud-cluster.yaml 部署到 kubernetes 集群 $ kubectl apply -f onecloud-cluster.yaml # 等待 onecloud 相关服务启动，这个过程会拉取各个服务的镜像，配置服务 # 需要等待几分钟让所有服务状态变为 Running # 可以多次使用下面的命令查看 pods 状态 $ kubectl get pods -n onecloud NAME READY STATUS RESTARTS AGE default-ansibleserver-6955fb8d66-gb8w7 1/1 Running 0 8m57s default-apigateway-57f78c9cfb-8xvgw 1/1 Running 0 8m54s default-autoupdate-5f8bf779dd-6drtb 1/1 Running 0 8m41s default-climc-6c49f88df9-s4f5g 1/1 Running 0 8m45s default-cloudevent-6775bf8d66-bppcv 1/1 Running 0 8m39s default-cloudid-7798948bc8-blkxw 1/1 Running 0 8m30s default-cloudnet-55fd8ff98b-2gnm4 1/1 Running 0 8m36s default-devtool-7db6b87cf9-bvxsm 1/1 Running 0 8m32s default-esxi-agent-bb555858c-ft6dz 1/1 Running 0 8m50s default-etcd-dvfcg6jfjp 1/1 Running 0 11m default-glance-86d99c66-7v4lg 1/1 Running 0 9m1s # 这里注意下，如果 host-deployer 一直为 ContainerCreating 的状态，可以先忽略，不影响使用 # 因为是 minikube 部署的，没有注入一些默认的配置，这个问题以后会解决 default-host-deployer-vmkxm 0/1 ContainerCreating 0 8m17s default-influxdb-69dcbdb4c-l4lp9 1/1 Running 0 8m44s default-keystone-78f45cc8db-xstk2 1/1 Running 0 9m48s default-logger-5576dbc7f4-8mdl4 1/1 Running 0 8m35s default-monitor-64d9c65b7b-4wf8t 1/1 Running 0 8m33s default-notify-59cc65d479-hccs8 11/11 Running 0 8m38s default-onecloud-service-operator-584989c746-8ndvf 2/2 Running 0 8m31s default-ovn-north-866c9fbc6f-87wkg 1/1 Running 0 8m49s default-region-5bc599845-nb882 1/1 Running 0 9m36s default-region-dns-hdj5k 1/1 Running 0 8m55s default-s3gateway-69b9c5b56c-hb64l 1/1 Running 0 8m32s default-scheduler-57c66964b7-qh9f2 1/1 Running 0 9m1s default-telegraf-f7rvx 2/2 Running 0 8m27s default-vpcagent-8ff58c47d-5b4j8 1/1 Running 0 8m41s default-web-79df8f97b9-c6lgm 1/1 Running 0 8m52s default-webconsole-79cc5cfb9-xd9tk 1/1 Running 0 8m36s default-yunionconf-5f79b9655f-trmls 1/1 Running 0 8m37s mysql-7d4f67979b-8gl4g 1/1 Running 0 11m onecloud-operator-69bf9fb476-dsw6d 1/1 Running 0 13m 也可打开 kubernetes dashboard 确认相关服务正常启动完成。\n# 启用 kubernetes dashboard $ minikube dashboard -p onecloud 创建账号登录 Web UI  创建账号: 部署完成后，需要使用我们的命令行工具 climc 创建帐号  # 进入 climc 容器 $ kubectl exec -n onecloud `kubectl -n onecloud get pods | grep \"default-climc\"| cut -f1 -d\" \"` -c climc -i -t -- /bin/bash -il # 创建用户 demo , 密码为 demo123A 的管理员 $ /opt/yunion/bin/climc user-create demo --password demo123A --enabled # 将用户 demo 加入 system 项目，并且赋予 admin 权限 $ /opt/yunion/bin/climc project-add-user system demo admin  登陆 web 前端 UI 界面  # 使用 kubectl port-forward 将 web 前端 forward 到本地 9999 端口 $ kubectl -n onecloud port-forward `kubectl -n onecloud get pods | grep \"default-web-\" | cut -f1 -d\" \"` 9999:443 --address=0.0.0.0 打开浏览器：https://localhost:9999\n集群清理 # 删除所有 onecloud 服务 $ kubectl delete -f onecloud-cluster.yaml $ kubectl delete -f onecloud-operator.yaml # stop kubernetes 集群，以后还可以用 minikube start 开启 $ minikube -p onecloud stop # 以下命令删除整个 minikube 创建的 kubernetes 集群 $ minikube -p onecloud delete 待解决的问题  default-host-deployer pod 无法启动，会处于 ContainerCreating 状态，这个是没有用 ocadm 部署集群导致的。未来会想办法支持该服务在 minikube 的集群里面运行，目前启动不了，不影响体验云联壹云。issue #8910  ","excerpt":"前提 注意 本章内容是方便快速体验云联壹云, 通过 MiniKube 快速搭建云联壹云服务，无法在生产环境使用，也无法验证云联内置私有云相关 …","ref":"/v3.6/zh/docs/quickstart/minikube/","title":"MiniKube 安装"},{"body":"环境准备 云联壹云 相关的组件运行在 kubernetes 之上，环境以及相关的软件依赖如下:\n 操作系统: CentOS 7.6 最低配置要求: CPU 4核, 内存 8G, 存储 150G 数据库: mariadb (CentOS 7自带的版本：Ver 15.1 Distrib 5.5.56-MariaDB） docker: ce-19.03.9 kubernetes: v1.15.8  需要能访问如下网址，如果企业有外网隔离规则，则需要打开相应白名单：\n CentOS YUM网络安装源 https://iso.yunion.cn/ https://registry.cn-beijing.aliyuncs.com https://meta.yunion.cn https://yunionmeta.oss-cn-beijing.aliyuncs.com  安装配置 mariadb mariadb 作为服务数据持久化的数据库，可以部署在其它节点或者使用单独维护的。下面假设还没有部署 mariadb，在控制节点上安装设置 mariadb。\n为了方便运行维护，mariadb推荐打开两个参数设施：\n skip_name_resolve：取消域名解析 expire_logs_days=30：设置binlog的超时时间为30天，超过30天的binglog自动删除  $ MYSQL_PASSWD='your-sql-passwd' # 安装 mariadb $ yum install -y epel-release mariadb-server $ systemctl enable --now mariadb $ mysqladmin -u root password \"$MYSQL_PASSWD\" $ cat \u003c\u003cEOF \u003e/etc/my.cnf [mysqld] datadir=/var/lib/mysql socket=/var/lib/mysql/mysql.sock # Disabling symbolic-links is recommended to prevent assorted security risks symbolic-links=0 # Settings user and group are ignored when systemd is used. # If you need to run mysqld under a different user or group, # customize your systemd unit file for mariadb according to the # instructions in http://fedoraproject.org/wiki/Systemd # skip domain name resolve skip_name_resolve # auto delete binlog older than 30 days expire_logs_days=30 [mysqld_safe] log-error=/var/log/mariadb/mariadb.log pid-file=/var/run/mariadb/mariadb.pid # # include all files from the config directory # !includedir /etc/my.cnf.d EOF $ mysql -uroot -p$MYSQL_PASSWD \\  -e \"GRANT ALL ON *.* to 'root'@'%' IDENTIFIED BY '$MYSQL_PASSWD' with grant option; FLUSH PRIVILEGES;\" $ systemctl restart mariadb 安装配置 docker 安装 docker\n$ yum install -y yum-utils bash-completion # 添加 yunion 云联壹云 rpm 源 $ yum-config-manager --add-repo https://iso.yunion.cn/yumrepo-3.6/yunion.repo $ yum install -y docker-ce-19.03.9 docker-ce-cli-19.03.9 containerd.io 配置 docker\n$ mkdir -p /etc/docker $ cat \u003c\u003cEOF \u003e/etc/docker/daemon.json { \"bridge\": \"none\", \"iptables\": false, \"exec-opts\": [ \"native.cgroupdriver=systemd\" ], \"data-root\": \"/opt/docker\", \"live-restore\": true, \"log-driver\": \"json-file\", \"log-opts\": { \"max-size\": \"100m\" }, \"registry-mirrors\": [ \"https://lje6zxpk.mirror.aliyuncs.com\", \"https://lms7sxqp.mirror.aliyuncs.com\", \"https://registry.docker-cn.com\" ] } EOF 启动 docker\n$ systemctl enable --now docker 安装 云联壹云 依赖内核 这里需要安装我们编译的内核，这个内核是基于上游 CentOS 3.10.0-1062 编译的，默认添加了 nbd 模块，nbd 模块用于镜像相关的操作。\n# 安装内核 $ yum install -y \\  kernel-3.10.0-1062.4.3.el7.yn20191203 \\  kernel-devel-3.10.0-1062.4.3.el7.yn20191203 \\  kernel-headers-3.10.0-1062.4.3.el7.yn20191203 # 重启系统进入内核 $ reboot # 重启完成后，查看当前节点内核信息 # 确保为 3.10.0-1062.4.3.el7.yn20191203.x86_64 $ uname -r 3.10.0-1062.4.3.el7.yn20191203.x86_64 安装配置 kubelet 从 云联壹云 rpm 的 yum 源安装 kubernetes 1.15.8，并设置 kubelet 开机自启动\n$ yum install -y bridge-utils ipvsadm conntrack-tools \\  jq kubelet-1.15.8-0 kubectl-1.15.8-0 kubeadm-1.15.8-0 $ echo 'source \u003c(kubectl completion bash)' \u003e\u003e ~/.bashrc \u0026\u0026 source ~/.bashrc $ source /etc/profile $ systemctl enable kubelet 安装完 kubernetes 相关的二进制后，还需要对系统做一些配置并启用 ipvs 作为 kube-proxy 内部的 service 负载均衡\n# 禁用 swap $ swapoff -a # 如果设置了自动挂载 swap，需要去 /etc/fstab 里面注释掉挂载 swap 那一行 # 关闭 selinux $ setenforce 0 $ sed -i 's/SELINUX=enforcing/SELINUX=disabled/' /etc/selinux/config # 禁用 firewalld $ systemctl stop firewalld $ systemctl disable firewalld # 禁用 NetworkManager $ systemctl stop NetworkManager $ systemctl disable NetworkManager $ ps -ef|grep dhcp | awk '{print $2}' |xargs kill -9 # 做一些 sysctl 的配置, kubernetes 要求 $ modprobe br_netfilter $ cat \u003c\u003cEOF \u003e\u003e /etc/sysctl.conf net.bridge.bridge-nf-call-iptables=1 net.bridge.bridge-nf-call-ip6tables=1 net.ipv4.ip_forward=1 EOF $ sysctl -p # 配置并开启 ipvs $ cat \u003c\u003cEOF \u003e /etc/sysconfig/modules/ipvs.modules #!/bin/bash ipvs_modules=\"ip_vs ip_vs_lc ip_vs_wlc ip_vs_rr ip_vs_wrr ip_vs_lblc ip_vs_lblcr ip_vs_dh ip_vs_sh ip_vs_fo ip_vs_nq ip_vs_sed ip_vs_ftp nf_conntrack_ipv4\" for kernel_module in \\${ipvs_modules}; do /sbin/modinfo -F filename \\${kernel_module} \u003e /dev/null 2\u003e\u00261 if [ $? -eq 0 ]; then /sbin/modprobe \\${kernel_module} fi done EOF $ chmod 755 /etc/sysconfig/modules/ipvs.modules \u0026\u0026 bash /etc/sysconfig/modules/ipvs.modules \u0026\u0026 lsmod | grep ip_vs 部署集群 提示  如果要部署高可用集群，请先搭建负载均衡集群，参考 部署 HA 环境。\n  安装部署工具 先安装部署工具 ocadm 和云平台的命令行工具 climc:\n# 安装 climc 云平台命令行工具 和 ocadm 部署工具 $ yum install -y yunion-climc yunion-ocadm # climc 在 /opt/yunion/bin 目录下，根据自己的需要加到 bash 或者 zsh 配置文件里面 $ echo 'export PATH=$PATH:/opt/yunion/bin' \u003e\u003e ~/.bashrc \u0026\u0026 source ~/.bashrc # 安装必要的服务，并启动和设置为开机自启 $ yum install -y yunion-executor \u0026\u0026 systemctl enable --now yunion-executor 部署 kubernetes 集群 接下来会现在当前节点启动 v1.15.8 的 kubernetes 服务，然后部署 云联壹云 控制节点相关的服务到 kubernetes 集群。\n拉取必要的 docker 镜像\n$ ocadm config images pull 使用 ocadm 部署 kubernetes 集群\n提示  如果要进行高可用部署，并已经搭建好了负载均衡集群，需要在 ocadm init 命令加上 --control-plane-endpoint \u003cvip\u003e:6443 参数，告诉 kubernetes 集群前端的 LoadBalancer vip，之后生成的配置就会都用这个 vip 当做控制节点的入口。\n  # 假设 mariadb 部署在本地，如果是使用已有的数据库，请改变对应的 ip $ MYSQL_HOST=$(ip route get 1 | awk '{print $NF;exit}') # 如果是高可用部署，记得在设置 EXTRA_OPT=' --control-plane-endpoint 10.168.222.18:6443' $ EXTRA_OPT=\"\" $ #EXTRA_OPT=' --control-plane-endpoint 10.168.222.18:6443' # 开始部署 kubernetes 以及 云联壹云 必要的控制服务，稍等 3 分钟左右，kubernetes 集群会部署完成 $ ocadm init --mysql-host $MYSQL_HOST \\  --mysql-user root --mysql-password $MYSQL_PASSWD $EXTRA_OPT ... Your Kubernetes and control-plane has initialized successfully! ...  提示  kubernetes 高可用部署需要 3 个节点，主要是 etcd 需要至少 3 个节点组成高可用集群。如果是高可用部署，请在另外两个节点执行 ocadm join --control-plane \u003cvip\u003e:6443 部署控制服务，join 的另外两个节点会自动和当前的控制节点组成高可用集群。参考: 加入控制节点\n  kubernetes 集群部署完成后，通过以下命令来确保相关的 pod (容器) 都已经启动, 变成 running 的状态。\n$ mkdir -p $HOME/.kube $ sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config $ sudo chown $(id -u):$(id -g) $HOME/.kube/config $ kubectl get pods --all-namespaces NAMESPACE NAME READY STATUS RESTARTS AGE kube-system calico-kube-controllers-648bb4447c-57gjb 1/1 Running 0 5h1m kube-system calico-node-j89jg 1/1 Running 0 5h1m kube-system coredns-69845f69f6-f6wnv 1/1 Running 0 5h1m kube-system coredns-69845f69f6-sct6n 1/1 Running 0 5h1m kube-system etcd-lzx-ocadm-test2 1/1 Running 0 5h kube-system kube-apiserver-lzx-ocadm-test2 1/1 Running 0 5h kube-system kube-controller-manager-lzx-ocadm-test2 1/1 Running 0 5h kube-system kube-proxy-2fwgf 1/1 Running 0 5h1m kube-system kube-scheduler-lzx-ocadm-test2 1/1 Running 0 5h kube-system traefik-ingress-controller-qwkfb 1/1 Running 0 5h1m local-path-storage local-path-provisioner-5978cff7b7-7h8df 1/1 Running 0 5h1m onecloud onecloud-operator-6d4bddb8c4-tkjkh 1/1 Running 0 3h37m 创建 云联壹云 集群 当 kubernetes 集群部署完成后，就可以通过 ocadm cluster create 创建 云联壹云 集群，该集群由 onecloud namespace 里面 onecloud-operator deployment 自动部署和维护。\n# 创建集群 # 如果要部署企业版的组件可以在 cluster create 的时候加上 --use-ee 参数 $ ocadm cluster create --wait 执行完 ocadm cluster create --wait 命令后，onecloud-operator 会自动创建各个服务组件对应的 pod，等待一段该命令执行完毕， 就可以通过访问 ‘https://本机IP:443’ 登入前端界面。\n创建登录用户 当控制节点部署完成后，需要创建一个用于前端登录的用户。云平台的管理员认证信息由 ocadm cluster rcadmin 命令可以得到 , 这些认证信息在使用 climc 控制云平台资源时会用到。\n# 获取连接 云联壹云 集群的环境变量 $ ocadm cluster rcadmin export OS_AUTH_URL=https://10.168.222.218:30357/v3 export OS_USERNAME=sysadmin export OS_PASSWORD=3hV3qAhvxck84srk export OS_PROJECT_NAME=system export YUNION_INSECURE=true export OS_REGION_NAME=region0 export OS_ENDPOINT_TYPE=publicURL  提示  如果是高可用部署，这些 endpoint 的 public url 会是 vip，如果要在 kubernetes 集群外访问需要到 haproxy 节点上添加对应的 frontend 和 backend，其中frontend的端口对应 endpoint 里面的端口，backend 对应 3 个 controlplane node 的 ip 和对应端口。\n  创建用户\n# 初始化连接集群的管理员认证信息 $ source \u003c(ocadm cluster rcadmin) # 设置想要创建的用户名和密码 $ OC_USERNAME=demo $ OC_PASSWORD=demo@123 # 创建指定的用户 $ climc user-create --password $OC_PASSWORD --enabled $OC_USERNAME # 将用户加入 system 项目并赋予 admin 角色 $ climc project-add-user system $OC_USERNAME admin 访问前端 # 获取本机 IP $ ip route get 1 | awk '{print $NF;exit}' 10.168.222.218 # 测试连通性 $ curl -k https://10.168.222.218 用浏览器访问 ‘https://本机IP’ 会跳转到 web 界面，使用 创建登录用户 里面指定的用户名和密码登录后，界面如下:\n删除环境 如果安装过程中失败，或者想清理环境，可执行以下命令删除 kubernetes 集群。\n$ ocadm reset --force 后续 如果没有意外，现在应该已经部署好了 云联壹云 on kubernetes 的集群，以下是一些后续的环节说明，可以根据自己的需要来进行额外的操作。\n添加计算节点 当控制节点搭建完成后，可以参考 计算节点 一节的内容，添加计算节点，组建一套私有云集群。\n控制节点作为计算节点 默认情况下 ocadm init 创建的节点是控制节点，不会运行 onecloud 计算节点的服务。如果需要把控制节点也作为计算节点，需要执行以下步骤:\n 安装计算节点需要的依赖，参考 “计算节点/安装依赖”，这里主要是要安装我们的内核和运行虚拟机的 qemu 等软件。  # 安装rpm包 $ yum --disablerepo='*' --enablerepo='yunion*' install -y \\  epel-release libaio jq libusb lvm2 nc ntp yunion-fetcherfs fuse fuse-devel fuse-libs \\  oniguruma pciutils spice spice-protocol sysstat tcpdump usbredir \\  yunion-qemu-2.12.1 yunion-executor \\  kmod-openvswitch \\  openvswitch net-tools $ systemctl enable --now yunion-executor  在控制节点启用该节点作为计算节点，命令如下:  # 用 kubectl get nodes 拿到当前的节点名称 $ kubectl get nodes NAME STATUS ROLES AGE controller01 Ready master 116d controller02 Ready master 40d node01 Ready \u003cnone\u003e 25d # 假设我要把 controller01 和 controller02 作为计算节点 $ ocadm node enable-host-agent \\  --node controller01 \\  --node controller02 # 等待并查看运行在 controller01/02 上的计算节点服务 $ kubectl get pods -n onecloud -o wide | grep host default-host-7b5cr 2/2 Running 218 18h 192.168.222.4 controller01 default-host-ctx5s 2/2 Running 218 18h 192.168.222.5 controller02 升级组件版本 请参考 升级相关 进行升级。\n","excerpt":"环境准备 云联壹云 相关的组件运行在 kubernetes 之上，环境以及相关的软件依赖如下:\n 操作系统: CentOS 7.6 最低配置 …","ref":"/v3.6/zh/docs/setup/controlplane/","title":"部署集群"},{"body":"架构简介 云联壹云 服务组件较多，接下来分别介绍每个组件的功能:\n   服务组件 功能用途     keystone 认证权限管理   region 多云资源控制器   scheduler 资源调度器   glance 虚拟机镜像管理   host 私有云虚拟机管理   baremetal 私有云物理机管理   esxi-agent vmware esxi 实例管理   lb-agent 私有云负载均衡   webconsole 提供 vnc, ssh 访问   logger 记录审计日志   apigateway api 网关，能通过该服务访问后端所有 api   climc 命令行管理工具    组件架构见下图，分为接入层，控制层和资源层三个主要部分。\n接入层 接入层实现云管平台的访问功能，允许用户通过如下3种方式访问云管平台的功能：\n  API访问: 通过REST API访问云管平台功能，用户可以直接通过http接口访问云管平台的REST API，也可以使用云管平台提供的SDK。目前SDK支持Java，Python和Golang等三种语言。\n  命令行访问: 通过云管平台提供的climc命令行工具访问云管平台功能，允许用户通过脚本调用climc，实现一些自动化运维功能。Climc使用Golang语言，基于云管平台的Golang SDK开发。\n  Web控制台访问: 通过Web UI访问云管平台的功能。允许用户通过主流web浏览器访问云管平台。Web控制台提供管理员使用的管理后台以及普通用户使用的普通功能页面，能够提供大部分的管理和使用功能。Web控制台基于Vue 2.0 JavaScript SPA框架实现。\n  控制层   控制层实现云管平台的管理和控制功能。主要由API网关，认证服务，镜像服务，云控制器和调度器，以及 webconsole vnc, ssh 代理服务等组件构成。\n  API网关提供Web控制台对各个服务的统一REST API访问接口。实现Web控制台的登录验证，session 控制，以及对后端各个服务的API调用。API网关由Golang完全自主开发，完全无状态架构，具备水平扩展能力。\n  认证服务提供平台的账户管理和认证体系，并提供基于项目的多租户支持，同时提供服务目录功能。认证服务支持多种认证源，允许和企业的LDAP／AD对接，允许用户以企业统一的账户体系登入系统。认证服务2.10之前版本基于OpenStack Keystone Pika版本，开发语言为Python。在开源版本基础上，我们修正了BUG，并做了若干改进。2.10之后版本采用golang语言开发。Keystone采用无状态架构，支持水平扩展，可以水平拆分实现服务高可用。\n  镜像服务提供云管平台各种主机资源的操作系统镜像的管理功能。提供镜像存储，元数据管理等功能。镜像服务1.x版本基于OpenStack Glance Folsom版本改进而来，开发语言为Python。在开源版本基础上，我们修正了BUG，并做了若干改进。2.x版本采用golang语言开发。Glance采用无状态架构，支持水平扩展，可以水平拆分实现服务高可用。\n  云控制器是整个云管平台的中枢，负责机房网络，宿主机，网络，存储，虚拟机等各类资源的元数据信息管理，以及对虚拟机，裸机等的自动化管理操作认证的调度，协调管理。云控制器内置基于REST API接口的分布式异步任务管理框架，实现对在计算节点进行的开关机，创建删除等耗时操作任务的管理协调工作。云控制器完全自主开发，云控制器采用无状态架构，可以水平扩展，通过水平拆分实现高可用。\n  调度器负责云管平台资源调度功能，是云管平台中资源获取决策的唯一执行者，根据用户对资源的要求，给出资源的最优提供者。调度器支持批量调度，调度性能优异，可扩展性好。调度器完全自主开发，基于Golang语言开发。\n  资源层  资源层实现对KVM虚拟机，裸机，VMWare虚拟机等计算资源的管理和控制功能。云管平台目前主要支持对KVM虚拟机，裸机，VMWare虚拟机，常用私有云openstack, zstack 以及公有云阿里云，Azure，腾讯云，AWS等公有云资源的管理。  ","excerpt":"架构简介 云联壹云 服务组件较多，接下来分别介绍每个组件的功能:\n   服务组件 功能用途     keystone …","ref":"/v3.6/zh/docs/contribute/services/","title":"服务组件介绍"},{"body":"介绍云平台后端服务所用的框架和相关库的使用方法，建议先阅读 “开发相关/服务组件介绍” 了解各个服务大概的功能。\n后端服务框架 keystone, region, glance 等后端服务，都是用的同一套后端服务框架，这个框架是我们自己定义实现的，核心模块如下:\n  REST API: 负责解析客户端发送的 CRUD http 请求，将不同的请求对应到 Model Dispatcher 模块。\n  Model Dispatcher: 将客户端的请求分发到对应资源的业务操作。\n  Model: 定义云平台各种资源，会进行数据库读写相关操作，如果具体业务需要进行耗时操作，会通过 Task 机制来执行耗时任务。\n  Task: 后台处理异步耗时任务的模块，会通过更新 Model 的状态来更新任务的执行结果。\n  云联壹云 代码结构  build: 打包rpm脚本 cmd: 可执行binary入口程序 pkg: 库  appsrv: 通用http服务框架 cloudcommon: 云平台服务框架，基于appsrv扩展  cloudcommon/options: 通用options cloudcommon/app: 通用服务初始化代码 cloudcommon/db: Model dispatcher和Models的基础实现 cloudcommon/db/lockman: 锁实现 cloudcommon/db/taskman: 异步任务框架      认证部分  客户端向服务发起请求前，需要从keystone获得token 客户端通过携带用户名密码调用keystone的/v3/auth/tokens接口获得token 客户端向服务发起的每次API请求都会在HTTP头携带该token，比如: X-Auth-Token: {token} 后端服务向keystone验证该token，获得用户的身份信息，执行后续API的流程 每个服务都有一个keystone注册的服务用户账号（user/password)，并且以admin角色加入system项目 服务启动后，会向keystone发起认证，获得admin token 用户通过API访问服务时，将在header携带token 使用这个admin token访问keystone的token验证接口，验证这个token，获得用户的身份信息  Model Dispatcher 把 REST API 和 Model 的方法进行一一映射\n   REST 请求 Model 方法 说明     GET /\u003cresources\u003e AllowListItems List的权限判断   - ListItemFilter 过滤   - GetCustomizeColumns 获得扩展字段的信息   GET /\u003cresources\u003e/\u003cres_id\u003e AllowGetDetails Get 的权限判断   - GetExtraDetails 获取扩展字段的信息   GET /\u003cresources\u003e/\u003cres_id\u003e/\u003cspec\u003e AllowGetDetails\u003cSpec\u003e 获取资源特定属性的权限判断   - GetDetails\u003cSpec\u003e 获取资源特定属性   POST /\u003cresources\u003e AllowCreateItem 创建操作的鉴权   - ValidateCreateData 校验和处理创建的数据   - CustomizeCreate 自定义的创建操作   - PostCreate 创建后的hook   - OnCreateComplete 创建完成的hook   POST /\u003cresources\u003e/\u003cres_id\u003e/\u003caction\u003e AllowPerformAction\u003cAction\u003e 某个资源执行特定操作的鉴权判断   - Perform\u003cAction\u003e 某个资源执行特定操作   PUT /\u003cresources\u003e/\u003cres_id\u003e AllowUpdateItem 对指定资源更新操作的鉴权   - ValidateUpdateData 校验和处理更新操作的数据   - PreUpdate 自定义的创建操作   - PostUpdate 创建后的hook   DELETE /\u003cresources\u003e/\u003cres_id\u003e AllowDeleteItem 删除指定资源的鉴权   - CustomizeDelete 自定义的删除操作   - PreDelete 删除前的hook   - Delete 执行删除操作   - PostDelete 删除后的hook    具体 restful 请求的绑定函数在: pkg/appsrv/dispatcher/dispatcher.go 文件中的 AddModelDispatcher 函数。\n数据库 ORM 模型 代码位于 cloudcommon/db\n 接口  IModelManager: 对应资源在数据库里面的表 IModel: 对应资源在数据库里面的单条数据   数据结构  SResourceBase: 基础资源  SStandaloneResourceBase: 基础设施的物理资源，没有具体ownerId的资源，如zone, host  SVirtualResourceBase: 虚拟资源，如虚拟机（guest)  SSharableVirtualResourceBase: 虚拟的可以共享的虚拟资源，如disk, network  SAdminSharableVirtualInfoBase: 管理配置用的可共享虚拟资源，如security group       SJointResourceBase: 联合数据类型，如虚拟网卡是虚拟机和网络的联合，虚拟磁盘挂在：虚拟机和虚拟磁盘的联合      举例 用虚拟机的 model 来举例，代码在: pkg/compute/models/guests.go。\nGuestManager 对应数据库里面的 guests_tbl，该对象嵌套 db.SVirtualResourceBaseManager 表示是虚拟资源的 Manager，这样会默认实现 db.IModelManager 接口，然后根据业务需要重写一些方法会比较方便。\nSGuest 对应 guests_tbl 数据库里面的每一行数据，由 GuestManager 管理，嵌套 db.SVirtualResourceBase 结构，默认就会有虚拟资源所需要的表结构，然后再定义一些虚拟机独有的属性比如 VcpuCount 表示 cpu 核数，VmemSize 表示内存大小。 在代码抽象后表示虚拟机实例，该对象会绑定对虚拟机具体的业务操作实现函数。\nimport \"yunion.io/x/cloudpods/pkg/cloudcommon/db\" ...... type SGuestManager struct { db.SVirtualResourceBaseManager } var GuestManager *SGuestManager func init() { GuestManager = \u0026SGuestManager{ SVirtualResourceBaseManager: db.NewVirtualResourceBaseManager( SGuest{}, \"guests_tbl\", \"server\", \"servers\", ), } GuestManager.SetVirtualObject(GuestManager) GuestManager.SetAlias(\"guest\", \"guests\") } type SGuest struct { db.SVirtualResourceBase db.SExternalizedResourceBase SBillingResourceBase VcpuCount int `nullable:\"false\" default:\"1\" list:\"user\" create:\"optional\"` // Column(TINYINT, nullable=False, default=1) \tVmemSize int `nullable:\"false\" list:\"user\" create:\"required\"` // Column(Integer, nullable=False)  BootOrder string `width:\"8\" charset:\"ascii\" nullable:\"true\" default:\"cdn\" list:\"user\" update:\"user\" create:\"optional\"` // Column(VARCHAR(8, charset='ascii'), nullable=True, default='cdn')  DisableDelete tristate.TriState `nullable:\"false\" default:\"true\" list:\"user\" update:\"user\" create:\"optional\"` // Column(Boolean, nullable=False, default=True) \tShutdownBehavior string `width:\"16\" charset:\"ascii\" default:\"stop\" list:\"user\" update:\"user\" create:\"optional\"` // Column(VARCHAR(16, charset='ascii'), default=SHUTDOWN_STOP)  KeypairId string `width:\"36\" charset:\"ascii\" nullable:\"true\" list:\"user\" create:\"optional\"` // Column(VARCHAR(36, charset='ascii'), nullable=True)  HostId string `width:\"36\" charset:\"ascii\" nullable:\"true\" list:\"admin\" get:\"admin\" index:\"true\"` // Column(VARCHAR(36, charset='ascii'), nullable=True) \tBackupHostId string `width:\"36\" charset:\"ascii\" nullable:\"true\" list:\"user\" get:\"user\"` Vga string `width:\"36\" charset:\"ascii\" nullable:\"true\" list:\"user\" update:\"user\" create:\"optional\"` // Column(VARCHAR(36, charset='ascii'), nullable=True) \tVdi string `width:\"36\" charset:\"ascii\" nullable:\"true\" list:\"user\" update:\"user\" create:\"optional\"` // Column(VARCHAR(36, charset='ascii'), nullable=True) \tMachine string `width:\"36\" charset:\"ascii\" nullable:\"true\" list:\"user\" update:\"user\" create:\"optional\"` // Column(VARCHAR(36, charset='ascii'), nullable=True) \tBios string `width:\"36\" charset:\"ascii\" nullable:\"true\" list:\"user\" update:\"user\" create:\"optional\"` // Column(VARCHAR(36, charset='ascii'), nullable=True) \tOsType string `width:\"36\" charset:\"ascii\" nullable:\"true\" list:\"user\" update:\"user\" create:\"optional\"` // Column(VARCHAR(36, charset='ascii'), nullable=True)  FlavorId string `width:\"36\" charset:\"ascii\" nullable:\"true\" list:\"user\" create:\"optional\"` // Column(VARCHAR(36, charset='ascii'), nullable=True)  SecgrpId string `width:\"36\" charset:\"ascii\" nullable:\"true\" get:\"user\" create:\"optional\"` // Column(VARCHAR(36, charset='ascii'), nullable=True) \tAdminSecgrpId string `width:\"36\" charset:\"ascii\" nullable:\"true\" get:\"admin\"` // Column(VARCHAR(36, charset='ascii'), nullable=True)  Hypervisor string `width:\"16\" charset:\"ascii\" nullable:\"false\" default:\"kvm\" list:\"user\" create:\"required\"` // Column(VARCHAR(16, charset='ascii'), nullable=False, default=HYPERVISOR_DEFAULT)  InstanceType string `width:\"64\" charset:\"ascii\" nullable:\"true\" list:\"user\" create:\"optional\"` } ...... 数据库锁 代码位于 cloudcommon/db/lockman:\n LockClass/ReleaseClass: 锁住一类实例，一般创建资源时候需要锁 LockObject/ReleaseObject: 锁住一个实例，一般修改资源实例是需要锁 LockRawObject/RelaseRawObject: 通用的锁  举例 pkg/cloudcommon/db/db_dispatcher.go 里面的 DoCreate 函数会创建对应 Model 的对象并插入数据到数据库，这个时候就需要加锁。\nfunc DoCreate(manager IModelManager, ctx context.Context, userCred mcclient.TokenCredential, query jsonutils.JSONObject, data jsonutils.JSONObject, ownerId mcclient.IIdentityProvider) (IModel, error) { lockman.LockClass(ctx, manager, GetLockClassKey(manager, ownerId)) defer lockman.ReleaseClass(ctx, manager, GetLockClassKey(manager, ownerId)) return doCreateItem(manager, ctx, userCred, ownerId, nil, data) } worker队列管理 为了避免不可预期的并发度，所有异步执行的代码都应该在worker内执行，以便于管理并发度。\n代码位于 appsrv/workers.go\nworkerman := appsrv.NewWorkerManager(name, parallel_cnt, …) workerman.Run(func() {…}, nil, nil) Task 机制 云平台的异步耗时任务会放在 Task 机制里面去执行，比如创建虚拟机操作，用户提交了请求，region 控制器校验参数合格后，会记录数据到数据库，然后马上返回客户端对应的虚拟机记录，与此同时，会开始执行创建虚拟机的 task，这个 task 会立即在后台执行，会通过更新虚拟机 SGuest model 的状态和记录操作日志来表示执行的成功或失败。\ntask 也是记录在数据库 tasks_tbl 里面的记录，对应的定义在: pkg/cloudcommon/db/taskman/tasks.go 里面，数据结构如下:\ntype STaskManager struct { db.SResourceBaseManager } var TaskManager *STaskManager func init() { TaskManager = \u0026STaskManager{ SResourceBaseManager: db.NewResourceBaseManager(STask{}, \"tasks_tbl\", \"task\", \"tasks\") } TaskManager.SetVirtualObject(TaskManager) } type STask struct { db.SResourceBase Id string `width:\"36\" charset:\"ascii\" primary:\"true\" list:\"user\"` // Column(VARCHAR (36, charset='ascii'), primary_key=True, default=get_uuid) ObjName string `width:\"128\" charset:\"utf8\" nullable:\"false\" list :\"user\"` // Column(VARCHAR(128, charset='utf8'), nullable=False)  ObjId string `width:\"128\" charset:\"ascii\" nullable:\"false\" lis t:\"user\" index:\"true\"` // Column(VARCHAR(ID_LENGTH, charset='ascii'), nullable=False)  TaskName string `width:\"64\" charset:\"ascii\" nullable:\"false\" list :\"user\"` // Column(VARCHAR(64, charset='ascii'), nullable=False)  UserCred mcclient.TokenCredential `width:\"1024\" charset:\"utf8\" nullable:\"false\" get :\"user\"` // Column(VARCHAR(1024, charset='ascii'), nullable=False)  // OwnerCred string `width:\"512\" charset:\"ascii\" nullable:\"true\"` // Column(VARCHAR (512, charset='ascii'), nullable=True) Params *jsonutils.JSONDict `charset:\"utf8\" length:\"medium\" nullable:\"false\" get:\"us er\"` // Column(MEDIUMTEXT(charset='ascii'), nullable=False)  Stage string `width:\"64\" charset:\"ascii\" nullable:\"false\" default:\"on_init\" list:\"u ser\"` // Column(VARCHAR(64, charset='ascii'), nullable=False, default='on_init')  taskObject db.IStandaloneModel `ignore:\"true\"` taskObjects []db.IStandaloneModel `ignore:\"true\"` } ......  Id: STask 里面的 Id 是该 task 记录的 Id ObjId: 对应资源对象的 Id，用于记录执行该 task 的对应操作的资源，比如某台虚拟机、磁盘的 Id UserCred: 存储执行 task 的用户信息 Params: 执行 task 的参数 TaskName: 对应 task 的名称 Stage: task 执行的阶段，默认为 OnInit  举例 以虚拟机关机这个操作来举例:\n 客户端发起 POST /servers/\u003cserver_id\u003e/stop 请求后，通过服务框架会执行 func (self *SGuest) PerformStop 函数，代码片段如下(位于: pkg/compute/models/guest_actions.go):  func (self *SGuest) PerformStop(ctx context.Context, userCred mcclient.TokenCredential, query jsonutils.JSONObject, data jsonutils.JSONObject) (jsonutils.JSONObject, error) { // XXX if is force, force stop guest \tvar isForce = jsonutils.QueryBoolean(data, \"is_force\", false) if isForce || utils.IsInStringArray(self.Status, []string{api.VM_RUNNING, api.VM_STOP_FAILED}) { return nil, self.StartGuestStopTask(ctx, userCred, isForce, \"\") } else { return nil, httperrors.NewInvalidStatusError(\"Cannot stop server in status %s\", self.Status) } }  SGuest 会执行 self.StartGuestStopTask 函数，该函数会去调用虚拟机不同的 Driver 执行关机操作  // pkg/compute/models/guest_actions.go func (self *SGuest) StartGuestStopTask(ctx context.Context, userCred mcclient.TokenCredential, isForce bool, parentTaskId string) error { ...... return self.GetDriver().StartGuestStopTask(self, ctx, userCred, params, parentTaskId) } // pkg/compute/guestdrivers/virtualization.go import \"yunion.io/x/cloudpods/pkg/cloudcommon/db/taskman\" ...... func (self *SVirtualizedGuestDriver) StartGuestStopTask(guest *models.SGuest, ctx context.Context, userCred mcclient.TokenCredential, params *jsonutils.JSONDict, parentTaskId string) error { task, err := taskman.TaskManager.NewTask(ctx, \"GuestStopTask\", guest, userCred, params, parentTaskId, \"\", nil) if err != nil { return err } task.ScheduleRun(nil) return nil } ......   taskman.TaskManager.NewTask(ctx, “GuestStopTask”, …) 这里面的 GuestStopTask 对应 pkg/compute/tasks/guest_stop_task.go 里面的 GuestStopTask，是通过 taskman 里面维护的一个 map 查找的。\n  task.ScheduleRun(nil) 会开始执行对应的 Task，默认会从 task 的默认 Stage OnInit 函数开始执行，所以通过 task 机制就会执行到 GuestStopTask.OnInit 函数。OnInit 函数最终会调用对应虚拟机的 driver 执行 RequestStopOnHost 函数并更新设置自己的 Stage 为 OnMasterStopTaskComplete。\n  对于虚拟机来说 RequestStopOnHost 函数会请求虚拟机所在的 host agent 关闭虚拟机，关机成功后会回调 region task 框架，该框架会根据 taskId 从数据库 load 回来 GuestStopTask，接着它设置的 Stage OnMasterStopTaskComplete 执行。\n  提示  这里失败会自动调用 OnGuestStopTaskCompleteFailed 函数，所以编写对应 task stage 函数时如果写 \u003cOnSometingComplete\u003e 函数时，必须也同时写 \u003cOnSometingCompleteFailed\u003e 函数来处理失败情况。\n   如果成功关机，OnMasterStopTaskComplete 调用 OnGuestStopTaskComplete 函数，该函数会把虚拟机的状态设置为 ready，并记录一条关机操作日志；如果失败会调用 OnGuestStopTaskCompleteFailed 函数，该函数会虚拟机状态设置为关机失败，并记录失败的原因。  func (self *GuestStopTask) OnInit(ctx context.Context, obj db.IStandaloneModel, data jsonutils.JSONObject) { guest := obj.(*models.SGuest) db.OpsLog.LogEvent(guest, db.ACT_STOPPING, nil, self.UserCred) self.stopGuest(ctx, guest) } func (self *GuestStopTask) stopGuest(ctx context.Context, guest *models.SGuest) { host := guest.GetHost() if host == nil { self.OnGuestStopTaskCompleteFailed(ctx, guest, jsonutils.NewString(\"no associated host\")) return } if !self.IsSubtask() { guest.SetStatus(self.UserCred, api.VM_STOPPING, \"\") } self.SetStage(\"OnMasterStopTaskComplete\", nil) err := guest.GetDriver().RequestStopOnHost(ctx, guest, host, self) ...... } func (self *GuestStopTask) OnMasterStopTaskComplete(ctx context.Context, guest *models.SGuest, data jsonutils.JSONObject) { ...... self.OnGuestStopTaskComplete(ctx, guest, data) } func (self *GuestStopTask) OnMasterStopTaskCompleteFailed(ctx context.Context, obj db.IStandaloneModel, reason jsonutils.JSONObject) { guest := obj.(*models.SGuest) self.OnGuestStopTaskCompleteFailed(ctx, guest, reason) } func (self *GuestStopTask) OnGuestStopTaskComplete(ctx context.Context, guest *models.SGuest, data jsonutils.JSONObject) { ...... guest.SetStatus(self.UserCred, api.VM_READY, \"\") ...... logclient.AddActionLogWithStartable(self, guest, logclient.ACT_VM_STOP, \"\", self.Us erCred, true) } func (self *GuestStopTask) OnGuestStopTaskCompleteFailed(ctx context.Context, guest *models.SGuest, reason jsonutils.JSONObject) { ...... db.OpsLog.LogEvent(guest, db.ACT_STOP_FAIL, reason.String(), self.UserCred) self.SetStageFailed(ctx, reason.String()) logclient.AddActionLogWithStartable(self, guest, logclient.ACT_VM_STOP, reason.String(), self.UserCred, false) } 如何增加一个新的服务  在keystone注册一个服务启用用的账户 在keystone注册service和endpoint 参考 cloudpods/pkg/logger实现服务代码 为服务准备一个配置文件，包含以下基础信息  假设服务名为 svc，用户和密码为 svcuser, svcuserpassword，服务监听地址为: http://localhost:8866, region 为 LocalTest，对应操作如下:\n# 创建 service $ climc service-create --enabled svc svc # 创建 endpoint，对应的 service 为 svc $ climc endpoint-create svc LocalTest internal http://localhost:8866 # 创建 user $ climc user-create --password svcuserpassword --enabled svcuser # 把 user 加入 system 项目 $ climc project-add-user system svcuser admin 配置信息如下\nregion:LocalTestport:8866auth_url:https://\u003ckeystone_url\u003e:35357/v3admin_user:svcuseradmin_password:svcuserpasswordadmin_tenant_name:system","excerpt":"介绍云平台后端服务所用的框架和相关库的使用方法，建议先阅读 “开发相关/服务组件介绍” 了解各个服务大概的功能。 …","ref":"/v3.6/zh/docs/contribute/framework/","title":"后端服务框架"},{"body":"部署完集群后，整个 kubernetes 集群只有一个节点，云联壹云 相关服务都运行在了该节点上，为了服务的高可用，我们可以继续添加节点到 kubernetes 集群。\n环境准备 参考 “部署集群/环境准备” 的流程，安装好 docker 和 kubelet。\n获取加入集群 token 然后在控制节点使用 ocadm 拿到加入集群的 token，在待部署节点使用 ocadm 加入集群，操作如下:\n在控制节点获取加入节点的 token\n$ ocadm token list | grep bootstrap 4s4meb.xvgk2bwpmbospn3s 23h 2019-07-10T15:41:10+08:00 authentication,signing The default bootstrap token generated by 'ocadm init'. system:bootstrappers:kubeadm:default-node-token  提示  如果 token 过期了，可以在管理节点使用 ocadm token create 创建新的 token 。\n  加入节点 加入已有 kubernetes 集群的节点有两种角色，‘controlplane’ 和 ‘node’。\ncontrolplane 角色的节点会运行 kube-apiserver、kube-controller-manager、kube-scheduler 和 etcd，加入 controlplane 节点的好处是让 kubernetes 控制相关服务和 etcd 变为高可用。\nnode 角色的节点只会运行 kubelet，运行负载容器。\n加入 controlplane 加入控制节点需要从已有的 kubernetes 集群下载证书，证书使用 certificate key 加密，通过以下方法获取 certificate-key\n$ ocadm init phase upload-certs [upload-certs] Storing the certificates in Secret \"kubeadm-certs\" in the \"kube-system\" Namespace [upload-certs] Using certificate key: afa5e18bacb3f50b424cbf815fce6d1bd916fe91b58ba467053dc6b460198c55 # 这里的 10.168.222.18 是控制节点的 ip，如果是高可用部署则为负载均衡器的 vip，请根据你的环境修改 $ ocadm join --control-plane 10.168.222.18:6443 \\  --token 4s4meb.xvgk2bwpmbospn3s \\  --certificate-key afa5e18bacb3f50b424cbf815fce6d1bd916fe91b58ba467053dc6b460198c55 \\  --discovery-token-unsafe-skip-ca-verification 加入 node # 这里的 10.168.222.18 是控制节点的 ip，如果是高可用部署则为负载均衡器的 vip, 请根据你的环境修改 $ ocadm join 10.168.222.18:6443 \\  --token 4s4meb.xvgk2bwpmbospn3s \\  --discovery-token-unsafe-skip-ca-verification ... This node has joined the cluster: * Certificate signing request was sent to apiserver and a response was received. * The Kubelet was informed of the new secure connection details. Run 'kubectl get nodes' on the control-plane to see this node join the cluster. ","excerpt":"部署完集群后，整个 kubernetes 集群只有一个节点，云联壹云 相关服务都运行在了该节点上，为了服务的高可用， …","ref":"/v3.6/zh/docs/setup/components/","title":"添加 K8S 节点"},{"body":"cloudpods-operator 是单独编写的一个组件，作为一个长期运行的服务运行在 Kubernetes 集群内部，作用是自动搭建和维护 云联壹云 所有服务。详细的介绍可以参考 cloudpods-operator 工作原理。\n简介 operator 在 K8S 里面创建一个叫做 OnecloudCluster 的资源，该资源里面定义了各个服务组件要使用的 docker 镜像仓库和版本，通过修改 OnecloudCluster 这个资源，可以实现对各个服务多方面的镜像版本控制。\n# 查看 OnecloudCluster 资源 $ kubectl get onecloudclusters.onecloud.yunion.io -n onecloud NAME KEYSTONE default registry.cn-beijing.aliyuncs.com/yunionio/keystone:archdev-v36 # 查看 default OnecloudCluster 资源的 YAML 详情 $ kubectl get onecloudclusters.onecloud.yunion.io -n onecloud default -o yaml # 进入 edit 编辑界面 $ kubectl edit onecloudclusters -n onecloud default 镜像控制 OnecloudCluster 资源的镜像版本控制的关键属性简介如下：\n   属性 作用 默认值     .spec.imageRepository 控制所有服务的镜像仓库地址 registry.cn-beijing.aliyuncs.com/yunionio   .spec.version 控制所有服务镜像的 tag 由部署时指定，比如 ‘v3.6.9’   .spec.$(组件名).repository 控制该组件镜像的仓库地址 默认没有设置，可以通过设置该值单独控制组件的镜像仓库   .spec.$(组件名).tag 控制该组件镜像的 tag 默认没有设置，可以通过设置该值单独控制组件的 tag    统一修改版本 通过修改 default onecloudcluster spec.imageRepository 和 spec.version 属性，就会把所有服务的镜像统一更改，以下是使用场景举例:\n 把所有的服务镜像通一修改到 archdev-v36，修改 spec.version  # 这里的 oc 是 onecloudcluster 的简写，也可以识别 $ kubectl edit oc -n onecloud default ... tolerations: - effect: NoSchedule key: node-role.kubernetes.io/master - effect: NoSchedule key: node-role.kubernetes.io/controlplane # 修改这里的 version ，然后所有服务对应 pod 里面的 image tag 都会变成 archdev-v36 version: archdev-v36 vpcAgent: disable: false image: registry.cn-beijing.aliyuncs.com/yunionio/vpcagent:archdev-v36 ... 修改所有服务镜像仓库到 registry.cn-beijing.aliyuncs.com/zexi 拉取镜像，修改 spec.imageRepository  $ kubectl edit oc -n onecloud default spec: ... tolerations: - effect: NoSchedule key: node-role.kubernetes.io/master - effect: NoSchedule key: node-role.kubernetes.io/controlplane # 这里修改 imageRepository 的值，所有的服务对应的 pod 里面的 image 都会从 `registry.cn-beijing.aliyuncs.com/zexi` 这个仓库拉取 imageRepository: registry.cn-beijing.aliyuncs.com/zexi influxdb: ... spec.imageRepository 和 spec.version 可以同时组合使用，这样就可以统一配置各个服务的镜像地址。  修改完这些属性后，可以查看 pods 的状态，会发现所有的 pods 都在重新拉取镜像启动。\n单独修改组件版本 通过修改各个组件里面的 spec.$(component).repository 和 spec.$(component).tag 属性，就会把这个服务对应的 deployment 或者 daemonset 的 image 修改。\n这两个属性设置 image 的优先级要高于外层的 spec.imageRepository 和 spec.version。也就是说通过修改组件的 repository 和 tag 属性，可以做到其它组件镜像不变的情况下，修改单个组件的 image ，这种机制在开发的时候有用。\n下面以 region 为例：\n 指定 spec.regionServer.repository 为 192.168.0.1:5000/yunionio 和 spec.regionServer.tag 为 lzx-dev，将会把 default-region deployment 里面的 image 改为: 192.168.0.1:5000/yunionio/region:lzx-dev。  $ kubectl edit oc -n onecloud default spec: ... regionServer: disable: false dnsDomain: cloud.onecloud.io # 这里设置 repository repository: 192.168.0.1:5000/yunionio # 这里设置 tag tag: lzx-dev dnsServer: 10.127.40.252 image: registry.cn-beijing.aliyuncs.com/yunionio/region:archdev-v36 imagePullPolicy: IfNotPresent replicas: 1 ... # 现在查看 default-region 这个 deployment # 会发现里面的 image 已经被 operator 按照 $(spec.regionServer.repository)/region:$(spec.regionServer.tag) 的格式修改了 $ kubectl get deployment -n onecloud default-region -o yaml | grep image: image: 192.168.0.1:5000/yunionio/region:lzx-dev image: 192.168.0.1:5000/yunionio/region:lzx-dev ","excerpt":"cloudpods-operator 是单独编写的一个组件，作为一个长期运行的服务运行在 Kubernetes 集群内部，作用是自动搭建和维 …","ref":"/v3.6/zh/docs/contribute/operator-intro/","title":"Operator 相关"},{"body":"查询物理机 # list baremetal 记录 climc host-list --baremetal true # list 已经安装系统的物理机 climc host-list --baremetal true --occupied # list 未安装系统的物理机 climc host-list --baremetal true --empty # 查询物理机详情，包括硬件信息，机房信息 climc host-show \u003chost_id\u003e 注册物理机 climc host-create \u003chost_id\u003e 重新准备物理机 climc host-prepare \u003chost_id\u003e 获取物理机登录信息 climc host-logininfo \u003chost_id\u003e 获取串口登录控制台 climc webconsole-baremetal \u003chost_id\u003e 开/关机 climc host-start/host-stop \u003chost_id\u003e 进入/退出维护模式 climc host-maintenance/host-unmaintenance \u003chost_id\u003e 删除物理机 climc host-delete \u003chost_id\u003e 转换/回收宿主机 climc host-convert-hypervisor climc host-undo-convert \u003chost_id\u003e 裸金属服务器相关 安装操作系统 climc server-create \\  --hypervisor baremetal \\ # 指定 server 的类型为 baremetal --ncpu 24 \\ # 创建到 24 核 cpu 的物理机 --raid-config 'raid1:2:MegaRaid' \\ # 第1块盘，使用 MegaRaid 控制器上的(0-1)号两块物理盘做 raid1 --raid-config 'none:1' \\ # 第2块盘，使用 MegaRaid 控制器上的(2)号物理盘，不做 raid --raid-config 'raid10:4:MegaRaid' \\ # 第3快盘, 使用 MegaRaid 控制器上的(3-6)号四块物理盘做raid10 --disk CentOS-7.5.qcow2:100g \\ # 系统盘使用 CentOS-7.5.qcow2 镜像作为操作系统，大小为 100g，使用第1块 raid1 的盘 --disk 'autoextend:ext4:/opt' \\ # 分区挂载到 /opt, 使用第1块 raid1 的盘，文件系统为 ext4, 大小为(第一块盘总大小 - 该盘其他分区的大小(100g)) --disk 'autoextend:xfs:/data-nonraid' \\ # 分区挂载到 /data-nonraid, 使用第2块没做 raid 的盘, 文件系统为 xfs，使用所有空间 --disk 'autoextend:ext4:/data-raid10' \\ # 分区挂载到 /data-raid10, 使用第3块 raid10 的盘，文件系统为 ext4, 使用所有空间 \u003cserver_name\u003e \\ # 裸金属服务器名称 64g # 创建到 64g 内存大小的物理机 raid 配置和分区 调用 server-create 接口时通过 ‘–raid-config’ 传递参数来配置 raid，每个 raid-config 对应到操作系统可见的磁盘设备(/dev/sdx)。\n‘–disk’ 参数对应不同磁盘上的分区，分区对应到磁盘的逻辑为: 分区按照顺序创建到第1块磁盘上，当 disk 设置 autoextend 参数后，表示接下来的 disk 分区会创建到下一个磁盘，以此类推。\n raid 配置 API 参数:     Key Type value 解释     type(磁盘类型) string rotate(机械盘), ssd(固态盘), hybrid(未知) -   conf (raid) string none, raid0, raid1, raid5, raid10 做raid几或者不做   count (磁盘数量) int e.g. 0, 2, 4 小于等于物理机实际的盘数   range (磁盘范围) []int e.g. [0,1,2,3], [4,7], [5,6] 物理磁盘在控制器上的索引号   splits (切割物理盘) string (30%,20%,), (300g,100g,) 做好 raid 的物理盘再切割为多块物理盘   adapter (控制器号) int 0, 1 对应driver的 Adapter 控制器   driver (控制器名称) string MegaRaid,HPSARaid,Mpt2SAS,MarvelRaid,Linux,PCIE 1台物理机上有多个控制器时用于选择盘   strip (设置raid strip 大小) *int e.g. 64*1024 设置strip size, 可选   ra *bool  设置读模式   wt   设置写模式   cachedbadbbu *bool     direct *bool        命令行格式:\n‘(none,raid0,raid1,raid5,raid10):%d:(MegaRaid|HPSARaid|Mpt2SAS|MarvelRaid|Linux|PCIE):(rotate|ssd|hybrid):[0-n]:strip%dk:adapter%d:ra:nora:wt:wb:direct:cachedbadbbu:nocachedbadbbu’\n  查询裸金属服务器 climc server-list --hypervisor baremetal climc server-show \u003cserver_id\u003e 重装操作系统 climc server-rebuild --image \u003cimage_id\u003e \u003cserver_id\u003e 开/关机 climc server-start \u003cserver_id\u003e climc server-stop \u003cserver_id\u003e 删除裸金属服务器 删除 server 裸金属服务器会销毁物理机上的操作系统和 raid 配置，对应的 baremetal 重新进入未分配状态\nclimc server-delete \u003cserver_id\u003e ","excerpt":"查询物理机 # list baremetal 记录 climc host-list --baremetal true # list 已经安装 …","ref":"/v3.6/zh/docs/howto/baremetal/operator/","title":"操作相关"},{"body":"climc server-create 命令提供创建云主机的操作。 云联壹云 可以同时管理多个私有云和公有云，不同供应商有各自的认证方式，在创建云主机之前需要做一些不同的准备工作。\n环境准备 云联壹云 虚拟机 云联壹云 提供自研的 kvm 虚拟机私有云管理平台，创建 kvm 虚拟机时需要有相应的宿主机，如果还没有添加 kvm 宿主机，请参考 安装部署/计算节点 注册对应的宿主机到云平台。\nVMware ESXI 虚拟机 TODO\n私有云 私有云和公有云都有自己的认证体系，为了让 云联壹云 能够管理各个云平台，需要把他们的认证信息导入到 云联壹云 平台。\n   平台 准备工作     openstack TODO   zstack TODO    公有云    平台 准备工作     阿里云 TODO   腾讯云 TODO   华为云 TODO   AWS TODO   Azure TODO   UCloud TODO    创建机器 创建机器命令为 server-create，可以使用 climc help server-create 查看创建 server 的所有参数，常用的参数如下：\n   参数名称 类型 作用     –ncpu int 虚拟机 cpu 个数   –disk []string 指定创建的系统盘镜像，指定多次表示虚拟机创建多块磁盘   –net []string 指定虚拟机使用的网络，指定多次将在虚拟机里面添加多个网卡   –allow-delete bool 允许删除虚拟机   –auto-start bool 创建完自动启动   –password string 设置虚拟机密码   –tenant string 创建到指定的项目   –prefer-region string 创建到指定的 region   –prefer-zone string 创建到指定的 zone   –prefer-host string 创建到指定的 host    注意以下几点:\n 名称、内存或者套餐类型在创建主机时必须使用; 系统盘的镜像通过 image-list 或者 cached-image-list，公有云的镜像列表通过 cached-image-list 接口查询，参考: 查询镜像;  下面以举例的方式创建机器：\n私有云主机 待创建规格:\n   名称 平台 套餐 内存 cpu 系统盘 网络 其他     vm1 kvm - 4g 4 centos7.qcow2 60g net1 2块数据盘， 一块100g ext4 挂载到 /opt，另外一块 50g xfs 挂载到 /data; 自动启动   vm2 esxi - 2g 2 ubuntu18.04.qcow2 100g net2 允许删除   vm3 opnstack t2.nano - - centos6.qcow2 net3 -    # 创建 kvm vm1 $ climc server-create --hypervisor kvm --disk centos7.qcow2:60g --disk 100g:ext4:/opt --disk 50g:xfs:/data --ncpu 4 --net net1 --auto-start vm1 4g # 创建 esxi vm2 $ climc server-create --hypervisor esxi --disk ubuntu18.04.qcow2:100g --net net2 --ncpu 2 --allow-delete vm2 2g # 创建 openstack vm3 $ climc server-create --hypervisor openstack --disk centos6.qcow2 --net net3 vm3 t2.nano 公有云主机 创建共有云主机和虚拟机的参数一致，但通常情况下需要通过 cloud-region-list 、zone-list 和 vpc-list 子命令挑选出各个公有云可用的 region, zone 和 network。\n然后 server-create 的时候通过 --prefer-region 或 --prefer-zone 创建到指定的区域，--net 创建到指定的 vpc 子网。\n# 查询 aliyun 的可用的 vpc $ climc vpc-list --provider Aliyun --details +--------------------------------------+-------------------------------------------+---------+-----------+--------------------------------------+------------+----------------+------------------------+ | ID | Name | Enabled | Status | Cloudregion_Id | Is_default | Cidr_Block | Region | +--------------------------------------+-------------------------------------------+---------+-----------+--------------------------------------+------------+----------------+------------------------+ | 6aabd4c5-8a6a-4ffb-83cd-39f924f773b7 | test12 | false | available | 9b0fdc39-701b-44fc-8842-664fe89359f1 | false | 192.168.0.0/16 | 阿里云 华北2（北京） | | 8f4d444f-cce4-4797-8441-e1b58c72ed26 | ali-yunion-bj | false | available | 9b0fdc39-701b-44fc-8842-664fe89359f1 | true | 172.17.0.0/16 | 阿里云 华北2（北京） | | bb8c1ec5-4577-4f84-8117-efab6586b799 | ali-transit-bj | false | available | 9b0fdc39-701b-44fc-8842-664fe89359f1 | false | 10.0.0.0/8 | 阿里云 华北2（北京） | | c4e1a012-5f2a-48fc-80ef-4ac0371006eb | hello | false | available | dbbfea2f-8bf4-4676-8036-4ad6f6e6b1ea | false | 10.0.0.0/8 | 阿里云 阿联酋（迪拜） | ... # 查询 vpc 6aabd4c5-8a6a-4ffb-83cd-39f924f773b7 下可用的 network $ climc network-list --vpc 6aabd4c5-8a6a-4ffb-83cd-39f924f773b7 +--------------------------------------+------------+----------------+-----------------+---------------+--------------------------------------+-----------+--------------+-----------------+-------------+-----------+ | ID | Name | Guest_ip_start | Guest_ip_end | Guest_ip_mask | wire_id | is_public | public_scope | guest_gateway | server_type | Status | +--------------------------------------+------------+----------------+-----------------+---------------+--------------------------------------+-----------+--------------+-----------------+-------------+-----------+ | b3dee5e6-0dce-403c-80b2-ad62880b662f | esrdfsfsd | 192.168.0.1 | 192.168.127.252 | 17 | a421934d-9cb4-4163-85b9-ad0038e9cb89 | true | system | 192.168.127.254 | guest | available | | d131de82-1be5-4f70-8b22-2303f4f409bb | sdfsdfdsff | 192.168.128.1 | 192.168.255.252 | 17 | 8ccdbe42-0c62-456f-842d-bc279a5c2786 | true | system | 192.168.255.254 | guest | available | +--------------------------------------+------------+----------------+-----------------+---------------+--------------------------------------+-----------+--------------+-----------------+-------------+-----------+ # 查询 region 9b0fdc39-701b-44fc-8842-664fe89359f1 下可用的 sku $ climc server-sku-list --region 9b0fdc39-701b-44fc-8842-664fe89359f1 --provider Aliyun # 创建 ecs.t5-lc2m1.nano aliyun vm4 虚拟机到 region 9b0fdc39-701b-44fc-8842-664fe89359f1 的子网 b3dee5e6-0dce-403c-80b2-ad62880b662f $ climc server-create --prefer-region 9b0fdc39-701b-44fc-8842-664fe89359f1 vm4 --hypervisor aliyun --net b3dee5e6-0dce-403c-80b2-ad62880b662f vm4 ecs.t5-lc2m1.nano ","excerpt":"climc server-create 命令提供创建云主机的操作。 云联壹云 可以同时管理多个私有云和公有云，不同供应商有各自的认证方式，在 …","ref":"/v3.6/zh/docs/howto/server/create/","title":"创建云主机"},{"body":"列表 # 查询所有镜像列表 $ climc image-list # 查询所有缓存的镜像列表 $ climc cached-image-list # 查询包含 ubuntu 关键字的镜像 $ climc image-list --search ubuntu # 查询公有云包含 centos 关键字的缓存 $ climc cached-image-list --search centos --public-cloud # image-list 支持的查询条件 $ climc help image-list # cached-image-list 支持的查询条件 $ climc help cached-image-list 详情 根据 image-list 可以获取镜像的列表，第1、2列包含镜像的 id 和 name，通过 id 或 name 可以获取镜像的详情。\n# 查询名称包含 CentOS 的镜像 $ climc image-list --search centos +--------------------------------------+-----------------------------------------+-------------+-----------+-----------+-----------+-------------+----------+---------+--------+----------------------------------+----------------------------------+--------+----------------+ | ID | Name | Disk_format | Size | Is_public | Protected | Is_Standard | Min_disk | Min_ram | Status | Checksum | Tenant_Id | Tenant | is_guest_image | +--------------------------------------+-----------------------------------------+-------------+-----------+-----------+-----------+-------------+----------+---------+--------+----------------------------------+----------------------------------+--------+----------------+ | abf0fd6e-ec40-44ef-8fa2-cfb7187ea656 | CentOS-7-x86_64-GenericCloud-1711.qcow2 | qcow2 | 876740608 | false | true | true | 8192 | 0 | active | 317ecf7d1128e0e53cb285b8704dc3d3 | d53ea650bfe144da8ee8f3fba417b904 | system | false | +--------------------------------------+-----------------------------------------+-------------+-----------+-----------+-----------+-------------+----------+---------+--------+----------------------------------+----------------------------------+--------+----------------+ *** Total: 1 Pages: 1 Limit: 20 Offset: 0 Page: 1 *** # 查看 CentOS-7-x86_64-GenericCloud-1711.qcow2 的详情 $ climc image-show CentOS-7-x86_64-GenericCloud-1711.qcow2 +--------------------+-------------------------------------------------------------------------------------------------------------------+ | Field | Value | +--------------------+-------------------------------------------------------------------------------------------------------------------+ | can_delete | false | | can_update | true | | checksum | 317ecf7d1128e0e53cb285b8704dc3d3 | | created_at | 2020-06-16T09:17:57.000000Z | | delete_fail_reason | {\"error\":{\"class\":\"ForbiddenError\",\"code\":403,\"data\":{\"id\":\"image is protected\"},\"details\":\"image is protected\"}} | | disk_format | qcow2 | | domain_id | default | | fast_hash | 4c53ba2c464213ddc2a77c9b4c5ad3b7 | | id | abf0fd6e-ec40-44ef-8fa2-cfb7187ea656 | | is_data | false | | is_emulated | false | | is_guest_image | false | | is_public | false | | is_standard | true | | is_system | false | | min_disk | 8192 | | min_ram | 0 | | name | CentOS-7-x86_64-GenericCloud-1711.qcow2 | | oss_checksum | 317ecf7d1128e0e53cb285b8704dc3d3 | | owner | d53ea650bfe144da8ee8f3fba417b904 | | pending_deleted | false | | project_domain | Default | | project_src | local | | properties | {\"os_arch\":\"x86_64\",\"os_type\":\"Linux\"} | | protected | true | | public_scope | system | | size | 876740608 | | status | active | | tenant | system | | tenant_id | d53ea650bfe144da8ee8f3fba417b904 | | update_version | 8 | | updated_at | 2020-06-16T09:19:24.000000Z | +--------------------+-------------------------------------------------------------------------------------------------------------------+ ","excerpt":"列表 # 查询所有镜像列表 $ climc image-list # 查询所有缓存的镜像列表 $ climc …","ref":"/v3.6/zh/docs/howto/image/query/","title":"查询镜像"},{"body":"你可能需要自己定制发行版的镜像，用于给不同的业务使用。本文介绍如何制作镜像。\n可以通过下载发行版操作系统的 iso , 然后本地启动虚拟机，将 iso 安装到虚拟机的磁盘，然后保存该磁盘，这个磁盘就可以作为镜像上传到 glance，但是这种方法人工参与的步骤太多，容易出错。\n推荐使用 packer 这个工具来自动化制作镜像，详细操作可以参考对应的文档 https://www.packer.io/docs/index.html 。\nhttps://github.com/yunionio/service-images 仓库包含了一些我们使用 packer 制作镜像的配置，可以参考使用。\n","excerpt":"你可能需要自己定制发行版的镜像，用于给不同的业务使用。本文介绍如何制作镜像。\n可以通过下载发行版操作系统的 iso , 然后本地启动虚拟机， …","ref":"/v3.6/zh/docs/howto/image/create/","title":"制作镜像"},{"body":"云主机(server)指云平台管理的虚拟机和裸金属服务器。\n  虚拟机: 又叫做云服务器，包括我们提供的 kvm 虚拟机、vmware、openstack 和各个公有云的虚拟机。\n  裸金属: 云平台提供物理机(baremetal)装机功能，安装完操作系统并被云平台管理的服务器称为裸金属服务器。\n  现在支持的主机和平台的对应关系如下：\n   类型 平台     kvm 云联壹云 私有云虚拟机   baremetal 云联壹云 私有云裸金属   esxi vmware 虚拟机   openstack openstack 私有云虚拟机   zstack zstack 私有云虚拟机   aliyun 阿里云虚拟机   qcloud 腾讯云虚拟机   aws AWS 虚拟机   azure Azure 虚拟机   huawei 华为云虚拟机   ucloud UCloud 虚拟机    ","excerpt":"云主机(server)指云平台管理的虚拟机和裸金属服务器。\n  虚拟机: 又叫做云服务器，包括我们提供的 kvm 虚拟 …","ref":"/v3.6/zh/docs/howto/server/","title":"云主机"},{"body":"主要结合应用场景介绍云平台各个资源的操作管理，首先会介绍命令行工具 climc 的用法，然后再具体介绍每种资源的操作。建议先熟悉命令行工具 climc 的使用过后在看后面的章节。\n熟悉命令行工具后，会分不同的部分介绍各种资源的操作和一些概念，云平台的资源大概分为 “虚拟资源” 和 “基础设施” 两类，有了基础设施类型的资源才能在其之上构建虚拟化的资源，具体分类如下:\n infra: 表示基础设施类型 virtual: 表示虚拟资源类型，属于具体的项目     名称 抽象资源 作用 类型     cloudregion 云平台地域 标记数据中心所在地域 infra   zone 云平台数据中心 标记数据中心 infra   vpc 逻辑隔离网络空间 抽象虚拟化网络的集合 infra   wire 对应二层扁平网络的广播域 抽象二层扁平网络广播域 infra   storage 存储 标记存储，提供云硬盘能力 infra   host 服务器 标记服务器，提供计算虚拟化 infra   server 云主机 运行在 host 上，使用虚拟化技术提供计算能力 virtual   disk 云硬盘 创建在 storage 上，使用虚拟化技术提供存储能力 virtual   network 网络 创建在 vpc 中，使用虚拟化技术提供网络 virtual   image 镜像 安装了操作系统的虚拟机磁盘，也属于 disk 一类 virtual   eip 外网浮动 ip 对应外网可用 ip virtual   loadbalancer 负载均衡器 标记负载均衡器，提供服务负载均衡 virtual    除了上面介绍的常见资源外，为了做多云管理，我们还引入了以下的概念:\n   名称 资源 作用 类型     cloudaccount 云平台的账户 对应各个云平台的认证信息 infra   project 项目 云联壹云 内部对虚拟机资源的划分 infra   schedtag 调度标签 可以标记多种资源，提供资源调度能力 infra   sku 套餐信息 对应创建虚拟资源的规格信息 infra    ","excerpt":"主要结合应用场景介绍云平台各个资源的操作管理，首先会介绍命令行工具 climc 的用法，然后再具体介绍每种资源的操作。 …","ref":"/v3.6/zh/docs/howto/","title":"操作管理"},{"body":"如果需要构建内部私有云，就需要部署计算节点(宿主机)。计算节点主要负责虚拟机、网络和存储的管理，需要安装的组件如下:\n   组件 用途 安装方式 运行方式     host 管理 kvm 虚拟机和存储 - docker   host-deployer 虚拟机部署服务 - docker   sdnagent 管理虚拟机网络和安全组 - docker   openvswitch 虚拟机网络端口和流表配置 rpm systemd   qemu 运行虚拟机 rpm process   kernel 云联壹云 提供的内核 rpm -    环境   操作系统: CentOS 7.x\n  硬件要求:\n Virtualization: CPU 要支持虚拟化，用于虚拟机 KVM 加速 打开 iommu，VT-d: 用于 GPU 透传(不用GPU可以不开)    网络:\n 当前可用的网段: 虚拟机可以直接使用和计算节点所在的扁平网段，需要预先划分保留对应端给云平台虚拟机使用，防止被其它设备占用，最后 IP 冲突    备注:\n 如果是以测试为目的，可以拿一台虚拟机部署计算节点的服务，但可能无法使用 KVM 加速和 GPU 透传    安装依赖 计算节点所需的依赖以 rpm 的方式安装\n# 添加 yum 源 $ cat \u003c\u003cEOF \u003e/etc/yum.repos.d/yunion.repo [yunion] name=Packages for Yunion Multi-Cloud Platform baseurl=https://iso.yunion.cn/yumrepo-3.6 sslverify=0 failovermethod=priority enabled=1 gpgcheck=0 EOF # 禁用防火墙和selinux $ systemctl disable firewalld $ sed -i 's/SELINUX=enforcing/SELINUX=disabled/g' /etc/selinux/config 安装 rpm 包\n$ yum --disablerepo='*' --enablerepo='yunion*' install -y \\  epel-release libaio jq libusb lvm2 nc ntp yunion-fetcherfs fuse fuse-devel fuse-libs \\  oniguruma pciutils spice spice-protocol sysstat tcpdump usbredir \\  yunion-qemu-2.12.1 yunion-executor \\  kernel-3.10.0-1062.4.3.el7.yn20191203 \\  kernel-devel-3.10.0-1062.4.3.el7.yn20191203 \\  kernel-headers-3.10.0-1062.4.3.el7.yn20191203 \\  kmod-openvswitch \\  openvswitch net-tools $ systemctl enable --now yunion-executor # 安装完成后需要重启进入我们的内核 $ reboot # 重启完成后，查看当前节点内核信息，确保为 yn 内核 $ uname -r 3.10.0-1062.4.3.el7.yn20191203.x86_64 安装 docker 和 kubelet 参考 “部署集群/环境准备” 的流程，安装好 docker 和 kubelet。\n安装配置 docker 安装 docker\n$ yum install -y yum-utils bash-completion # 添加 yunion 云联壹云 rpm 源 $ yum-config-manager --add-repo https://iso.yunion.cn/yumrepo-3.6/yunion.repo $ yum install -y docker-ce-19.03.9 docker-ce-cli-19.03.9 containerd.io 配置 docker\n$ mkdir -p /etc/docker $ cat \u003c\u003cEOF \u003e/etc/docker/daemon.json { \"bridge\": \"none\", \"iptables\": false, \"exec-opts\": [ \"native.cgroupdriver=systemd\" ], \"data-root\": \"/opt/docker\", \"live-restore\": true, \"log-driver\": \"json-file\", \"log-opts\": { \"max-size\": \"100m\" }, \"registry-mirrors\": [ \"https://lje6zxpk.mirror.aliyuncs.com\", \"https://lms7sxqp.mirror.aliyuncs.com\", \"https://registry.docker-cn.com\" ] } EOF 启动 docker\n$ systemctl enable --now docker 安装配置 kubelet 从 云联壹云 rpm 的 yum 源安装 kubernetes 1.15.8，并设置 kubelet 开机自启动\n$ yum install -y bridge-utils ipvsadm conntrack-tools \\  jq kubelet-1.15.8-0 kubectl-1.15.8-0 kubeadm-1.15.8-0 $ echo 'source \u003c(kubectl completion bash)' \u003e\u003e ~/.bashrc \u0026\u0026 source ~/.bashrc $ source /etc/profile $ systemctl enable kubelet 安装完 kubernetes 相关的二进制后，还需要对系统做一些配置并启用 ipvs 作为 kube-proxy 内部的 service 负载均衡\n# 禁用 swap $ swapoff -a # 如果设置了自动挂载 swap，需要去 /etc/fstab 里面注释掉挂载 swap 那一行 # 关闭 selinux $ setenforce 0 $ sed -i 's/SELINUX=enforcing/SELINUX=disabled/' /etc/selinux/config # 禁用 firewalld $ systemctl stop firewalld $ systemctl disable firewalld # 禁用 NetworkManager $ systemctl stop NetworkManager $ systemctl disable NetworkManager $ ps -ef|grep dhcp | awk '{print $2}' |xargs kill -9 # 做一些 sysctl 的配置, kubernetes 要求 $ modprobe br_netfilter $ cat \u003c\u003cEOF \u003e\u003e /etc/sysctl.conf net.bridge.bridge-nf-call-iptables=1 net.bridge.bridge-nf-call-ip6tables=1 net.ipv4.ip_forward=1 EOF $ sysctl -p # 配置并开启 ipvs $ cat \u003c\u003cEOF \u003e /etc/sysconfig/modules/ipvs.modules #!/bin/bash ipvs_modules=\"ip_vs ip_vs_lc ip_vs_wlc ip_vs_rr ip_vs_wrr ip_vs_lblc ip_vs_lblcr ip_vs_dh ip_vs_sh ip_vs_fo ip_vs_nq ip_vs_sed ip_vs_ftp nf_conntrack_ipv4\" for kernel_module in \\${ipvs_modules}; do /sbin/modinfo -F filename \\${kernel_module} \u003e /dev/null 2\u003e\u00261 if [ $? -eq 0 ]; then /sbin/modprobe \\${kernel_module} fi done EOF $ chmod 755 /etc/sysconfig/modules/ipvs.modules \u0026\u0026 bash /etc/sysconfig/modules/ipvs.modules \u0026\u0026 lsmod | grep ip_vs 控制节点操作 以下操作在控制节点进行。\n创建计算节点所在的网段 我的环境计算节点的 ip 为 10.168.222.140，就创建一个对应的 计算节点(host)网段。\n提示 需要根据自己的计算节点环境创建对应的网段，如果不创建该网段，计算节点就没法注册进来。  # 查看当前环境的 zone $ climc zone-list +--------------------------------------+-------+--------+----------------+ | ID | Name | Status | Cloudregion_ID | +--------------------------------------+-------+--------+----------------+ | f73a2120-1206-45fa-8d43-de374ab0f494 | zone0 | enable | default | +--------------------------------------+-------+--------+----------------+ # 在 zone0 里面创建一个 wire bcast0，该资源抽象计算节点所在的二层广播域信息 $ climc wire-create zone0 bcast0 1000 # 在 wire bcast0 之上创建一个计算节点的网络，计算节点的 host 服务注册会用到，如果 host 注册时没有在云平台找到对应的网络，将会注册失败 $ climc network-create --gateway 10.168.222.1 --server-type baremetal bcast0 adm0 10.168.222.140 10.168.222.140 24 计算节点(host)操作 以下操作在计算节点进行，计算节点也叫 host，私有云计算节点上面会运行 host 服务来管理 kvm 虚拟机。\n配置 host 服务 参考 “添加节点/获取加入集群token” 的流程获取join所需的信息\n# 使用 ocadm join 来创建一台计算节点 # 可选参数 --host-networks: 配置host服务的网络，比如: 'eth0/br0/10.168.222.140', eth0是物理网卡，br0是网桥名称，10.168.222.140是宿主机的ip # 获取计算节点 IP $ host_addr=$(ip route get 1 | awk '{print $NF;exit}') $ echo $host_addr 10.168.222.140 # 可选参数 --host-local-image-path: 配置host服务磁盘的存储路径，比如: '/opt/cloud/workspace/disks' # 注意：容器部署的host服务只会挂载/opt/cloud目录 # 如果有其他挂载点需要bind mount到/opt/cloud下，可在fstab中添加一行如'/src /opt/cloud/dst none defaults,bind 0 0' # 可选参数 --host-hostname: 配置宿主机的hostname, 比如: 'node1' $ ./ocadm join $api_server_addr \\  --enable-host-agent \\  --token $token \\  --discovery-token-unsafe-skip-ca-verification # 然后等待宿主机上的host pod和host-deployer pod为running状态 控制节点启用 host 回到控制节点，启用刚才上报的计算节点，只有启用的宿主机才能运行虚拟机。\n# 使用 climc 查看注册的 host 列表 $ climc host-list +--------------------------------------+-------------------------+-------------------+----------------+----------------------------+---------+---------+-------------+----------+-----------+------------+---------------+--------------+------------+-------------------------+--------------+ | ID | Name | Access_mac | Access_ip | Manager_URI | Status | enabled | host_status | mem_size | cpu_count | node_count | sn | storage_type | host_type | version | storage_size | +--------------------------------------+-------------------------+-------------------+----------------+----------------------------+---------+---------+-------------+----------+-----------+------------+---------------+--------------+------------+-------------------------+--------------+ | 3830870e-a499-459d-89df-bb6979b5e1ff | lzx-allinone-standalone | 00:22:39:4c:6c:e9 | 10.168.222.140 | http://10.168.222.140:8885 | running | false | online | 8192 | 4 | 1 | Not Specified | rotate | hypervisor | master(7ab047419092301) | 50141 | +--------------------------------------+-------------------------+-------------------+----------------+----------------------------+---------+---------+-------------+----------+-----------+------------+---------------+--------------+------------+-------------------------+--------------+ *** Total: 0 Pages: 0 Limit: 20 Offset: 0 Page: 1 *** # 启动 host $ climc host-enable lzx-allinone-standalone 创建虚拟机测试 上传 cirrors 测试镜像 # 下载 cirros 测试镜像 $ wget https://iso.yunion.cn/yumrepo-2.10/images/cirros-0.4.0-x86_64-disk.qcow2 # 将镜像上传到 glance $ climc image-upload --format qcow2 --os-type Linux --min-disk 10240 cirros-0.4.0-x86_64-disk.qcow2 ./cirros-0.4.0-x86_64-disk.qcow2 # 查看上传的镜像 $ climc image-list +--------------------------------------+--------------------------------+-------------+----------+-----------+----------+---------+--------+----------------------------------+ | ID | Name | Disk_format | Size | Is_public | Min_disk | Min_ram | Status | Checksum | +--------------------------------------+--------------------------------+-------------+----------+-----------+----------+---------+--------+----------------------------------+ | 63f6f2af-4db2-4e30-85f5-0ad3baa27bd9 | cirros-0.4.0-x86_64-disk.qcow2 | qcow2 | 22806528 | false | 30720 | 0 | active | 76dc07d1a730a92d0db7fb2d3c305ecd | +--------------------------------------+--------------------------------+-------------+----------+-----------+----------+---------+--------+----------------------------------+ # 如果使用虚拟机作为计算节点，存储可能不大，可以把镜像的默认大小30g调整到10g $ climc image-update --min-disk 10240 cirros-0.4.0-x86_64-disk.qcow2 创建测试网络 下面是随机创建了一个主机间不可达的网络用于测试，如果有划分好的扁平二层可用网络，可以直接拿来给虚拟机使用。\n$ climc network-create --gateway 10.20.30.1 --server-type guest bcast0 vnet0 10.20.30.2 10.20.30.254 24 $ climc network-public vnet0 创建虚拟机 # 创建虚拟机 testvm01，512M内存, 1个CPU, 系统盘 10g, 第二块磁盘 5g 格式化为 ext4 并挂载到 /opt 的虚拟机 $ climc server-create --auto-start --allow-delete \\ \t--disk cirros-0.4.0-x86_64-disk.qcow2:10g --disk 5g:ext4:/opt \\ \t--net vnet0 --ncpu 1 --mem-spec 512M testvm01 # 查看创建的虚拟机，1分钟后应该会变为 running 状态 $ climc server-list --details +--------------------------------------+----------+--------------+--------------+-------+---------+------------+-----------+----------+-----------------------------+------------+---------+-------------------------+--------+-----------+ | ID | Name | Billing_type | IPs | Disk | Status | vcpu_count | vmem_size | Secgroup | Created_at | Hypervisor | os_type | Host | Tenant | is_system | +--------------------------------------+----------+--------------+--------------+-------+---------+------------+-----------+----------+-----------------------------+------------+---------+-------------------------+--------+-----------+ | bcda7d18-decc-4b5f-8654-2d201a84d1fb | testvm01 | postpaid | 10.20.30.254 | 35840 | running | 1 | 512 | Default | 2019-09-23T05:08:49.000000Z | kvm | Linux | lzx-allinone-standalone | system | false | +--------------------------------------+----------+--------------+--------------+-------+---------+------------+-----------+----------+-----------------------------+------------+---------+-------------------------+--------+-----------+ *** Total: 0 Pages: 0 Limit: 20 Offset: 0 Page: 1 *** # 获取虚拟机登录信息 $ climc server-logininfo testvm01 +-----------+------------------------------------------+ | Field | Value | +-----------+------------------------------------------+ | login_key | 49wqh5OWGW3jSr1A8RfrMoH69iRRECzaMZITBA== | | password | zS27FwwUFr96 | | updated | 2019-09-23T05:11:29.306403Z | | username | root | +-----------+------------------------------------------+ # 在计算节点联通测试网络(如果你是直接用的二层网络，应该能直接 ping 通虚拟机的 ip 了，不需要做这一步) $ ip address add 10.20.30.1/24 dev br0 # 用之前 server-logininfo 命令获取的用户名密码，直接登录到虚拟机里面 $ ssh root@10.20.30.254 PING 10.20.30.254 (10.20.30.254) 56(84) bytes of data. 64 bytes from 10.20.30.254: icmp_seq=1 ttl=64 time=1.31 ms # 如果网络不通，也可以通过 vnc 的方式打开虚拟机的 tty 登录界面，操作如下 # 打开 vnc 链接，用浏览器打开下面的链接 # 打开 vnc 链接时会出现不安全认证，导致 websocket 无法握手，需要在浏览器信任 webconsole server 对应的 endpoint $ climc endpoint-list --details | grep webconsole | grep public | 3da1e476aa7b4ff68e206754aed72d8f | region0 | 16120e8f3eec46dc86c59b3e426b0502 | webconsole | webconsole | https://10.168.222.218:8899 | public | true | # 然后用浏览器访问下 https://10.168.222.218:8899 , 信任该链接即可 # 在通过 webconsole-server 命令获取 vnc web 界面的链接地址，然后用浏览器打开该地址 $ climc webconsole-server testvm01 https://console.yunion.cn/web-console?access_token=FI-VXQSAonhzfSnxVTKCCbwHinp7swlRkmi-4p6s-4OfZpg6TG9YhWuwbHEUA1D7XoKu_w%3D%3D\u0026api_server=https%3A%2F%2F10.168.222.216%3A8899\u0026password=65xB2kaE\u0026protocol=vnc ","excerpt":"如果需要构建内部私有云，就需要部署计算节点(宿主机)。计算节点主要负责虚拟机、网络和存储的管理，需要安装的组件如下:\n   组件 用途 安装 …","ref":"/v3.6/zh/docs/setup/host/","title":"添加计算节点"},{"body":"启用 baremetal-agent 之前需要部署 云联壹云 集群，详见 “安装部署/部署集群” 。\n待集群准备完毕后需要指定集群中的一个 node 来部署 baremetal-agent 服务。\n注意 目前只能指定一个 node 来部署运行 baremetal-agent 服务，因为 baremetal-agent 服务是有状态的，不能多副本夸节点运行。  启用 baremetal-agent 在通过 pxe 引导流程中，baremetal-agent 只会处理来自 dhcp relay 服务器的请求, 所以你需要事先在交换机配置 dhcp relay 或者使用 云联壹云 host 服务的 dhcp relay 功能。\n如何配置 host 服务 启用 dhcp relay 注意 如果在交换机上配置了 dhcp relay，则不需要在这里配置计算节点的 dhcp_relay 了，可以跳过这一步。  # 登录到已经部署好计算节点的服务器上修改 /etc/yunion/host.conf，添加 dhcp_relay 配置项： dhcp_relay: - 10.168.222.198 # baremetal agent dhcp服务监听地址 - 67 # baremetal agent dhcp服务监听端口 # 然后重启host服务 $ kubectl get pods -n onecloud -o wide | grep host default-host-p6d8h 2/2 Running 0 78m 10.168.222.189 k8s-dev1 \u003cnone\u003e \u003cnone\u003e default-host-xdc7x 2/2 Running 0 78m 10.168.222.150 k8s-dev2 \u003cnone\u003e \u003cnone\u003e # 找到对应的 pod 删除等待 host 服务自动重启 $ kubectl delete pods -n onecloud default-host-xdc7x 启用 baremetal-agent 然后选择 node 启用 baremetal-agent。\n# $listen_interface 指的是 baremetal-agent 监听的网卡名称 $ ocadm baremetal enable --node $node_name --listen-interface $listen_interface # 观察 baremetal agent pod 状态查看是否启动成功 $ watch \"kubectl get pods -n onecloud | grep baremetal\" default-baremetal-agent-7c84996c9b-hhllw 1/1 Running 0 3m10s # 启动成功确认 baremetal-agent 注册到控制节点 $ climc agent-list +--------------------------------------+--------------------------+----------------+-----------------------------+---------+------------+------------------------------------------+--------------------------------------+ | ID | Name | Access_ip | Manager_URI | Status | agent_type | version | zone_id | +--------------------------------------+--------------------------+----------------+-----------------------------+---------+------------+------------------------------------------+--------------------------------------+ | f3c2c671-c41d-4f30-8d04-e022b49bb9b5 | baremetal-10.168.222.150 | 10.168.222.150 | https://10.168.222.150:8879 | enabled | baremetal | remotes/origin/master(5e415506120011509) | 6230b485-2e54-480e-8284-33360b8202a8 | +--------------------------------------+--------------------------+----------------+-----------------------------+---------+------------+------------------------------------------+--------------------------------------+ 部署完成后可以参考 “操作管理/物理机” 来进行对物理机的注册管理。\n禁用 baremetal-agent 可以在启用 baremetal-agent 的节点中选择节点禁止 baremetal-agent 调度到该节点。\nocadm baremetal disable --node $node_name ","excerpt":"启用 baremetal-agent 之前需要部署 云联壹云 集群，详见 “安装部署/部署集群” 。 …","ref":"/v3.6/zh/docs/setup/baremetal/","title":"物理机管理服务"},{"body":"默认情况下部署好的版本是 开源版本(CE: Community Edition)，可以使用 ocadm cluster update 命令切换成 企业版本(EE: Enterprise Edition)。\n切换操作 # 切换到企业版 $ ocadm cluster update --use-ee --wait # 切换到开源版的 web 前端 $ ocadm cluster update --use-ce --wait ocadm cluster update --use-ee/--use-ce 命令会更新替换当前的 default-web deployment\n待所有pod启动后，由于开源版和企业版的前端分别依赖不同的 default-web configmap，直接切换过去会导致 default-web configmap 没有更新，web前端无法访问，因为需要删除web服务的nginx configmap，并重启 web 服务。\n# 删除 default-web 的 configmap 文件 $ kubectl delete configmap -n onecloud default-web # 重启 default-web 服务 $ kubectl rollout restart deployment -n onecloud default-web ","excerpt":"默认情况下部署好的版本是 开源版本(CE: Community Edition)，可以使用 ocadm cluster update 命令切 …","ref":"/v3.6/zh/docs/setup/ce-ee-switch/","title":"切换到企业版"},{"body":"","excerpt":"","ref":"/v3.6/en/docs/contact/","title":"Contact us"},{"body":"","excerpt":"","ref":"/v3.6/zh/docs/contact/","title":"联系我们"},{"body":"宿主机(host): 指运行虚拟机的机器，云平台的抽象的宿主机根据 hypervisor 字段判断不同平台的宿主机。现在支持的类型如下：\n   类型 平台     hypervisor 云联壹云 私有云宿主机   baremetal 云联壹云 私有云物理机   esxi vmware 宿主机   openstack openstack 私有云宿主机   zstack zstack 私有云宿主机    ","excerpt":"宿主机(host): 指运行虚拟机的机器，云平台的抽象的宿主机根据 hypervisor 字段判断不同平台的宿主机。现在支持的类型如下： …","ref":"/v3.6/zh/docs/howto/host/","title":"宿主机"},{"body":"创建好主机后，登录的方式大概分为以下几种：\n ssh: linux 通用，要求主机网络可达; rdp: windows 远程桌面，要求主机网络可达； vnc: vnc 链接，对主机网络没有要求，只要能链接云平台 vnc proxy 即可; ipmi sol: 只对装有 BMC 的物理机可用;  针对以上的链接方式，我们提供以下接口链接云主机：\nvnc 链接 climc webconsole-server 命令提供通过 vnc 的方式链接虚拟机，该方式对裸金属服务器不可用。\n$ climc webconsole-server \u003cserver_id\u003e ssh 链接 查询 server 的 ip\n# 可通过 server-list --search --details 的方式找到主机的 ip $ climc server-list --search \u003cserver_name\u003e --details # 或者通过 server-show \u003cserver_id\u003e 的方式得到 ip $ climc server-show \u003cserver_name\u003e | grep ip | ips | 10.168.222.226 | 查询 server 的登录信息\n$ climc server-logininfo \u003cserver_name\u003e +----------+-----------------------------+ | Field | Value | +----------+-----------------------------+ | password | @2aWXB6AmCbV | | updated | 2019-07-03T10:00:20.801716Z | | username | root | +----------+-----------------------------+ ssh 登录\n$ ssh root@10.168.222.226 通过 webconsole 登录\n$ climc webconsole-ssh 10.168.222.226 https://console.yunion.cn/web-console?access_token=y7bjpBwtvJHLHpwOUMzNVvsYiAgY1vskIuVwB-aINfH4mm8MsZqwxKSfHqm2pCvY6O8bBA%3D%3D\u0026api_server=https%3A%2F%2Foffice.yunion.io\u0026protocol=tty 在浏览器打开 webconsole 放回的 url ，就会到对应虚拟机的登录界面\n","excerpt":"创建好主机后，登录的方式大概分为以下几种：\n ssh: linux 通用，要求主机网络可达; rdp: windows 远程桌面，要求主机网 …","ref":"/v3.6/zh/docs/howto/server/connect/","title":"登录云主机"},{"body":"开关机 # 开机 $ climc server-start \u003cserver_id\u003e # 关机 $ climc server-stop \u003cserver_id\u003e # 强制关机 $ climc server-stop --is-force \u003cserver_id\u003e # 重启 $ climc server-restart \u003cserver_id\u003e 删除 # 删除至回收站 $ climc server-delete \u003cserver_id\u003e # 彻底删除 $ climc server-delete -f \u003cserver_id\u003e 重装密码 $ climc server-deploy --reset-password --password \u003cyour_password\u003e \u003cserver_id\u003e TODO\n","excerpt":"开关机 # 开机 $ climc server-start \u003cserver_id\u003e # 关机 $ climc server-stop …","ref":"/v3.6/zh/docs/howto/server/others/","title":"其他操作"},{"body":"术语解释   Baremetal: 指尚未安装操作系统的服务器， 也叫作物理机\n  PXE (Preboot eXecution Environment): 使用网络接口启动计算机的机制。这种机制不依赖本地数据存储设备（如硬盘）或本地已安装的操作系统，使用 DHCP 协议查找引导服务器并获取 IP，再通过 TFTP 协议下载初始引导程序和附加文件启动\n  DHCP (Dynamic Host Configuration Protocol): 动态主机设置协议是一个局域网的网络协议，使用UDP协议工作，为机器分配 IP\n  TFTP (Trivial File Transfer Protocol): 小型文件传输协议，使用UDP协议传输文件\n  DHCP Relay: 在不同子网和物理网段之间处理和转发dhcp信息的功能\n  IPMI (Intelligent Platform Management Interface)：管理服务器硬件的标准，特性是独立于操作系统外自行运行，即使在缺少操作系统或系统管理软件、或受监控的系统关机但有接电源的情况下仍能远程管理系统，也能在操作系统引导后运行\n  BMC (Baseboard management controller): 基板管理控制器，支持行业标准的 IPMI 规范\n  SSH (Secure Shell): 用于远程登录控制服务器\n  RAID (Redundant Array of Independent Disks): 磁盘阵列，把多个硬盘组合成为一个逻辑扇区，操作系统只会把它当作一个硬盘\n  Region Service: 云平台控制服务，提供 baremetal 相关 API\n  Baremetal Agent: 云平台管理 baremetal 的服务\n  Glance Service: 云平台镜像服务，提供物理机装机的 Image 镜像\n  裸金属服务器: baremetal 物理机安装操作系统后，在云平台创建的 server 的记录\n  宿主机: 可以运行云平台虚拟机的节点\n  ","excerpt":"术语解释   Baremetal: 指尚未安装操作系统的服务器， 也叫作物理机\n  PXE (Preboot eXecution …","ref":"/v3.6/zh/docs/howto/baremetal/","title":"物理机"},{"body":"支持将libvirt管理的虚拟机导入到云联壹云平台。\n注意事项   首先需要在libvirt管理的宿主机上安装我们的计算节点\n  安装好计算节点后需要添加的虚拟机的网络到控制节点\n  确保libvirt服务关闭\n  相关操作  准备好需要导入虚拟机的信息文件servers.yaml， 格式如下:  hosts: - host_ip: 10.168.222.137 xml_file_path: /etc/libvirt/qemu monitor_path: /var/lib/libvirt/qemu servers: - mac: 52:54:00:4A:19:AF ip: 10.168.222.53 - mac: 52:54:00:4A:19:CC ip: 10.168.222.54 - host_ip: 10.168.222.130 xml_file_path: /etc/libvirt/qemu monitor_path: /var/lib/libvirt/qemu servers: - mac: 53:54:00:4A:19:EC ip: 11.168.222.50 - mac: 53:54:00:4A:19:EE ip: 11.168.222.51 - `host_ip` 是要导入的宿主机的ip - `xml_file_path`是libvirt存储虚拟机xml文件的路径， - `monitor_path`是libvirt存储虚拟机monitor socket文件的路径， - `servers`是需要导入的虚拟机，里面描述了虚拟机的ip和mac对应关系    执行 climc servers-import-from-libvirt 开始导入  # 导入前确认libvirt服务关闭 $ climc servers-import-from-libvirt servers.yaml ","excerpt":"支持将libvirt管理的虚拟机导入到云联壹云平台。\n注意事项   首先需要在libvirt管理的宿主机上安装我们的计算节点\n  安装好计算 …","ref":"/v3.6/zh/docs/howto/server/import/","title":"libvirt管理虚机导入"},{"body":"目前仅支持 云联壹云 kvm 虚拟机使用 GPU，使用的 PCI Passthrough 的方式将宿主机上的 Nvidia/AMD GPU 透传给虚拟机使用。\n相关操作 创建 GPU 云主机  查询 gpu 列表  $ climc isolated-device-list --gpu +--------------------------------------+----------+---------------------+---------+------------------+--------------------------------------+ | ID | Dev_type | Model | Addr | Vendor_device_id | Host_id | +--------------------------------------+----------+---------------------+---------+------------------+--------------------------------------+ | 273f4f72-06b6-49aa-8456-4beceec44997 | GPU-HPC | GeForce GTX 1050 Ti | 41:00.0 | 10de:1c82 | 3bce9607-2597-469f-8d9b-977345456739 | | a77333e9-08d9-45c6-87eb-a7d8d902c5f5 | GPU-HPC | Quadro FX 580 | 05:00.0 | 10de:0659 | 3bce9607-2597-469f-8d9b-977345456739 | +--------------------------------------+----------+---------------------+---------+------------------+--------------------------------------+  创建 server  server-create 中的 --isolated-device 参数指定透传的设备到云主机，可以重复使用多次，透传多个 gpu 到云主机，但要求透传到同一云主机的 gpu 必须在同一宿主机。其余创建参数和创建普通云主机是一样的。\n$ climc server-create --hypervisor kvm --isolated-device 273f4f72-06b6-49aa-8456-4beceec44997 ... 查询 GPU 云主机 $ climc server-list --gpu 关联 GPU 如果云主机所在的宿主机有可用的 gpu，在主机关机的情况下，可以通过 server-attach-isolated-device 命令将 gpu 和云主机关联起来，下次主机启动后就可以使用该 gpu 。\n$ climc server-attach-isolated-device \u003cserver_id\u003e \u003cdevice_id\u003e 卸载 GPU 如果云主机关联了 gpu，可以通过 server-detach-isolated-device 卸载主机的某一 gpu。\n$ climc server-detach-isolated-device \u003cserver_id\u003e \u003cdevice_id\u003e ","excerpt":"目前仅支持 云联壹云 kvm 虚拟机使用 GPU，使用的 PCI Passthrough 的方式将宿主机上的 Nvidia/AMD GPU  …","ref":"/v3.6/zh/docs/howto/server/gpu/","title":"GPU相关"},{"body":"TODO\n","excerpt":"TODO\n","ref":"/v3.6/zh/docs/howto/network/","title":"网络"},{"body":"TODO\n","excerpt":"TODO\n","ref":"/v3.6/zh/docs/howto/lb/","title":"负载均衡"},{"body":"TODO\n","excerpt":"TODO\n","ref":"/v3.6/zh/docs/howto/storage/","title":"存储"},{"body":"TODO\n","excerpt":"TODO\n","ref":"/v3.6/zh/docs/howto/multicloud/","title":"多云管理"},{"body":"TODO\n","excerpt":"TODO\n","ref":"/v3.6/zh/docs/howto/auth/","title":"认证与权限"},{"body":"TODO\n","excerpt":"TODO\n","ref":"/v3.6/zh/docs/howto/server/migrate/","title":"迁移相关"},{"body":"容器集群是基于云平台虚拟机搭建部署 kubernetes 集群，目前支持在以下平台部署：\n 云联壹云私有云 阿里云 AWS  ","excerpt":"容器集群是基于云平台虚拟机搭建部署 kubernetes 集群，目前支持在以下平台部署：\n 云联壹云私有云 阿里云 AWS  ","ref":"/v3.6/zh/docs/howto/container/","title":"容器集群"},{"body":"TODO\n","excerpt":"TODO\n","ref":"/v3.6/zh/docs/howto/server/backup/","title":"主备机"},{"body":"TODO\n","excerpt":"TODO\n","ref":"/v3.6/zh/docs/howto/scheduler/","title":"资源调度"},{"body":"导入镜像 云平台的 glance 镜像服务支持从外部 url 导入镜像，对应 climc 的子命令为 image-import　。\n# 导入 https://iso.yunion.cn/yumrepo-3.2/images/cirros-0.4.0-x86_64-disk.qcow2 镜像 $ climc image-import --format qcow2 --os-type Linux cirros-test.qcow2 https://iso.yunion.cn/yumrepo-3.2/images/cirros-0.4.0-x86_64-disk.qcow2 使用 image-list 或 image-show 查询导入镜像的状态，变为 active 时表明可以使用。\n下载镜像 如果需要将云平台的镜像导出到本地，就需要用 climc image-download 把 glance 存的镜像下载下来。\n参考 查询镜像 查询你想要下载的镜像，获取镜像 id 或 name。\n下载镜像:\n# OUTPUT 指定镜像的保存路径和文件名称，如/root/test.qcow2 $ climc image-download [--output OUTPUT] \u003cimage_id\u003e 删除镜像 镜像默认启用了删除保护，当镜像确定不用了，需要先通过climc image-update禁用删除保护，再通过 climc image-delete 删除镜像。\n# 禁用镜像删除保护 $ climc image-update --unprotected \u003cimage_id\u003e # 删除镜像 $ climc image-delete \u003cimage_id\u003e ","excerpt":"导入镜像 云平台的 glance 镜像服务支持从外部 url 导入镜像，对应 climc 的子命令为 image-import　。\n# …","ref":"/v3.6/zh/docs/howto/image/operation/","title":"其他操作"},{"body":"","excerpt":"","ref":"/v3.6/en/docs/changelog/","title":"CHANGELOG"},{"body":"","excerpt":"","ref":"/v3.6/zh/docs/changelog/","title":"CHANGELOG"},{"body":"本文介绍从 v3.4.x 升级到 v3.6.x 的步骤以及注意事项。\n版本升级建议从相邻的版本升级，比如从 v3.2.x 升级到 v3.6.x 需要以下的步骤：\n v3.2.x =\u003e v3.3.x v3.3.x =\u003e v3.4.x v3.4.x =\u003e v3.6.x  直接跨多个版本升级可能会出现问题，建议参考以下的内容选择升级步骤:\n v3.1.x 升级到 v3.2.x v3.2.x 升级到 v3.3.x v3.3.x 升级到 v3.4.x  总体来说，升级的步骤如下:\n使用我们编写的 ocboot 工具进行升级，这个工具主要是调用 ansible 来升级集群里面的所有节点。\n 使用 git 拉取最新的 ocboot 代码，切换到 release/3.6 分支 使用 ocboot 进行大版本升级  查看当前版本 可以使用 kubectl 查看当前集群的版本\n# 使用 kubectl 获得当前集群的版本为 v3.4.5 $ kubectl -n onecloud get onecloudclusters default -o=jsonpath='{.spec.version}' v3.4.5 拉取 ocboot 工具 如果本地已经有 ocboot 工具可以跳过此步，只用把代码更新到对应的分支。\n# 本地安装 ansible $ yum install -y ansible python-paramiko # 下载 ocboot 工具到本地 $ git clone -b release/3.6 https://github.com/yunionio/ocboot \u0026\u0026 cd ./ocboot 更新 ocboot 代码 $ git checkout release/3.6 $ git pull 更新 云联壹云 服务 更新服务的原理是通过本机 ssh 免密码远程登录到集群的第一个控制节点，获取所有节点的信息后，然后通过 ansible 执行 playbook 更新，所以有以下要求：\n 本机能够 ssh 远程登录 PRIMARY_MASTER_HOST PRIMARY_MASTER_HOST 能够 ssh 免密码登录集群中的其它节点  如果没有设置免密码登录，请使用 ssh-copy-id -i ~/.ssh/id_rsa.pub root@PRIMARY_MASTER_HOST 命令把公钥下发到自己环境对应的节点。\n升级的版本号可以到 CHANGELOG release/3.6 页面 查询。\n# 使用 ocboot 相关服务到 v3.6.9 版本 # 该步骤会因为拉取 docker 镜像等待较长时间，请耐心等待 # PRIMARY_MASTER_HOST 是指部署集群的第一个节点的 ip 地址 # 需要本机能够使用 ssh 密钥登录上去 $ ./ocboot.py upgrade \u003cPRIMARY_MASTER_HOST\u003e v3.6.9 # 另外可以使用 `./ocboot.py upgrade --help` 查看其它可选参数 # 比如: # --user 可以指定其它 ssh 用户 # --port 指定 ssh 端口 # --key-file 指定另外的 ssh private key # --as-bastion 可以让 PRIMARY_MASTER_HOST 作为堡垒机部署在内网的宿主机 # 另外可以在升级的过程中可以登录到 PRIMARY_MASTER_HOST， 使用 kubectl 查看对应 pods 的升级情况 $ kubectl get pods -n onecloud --watch ","excerpt":"本文介绍从 v3.4.x 升级到 v3.6.x 的步骤以及注意事项。\n版本升级建议从相邻的版本升级，比如从 v3.2.x …","ref":"/v3.6/zh/docs/setup/upgrade/","title":"升级相关"},{"body":"简介 从 v3.6.10 版本开始，可以将”云联壹云“部署到 ARM(AArch64) 架构的机器上，目前我们适配的 Linux 发行版是 Debian 10(buster) 和 统信 UOS 。\n因为服务是容器化运行在 Kubernetes 之上的，为了在 ARM 架构的机器上运行容器，我们使用了 docker buildx 和交叉编译的技术编译打包了同时支持 x86_64 和 arm64 的统一容器镜像。这样的可以让 Kubernetes 屏蔽 CPU 架构的差异性，我们制作的支持多架构的容器镜像可以在不同架构的机器上运行服务，实现 X86 和 ARM 机器混合部署的效果。\n部署 部署方式和原来的 X86 部署并没有太大差别，唯一的区别是我们 X86 上使用的 Linux 发行版是 CentOS 7 ，但在 ARM 架构的机器上需要安装 Debian 10(buster) 或者 统信 UOS 发行版。其它部署方式是一致的，使用我们编写的 https://github.com/yunionio/ocboot 部署工具来统一部署，这个工具里面包含了在 Debian 和 UOS 上部署的 ansible playbook 。\n前提条件  ARM 机器必须提前安装好 Debian 10 或者 UOS 操作系统 ARM 机器能够访问公网 ARM 机器开启 ssh 服务，保证运行 ocboot 的节点能够免密登录待部署的 ARM 机器  单节点 All in One 部署 单节点 All in One 部署是指把整个”云联壹云“全部部署到一个节点，ARM 的部署和 X86 的部署没有任何区别，准备好环境后，直接参考 All in One 安装 的部署流程即可。\n多节点混合部署 多节点部署请先参考 多节点安装 了解多节点安装准备工作和配置。接下来以一台 X86 和一台 ARM 机器演示混合部署的流程。\n   架构 操作系统 IP 登录用户 角色     X86_64 CentOS 7 10.127.40.252 root mariadb_node \u0026 primary_master_node   ARM64 Debian 10 10.127.100.8 root worker_nodes    编写如下部署配置:\n# 编写配置 $ vim ./config-hybrid.yml # mariadb_node 表示要在 10.127.40.252 这台节点上部署 mariadb 数据库 mariadb_node: hostname: 10.127.40.252 user: root db_user: root db_password: your-sql-password # primary_master_node 表示将 10.127.40.252 作为第一个部署的 master 节点 # 上面会运行云联壹云必要的控制服务 primary_master_node: onecloud_version: v3.6.15 hostname: 10.127.40.252 user: root db_host: 10.127.40.252 db_user: root db_password: your-sql-password controlplane_host: 10.127.40.252 controlplane_port: \"6443\" # onecloud 登录用户 onecloud_user: admin # onecloud 登录用户密码 onecloud_user_password: admin@123 # as_host 表示将这个 master 节点作为私有云计算节点 as_host: true # worker_nodes 表示在 10.127.100.8 上部署内置私有云计算服务 # 同时会将 worker_nodes 角色的节点作为私有云计算节点 worker_nodes: hosts: # 如果有多台节点，可以在这里按照 YAML 数组的格式填写多个节点的 IP - hostname: 10.127.100.8 user: root controlplane_host: 10.127.40.252 controlplane_port: \"6443\" 使用 ocboot 安装 config-hybrid.yml 配置部署:\n$ ./run.py ./config-hybrid.yml .... # 部署完成后会有如下输出，表示运行成功 # 浏览器打开 https://10.127.40.252 # 使用 admin/admin@123 用户密码登录就能访问前端界面 Initialized successfully! Web page: https://10.127.40.252 User: admin Password: admin@123 部署完成后，登入前端就能发现混合部署的两台 X86 和 ARM 的宿主机，截图如下，aarch64 和 x86_64 分别对应 ARM64 和 X86_64 的 CPU 架构宿主机。\n创建 ARM 虚拟机 基于 ARM 的机器部署完服务后，请先阅读 All in One/FAQ 和 All in One/创建第一台虚拟机 了解创建虚拟机需要创建网络、启用宿主机和导入镜像等步骤。\n导入镜像 对于 ARM(AArch64) 虚拟机来说需要使用对应的 ARM(AArch64) 虚拟机镜像，这里分别导入 ARM64 和 X86_64 的 CentOS 7 虚拟机镜像进行测试。\n ARM64 镜像 CentOS-7-aarch64-GenericCloud-2003.qcow2: https://cloud.centos.org/centos/7/images/CentOS-7-aarch64-GenericCloud-2003.qcow2 X86_64 镜像 CentOS-7-x86_64-GenericCloud-1503.qcow2: https://cloud.centos.org/centos/7/images/CentOS-7-x86_64-GenericCloud-1503.qcow2  导入镜像后的截图如下:\n创建虚拟机 镜像和对应的网路准备完成后，就可以到虚拟机创建界面根据需要选择不同 CPU 架构创建虚拟机。创建界面截图如下：\n分别创建 aarch64 和 x86_64 架构的虚拟机后，可以在虚拟机的列表页面看到每台虚拟机的 CPU 架构，截图如下:\n","excerpt":"简介 从 v3.6.10 版本开始，可以将”云联壹云“部署到 ARM(AArch64) 架构的机器上，目前我们适配的 Linux …","ref":"/v3.6/zh/docs/setup/host-aarch64/","title":"ARM(AArch64) 部署"},{"body":"Architecture Optimize the general architecture of cloudpods\n Seperate on-premise cloud (Cloudpods native cloud, i.e. KVM, Baremetal, VMware) and Cloud Management (Management of other clouds) into different service components On-premise cloud: seperate a storage agent to do storage management tasks On-premise cloud: integrate Rook for shared storage On-premise cloud: store state of baremetal agent in DB Cloud management: allow managing multiple instance of cloudpods native cloud Cloud management: recode resource synchronization, better code structure and finer grain synchronization resource  Mutli-cloud Resource Management Further broaden the coverage of cloud products and providers.\n Support more kinds of resources, such as Azure RDS，Redis，LoadBalance，WebApp, AWS redis Support more cloud providers, such as QingCloud Support read-only mode of cloud account  Unified Monitoring and Alerting A unified Multi-cloud monitoring and alerting solution.\n Adopts Prometheus as the core monitoring solution. Automate monitoring agent installation Secure communication channel for collecting monitoring metrics across multi-cloud boundaries Integrating native alerting on cloud providers  Multi-cloud Application Delivery and Orchastration Based on container technology, develop the capability to deliver applications across multi-cloud.\n Unified management of multiple Kubernetes clusters Deployment of Kubernetes Clusters over multi-cloud environment Multi-cloud application delivery Multi-cloud application migration  ","excerpt":"Architecture Optimize the general architecture of cloudpods\n Seperate …","ref":"/v3.6/en/docs/roadmap/","title":"ROADMAP"},{"body":"多云资源对接 完善多云对接的广度和深度，接入更多的云平台和云产品\n 支持 Azure RDS，Redis，LoadBalance，WebApp 等 支持 AWS Redis 等 对接 NAS，MongoDB，MQ 等通用云产品 对接有较强客户需求的其他云平台，例如中国移动公有云，青云等  统一监控报警 完善多云监控数据采集的能力，实现多云统一监控报警\n 全面采用 Prometheus 方案，从现有基于 Influxdb 的监控存储方案逐步迁移到 Prometheus 的监控方案，将监控后端采用多实例基于对象存储的分布式 Prometheus 集群方案 基于 Agent 的监控数据的采集，实现自动化安装 Agent ，通过 Agent 采集监控指标，获得更准确，更丰富和更精细化的监控指标，不仅涵盖基础设施（计算网络存储）的监控指标，含可以包含应用的监控指标（nginx，mysql等） 实现跨云监控数据采集，通过代理网关打通监控服务和资源的网络隧道，实现跨云采集内网监控 对接云平台自身的报警API，实现云平台自身报警和 Prometheus 报警的统一  多云应用和编排 以容器为基础，应用为核心，发展多云应用部署和编排能力\n 多 Kubernetes 集群的统一管理：完善多集群容器集群的数据采集和呈现，实现应用在多容器集群的部署和升级 多云容器集群部署：进一步完善在多云环境的容器部署能力，提高可靠性和速度，提高容器集群的性能和稳定性 多云应用部署：基于多容器容器集群实现多云应用部署 多云应用迁移：实现应用在多云环境的迁移  ","excerpt":"多云资源对接 完善多云对接的广度和深度，接入更多的云平台和云产品\n 支持 Azure …","ref":"/v3.6/zh/docs/roadmap/","title":"ROADMAP"},{"body":"默认部署完成后，访问前端界面，浏览器会提示不安全的 SSL 连接，原因是前端默认使用的是自签发的证书。本文介绍如何使用自定义证书替换掉前端默认的证书。\n操作步骤 假设已经准备好的证书文件为：cert.pem 和 cert.key，域名为 foo.bar.com 。\n1. 将证书导入 kubernetes 集群 kubernetes 使用 secret 这种资源保存证书内容，然后前端服务使用 ingress 引用对应的证书，提供 HTTPS 连接。为了使用自定证书，需要先把证书保存到集群。\n# 创建证书 $ kubectl create secret tls yunion-io-web-secret --key cert.key --cert cert.pem -n onecloud 2. 编辑 ingress 规则 编辑 default-web ingress 规则，引用刚才创建的 yunion-io-web-secret 证书。\n$ kubectl edit ingress -n onecloud default-web ... tls: # 修改这个 secretName 为 yunion-io-web-secret - secretName: yunion-io-web-secret ... 3. 重启 ingress controller 设置完 default-web ingress 规则后，可以重启下 ingress controller 服务，让证书生效。\n$ kubectl rollout restart daemonset -n kube-system traefik-ingress-controller 4. 修改服务 api_server 入口配置 因为使用域名 foo.bar.com 访问，需要修改云平台的默认 api_server 配置，这个配置会影响前端 VNC 连接的地址。将旧的 https:// 访问地址改为 http://foo.bar.com，操作如下：\n$ climc service-config-edit common default: api_server: https://foo.bar.com ... 配置完成后就可以通过 https://foo.bar.com 访问前端了。\n","excerpt":"默认部署完成后，访问前端界面，浏览器会提示不安全的 SSL 连接，原因是前端默认使用的是自签发的证书。本文介绍如何使用自定义证书替换掉前端默 …","ref":"/v3.6/zh/docs/setup/config-ssl-certs/","title":"更换前端证书"},{"body":"作者: 李泽玺\nKubernetes 里面的 Pod 资源是最小的计算单元，抽象了一组（一个或多个）容器。容器也是 Linux 系统上的进程，但基于 Namespace 和 Cgroups(Control groups) 等技术实现了不同程度的隔离。 简单来说 Namespace 可以让每个进程有独立的 PID, IPC 和网络空间。Cgroups 可以控制进程的资源占用，比如 CPU ，内存和允许的最大进程数等等。\n今天主要介绍如何通过 Cgroups 里面的 pids 控制器限制 Kubernetes Pod 容器的最大进程数量。\n场景介绍 之前遇到过这样一个问题，我们的服务会调用执行外部的命令，每调用一次外部命令就会 fork 产生子进程。但是由于代码上的 bug ，没有及时对子进程回收，然后这个容器不断 fork 产生子进程，耗尽了宿主机的进程表空间，最终导致整个系统不响应，影响了其它的服务。\n这种问题除了让开发人员修复 bug 外，也需要在系统层面对进程数量进行限制。所以，如果一个容器里面运行的服务会 fork 产生子进程，就很有必要使用 Cgroups 的 pids 控制器限制这个容器能运行的最大进程数量。\n解决方法 Kubelet 开启 PodPidsLimit 功能 Kubernetes 里面的每个节点都会运行一个叫做 Kubelet 的服务，负责节点上容器的状态和生命周期，比如创建和删除容器。根据 Kubernetes 的官方文档 Process ID Limits And Reservations 内容，可以设置 Kubelet 服务的 –pod-max-pids 配置选项，之后在该节点上创建的容器，最终都会使用 Cgroups pid 控制器限制容器的进程数量。\n我们 Kubernetes 是在 CentOS 7 上使用 kubeadm 部署的 v1.15.9 版本，需要额外设置 SupportPodPidsLimit 的 feature-gate，对应操作如下（其它发行版应该也类似）：\n# kubelet 使用 systemd 启动的，可以通过编辑 /etc/sysconfig/kubelet # 添加额外的启动参数，设置 pod 最大进程数为 1024 $ vim /etc/sysconfig/kubelet KUBELET_EXTRA_ARGS=\"--pod-max-pids=1024 --feature-gates=\\\"SupportPodPidsLimit=true\\\"\" # 重启 kubelet 服务 $ systemctl restart kubelet # 查看参数是否生效 $ ps faux | grep kubelet | grep pod-max-pids root 104865 10.5 0.6 1731392 107368 ? Ssl 11:56 0:30 /usr/bin/kubelet ... --pod-max-pids=10 --feature-gates=SupportPodPidsLimit=true 验证 PodPidsLimit 通过配置 Kubelet 的 –pod-max-pids=1024 选项，限制了一个容器内允许的最大进程数为 1024 个。现在来测试下如果容器内不断 fork 子进程，数目到达 1024 个时会触发什么行为。\n参考 Fork bomb 的内容，可以创建一个 pod，不断 fork 子进程。\n# 创建普通的 nginx pod yaml $ cat \u003c\u003cEOF \u003e test-nginx.yaml apiVersion: v1 kind: Pod metadata: name: test-nginx spec: containers: - name: nginx image: nginx EOF # 创建到 Kubernetes 集群 $ kubectl apply -f test-nginx.yaml # 进入 nginx 容器模拟 fork bomb  $ kubectl exec -ti test-nginx bash root@test-nginx:/# bash -c \"fork() { fork | fork \u0026 }; fork\" environment: fork: retry: Resource temporarily unavailable environment: fork: retry: Resource temporarily unavailable environment: fork: retry: Resource temporarily unavailable 通过进入一个 nginx 容器里面使用 bash 运行 fork bomb 命令，我们会发现当 fork 的子进程达到限制的上限数目后，会报 retry: Resource temporarily unavailable 的错误，这个时候再看下宿主机的 fork 进程数目。\n# 通过在外部宿主机执行下面的命令，会发现 fork 的进程数目接近 1024 个 $ ps faux | grep fork | wc -l 1019 通过以上的实验，发现能够通过设置 Kubelet 的 –pod-max-pids 选项，限制容器类的进程数，避免容器进程数不断上升最终耗尽宿主机资源，拖垮整个宿主机系统。\n原理实现 通过之前描述的解决方法，已经能够限制容器的进程数了。\n现在从代码的层面看下 Kubelet 如何设置 Cgroups pids 控制器。\nKubelet 代码调用 首先来看下 Kubelet 代码里面 –pod-max-pids 是怎么生效的，Kubernetes 的版本为 v1.15.9。\n–pid-max-pids 选项是在 cmd/kubelet/app/options/options.go 里面的 AddKubeletConfigFlags 函数设置的，对应代码如下。\n// cmd/kubelet/app/options/options.go func AddKubeletConfigFlags(mainfs *pflag.FlagSet, c *kubeletconfig.KubeletConfiguration) { ... // 这里定义了 '--pod-max-pids' 的选项  // 对应参数的值通过命令行解析到 kubeletconfig.KubeletConfiguration.PodPidsLimit 里面  fs.Int64Var(\u0026c.PodPidsLimit, \"pod-max-pids\", c.PodPidsLimit, \"Set the maximum number of processes per pod. If -1, the kubelet defaults to the node allocatable pid capacity.\") ... } PodPidsLimit 配置参数解析完成后，kubelet 会在启动的时候把值设置到 ContainerManager 里面，对应代码在 cmd/kubelet/app/server.go 里面的 run 函数，注释如下。\n// cmd/kubelet/app/server.go func run(s *options.KubeletServer, kubeDeps *kubelet.Dependencies, stopCh \u003c-chan struct{}) (err error) { ... kubeDeps.ContainerManager, err = cm.NewContainerManager( ... cm.NodeConfig{ ... // 容器 runtime，默认使用 docker  ContainerRuntime: s.ContainerRuntime, // 使用 Cgroups 控制 pod 的服务质量  CgroupsPerQOS: s.CgroupsPerQOS, // 操作 Cgroups 的驱动，有 cgroupfs 和 systemd 两种  // 我们默认配置使用 systemd 来控制 Cgroups  CgroupDriver: s.CgroupDriver, ... // 这里就是 PodPidsLimit 的设置了，通过刚才 options 的解析  // 赋值到了 ContainerManager.ExperimentalPodPidsLimit 属性  ExperimentalPodPidsLimit: s.PodPidsLimit, // 限制容器 CPU 使用率的参数  EnforceCPULimits: s.CPUCFSQuota, CPUCFSQuotaPeriod: s.CPUCFSQuotaPeriod.Duration, }, ... ...) ... } 初始化 ContainerManager 后，会在 pkg/kubelet/cm/container_manager_linux.go 里面调用 NewPodContainerManager 创建 PodContainerManager，代码如下。\n// pkg/kubelet/cm/container_manager_linux.go ... func (cm *containerManagerImpl) NewPodContainerManager() PodContainerManager { // 默认情况下已经打开了 CgroupsPerQOS 的选项  if cm.NodeConfig.CgroupsPerQOS { // 这里返回 PodContainerManager 接口的实现  return \u0026podContainerManagerImpl{ qosContainersInfo: cm.GetQOSContainersInfo(), subsystems: cm.subsystems, cgroupManager: cm.cgroupManager, // 这里设置 podPidsLimit  podPidsLimit: cm.ExperimentalPodPidsLimit, enforceCPULimits: cm.EnforceCPULimits, cpuCFSQuotaPeriod: uint64(cm.CPUCFSQuotaPeriod / time.Microsecond), } } return \u0026podContainerManagerNoop{ cgroupRoot: cm.cgroupRoot, } } ... 从之前的代码能发现 PodContainerManager 是一个接口，对应的实现在 pkg/kubelet/cm/pod_container_manager_linux.go 里面，与 Cgroup 相关的函数则是 podContainerManagerImpl.EnsureExists 函数。\n// pkg/kubelet/cm/pod_container_manager_linux.go ... // podContainerManagerImpl 就是实现 PodContainerManager 接口的结构体 // EnsureExists 会根据 api 里面 Pod 的定义，在当前系统创建对应容器的 cgroup 配置 func (m *podContainerManagerImpl) EnsureExists(pod *v1.Pod) error { // podContainerName 也会作为 cgroup name，根据 pod 的 QOS 级别和 UUID 生成  // 查看容器是否存在  alreadyExists := m.Exists(pod) if !alreadyExists { // 创建 pod 对应容器的 cgroup  containerConfig := \u0026CgroupConfig{ Name: podContainerName, ResourceParameters: ResourceConfigForPod(pod, m.enforceCPULimits, m.cpuCFSQuotaPeriod), } // 如果启用了 SupportPodPidsLimit feature-gate ，并且 podPidsLimit 大于 0  if utilfeature.DefaultFeatureGate.Enabled(kubefeatures.SupportPodPidsLimit) \u0026\u0026 m.podPidsLimit \u003e 0 { // 这里就会配置 PidsLimit  containerConfig.ResourceParameters.PidsLimit = \u0026m.podPidsLimit } // 调用 cgroupManager 根据 containerConfig 创建对应的 cgroup  if err := m.cgroupManager.Create(containerConfig); err != nil { return fmt.Errorf(\"failed to create container for %v : %v\", podContainerName, err) } } ... return nil } ... 接下来看 cgroupManager.Create 函数的实现，对应代码实现在 pkg/kubelet/cm/cgroup_manager_linux.go 里面的 cgroupManagerImpl.Create。\n... func (m *cgroupManagerImpl) Create(cgroupConfig *CgroupConfig) error { ... resources := m.toResources(cgroupConfig.ResourceParameters) libcontainerCgroupConfig := \u0026libcontainerconfigs.Cgroup{ Resources: resources, } // libcontainer consumes a different field and expects a different syntax  // depending on the cgroup driver in use, so we need this conditional here.  if m.adapter.cgroupManagerType == libcontainerSystemd { // 我们使用 systemd 管理 cgroup ，所以这里会更新下 systemd 对应 cgroup 的配置  updateSystemdCgroupInfo(libcontainerCgroupConfig, cgroupConfig.Name) } else { libcontainerCgroupConfig.Path = cgroupConfig.Name.ToCgroupfs() } if utilfeature.DefaultFeatureGate.Enabled(kubefeatures.SupportPodPidsLimit) \u0026\u0026 cgroupConfig.ResourceParameters != nil \u0026\u0026 cgroupConfig.ResourceParameters.PidsLimit != nil { // 设置 libcontainerCgroupConfig 里面的 PidsLimit  // 这里 PidsLimit 就是一开始参数指定的 --pod-max-pids 的值  libcontainerCgroupConfig.PidsLimit = *cgroupConfig.ResourceParameters.PidsLimit } // 这里根据 cgroup 的配置返回 libcontainercgroups.Manager 接口的实现  // 这里的实现是 systemd 的实现  manager, err := m.adapter.newManager(libcontainerCgroupConfig, nil) if err != nil { return err } // 调用 libcontainer 里面的 cgroups manager Apply 接口把 pod 的 cgroup 配置应用到系统  // 在我们的环境中，这个 Apply 函数会由 libcontainer/cgroupfs/systemd.Manager 实现  if err := manager.Apply(-1); err != nil { return err } ... return nil } ... 在看下最后的 Apply 函数，该函数会调用到 vendor/github.com/opencontainers/runc/libcontainer/cgroups/systemd/apply_systemd.go 里面的 systemd 实现。\n// vendor/github.com/opencontainers/runc/libcontainer/cgroups/systemd/apply_systemd.go ... func (m *Manager) Apply(pid int) error { // 初始化 systemd cgroup 需要的一些变量  var ( c = m.Cgroups // systemd unit name  unitName = getUnitName(c) slice = \"system.slice\" // systemd unit 里面的配置属性  properties []systemdDbus.Property ) ... // Always enable accounting, this gets us the same behaviour as the fs implementation,  // plus the kernel has some problems with joining the memory cgroup at a later time.  properties = append(properties, newProp(\"MemoryAccounting\", true), newProp(\"CPUAccounting\", true), newProp(\"BlockIOAccounting\", true)) ... if c.Resources.Memory != 0 { // 设置 cgroup memory limit  properties = append(properties, newProp(\"MemoryLimit\", uint64(c.Resources.Memory))) } if c.Resources.CpuShares != 0 { // 设置 cgroup cpu shares  properties = append(properties, newProp(\"CPUShares\", c.Resources.CpuShares)) } ... if c.Resources.BlkioWeight != 0 { // 设置 cgroup block io weight  properties = append(properties, newProp(\"BlockIOWeight\", uint64(c.Resources.BlkioWeight))) } if c.Resources.PidsLimit \u003e 0 { // 这里设置了本文关注的 PidsLimit 参数  // 发现会对应 systemd 里面的 TasksAccounting 和 TasksMax 属性  properties = append(properties, newProp(\"TasksAccounting\", true), newProp(\"TasksMax\", uint64(c.Resources.PidsLimit))) } ... // 通过 systemdDbus 根据之前的 cgroup 设置创建对应的 unit  if _, err := theConn.StartTransientUnit(unitName, \"replace\", properties, statusChan); err == nil { ... } // 最后加入 Cgroups  if err := joinCgroups(c, pid); err != nil { return err } ... } ... Systemd Cgroup slice 通过对 Kubelet 调用 libcontainer，最后由 systemd 创建 pod 容器对应 cgroup unit 的代码调用分析，在这里看下对应 pod 的 systemd unit 配置。\n从之前代码看，最终生成的 systemd unit 和 cgroup 和 pod 的 uid 和 qosClass 有关系，所以先通过以下的命令拿到 pod 的 uid 和 qosClass。\n$ kubectl get pods test-nginx -o yaml | grep -E 'uid|qos' uid: 2ac1e32c-d8d6-4533-8eab-d04d60465065 qosClass: BestEffort 然后找到对应的 systemd unit .slice 文件。\n# uid 取前 8 位，qosClass 小写 # 找到对应的 kubepods-besteffort-pod2ac1e32c_d8d6_4533_8eab_d04d60465065.slice $ systemctl | grep 2ac1e32c | grep besteffort kubepods-besteffort-pod2ac1e32c_d8d6_4533_8eab_d04d60465065.slice loaded active active libcontainer container kubepods-besteffort-pod2ac1e32c_d8d6_4533_8eab_d04d60465065.slice # 查看对应 slice 的配置 $ systemctl status kubepods-besteffort-pod2ac1e32c_d8d6_4533_8eab_d04d60465065.slice ● kubepods-besteffort-pod2ac1e32c_d8d6_4533_8eab_d04d60465065.slice - libcontainer container kubepods-besteffort-pod2ac1e32c_d8d6_4533_8eab_d04d60465065.slice Loaded: loaded (/run/systemd/system/kubepods-besteffort-pod2ac1e32c_d8d6_4533_8eab_d04d60465065.slice; static; vendor preset: disabled) Drop-In: /run/systemd/system/kubepods-besteffort-pod2ac1e32c_d8d6_4533_8eab_d04d60465065.slice.d └─50-BlockIOAccounting.conf, 50-CPUAccounting.conf, 50-CPUShares.conf, 50-DefaultDependencies.conf, 50-Delegate.conf, 50-Description.conf, 50-MemoryAccounting.conf, 50-TasksAccounting.conf, 50-TasksMax.conf, 50-Wants-kubepods-besteffort\\x2eslice.conf Active: active since Fri 2021-06-25 16:21:25 CST; 7min ago Tasks: 6 (limit: 1024) Memory: 6.8M CGroup: /kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod2ac1e32c_d8d6_4533_8eab_d04d60465065.slice ├─docker-2d151786c9985db74632c09412207fa99755473fde93d09920604e097f25a2b7.scope │ ├─32662 nginx: master process nginx -g daemon off; │ ├─32703 nginx: worker process │ ├─32704 nginx: worker process │ ├─32705 nginx: worker process │ └─32706 nginx: worker process └─docker-966047566d9e90d9ef64126b605101c174d750ec0cde3d3a83c5b313c7af9a21.scope └─32544 /pause Jun 25 16:21:25 centos7-oc-dev systemd[1]: Created slice libcontainer container kubepods-besteffort-pod2ac1e32c_d8d6_4533_8eab_d04d60465065.slice. # 通过 systemctl status 能发现 50-TasksMax.conf 的文件 # 从之前的代码分析，发现 PodPidsLimit 会对应到 systemd 的 TasksMax 属性 # 现在在看下这个文件的内容 $ cat /run/systemd/system/kubepods-besteffort-pod2ac1e32c_d8d6_4533_8eab_d04d60465065.slice.d/50-TasksMax.conf [Slice] TasksMax=1024 # TasksMax 设置为了 1024 ，限制了这个进程最大子进程（Task）数量 Cgroup FS 查看之前的 vendor/github.com/opencontainers/runc/libcontainer/cgroups/systemd/apply_systemd.go 代码，发现在创建完 pod 容器对应的 systemd cgroup slice 后，还会调用一次 joinCgroups 这个函数。这个函数会使用 Cgroup FS 原生的方法，在 /sys/fs/cgroup 里面创建对应 pod 容器的 group 。\n所以再看下 Cgroup FS 里面 pod 设置 pid limit 的配置。\n# 找到 Cgroup FS pids 控制器的挂载点 $ cgroup on /sys/fs/cgroup/pids type cgroup (rw,nosuid,nodev,noexec,relatime,pids) # 看下 /sys/fs/cgroup/pids 目录下的文件 $ ls -alh /sys/fs/cgroup/pids ... # 发现有一个由 Kubelet 创建的 kubepods.slice drwxr-xr-x 4 root root 0 Jun 25 04:49 kubepods.slice ... # 再通过查看 /sys/fs/cgroup/pids/kubepods.slice 目录 # 会发现 kubepods-besteffort.slice 和 kubepods-burstable.slice 两个目录 # 分别对应 pod 容器的 QOS 级别 $ ls -alh /sys/fs/cgroup/pids/kubepods.slice ... drwxr-xr-x 42 root root 0 Jun 25 16:21 kubepods-besteffort.slice drwxr-xr-x 8 root root 0 Jun 25 04:49 kubepods-burstable.slice ... # 结合刚才的代码片段，也可以想到原生 Cgroup FS 的目录和 systemd 的应该是差不多的层级 # 现在直接用 find 命令查看 pids 控制器下面的 cgroup 设置 $ find /sys/fs/cgroup/pids/kubepods.slice -type f | grep pod2ac1e32c ... # 能发现 pids.current 和 pids.max 两个 cgroup 的配置 # pids.current 表示当前 pod 里面的进程（Task）数量 /sys/fs/cgroup/pids/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod2ac1e32c_d8d6_4533_8eab_d04d60465065.slice/pids.current # pids.max 则表示 pod 里面能运行的进程（Task）上限 /sys/fs/cgroup/pids/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod2ac1e32c_d8d6_4533_8eab_d04d60465065.slice/pids.max ... # 查看 pod pids.max 设置，结果为 1024 $ cat /sys/fs/cgroup/pids/kubepods.slice/kubepods-besteffort.slice/kubepods-besteffort-pod2ac1e32c_d8d6_4533_8eab_d04d60465065.slice/pids.max 1024 另外这篇内核文档 Process Number Controller 对 cgroup pids 控制器的使用进行了介绍，可以了解下。\n","excerpt":"作者: 李泽玺\nKubernetes 里面的 Pod 资源是最小的计算单元，抽象了一组（一个或多个）容器。容器也是 Linux 系统上的进 …","ref":"/v3.6/zh/blog/2021/06/25/cgroups-kubernetes-pid-limits/","title":"使用 Cgroups 限制 Kubernetes Pod 进程数"},{"body":"作者: 李泽玺\nLinux 上虚拟机 GPU 透传需要使用 vfio 的方式。主要是因为在 vfio 方式下对虚拟设备的权限和 DMA 隔离上做的更好。但是这么做也有个缺点，这个物理设备在主机和其他虚拟机都不能使用了。\nqemu 直接使用物理设备本身命令行是很简单的，关键在于事先在主机上对系统、内核和物理设备的一些配置。\n单纯从 qemu 的命令行来看，其实和普通虚拟机启动就差了最后那个 -device 的选项。这个选项也比较容易理解，就是把主机上的设备 0000:00:01.0 传给了虚拟机使用。\n$ qemu-system-x86_64 -m 4096 -smp 4 --enable-kvm \\  -drive file=~/guest/fedora.img \\  -device vfio-pci,host=0000:00:01.0 系统及硬件准备 BIOS中打开IOMMU 设备直通在 x86 平台上需要打开 iommu 功能。这是 Intel 虚拟技术 VT-d(Virtualization Technology for Device IO) 中的一个部分。有时候这部分的功能没有被打开。\n打开的方式在 BIOS 设置中 Security-\u003eVirtualization-\u003eVT-d 这个位置。当然不同的 BIOS 位置可能会略有不同。记得在使用直通设备前要将这个选项打开。\n内核配置勾选IOMMU INTEL_IOMMU │ Location: │ │ -\u003e Device Drivers │ │ (2) -\u003e IOMMU Hardware Support (IOMMU_SUPPORT [=y]) 内核启动参数enable IOMMU BIOS 中打开，内核编译选项勾选还不够。还需要在引导程序中添加上内核启动参数\n# 对应编辑 /etc/default/grub, 设置 GRUB_CMDLINE_LINUX= $ cat /etc/default/grub ... GRUB_CMDLINE_LINUX=\"intel_iommu=on iommu=pt vfio_iommu_type1.allow_unsafe_interrupts=1 rdblacklist=nouveau nouveau.modeset=0\" ... # 重新生成 grub 引导配置文件 $ grub2-mkconfig -o /boot/grub2/grub.cfg # 将vfio相关 module 设置为开机load $ cat /etc/modules-load.d/vfio.conf vfio vfio_iommu_type1 vfio_pci vfio_virqfd Setting up IOMMU Kernel parameters\n找到 nvidia GPU BusID record PCI addresses and hardware IDs of the GPU\n$ lspci -k | grep -i nvidia -A 3 41:00.0 VGA compatible controller: NVIDIA Corporation GP107 [GeForce GTX 1050 Ti] (rev a1) Subsystem: Device 1b4c:11bf Kernel driver in use: vfio-pci Kernel modules: nouveau 41:00.1 Audio device: NVIDIA Corporation GP107GL High Definition Audio Controller (rev a1) Subsystem: Device 1b4c:11bf Kernel driver in use: snd_hda_intel Kernel modules: snd_hda_intel # pci address =\u003e 41:00.0,41:00.1 # device id =\u003e 1b4c:11bf # 这里找到了两张 nvidia 卡，它们的 device id 都是 1b4c:11bf, 一张是 Audio device # 这样是不能 passthrough 进去的，因为: # vfio-pci use your vendor and device id pair to identify which device they need to bind to at boot, # if you have two GPUs sharing such an ID pair you will not be able to get your passthough driver to bind with just one of them # 使用下面的脚本解决这种情况： $ cat /usr/bin/vfio-pci-override.sh #!/bin/sh for i in $(find /sys/devices/pci* -name boot_vga); do if [ $(cat \"$i\") -eq 0 ]; then GPU=\"${i%/boot_vga}\" AUDIO=\"$(echo \"$GPU\" | sed -e \"s/0$/1/\")\" echo \"vfio-pci\" \u003e \"$GPU/driver_override\" if [ -d \"$AUDIO\" ]; then echo \"vfio-pci\" \u003e \"$AUDIO/driver_override\" fi fi done modprobe -i vfio-pci # 把脚本传入 /etc/modprobe.d/vfio.conf $ cat /etc/modprobe.d/vfio.conf install vfio-pci /usr/bin/vfio-pci-override.sh options vfio-pci ids=10de:1c82 disable_vga=1 使用 vfio 管理 GPU # /etc/modprobe.d/vfio.conf, ids 为 lspci 找到的 hardware id, 多个设备的话用','分割 $ cat /etc/modprobe.d/vfio.conf options vfio-pci ids=10de:134d disable_vga=1 # 禁用NVIDIA nouveau 开源驱动, /etc/modprobe.d/blacklist.conf $ cat /etc/modprobe.d/blacklist.conf blacklist nouveau # kvm 模块配置, /etc/modprobe.d/kvm.conf $ cat /etc/modprobe.d/kvm.conf options kvm ignore_msrs=1 重启系统，启动完成后查看当前的 nvidia GPU 是否被 vfio-pci 模块使用, 确认IOMMU功能确实打开。\n$ dmesg | grep -e DMAR -e IOMMU | grep enabled # 如果能搜索到 DMAR: IOMMU enabled # 表示上述配置成功。 # 查看 GPU 是否被 vfio-pci 使用 # 另外注意检查看看 41:00.1 Audio device 是否也被 vfio-pci 使用 $ lspci -k | grep -i -e nvidia -A 3 41:00.0 VGA compatible controller: NVIDIA Corporation GP107 [GeForce GTX 1050 Ti] (rev a1) Subsystem: Device 1b4c:11bf Kernel driver in use: vfio-pci # GTX 1050 Ti GPU 被 vfio-pci 使用 Kernel modules: nouveau 41:00.1 Audio device: NVIDIA Corporation GP107GL High Definition Audio Controller (rev a1) Subsystem: Device 1b4c:11bf Kernel driver in use: vfio-pci # 发现 Audio device 也被 vfio-pci 使用了 Kernel modules: snd_hda_intel ... # list GPU IOMMU group $ find /sys/kernel/iommu_groups/ -type l | grep 41:00 /sys/kernel/iommu_groups/27/devices/0000:41:00.0 /sys/kernel/iommu_groups/27/devices/0000:41:00.1 # 找到IOMMU Group 管理的 PCI 设备 #!/bin/bash shopt -s nullglob for d in /sys/kernel/iommu_groups/*/devices/*; do n=${d#*/iommu_groups/*}; n=${n%%/*} printf 'IOMMU Group %s ' \"$n\" lspci -nns \"${d##*/}\" done 使用 qemu 透传 nvidia GPU 准备好centos7镜像，然后在虚拟机里面安装 nvidia 官方闭源驱动和 cuda SDK\n# 我从服务器上拷贝过来的是 vmdk 的镜像，先把它转换成 qcow2 的格式 $ /usr/local/qemu-2.9.0/bin/qemu-img convert -f vmdk -O qcow2 centos-7.3.1611-20180104.vmdk centos-7.3.1611-20180104.qcow2 # 使用 qemu 启动，注意-cpu 需要 kvm=off 参数 # kvm=off will hide the kvm hypervisor signature, this is required for NVIDIA cards # since its driver will refuse to work on an hypervisor and result in Code 43 on windows $ cat startvm.sh #!/bin/sh /usr/local/qemu-2.9.0/bin/qemu-system-x86_64 -enable-kvm \\ -m 4096 -cpu host,kvm=off -smp 4,sockets=1,cores=4,threads=1 \\ -drive file=./centos-7.3.1611-20180104.qcow2 \\ -device vfio-pci,host=41:00.0,multifunction=on,addr=0x16 \\ -device vfio-pci,host=41:00.1 \\ -net nic,model=e1000 -net user,hostfwd=tcp::5022-:22 \\ -vnc :1 # 这台虚拟机开了vnc和ssh 端口转发，可以使用vnc或者ssh访问 # 从host进入虚拟机 $ ssh 127.0.0.1 -p 5022 # 查看虚拟机透传进来的显卡 $ lspci -k | grep -i nvidia -A 3 00:04.0 Audio device: NVIDIA Corporation Device 0fb9 (rev a1) Subsystem: Device 1b4c:11bf Kernel driver in use: snd_hda_intel Kernel modules: snd_hda_intel 00:16.0 VGA compatible controller: NVIDIA Corporation GP107 (rev a1) Subsystem: Device 1b4c:11bf Kernel modules: nouveau 安装nvidia 驱动和 Cuda nvidia 驱动需要从官方下载，如果先安装 cuda 的话会一同安装 nvidia 驱动。 接下来采用虚拟机先安装驱动再安装 cuda 的步骤。\n参考： installing-nvidia-drivers-centos-7 NVIDIA CUDA GETTINGS STARTED GUIDE FOR LINUX\n安装 nvidia 驱动 下载地址：http://www.nvidia.com/object/unix.html\n# update 后如果更新内核，需要重启 $ yum -y update # 安装 gcc、make、glibc等工具和库 $ yum -y groupinstall \"Development Tools\" $ yum -y install kernel-devel # Download the latest NVIDIA driver for unix. $ wget http://us.download.nvidia.com/XFree86/Linux-x86_64/390.42/NVIDIA-Linux-x86_64-390.42.run $ yum -y install epel-release $ yum -y install dkms # Edit /etc/default/grub. Append the following to “GRUB_CMDLINE_LINUX” rd.driver.blacklist=nouveau nouveau.modeset=0 # Generate a new grub configuration to include the above changes. $ grub2-mkconfig -o /boot/grub2/grub.cfg # Edit/create /etc/modprobe.d/blacklist.conf and append: blacklist nouveau # Backup your old initramfs and then build a new one $ mv /boot/initramfs-$(uname -r).img /boot/initramfs-$(uname -r)-nouveau.img $ dracut /boot/initramfs-$(uname -r).img $(uname -r) # 重启again # Run the NVIDIA driver installer and enter yes to all options. $ sh NVIDIA-Linux-x86_64-*.run # 装好后再一次重启，lspci -k 看下gpu使用的驱动是否是nvidia $ lspci -k | grep -i nvidia -A 3 00:04.0 Audio device: NVIDIA Corporation GP107GL High Definition Audio Controller (rev a1) 00:16.0 VGA compatible controller: NVIDIA Corporation GP107 [GeForce GTX 1050 Ti] (rev a1) Kernel driver in use: nvidia # 发现已经使用nvidia驱动 Kernel modules: nouveau, nvidia_drm, nvidia # 执行 nvidia-smi 看下输出和温度 $ nvidia-smi Thu Mar 15 01:31:09 2018 +-----------------------------------------------------------------------------+ | NVIDIA-SMI 390.42 Driver Version: 390.42 | |-------------------------------+----------------------+----------------------+ | GPU Name Persistence-M| Bus-Id Disp.A | Volatile Uncorr. ECC | | Fan Temp Perf Pwr:Usage/Cap| Memory-Usage | GPU-Util Compute M. | |===============================+======================+======================| | 0 GeForce GTX 105... Off | 00000000:00:16.0 Off | N/A | | 40% 32C P0 N/A / 100W | 0MiB / 4040MiB | 0% Default | +-------------------------------+----------------------+----------------------+ +-----------------------------------------------------------------------------+ | Processes: GPU Memory | | GPU PID Type Process name Usage | |=============================================================================| | No running processes found | +-----------------------------------------------------------------------------+ $ nvidia-smi -q -d TEMPERATURE ==============NVSMI LOG============== Timestamp : Thu Mar 15 01:32:42 2018 Driver Version : 390.42 Attached GPUs : 1 GPU 00000000:00:16.0 Temperature GPU Current Temp : 32 C GPU Shutdown Temp : 102 C GPU Slowdown Temp : 99 C GPU Max Operating Temp : N/A Memory Current Temp : N/A Memory Max Operating Temp : N/A 安装 cuda 下载地址： https://developer.nvidia.com/cuda-downloads 这里选择 runfile，以后为了方便也可以选择 rpm(network)的方式，会自动帮我们安装 nvidia 驱动\n$ wget https://developer.nvidia.com/compute/cuda/9.1/Prod/local_installers/cuda_9.1.85_387.26_linux # Say no to installing the NVIDIA driver. # The standalone driver you already installed is typically newer than what is packaged with CUDA. # Use the default option for all other choices. $ sh cuda_*.run # 添加 CUDA 相关的环境变量 export PATH=$PATH:/usr/local/cuda/bin export LD_LIBRARY_PATH=/usr/local/cuda/lib64:$LD_LIBRARY_PATH # make samples $ cd ~/NVIDIA_CUDA-9.1_Samples; make -j 4 $ cd bin/x86_64/linux/release $ ./deviceQuery # 查询gpu信息 ./deviceQuery Starting... CUDA Device Query (Runtime API) version (CUDART static linking) Detected 1 CUDA Capable device(s) Device 0: \"GeForce GTX 1050 Ti\" CUDA Driver Version / Runtime Version 9.1 / 9.1 CUDA Capability Major/Minor version number: 6.1 Total amount of global memory: 4040 MBytes (4236312576 bytes) ( 6) Multiprocessors, (128) CUDA Cores/MP: 768 CUDA Cores GPU Max Clock rate: 1481 MHz (1.48 GHz) Memory Clock rate: 3504 Mhz Memory Bus Width: 128-bit L2 Cache Size: 1048576 bytes ... $ ./bandwidtTest # 使用 cuda 测试gpu bandwidth Running on... Device 0: GeForce GTX 1050 Ti Quick Mode Host to Device Bandwidth, 1 Device(s) PINNED Memory Transfers Transfer Size (Bytes) Bandwidth(MB/s) 33554432 9719.0 Device to Host Bandwidth, 1 Device(s) PINNED Memory Transfers Transfer Size (Bytes) Bandwidth(MB/s) 33554432 9215.8 Device to Device Bandwidth, 1 Device(s) PINNED Memory Transfers Transfer Size (Bytes) Bandwidth(MB/s) 33554432 95525.1 Result = PASS NOTE: The CUDA Samples are not meant for performance measurements. Results may vary when GPU Boost is enabled. ","excerpt":"作者: 李泽玺\nLinux 上虚拟机 GPU 透传需要使用 vfio 的方式。主要是因为在 vfio 方式下对虚拟设备的权限和 DMA 隔离 …","ref":"/v3.6/zh/blog/2021/06/07/nvidia-gpu-passthrough-record/","title":"使用Linux vfio将Nvidia GPU透传给QEMU虚拟机"},{"body":"作者: 高现起\n大家好，我是高现起，目前在负责云联壹云融合云管理平台的产品工作，今天很高兴由我给大家介绍一下最新发布的3.7版本的新功能。\n我将围绕以下目录展开我今天的内容：\n 产品简介 3.7版本新功能介绍 功能规划  一、产品简介 目前，企业的IT资源属于无处不在的状态，根据 Flexera 2020 云状态（原 RightScale 云状态报告）报告，93%的企业实施了多云战略。虽然这一调查的依据是全球750家企业的云决策者，但是从国内的实际情况来说，数字可能没有那么大，趋势还是有的，就是多云已经是更多企业的选择了。\n多云环境，我们又统称为异构IT基础设施，那么这种异构IT基础设施在给客户带来更优性能更优成本的同时，也会带来一些新的问题，例如我下边列举的5种不同角色的用户所遇到的问题：\n 运维工程师/开发工程师-如何统一管理所有的云计算资源？ 财务专员-如何获取统一易读的公有云账单？ 运维主管/开发主管-如何及时获取资源整体的使用情况？ 财务主管-如何及时获取IT资源成本的使用结构？ CTO/CIO-如何提高IT资源的ROI（投资回报率）？  我们早在2017年就关注到多云带来客户的问题，开始做云联壹云这款产品，希望能够帮助企业很好的解决这些问题。\n云联壹云是一站式管理云计算资源的解决方案，希望帮助客户在一个地方管理本地IDC、私有云、公有云等IT资源，整体提高企业IT基础设施的管理效率。\n从产品架构图上，我们可以看出，底层是一些异构资源，上层是一些应用或服务，云联壹云处于承上启下的作用，向下屏蔽异构的差异，向上提供一致的资源管理能力。\n以上是我们最新版本也就是3.7版本的功能概览。\n最底层是异构资源，中层就是我们云管理平台的功能概览，上层应用和服务。云管理平台的底层是多云的适配层，往上是基础的资源管理，包括计算、存储、网络、PaaS服务等，再往上是针对企业客户做的三大块的功能，依次是权限管理、统一监控和报警、成本管理包括私有云的计量计费公有云的账单分析和成本优化等等，面向用户层，我们针对不同的用户有不同的用户界面，包括管理员的系统管理视图，租户的租户管理视图，普通用户的项目视图，针对运维人员的climc命令行工具，针对开发人员，我们也有丰富的REST API以及各个开发语言的SDK。\n这款产品能够带给客户3种价值：\n 省人省事-一站式采买、批量操作、一次配置，全网生效、统一获取易读账单 省钱-算好账、摊好钱、节成本 安全-统一认证、统一授权、免密登录  总而言之，云联壹云希望帮助用户解决异构IT基础设施带来的问题，充分发挥异构IT基础设施的优势。\n二、3.7版本新功能介绍 3.7版本增加了不下30多项功能或更新，由于时间关系，今天我主要给大家介绍这5个方面的功能：\n 多云资源对接 多云账单管理 多云监控告警 多云权限管理 标签管理  1. 多云资源对接 在3.7版本，我们不断围绕客户需求，支持更多公有云资源的纳管：\n AWS平台对接Redis Azure平台对接RDS 阿里云和华为云NAS文件存储对接 移动云对接 阿里云、华为云NAT网关支持  2. 多云账单管理 2.1 支持AWS的预留实例分析，包括RI推荐及RI覆盖率，帮助客户用好RI，节约成本\n2.2 支持价格对比功能，同配置全网比价，帮助客户发现便宜资源\n2.3 支持所有平台费用报告及定期发送\n2.4 支持预算管理功能，并且可以配置预算告警，防止费用超支\n2.5 费用优化迭代，更多纬度节省费用，帮助用户发现更多可以优化成本的途径\n3. 多云监控告警 3.1 支持自定义监控面板，一次定义，随时查看\n3.2 报警策略支持函数及静默期设置，有效避免毛刺、报警泛滥等问题\n3.3 支持自动化安装监控插件，可显示内存使用率等更多监控指标\n3.4 大屏增加地图，可根据资源城市进行分布\n3.5 增加监控总览，可以查看告警情况及平台各纬度使用情况\n4. 多云权限管理  在一个地方创建及管理所有云平台的子账号，并分配权限 通过云管壹云控制台可一键跳转免密登录公有云控制台 员工离职，自动注销对应的公有云账号  5. 标签管理  标签支持CMP与公有云平台双向同步 标签搜索增强，支持特殊符号复杂搜索  除以上5大功能的更新外，我们其实还有很多细节更新，在这里就不在展开给大家介绍，感兴趣的同学可以看一下以下总结\n三、功能规划 我们近期的功能规划主要是以下6个方面\n 京东云对接，我们有客户对京东云资源的纳管有需求 Azure RI\u0026CPP使用率、覆盖率以及推荐 产品内置负载均衡支持VPC网络（这个是我们私有云的功能） 公有云账单的二次定价，我们很多MSP厂商的需求 公有云WAF产品对接 监控报警的迭代，后期也会增加监控数据报表的功能  总结 好的，今天直播咱们就到这里，咱们简单的总结一下今天的内容：\n产品简介，在多云趋势的背景下，云联壹云产品希望帮助用户解决异构资源管理问题，提升企业IT基础设施管理效率，以及云联壹云带给客户省人省事、省钱、安全三大产品价值；\n3.7版本新功能介绍，主要给大家介绍了多云对接、多云账单管理、多云监控告警、多云权限管理以及标签管理5大模块的功能或更新；\n功能规划，我们近期将会围绕京东云对接、AzureCPP、内置负载均衡支持VPC、公有云账单二次定价、公有云WAF对接、监控迭代5大方面展开产品的功能设计与实现。\n感谢大家百忙之中参加我们的Meetup，下次直播再见。\n","excerpt":"作者: 高现起\n大家好，我是高现起，目前在负责云联壹云融合云管理平台的产品工作，今天很高兴由我给大家介绍一下最新发布的3.7版本的新功能。\n …","ref":"/v3.6/zh/blog/2021/05/31/cloudpods-3.7-new-feature-introduction/","title":"直播回顾：Cloudpods 3.7版本新功能介绍"},{"body":"作者: 周有松\n各位朋友大家好，欢迎大家在周三的晚上参加我们的线上Meetup分享。我是周有松，目前负责云联壹云网络相关功能的开发工作，今天分享的题目是“云上负载均衡产品的应用”。\n今天的内容会从以下几个方面展开：\n 负载均衡产品简介。主要介绍负载均衡作为一个云上产品，它的功能模型是怎样的，日常使用中会遇到的业务词汇 负载均衡的功能与典型应用场景。这部分主要结合业务词汇，对负载均衡服务中常见的一些功能选项进行介绍，并举例介绍一些典型的应用场景 最后，我们做一下总结，讨论一下负载均衡产品相比传统方式的优点  一、产品简介 1. 以NGINX为例 提到负载均衡，我们以前一般先会想到NGINX，或者淘宝的分支Tengine。我们先来看看\n 它是怎样工作的 它解决了什么样的问题 它适合什么样的应用场景  在加入了NGINX之后，客户端（Client IP）首先与NGINX建立连接（Virtual IP+Virtual Port），请求也先发给NGINX，再由NGINX从多个后端服务器中选择一台，建立连接后把请求转发给后端服务器（Real IP）。\nNGINX作为网络转发节点，不参与后端服务的业务逻辑处理。而相比客户端直连后端，多个后端服务器可同时处理业务请求，应用的服务能力得到水平扩展。同时，转发节点上可以对后端做健康检查，自动屏蔽掉不健康的后端服务器，保障业务的高可用，使得单个后端服务器在故障、升级、过载时依然对用户连续可用。\n因此，我们说水平扩展、高可用是负载均衡解决的最基本的两个问题。从另外一方面来说，使用负载均衡的业务，在架构设计上应该是能够水平扩展的。比如，一个应用的多个实例之间不需要通信，相互之间没有复杂的状态维护。\n2. 业务词汇 在使用云上负载均衡的时候，不管哪个厂商的产品，我们会遇到一些常用的业务词汇。我们围绕一张图来简要介绍。\n负载均衡实例，除了区域、可用区之外，每个实例至少有一个IP地址。同一个负载均衡实例下可以有多个监听，每个监听一般至少有协议、端口两个属性。后面还会介绍监听的其它属性，比如调度算法、健康检查、转发策略等。\n实例和监听对应到NGINX上，其实是Virtual IP和Virtual Port的组合。每个监听有一个后端服务器组，组内可以有多个后端服务器，监听将来自客户端的请求转发给后端服务器（Real IP、Real Port）。\n对于HTTPS协议的监听，我们还会遇到TLS证书的概念。\n通常每个监听还可以绑定一个访问控制列表，用来设置黑名单、白名单，限定业务的服务范围。\n将业务词汇放到转发模型上，我们可以得到这样一张图。在壹云的负载均衡实现中，转发节点使用HAProxy负责具体的流量转发。实例和监听的配置被转换为HAProxy的配置应用到转发节点上。HAProxy据此将流量转发到后端服务器组。\n二、功能与应用场景 1. 监听协议 一般来说，负载均衡监听支持的传输层协议为TCP、UDP，应用层一般支持HTTP、HTTPS。其中对HTTP协议的支持一般包括HTTP/1.0，HTTP/1.1，HTTP/2，以及WS（WebSocket），WSS（WebSocket Secure）等。\n除此之外，许多厂商的负载均衡产品也陆续开始了QUIC协议的支持。QUIC有时也被称作HTTP/3，它的传输层协议类型为UDP。壹云的负载均衡产品基于HAProxy，它将会随着HAProxy 2.5的发版实现对QUIC协议的支持。\n同实例下的多个监听，传输层协议相同时，端口必须不能冲突。比如，同一实例下，无法TCP/80和HTTP/80的两个监听只能选其一。但是TCP/53和UDP/53的两个监听可以同时存在。\n从开销来说，HTTPS因为涉及到TLS协商和传输加解密，开销最大。HTTP其次，相比TCP协议转发节点需要对传输的数据做内容解析。TCP作为有状态的连接，相比UDP开销又要大一些。\n图中展示的是壹云控制台中负载均衡监听创建的第1步。其中，端口对所有协议类型都是必选的项。创建HTTPS监听时，要求必须关联相应的TLS证书。对于WS、WSS的支持是默认就有的。\n主流的浏览器要求HTTP/2必须运行在加密信道上，一般来说，负载均衡产品对于HTTPS监听默认开启HTTP/2的支持。极个别情况下，某些应用的客户端遇到HTTP/2时会有兼容性问题，所以负载均衡产品通常也会提供开关，允许显式将HTTP/2支持关闭。\n2. 调度算法 监听收到客户端的请求后，从后端服务器组中选出一个后端做转发。这个算法通常就叫“调度算法”。一般来说我们常用的有3种：\n 轮询，round robin。这种策略比较适用于短连接、短生命周期的业务，比如网页浏览。每打开一个网页，通常需要下载HTML、CSS、JS、字体等文档，每个请求大约秒级、毫秒级即可完成。这种场景下，轮询作为一种简单的算法，能够实现较好的均衡效果。 最小连接数，least connected。转发节点会记录它与每个监听的后端服务器的当前活跃的连接数，在转发请求时，从中选择一个活跃连接数最少的后端。这种算法较适合长连接、生命周期较长的业务，比如大文件上传下载、长时的交互会话如SSH等。 源一致性哈希。在这类算法中，转发节点通常会对请求来源标记一个身份，比如源IP地址、请求中的某个HTTP cookie值等。对于来自同一个标记的请求，将其转发到上次选择的后端服务器。这种算法较适合需要维护会话缓存、关联状态的业务。例如，某些业务后端收到请求后，需要从别处获取并缓存该请求相关的信息，比如订单详情、关联的用户详情等等，如果来自同一个用户的请求依然送到同一个后端，使得缓存使中率提高。这种对Locality的利用对应用的体验提升较好。  3.健康检查 健康检查是一种负载均衡服务实现高可用，保障业务连续性的机制。通过健康检查结果，转发节点将不健康的后端向用户屏蔽，实现故障、升级等行为对用户的无感知。\n云上负载均衡的健康检查通常有以下几种：\n TCP检查。即通过TCP连接是否能够成功建立判断后端的健康与否，连接建立成功后会立即发出RST报文中断连接，减少后端资源占用。使用这种健康检查时，在后端的日志中可能会周期出现“connection reset”字样的信息，是预期中的效果。 UDP检查。一般的机制是，向后端服务器发送指定内容的请求，在约定时间内若能收到来自后端的响应，并且响应内容匹配，则认为此次检查结果为健康。由于UDP是无状态连接协议，因此配置的参数里除了指定请求、响应的内容，还需指定响应超时时间。 HTTP检查。通常通过向后端发送HEAD请求，对响应的状态码做检查来判断健康与否。默认的配置一般是2xx、3xx的响应判定为健康，4xx、5xx判定为故障。对状态码的归类一般也是可配置的。  云上负载均衡产品一般会某个后端的检查结果，作为一个初步诊断。一般会有连接超时、连接错误、响应错误等。当所有后端都被判定为不可用时，对于HTTP/HTTPS类型的监听，转发节点通常会直接返回503 Service Unavailable。\n4. HTTP转发策略 转发策略是针对HTTP/HTTPS监听为言的。简单来说，它通过匹配用户请求中的Host、Path字段来决定将请求转发到哪个后端服务器组。\n首先，同一监听下的多个转发策略共用一个IP、端口组合，实现了复用，并且业务的域名和路径统一管理，无需配置到每一台后端服务器上。例如，我们可以将wiki.example.com, task.example.com解析到同负载均衡实例的IP地址，然后创建一个HTTPS监听，再创建2个转发策略，分别匹配这两个域名，实现不同的转发路径。也可以通过共用域名解析，分配不同URL路径（/wiki，/task）的方式实现相同的效果。\n另外，同一监听下的转发策略可以共用监听自身的ACL规则，共享监听的带单和速率控制，因此管理、配置会明晰简单。\n5. 会话保持 会话保持也叫Sticky Session，适用于HTTP/HTTPS类型的监听。它是一种通过在HTTP cookie中嵌入后端标识的方式指定请求的转发路径。根据Set-Cookie的时间不同，通常有两个选项：\nServer模式。后端服务器知道自己的标识，在返回响应的时候给出Set-Cookie，经过转发节点交给浏览器后，记录在浏览器。转发请求下次收到该浏览器的请求时会看到相应的Cookie值，将其转发到上次的后端服务器。\nInsert模式。转发节点收到后端服务器的响应后，再转发给浏览器前会加入Set-Cookie头部，这个值之后会记录在浏览器中。转发节点下次收到浏览器的请求时，若其中包含此cookie，它会将其去除之后再转发给后端服务器。因此，在Insert模式下，后端服务器感知不到此cookie的存在。\n6. 跳转 HTTP/HTTPS协议的监听可以指定跳转目标。这种情况下，监听无需绑定后端服务器组。\n跳转类型的监听通常用来实现HTTP到HTTPS的跳转，实现全站加密访问。例如，在明文HTTP协议下，有些宽带运营商可能会篡改应用的响应，在其中插入广告等信息，某些情况下还可能导致信息安全问题。强制HTTPS跳转作为一种应对措施，可以帮助实现用户到站点的端到端保密信道。\n另外，跳转还可以用来实现站点的迁移、应用的升级场景里。当迁移、升级完成后，通过跳转将用户请求转移到新站点，旧的URL依然可用，迁移升级过程对用户无感知，回滚也非常便捷。\n7. 访问控制 监听可以指定访问控制列表（ACL），并指定该列表的类型是黑名单还是白名单。\n有时我们有一些内部接口、服务需要只能够有限开放，比如同公司另外一个机房，或者不同公司的合作伙伴等。此时通过访问控制列表实现就非常方便，在界面上统一管理、备注。\n另外一种情况下，有些应用我们需要限定服务区域，比如版权、监管的原因等。此时我们可以将服务区域的来源地址做成白名单，仅开放应用给这些区域。网络控制在负载均衡一处完成，整个过程应用本身无需配置变更。\n8. 获取客户端真实IP 从产品简介中我们可以看到，客户端的连接和请求终结在转发节点上，后端服务器看到的连接都来自转发节点。此时，后端看到的网络层源IP也都是转发节点的地址。负载均衡产品一般提供提供了以下几种方式让后端服务器能够获取客户端的源IP地址：\n对于HTTP/HTTPS协议，转发节点可以通过HTTP头部来传递客户端的源地址，头部的名称一般为X-Forwarded-For。\n对于其它协议，一般通过PROXY协议来向后端服务器传递此信息。PROXY协议由HAProxy项目制订，AWS的负载均衡即支持此规范，另外还有NGINX、LightHTTPd也是支持此协议的。举例来说，对于TCP连接，PROXY协议会在连接建立后先进行连接信息传递，之后才是正常的数据交换。因此，如果PROXY协议直接对接应用服务，需要对应用服务的连接入口进行微小的修改。\n一部分云厂商在整个负载均衡转发面实施会话记录、地址转换，使得虚机作为后端服务器时看到源地址即为客户请求的源地址，此时无需额外机制获得客户端的真实IP地址。需要注意的是，对于内网负载均衡，服务器在访问自身作为后端监听时，会出现因为源、目的IP地址都是自己而造成路径不通，这是这种机制的一个小限制。\n9. 请求速率控制 壹云的负载均衡对于HTTP/HTTPS类型的监听可以实施请求速率控制。分为两个方面：\n一是对监听整体进行速率控制。例如，某个应用现在的服务能力是每秒3000个请求，为了保护后端服务器，避免过载造成雪崩效应等，我们可以设定整体的速率控制。\n二是对每个来源IP地址进行控制。这个可以用于阻止来自单个客户的高频异常请求，比如刷单、爬虫类请求等\n10. TLS证书 最后，我们简单介绍一下TLS证书。用户在使用负载均衡时，经常反馈在证书上传这一步产生困惑。\n首先，从非对称加密算法的类型来说，证书一般分别为RSA、EC证书两类。其中EC证书也叫椭圆曲线证书，相对较新一些，大部分平台也是支持的。\n上传证书时，一般要求同时上传证书、私钥两个文件或文件的内容。这两者是成对出现的。云平台一般支持PEM格式的证书和私钥，为base64编码带标识头的文本格式。与之对应通常叫DER格式，它是ASN.1编码的二进制格式。如果用文本编辑器打开证书和私钥文件，看到的是规整的ASCII字符串，那么应该是PEM格式，如果是乱码状态，很可能就是DER格式了。\n图中是常见的3种私钥PEM文件头。PKCS是RSA Laboratory制定的一系列标准。其中PKCS#8支持封装多种加密算法的私钥，因此此种格式的PEM私钥有可能是RSA或者EC格式的私钥。\n图中展示了壹云控制台中证书列表的菜单位置。从中可以看到证书上传后，可以直接看到证书的CN（Common Name）。SAN（Subject Alternative Name），以及过期时间。在“操作”列中，若“删除”操作为灰色禁用状态，一般表示该证书正被HTTPS监听关联使用\n我们可以从证书的详情中，找到与它关联的监听列表，实现对所有监听批量更新证书。\n三、总结 以上结合实际的场景对负载均衡产品做了一个简略的介绍，我们经常被问到，这些功能特性都可以通过自己搭建NGINX一步一步配置出来，为什么还要花钱用云上的产品呢？\n首先，作为一种模块化封装的产品，负载均衡的主要优势在于简便、高效。自建NGINX时，我们需要自己配置集群高可用，考虑集群的水平扩展和扩容。在生产环境时还需要配置自己的监控、告警策略。在管理层面，权限管理和操作过程审计也必不可少，然而NGINX作为基础组件与这些上层概念距离较远，需要较复杂的过程才可实现相等效果。\n其次，云上负载均衡通常都有开放的API，可通过编程与周边系统对接，灵活应对需求。\n从企业IT资产管理的角度来说，负载均衡代表着更先进的生产力。壹云控制台上的信息呈现相比命令行中单字符控制来说，更加一目了然，操作也更加简便，使得对于操作结果的可预期性更强。\n","excerpt":"作者: 周有松\n各位朋友大家好，欢迎大家在周三的晚上参加我们的线上Meetup分享。我是周有松，目前负责云联壹云网络相关功能的开发工作，今天 …","ref":"/v3.6/zh/blog/2021/05/31/cloudpods-lb-application-intro/","title":"直播回顾：Cloudpods负载均衡的功能介绍"},{"body":"    Cloudpods   An open Source Unified Multi-Cloud/Hybrid-Cloud Cloud platform\nTo unify many distinct clouds into the one that behaves like an integral cloud platform.        Unified multi/hybrid cloud  =   Embedded Private Cloud   +   Unified API   +   Unified Identity   +   Unified Networking       Architecture    Supported Platforms and Technologies               Companies using Cloudpods       - -  --   @2021 Cloudpods.org       ","excerpt":"    Cloudpods   An open Source Unified Multi-Cloud/Hybrid-Cloud Cloud …","ref":"/v3.6/en/","title":"Cloudpods"},{"body":"    Cloudpods开源融合云平台   开源融合多云混合云平台\n统一多云差异，构建统一融合的云上之云。        融合云  =   Embedded Private Cloud   +   Unified API 统一API   +   Unified Identity 统一认证   +   Unified Networking 融合网络   +   Kubernetes     融合云架构    支持云平台和技术               谁在用       - -  --   @2021 Cloudpods.org       ","excerpt":"    Cloudpods开源融合云平台   开源融合多云混合云平台\n统一多云差异，构建统一融合的云上之云。        融合云  = …","ref":"/v3.6/zh/","title":"Cloudpods"},{"body":"Welcome the documentation of Cloudpods.\nWhat is Cloudpods? Cloudpods is an open-source unified multi-cloud/hybrid-cloud Cloud platform that provides unified APIs to access heterogenous IaaS resources across a broad range of cloud providers, including on-premise KVM/BareMetal/VMware, private clouds such as OpenStack, and public clouds such as AWS, Azure, Alibaba Cloud, etc. Cloudpods provides a set of APIs and a web UI dashboard. Cloudpods hides the differences of underlying resources, and makes it easy to build PaaS services and applications across multi-cloud/hybrid-cloud platforms.\nFeatures Here are some highlight features of Cloudpods:\n A self-contained light-weight private cloud that manages KVM hypervisor in scale A self-contained BareMetal cloud that automates the full life-cycle management of baremetal physical machines A self-contained VMware vSphere management platform that enables self-service and automation A multi-cloud solution that is able to manage a wide range of major cloud providers, including private cloud, such as OpenStack, and public clouds, such as AWS, Azure, Google Cloud, Alibaba Cloud, Tencent Cloud, Huawei Cloud, etc. A full set of feature-rich APIs to access a wide range of the IaaS resources from platforms above with consistent resource models and APIs A multi-tenancy RBAC-enabled identity and access management system A multi-cloud image management system that automates image conversion between different cloud platforms The platform adopted a cloud native architecture and run in Kubernetes cluster and support high availability deployment  ","excerpt":"Welcome the documentation of Cloudpods.\nWhat is Cloudpods? Cloudpods …","ref":"/v3.6/en/docs/","title":"Welcome to Cloudpods documentation"},{"body":"","excerpt":"","ref":"/v3.6/zh/search/","title":"Search Results"},{"body":"","excerpt":"","ref":"/v3.6/zh/blog/","title":"Cloudpods 博客"},{"body":"欢迎查看 Cloudpods 文档，本文档会介绍 Cloudpods 服务安装部署、资源操作管理和开发贡献等内容。\n什么是 Cloudpods? Cloudpods 是一个开源的多云平台。构建在用户分布于多云基础设施之上，通过技术手段将分布于多云的异构IT资源统一管理，将多底层多云的差异向用户屏蔽，并通过网络和调度实现资源的融合与打通，在多云之上进行抽象，向用户呈现统一的使用界面和API接口，让用户就像使用一个云平台一样使用分布于多云的资源，实现一个统一的“云上之云”的云平台。\nCloudpods 具备以下功能特性:\n  多云资源统一管理\n统一API、镜像、调度、账号体系、监控和计费等操作，能够全面管理 On premises、 私有云、公有云资源。\n  内置私有云\nCloudpods内置完备的私有云实现，提供对用户本地IDC的虚拟机、物理机和负载均衡等资源管理。\n  为多云Kubernetes提供运行环境\nCloudpods自身为运行在Kubernetes的云原生应用，并且能在多云环境部署运行Kubernetes集群。\n  从哪开始? 文档分为以下部分：\n  快速开始: 快速搭建部署服务\n  安装部署: 详细介绍安装和部署 Cloudpods 各个服务与组件\n  开发相关: 搭建开发环境，提交 PR\n  操作管理: 介绍如何操作云平台资源和管理服务\n  ","excerpt":"欢迎查看 Cloudpods 文档，本文档会介绍 Cloudpods 服务安装部署、资源操作管理和开发贡献等内容。 …","ref":"/v3.6/zh/docs/","title":"欢迎来到Cloudpods"}]