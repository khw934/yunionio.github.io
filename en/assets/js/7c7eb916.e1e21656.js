"use strict";(self.webpackChunkdocs_new=self.webpackChunkdocs_new||[]).push([[1577],{15376:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>r,contentTitle:()=>l,default:()=>u,frontMatter:()=>a,metadata:()=>i,toc:()=>c});var s=t(85893),o=t(11151);const a={edition:"ce",sidebar_position:25},l="Uninstall",i={id:"operations/uninstallation",title:"Uninstall",description:"The uninstallation methods vary depending on the platforms installation method, as follows.",source:"@site/i18n/en/docusaurus-plugin-content-docs/current/operations/uninstallation.md",sourceDirName:"operations",slug:"/operations/uninstallation",permalink:"/en/docs/operations/uninstallation",draft:!1,unlisted:!1,editUrl:"https://github.com/yunionio/website/tree/master/docs/operations/uninstallation.md",tags:[],version:"current",sidebarPosition:25,frontMatter:{edition:"ce",sidebar_position:25},sidebar:"tutorialSidebar",previous:{title:"Changing Node IP",permalink:"/en/docs/operations/change-node-ip"},next:{title:"Development",permalink:"/en/docs/development/"}},r={},c=[{value:"Ocboot Quick Installation",id:"ocboot-quick-installation",level:2},{value:"Kubernetes Helm Installation",id:"kubernetes-helm-installation",level:2},{value:"Docker Compose Installation",id:"docker-compose-installation",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",p:"p",pre:"pre",...(0,o.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"uninstall",children:"Uninstall"}),"\n",(0,s.jsx)(n.p,{children:"The uninstallation methods vary depending on the platforms installation method, as follows."}),"\n",(0,s.jsx)(n.h2,{id:"ocboot-quick-installation",children:"Ocboot Quick Installation"}),"\n",(0,s.jsx)(n.p,{children:"Ocboot Quick Installation means installing a Kubernetes cluster on the server in an All in One manner, and then deploying Cloudpods in the cluster. Therefore, uninstalling Cloudpods only requires uninstalling the installed Kubernetes cluster and related packages on the server."}),"\n",(0,s.jsx)(n.p,{children:"Commands to uninstall Kubernetes services on the server:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"$ ocadm reset --force\n$ kubeadm reset --force\n$ ipvsadm --clear\n"})}),"\n",(0,s.jsx)(n.p,{children:"Stop and disable related services:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"$ systemctl disable --now docker.socket docker kubelet yunion-executor\n"})}),"\n",(0,s.jsx)(n.p,{children:"Uninstall packages such as kubelet and yunion-executor, and remove the related data directories. Take CentOS as an example:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"$ rpm -qa |grep kube |xargs -I {} yum -y remove {} \n$ rpm -qa |grep yunion |xargs -I {} yum -y remove {}\n$ rm -rf /etc/kubernetes/ /var/lib/etcd/ /root/.kube/ /opt/cloud/\n"})}),"\n",(0,s.jsx)(n.p,{children:"Uninstall the database:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'$ yum -y remove mariadb*\n$ rm -rf /var/lib/mysql  # Retain the original data by executing mv -f /var/lib/mysql /var/lib/mysql.$(date +"%Y%m%d-%H%M").bak\n$ rm -rf /etc/my.conf\n'})}),"\n",(0,s.jsx)(n.p,{children:"Reboot the machine to restore the previous network:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"$ reboot\n"})}),"\n",(0,s.jsx)(n.p,{children:"Uninstall Openvswitch (restart first, then uninstall openvswitch to avoid possible network disconnection). The command is as follows:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"$ systemctl disable --now openvswitch\n$ yum -y remove openvswitch-*\n$ rm -rf /etc/openvswitch\n"})}),"\n",(0,s.jsx)(n.h2,{id:"kubernetes-helm-installation",children:"Kubernetes Helm Installation"}),"\n",(0,s.jsx)(n.p,{children:"Use the following command to uninstall:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"helm uninstall -n onecloud  default\n"})}),"\n",(0,s.jsx)(n.h2,{id:"docker-compose-installation",children:"Docker Compose Installation"}),"\n",(0,s.jsx)(n.p,{children:"Use the following command to uninstall:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"docker compose down\n"})})]})}function u(e={}){const{wrapper:n}={...(0,o.a)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},11151:(e,n,t)=>{t.d(n,{Z:()=>i,a:()=>l});var s=t(67294);const o={},a=s.createContext(o);function l(e){const n=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:l(e.components),s.createElement(a.Provider,{value:n},e.children)}}}]);