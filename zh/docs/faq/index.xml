<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Cloudpods –
常见问题</title><link>https://www.cloudpods.org/zh/docs/faq/</link><description>Recent content in 常见问题 on Cloudpods</description><generator>Hugo -- gohugo.io</generator><lastBuildDate>Thu, 29 Aug 2019 22:01:30 +0800</lastBuildDate><atom:link href="https://www.cloudpods.org/zh/docs/faq/index.xml" rel="self" type="application/rss+xml"/><item><title>Docs: 快速入门</title><link>https://www.cloudpods.org/zh/docs/faq/intro/</link><pubDate>Thu, 29 Aug 2019 18:50:55 +0800</pubDate><guid>https://www.cloudpods.org/zh/docs/faq/intro/</guid><description>
&lt;h2 id="本产品可以解决的问题">本产品可以解决的问题？&lt;/h2>
&lt;ul>
&lt;li>云化企业私有基础设施
&lt;ul>
&lt;li>虚拟化平台（KVM、VMware）云化管理&lt;/li>
&lt;li>物理资源的云化管理&lt;/li>
&lt;li>生产级Kubernetes运行环境（网络和存储方案）&lt;/li>
&lt;li>轻量级产品化私有云交付&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>统一多云环境
&lt;ul>
&lt;li>统一裸机和虚拟机镜像&lt;/li>
&lt;li>统一API&lt;/li>
&lt;li>统一监控告警&lt;/li>
&lt;li>统一计费&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>解决企业跨云痛点
&lt;ul>
&lt;li>便捷的跨云迁移&lt;/li>
&lt;li>跨云帐号体系安全&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>业务视角的资源管理
&lt;ul>
&lt;li>基于项目的资源管理&lt;/li>
&lt;li>对接企业LDAP&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="产品架构及功能有哪些">产品架构及功能有哪些？&lt;/h2>
&lt;p>多云运维管理平台产品结构图如下所示：&lt;br>
&lt;img src="../image/%E6%9E%B6%E6%9E%84%E5%9B%BE.png" alt="">&lt;/p>
&lt;ul>
&lt;li>
&lt;p>在Cloudpods主要解决提供以下主要功能：&lt;/p>
&lt;ul>
&lt;li>VMware，KVM和裸机等计算资源的统一纳管(批量创建/删除/监控等) ；&lt;/li>
&lt;li>KVM，VMware，Kubernetes等计算节点的自动部署扩容；&lt;/li>
&lt;li>基于扁平网络的自动化IP地址管理；&lt;/li>
&lt;li>跨平台的统一镜像支持；&lt;/li>
&lt;li>支持复杂调度策略，满足企业对计算资源分配的复杂需求；&lt;/li>
&lt;li>资源创建的自动化流程；&lt;/li>
&lt;li>支持实时监控宿主机与云资源的CPU、内存、存储使用率等；&lt;/li>
&lt;li>支持对虚拟机和裸金属的生命周期管理；&lt;/li>
&lt;li>账号体系与企业现有账号体系（LDAP）对接；&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>基于项目的多租户体系与工单自助服务；&lt;/p>
&lt;ul>
&lt;li>支持监控告警等。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="云管平台能干什么">云管平台能干什么？&lt;/h2>
&lt;p>Cloudpods管理平台是混合云环境中统一管理服务和资源的运维系统，全面纳管公有云，私有云，混合云资源。是您多云时代的最佳云计算合作伙伴。&lt;/p>
&lt;ul>
&lt;li>云管平台支持实时监控基础设施中物理资源的使用情况以及公有云账户余额状态，当余额不足或资源不够时，云管平台将立即向管理源发送告警信息；&lt;/li>
&lt;li>云管平台内置镜像市场功能，用户可快速导入可用镜像创建虚拟机；&lt;/li>
&lt;li>云管平台支持对虚拟机生命管理操作；&lt;/li>
&lt;li>云管平台以项目为单位进行租户隔离，不同项目的用户仅可以看到属于项目中的资源信息；&lt;/li>
&lt;li>云管平台支持安全组、EIP、负载均衡等网络设置，仅需在UI界面上进行鼠标配置，无需复杂繁琐的步骤过程即可快速搭建灵活多样的网络场景；&lt;/li>
&lt;li>云管平台支持部署在Kubernetes集群上，天然具有高可用，水平扩展的能力，灵活控制版本升级回滚等；&lt;/li>
&lt;li>云管平台支持Kubernetes集群管理，支持基于Chart快速编排应用。&lt;/li>
&lt;/ul>
&lt;h2 id="产品特色有哪些">产品特色有哪些？&lt;/h2>
&lt;ul>
&lt;li>统一全面
&lt;ul>
&lt;li>物理机/虚拟机/容器全面纳管&lt;/li>
&lt;li>统一API／镜像／控制台/监控&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>可扩展性架构
&lt;ul>
&lt;li>基于Region和Zone的分层架构，能够在集群、机房、区域等层次平行扩容，支持万台以上宿主机规模；&lt;/li>
&lt;li>支持部署在Kubernetes集群之上，以pod的形式运行Cloudpods的组件，天然具有高可用，水平扩展的能力。&lt;/li>
&lt;li>平台支持KVM、VMware、OpenStack、Kubernetes等不同的资源类型统一管理；&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>便于部署运维
&lt;ul>
&lt;li>支持物理机和宿主机节点自动部署，单台物理机部署时间小于30分钟，大大提升运维效率；&lt;/li>
&lt;li>支持基于扁平网络的IP管理；&lt;/li>
&lt;li>云管平台提供自服务portal，便于用户管理和使用虚拟机和裸金属资源；&lt;/li>
&lt;li>云管平台提供统一的系统监控和展示功能；&lt;/li>
&lt;li>提供统一的镜像支持，不同平台（公有云平台和私有云平台）、不同资源（物理机和虚拟机）可以共享同一个镜像，便于运维标准化；&lt;/li>
&lt;li>支持复杂的调度策略，满足企业对计算资源分配的复杂需求，单台虚拟机创建时间小于1分钟，500台虚拟机并发创建时间小于30分钟；&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>完善的安全设计
&lt;ul>
&lt;li>虚拟机具备完整的物理资源。虚拟机之间、虚拟机和宿主机之间相互隔离，互不影响&lt;/li>
&lt;li>账户采用基于项目的多租户隔离体系，支持跟企业现有账号体系(LDAP/AD)对接，实现资源和运维管理的区分隔离；&lt;/li>
&lt;li>统一账户权限管理体系，降低跨云账户管理安全隐患；&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>开放
&lt;ul>
&lt;li>所有功能都是基于API访问，便于协作，实现IT自动化；&lt;/li>
&lt;li>系统扩展性好，业务部门方便调用；&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="有哪些文档用户应该看什么">有哪些文档？用户应该看什么？&lt;/h2>
&lt;p>有如下文档：&lt;strong>安装部署&lt;/strong>、&lt;strong>管理手册&lt;/strong>、&lt;strong>快速使用&lt;/strong>、&lt;strong>用户手册&lt;/strong>、&lt;strong>常见问题&lt;/strong>、&lt;strong>开发文档&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>安装部署：主要介绍Cloudpods平台容器化部署的安装、系统初始化部署以及升级内容等。&lt;/li>
&lt;li>管理手册：管理手册帮助管理员快速搭建Cloudpods环境，内容涵盖，KVM平台配置、私有云、公有云平台配置、镜像制作、服务配置、climc命令等内容。&lt;/li>
&lt;li>快速使用：帮助普通用户快速使用Cloudpods平台虚拟机以及相关功能等。&lt;/li>
&lt;li>用户手册：供管理员和普通用户使用，用户手册涵盖系统所有功能的使用步骤、注意事项以及参数说明等内容。&lt;/li>
&lt;li>常见问题：摘选出用户在实际使用过程中的常见问题集锦，并给出解决方案。&lt;/li>
&lt;li>开发文档：面向基于Cloudpods的生态对接与二次开发，主要从API层面带你认识Cloudpods产品，方便云计算配套产品与技术深入对接。&lt;/li>
&lt;/ul>
&lt;p>阅读建议如下：&lt;/p>
&lt;ul>
&lt;li>对于普通用户：
&lt;ul>
&lt;li>首先应该了解IaaS的概念，了解Cloudpods是什么，Cloudpods用途等。&lt;/li>
&lt;li>可参考安装部署手册，快速安装部署云管平台。&lt;/li>
&lt;li>安装成功后，安装管理手册中内容对接多云平台，纳管物理机和宿主机等。&lt;/li>
&lt;li>资源纳管完成后，即可使用普通用户按照快速使用内容使用Cloudpods平台。&lt;/li>
&lt;li>如需功能的详细说明，可参考用户手册。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>对于开发者：
&lt;ul>
&lt;li>可参考开发者手册了解API文档。&lt;/li>
&lt;li>开发者手册和climc命令行工具是必须的工具&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>对于老司机：
&lt;ul>
&lt;li>快速阅读安装部署文档后，按照需求搭建自己的云管平台。&lt;/li>
&lt;li>在使用过程中，遇到问题都可以先参考常见问题。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul></description></item><item><title>Docs: 安装部署</title><link>https://www.cloudpods.org/zh/docs/faq/setup/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://www.cloudpods.org/zh/docs/faq/setup/</guid><description>
&lt;h2 id="产品支持哪些硬件环境">产品支持哪些硬件环境？&lt;/h2>
&lt;p>支持带硬件虚拟化特性的x86服务器(机架、刀片、塔式、整机柜)、工作站或台式机，支持主流的Intel或AMD的处理器。&lt;/p>
&lt;h2 id="产品支持在哪些操作系统上直接部署">产品支持在哪些操作系统上直接部署？&lt;/h2>
&lt;p>目前Cloudpods支持在CentOS 7.x操作系统上部署，使用安装脚本自动安装部署。&lt;/p>
&lt;h2 id="安装部署产品需要多少台机器">安装部署产品需要多少台机器？&lt;/h2>
&lt;p>Cloudpods最小安装只需要一台机器，同时作为管理节点和计算节点；&lt;/p>
&lt;p>生产环境建议分离部署，Cloudpods只需一台管理节点，就可以管控基础设施。&lt;/p>
&lt;h2 id="安装部署产品的机器的最低配置要求多少">安装部署产品的机器的最低配置要求多少？&lt;/h2>
&lt;p>8核CPU、16GB内存、200GB存储空间。最低配置仅适用于测试环境。&lt;/p>
&lt;h2 id="能在产品的虚拟机上安装控制节点吗">能在产品的虚拟机上安装控制节点吗？&lt;/h2>
&lt;p>可以。如果为管理节点建议虚拟机配置CPU核数≥8，内存≥16GB，否则可能遇到安装卡顿等问题。&lt;/p>
&lt;h2 id="多节点部署可以有节点使用虚拟机吗">多节点部署可以有节点使用虚拟机吗？&lt;/h2>
&lt;p>可以，建议使用虚拟机部署管理节点，配置不低于8核CPU、16GB内存。且虚拟机节点使用桥接与物理服务器网络连通。&lt;/p>
&lt;h2 id="如何安装产品">如何安装产品？&lt;/h2>
&lt;p>支持使用Cloudpods DVD镜像直接安装部署Cloudpods。使用镜像安装Cloudpods的内容请参考《&lt;a href="../../quickstart">安装部署&lt;/a>》&lt;/p>
&lt;h2 id="一键安装产品后启动时间过长怎么办">一键安装产品后，启动时间过长怎么办？&lt;/h2>
&lt;p>管理节点启动时间与节点配置资源有关，在虚拟机上安装Cloudpods才出现时间过长的情况。&lt;/p>
&lt;p>解决方案：建议使用虚拟环境时，配置CPU核数≥8，内存≥16GB。&lt;/p>
&lt;h2 id="如何通过镜像升级现有的产品的控制节点和计算节点">如何通过镜像升级现有的产品的控制节点和计算节点？&lt;/h2>
&lt;ol>
&lt;li>
&lt;p>将新下载的ISO镜像挂载在控制节点或计算节点的/mnt目录下 。&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8f5902;font-style:italic"># 升级操作必须使用非root的任意用户&lt;/span>
$ su yunion
$ sudo mount -o loop Yunion-x86_64-DVD-3.0-x.iso /mnt
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>进入“/mnt/yunion”目录，执行upgrade.sh升级脚本，将自动更新各组件软件，并重启服务。&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ &lt;span style="color:#204a87">cd&lt;/span> /mnt/yunion
$ ./upgrade.sh
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ol></description></item><item><title>Docs: 多云管理</title><link>https://www.cloudpods.org/zh/docs/faq/cloudaccount/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://www.cloudpods.org/zh/docs/faq/cloudaccount/</guid><description>
&lt;h2 id="产品支持对接哪些平台">产品支持对接哪些平台？&lt;/h2>
&lt;p>目前Cloudpods支持对接的私有云平台有VMware、OpenStack、ZStack、DStack；公有云平台有阿里云、AWS、Azure、华为云、腾讯云、UCloud、谷歌云、天翼云、Ecloud。&lt;/p>
&lt;h2 id="管理公有云平台云账号需要什么权限">管理公有云平台，云账号需要什么权限？&lt;/h2>
&lt;p>至少需要所操作资源的管理权限。建议授予云账号平台所有功能的管理权限。&lt;/p>
&lt;h2 id="对接云账号后新建相关资源时为什么不显示云平台">对接云账号后，新建相关资源时为什么不显示云平台？&lt;/h2>
&lt;p>可能有以下原因：&lt;/p>
&lt;ul>
&lt;li>云账号被禁用。&lt;/li>
&lt;li>云账号状态为连接失败或不正常。&lt;/li>
&lt;li>公有云某个区域下没有IP子网和VPC，新建虚拟机时不显示该区域所在的城市。&lt;/li>
&lt;li>从云账号同步下来的宿主机禁用，新建虚拟机时不显示该云平台。&lt;/li>
&lt;/ul>
&lt;p>如不符合以上原因，请联系我们售后人员进行排查。&lt;/p>
&lt;h2 id="在其他云平台关闭虚拟机电源在平台上该虚拟机过了十分钟左右仍然显示-运行中是什么原因">在其他云平台关闭虚拟机电源，在平台上该虚拟机过了十分钟左右仍然显示 运行中，是什么原因？&lt;/h2>
&lt;p>Cloudpods平台不会实时与其它平台进行同步更新，建议用户都使用Cloudpods平台进行管理操作。不要跨两个平台分别进行操作。&lt;/p>
&lt;p>Cloudpods平台与其它云平台同步机制如下：&lt;/p>
&lt;ol>
&lt;li>自动同步，用户在添加云账号时或对已纳管的云账号进行“设置自动同步”操作实现定期的状态同步。&lt;/li>
&lt;li>手动同步，支持对云账号或单个资源进行状态同步。用户可以单击资源操作列的 &lt;strong>&lt;em>&amp;ldquo;同步状态&amp;rdquo;&lt;/em>&lt;/strong> 按钮，实现主动同步单个资源的状态。&lt;/li>
&lt;/ol>
&lt;h2 id="如何删除一个已经同步导入资源信息的云账号">如何删除一个已经同步导入资源信息的云账号？&lt;/h2>
&lt;p>在云管平台上添加云账号，并执行全量同步操作后，会导入云账号下的资源信息，如虚拟机、EIP、VPC等。删除云账号时由于云管平台上存在由该云账号导入的资源，所以无法删除云账号，需要先删除该云账号关联的资源，才可以删除云账号，然而该操作比较麻烦。由此，云管平台提供了删除云账号的脚本clean_provider.sh，该脚本将会自动遍历云账号导入的所有资源信息，逐个删除相应的数据库记录，最终删除云账号。&lt;/p>
&lt;p>通过ssh远程连接控制节点，执行以下命令：&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ &lt;span style="color:#204a87">export&lt;/span> &lt;span style="color:#000">API_VERSION&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>V2 &lt;span style="color:#8f5902;font-style:italic">#脚本使用V2版本的API，所以需要显式声明&lt;/span>
$ &lt;span style="color:#204a87">cd&lt;/span> /opt/yunion/scripts/tools/
$ ./clean_provider.sh &amp;lt;provider_id_or_name&amp;gt;
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="如何设置openstack的虚拟机免密登陆">如何设置OpenStack的虚拟机免密登陆？&lt;/h2>
&lt;p>在云管平台中需要把OpenStack虚拟机所在的VPC中direct值设置为true，然后在平台中设置免密登陆成功，再安装监控agent。&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ &lt;span style="color:#204a87">source&lt;/span> &amp;lt;&lt;span style="color:#ce5c00;font-weight:bold">(&lt;/span>ocadm cluster rcadmin&lt;span style="color:#ce5c00;font-weight:bold">)&lt;/span>
$ climc server-show 虚拟机名称 &lt;span style="color:#000;font-weight:bold">|&lt;/span> grep vpc_id &lt;span style="color:#8f5902;font-style:italic"># 查看虚拟机所在vpc的id&lt;/span>
$ climc vpc-update --direct vpc_id &lt;span style="color:#8f5902;font-style:italic"># vpc_id为上述查询的值&lt;/span>
&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Docs: 资源同步不下来问题排查</title><link>https://www.cloudpods.org/zh/docs/faq/sync/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://www.cloudpods.org/zh/docs/faq/sync/</guid><description>
&lt;h2 id="检查账号权限">检查账号权限&lt;/h2>
&lt;ul>
&lt;li>打开云账号详情标签页, 查看是否有截图中提示的缺少权限&lt;/li>
&lt;/ul>
&lt;p>&lt;img src="../image/lake_of_permission.png" alt="">&lt;/p>
&lt;h2 id="检查云订阅是否被禁用">检查云订阅是否被禁用&lt;/h2>
&lt;p>&lt;img src="../image/cloudprovider_disabled.png" alt="">&lt;/p>
&lt;h2 id="检查资源所在的云订阅区域是否被禁用-同时查看同步时间若长时间未同步可以先手动同步下">检查资源所在的云订阅区域是否被禁用, 同时查看同步时间，若长时间未同步，可以先手动同步下&lt;/h2>
&lt;p>&lt;img src="../image/cloudprovider_region_disabled.png" alt="">&lt;/p>
&lt;h2 id="检查同步参数skip_server_by_sys_tag_keys">检查同步参数skip_server_by_sys_tag_keys&lt;/h2>
&lt;pre>&lt;code># 此参数含义是若有公有云虚拟机带有特定系统标签, 则跳过此虚拟机同步，目前默认跳过阿里云弹性伸缩组相关实例
$ climc service-config-show region2 | grep skip_server_by_sys_tag_keys
&amp;quot;skip_server_by_sys_tag_keys&amp;quot;: &amp;quot;acs:autoscaling:scalingGroupId&amp;quot;,
# 若需要同步弹性伸缩组实例，可将此参数改为其他标签
$ climc service-config --config skip_server_by_sys_tag_keys=other-tag region2
# 同时可以检查下skip_server_by_user_tag_keys设置
# 此参数含义是若有公有云虚拟机带有特定自定义标签, 则跳过此虚拟机同步
&lt;/code>&lt;/pre></description></item><item><title>Docs: 资源纳管</title><link>https://www.cloudpods.org/zh/docs/faq/heterresource/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://www.cloudpods.org/zh/docs/faq/heterresource/</guid><description>
&lt;h2 id="支持哪些虚拟化平台">支持哪些虚拟化平台？&lt;/h2>
&lt;p>支持管理KVM、VMware等虚拟化平台，同时支持阿里云、腾讯云等公有云平台&lt;/p>
&lt;h2 id="支持哪些类别的裸金属服务器">支持哪些类别的裸金属服务器？&lt;/h2>
&lt;p>目前主要支持x86服务器，如Intel与AMD平台的物理服务器。&lt;/p>
&lt;h2 id="vmware-esxi设置虚拟机嵌套虚拟化的方法">VMware ESXi设置虚拟机嵌套虚拟化的方法？&lt;/h2>
&lt;p>在Cloudpods平台上创建虚拟化平台未VMware的虚拟机默认无法嵌套虚拟化，需要在VMware上配置虚拟机的嵌套虚拟化。设置方法如下：&lt;/p>
&lt;ul>
&lt;li>
&lt;p>修改ESXi宿主机上的配置文件，使所有在宿主机上创建的虚拟机都支持嵌套虚拟化。&lt;/p>
&lt;ol>
&lt;li>通过ssh服务远程连接VMware ESXi主机，在/etc/vmware/config文件的末尾添加vhv.enable = “TRUE” 命令。&lt;/li>
&lt;li>重启ESXi宿主机。若vCenter部署在ESXi宿主机，重启ESXi宿主机可能会出现vCenter无法访问的问题，请谨慎操作。由于ESXi重启，ESXi上的所有虚拟机都会关机，需要手动启动vCenter虚拟机。等待一段时间后，vCenter才可以正常访问。&lt;/li>
&lt;/ol>
&lt;/li>
&lt;li>
&lt;p>通过在vSphere上修改虚拟机的设置，对单个服务器启用嵌套虚拟化。&lt;/p>
&lt;ol>
&lt;li>将需要启用嵌套虚拟化的虚拟机关机。&lt;/li>
&lt;li>在vSphere控制台上选择该虚拟机，进入虚拟机详情页面。&lt;/li>
&lt;li>单击虚拟机名称右侧的 &lt;strong>&lt;em>&amp;ldquo;操作&amp;rdquo;&lt;/em>&lt;/strong> 按钮，选择下拉菜单 &lt;strong>&lt;em>&amp;ldquo;编辑设置&amp;rdquo;&lt;/em>&lt;/strong> 菜单项，弹出编辑设置对话框。&lt;/li>
&lt;li>在虚拟硬件页签中展开CPU配置项，在硬件虚拟化列勾选”向客户机操作系统公开硬件辅助的虚拟化“，单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮。&lt;/li>
&lt;/ol>
&lt;p>&lt;img src="../image/VMware.png" alt="">&lt;/p>
&lt;/li>
&lt;li>
&lt;p>通过在vSphere上替换虚拟机的配置文件（xxx.vmx），启用单个服务器的嵌套虚拟化。该步骤较为复杂，请优先用上一种。&lt;/p>
&lt;ol>
&lt;li>将需要启用嵌套虚拟化的虚拟机关机。&lt;/li>
&lt;li>在vSphere上查看并复制指定虚拟机的配置文件（虚拟机详情-编辑设置-虚拟机选项-常规选项）。&lt;/li>
&lt;li>在存储-文件中搜索配置文件，并将配置文件下载到本地。&lt;/li>
&lt;li>在配置文件的末尾尾添加vhv.enable = “TRUE” 命令，保存配置文件。&lt;/li>
&lt;li>将修改后的配置文件上传到对应目录下替换原来的配置文件。&lt;/li>
&lt;li>启动虚拟机，在vSphere上虚拟机详情-摘要-虚拟机硬件-CPU中可以查看到硬件虚拟化已开启。&lt;/li>
&lt;/ol>
&lt;/li>
&lt;/ul>
&lt;h2 id="如何在bios打开硬件虚拟化支持">如何在BIOS打开硬件虚拟化支持？&lt;/h2>
&lt;p>BIOS中默认开启硬件虚拟化支持。如果有修改，需要在BIOS中打开Intel Virtual Technology或Secure Virtual Machine选项，保存并退出。&lt;/p>
&lt;h2 id="如何指定宿主机的启动内核">如何指定宿主机的启动内核？&lt;/h2>
&lt;ol>
&lt;li>
&lt;p>首先通过以下命令查看当前宿主机的启动内核：&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ uname -r
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>通过以下命令查看宿主机上所有可用内核：&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ grep &lt;span style="color:#4e9a06">&amp;#39;^menuentry&amp;#39;&lt;/span> /boot/grub2/grub.cfg
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="../image/hostkernel.png" alt="">&lt;/p>
&lt;/li>
&lt;li>
&lt;p>如上图，当前宿主机的启动内核为序号0“3.10.0-957.12.1.el7.x86_64”，内核序号从0开始，依次排序。如需将启动内核指定为“3.10.0-862.14.4.el7.yn20190712.x86_64”，该内核序号为1。则需要修改/etc/default/grub文件，增加或将原来的GRUB_DEFAULT的值改为1。&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ vi /etc/default/grub &lt;span style="color:#8f5902;font-style:italic">#按进入insert模式修改以下内容&lt;/span>
&lt;span style="color:#000">GRUB_DEFAULT&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> &lt;span style="color:#8f5902;font-style:italic">#修改完成后，按ESC后输入：wq保存配置&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>执行以下命令重新生成启动菜单。&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ grub2-mkconfig -o /boot/grub2/grub.cfg
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>重启宿主机，查看宿主机启动内核是否已修改为“3.10.0-862.14.4.el7.yn20190712.x86_64”。&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ uname -r
&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;img src="../image/hostkernelmodify.png" alt="">&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h2 id="如何将宿主机新的本地磁盘加入存储池用于存储虚拟机的虚拟磁盘">如何将宿主机新的本地磁盘加入存储池，用于存储虚拟机的虚拟磁盘？&lt;/h2>
&lt;ol>
&lt;li>
&lt;p>首先将该磁盘分区格式化，建议用&lt;strong>parted&lt;/strong>进行分区，建议用&lt;strong>ext4&lt;/strong>格式化磁盘。&lt;/p>
&lt;/li>
&lt;li>
&lt;p>格式化完成后，将磁盘挂载在“/opt/cloud/”下的任意目录，并且修改/etc/fstab，将配置持久化fstab中，建议使用磁盘的UUID来指定磁盘，使用blkid命令来获取磁盘UUID。&lt;/p>
&lt;/li>
&lt;li>
&lt;p>以上操作完成后，修改该宿主机的/etc/yunion/host.conf，找到 &lt;strong>local_image_path&lt;/strong> 配置项，将新磁盘的挂载目录路径加入数组中。保存后，重启host服务。&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8f5902;font-style:italic"># 查看host服务所在pod，并删除&lt;/span>
$ kubectl get pods -n onecloud &lt;span style="color:#000;font-weight:bold">|&lt;/span> grep host
$ kubectl delete pod &amp;lt;host-pod-name&amp;gt; -n onecloud
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>如用户没有将磁盘挂载到“/opt/cloud/”目录下，且不想修改挂载目录，可按照下面步骤进行操作。&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8f5902;font-style:italic"># 假设之前挂载目录为“/data/test”，通过mount --bind命令将“/data/test”挂载到“/opt/cloud/test”&lt;/span>
$ mount --bind /data/test /opt/cloud/test
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>并修改/etc/fstab，将配置持久化fstab中。&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">/data/test /opt/cloud/test none defaults,bind &lt;span style="color:#0000cf;font-weight:bold">0&lt;/span> &lt;span style="color:#0000cf;font-weight:bold">0&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>修改该宿主机的/etc/yunion/host.conf，找到 &lt;strong>local_image_path&lt;/strong> 配置项，将新磁盘的挂载目录路径加入数组中。保存后，重启host服务。&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8f5902;font-style:italic"># 查看host和host-image服务所在pod，并删除&lt;/span>
$ kubectl get pods -n onecloud &lt;span style="color:#000;font-weight:bold">|&lt;/span> grep -E &lt;span style="color:#4e9a06">&amp;#39;host|host-image&amp;#39;&lt;/span>
$ kubectl delete pod -n onecloud &amp;lt;host-pod-name&amp;gt; &amp;lt;host-image-pod-name&amp;gt;
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ol>
&lt;div class="alert alert-warning" role="alert">
&lt;h4 class="alert-heading">注意&lt;/h4>
当磁盘挂载到非“/opt/cloud”目录下，且已修改/etc/yunion/host.conf的local_image_path配置项后，此时Cloudpods平台上显示的存储大小可能与存储的真实容量不符。此时用户按照步骤4修改将之前的挂载目录挂载到“/opt/cloud”目录下，宿主机和本地存储的服务将变成离线状态，在Cloudpods平台上删除离线状态的新增的存储，即可恢复正常。
&lt;/div>
&lt;h2 id="如何清理一台已经下线的宿主机上面的虚拟机的记录">如何清理一台已经下线的宿主机上面的虚拟机的记录？&lt;/h2>
&lt;p>在云管平台上删除虚拟机时，控制器会请求虚拟机所在宿主机上的host服务清理虚拟机对应的配置文件和磁盘文件信息，宿主机上清理虚拟机信息成功返回后，控制器才会删除虚拟机对应的数据库记录。&lt;/p>
&lt;p>当宿主机由于异常原因（故障或其他原因）下线时，在云管平台上删除宿主机上的虚拟机时，控制器请求删除虚拟机配置文件等信息无法得到宿主机host服务的响应，将导致虚拟机删除失败。为了删除已下线宿主机上的虚拟机，云管平台Climc命令提供server-purge的接口，在宿主机不可用状态，可以使用server-purge命令清理虚拟机的数据库记录。&lt;/p>
&lt;p>server-purge命令使用如下：&lt;/p>
&lt;p>通过ssh远程连接控制节点，执行以下命令。&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8f5902;font-style:italic"># 模拟宿主机下线操作，将宿主机禁用&lt;/span>
$ climc host-disable &amp;lt;host_id&amp;gt;
&lt;span style="color:#8f5902;font-style:italic"># 删除宿主机上的虚拟机记录 &lt;/span>
$ climc server-purge &amp;lt;server_id&amp;gt;
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="如何快速清理一台已经下线的宿主机上面的数据库记录">如何快速清理一台已经下线的宿主机上面的数据库记录？&lt;/h2>
&lt;p>删除宿主机的数据库记录要求删除宿主机上所有的虚拟机和本地磁盘信息。当宿主机下线时，云管平台无法在界面正常删除虚拟机和本地磁盘，只能在控制节点使用server-purge和disk-purge命令在后台逐个删除，删除操作较为麻烦。为了能快速清理以及下线的宿主机数据库记录，云管平台的控制节点提供了快速清理脚本clean_host.sh。&lt;/p>
&lt;p>使用方法如下：&lt;/p>
&lt;p>通过ssh远程连接控制节点，执行以下命令：&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">kubectl &lt;span style="color:#204a87">exec&lt;/span> -ti -n onecloud &lt;span style="color:#204a87;font-weight:bold">$(&lt;/span>kubectl get pods -n onecloud &lt;span style="color:#000;font-weight:bold">|&lt;/span> grep climc &lt;span style="color:#000;font-weight:bold">|&lt;/span> awk &lt;span style="color:#4e9a06">&amp;#39;{print $1}&amp;#39;&lt;/span>&lt;span style="color:#204a87;font-weight:bold">)&lt;/span> sh &lt;span style="color:#8f5902;font-style:italic"># 进入climc容器执行如下命令&lt;/span>
$ /opt/yunion/scripts/tools/clean_host.sh &amp;lt;host_id&amp;gt;
&lt;/code>&lt;/pre>&lt;/div>&lt;p>如果该宿主机是从物理机转换过来的，还需要重启 baremetal-agent 服务更新记录：&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ kubectl rollout restart deployment -n onecloud default-baremetal-agent
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="为什么物理服务器baremetal无法被云管平台纳管">为什么物理服务器Baremetal无法被云管平台纳管？&lt;/h2>
&lt;p>请检查并确保物理服务器满足以下配置项：&lt;/p>
&lt;ul>
&lt;li>
&lt;p>物理服务器启动方式为legacy bios，而不是uefi。&lt;/p>
&lt;/li>
&lt;li>
&lt;p>服务器支持网络启动，且启动顺序为pxe优先。pxe启动可能需要配置对应网卡，如Dell服务器。&lt;/p>
&lt;/li>
&lt;li>
&lt;p>如果待纳管的物理服务器跟barametal服务端在一个网段内，需要保证两端交换机配置一致，比如端口都设置为access模式，且pvid相同。同时需要启动host服务，并打开dhcp relay功能，使host服务能接收dhcp广播请求并relay到baremetal服务；&lt;/p>
&lt;/li>
&lt;li>
&lt;p>如果待纳管服务器跟baremetal服务端不在一个网段内，需要确保网关交换机或同一网段host服务开启dhcp relay；&lt;/p>
&lt;/li>
&lt;li>
&lt;p>检查ipmi设置，如果使用独立的管理口，需要确保管理口网络能跟baremetal服务端互通，pxe请求也能够到达baremetal服务端；&lt;/p>
&lt;ul>
&lt;li>HP服务器默认未开启IPMI over LAN，需要手动开启，设置方法：登入ILO web管理界面，选择Administration -&amp;gt; Access Settings. 勾选Enable IPMI / DCIM over LAN on port 623。&lt;/li>
&lt;li>Dell/EMC服务器开启IPMI over LAN的方法：登入iDRAC web管理界面，选择iDRAC设置，网络设置，IPMI设置，勾选IPMI over LAN (Enabled)。&lt;/li>
&lt;/ul>
&lt;p>&lt;img src="../image/ipmi.png" alt="">&lt;/p>
&lt;/li>
&lt;li>
&lt;p>云管平台上需要配置物理IP子网网段，具有足够的可用IP地址。一台pxe服务器需要3个IP地址才能完成纳管后系统部署。&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h2 id="为什么将网线插到dell物理服务器第一个网卡可以通过pxe启动而将网线插入其他网卡则不能通过pxe启动">为什么将网线插到Dell物理服务器第一个网卡可以通过PXE启动，而将网线插入其他网卡则不能通过PXE启动？&lt;/h2>
&lt;p>需要启用网卡的PXE启动设置。&lt;/p>
&lt;p>设置方法如下：&lt;/p>
&lt;p>进入Device setting，选择插入网线的网卡，选择NIC Setting，设置PXE启动即可。&lt;/p>
&lt;h2 id="如何设置物理机转换宿主机使用的默认镜像">如何设置物理机转换宿主机使用的默认镜像？&lt;/h2>
&lt;p>Cloudpods平台物理机转换宿主机功能使用的镜像不同于直接从镜像市场导入的镜像，需要由我司专门制作并提供的宿主机镜像（可联系运维人员获取宿主机镜像）。为了方便用户使用，云管平台还提供了物理机转换宿主机时默认镜像配置的功能，默认镜像设置完成后，用户无需考虑选择哪个镜像或网络，只需要选择磁盘RAID配置即可快速将物理机转换为宿主机使用。若物理机不满足磁盘RAID配置条件，用户只能通过自定义设置，手动配置磁盘RAID、选择镜像、设置网络等。&lt;/p>
&lt;div class="alert alert-warning" role="alert">
&lt;h4 class="alert-heading">注意&lt;/h4>
当物理机只存在一个RAID控制器，且该控制器下存在大于等于4块相同配置的磁盘时，磁盘支持”默认配置（最高）冗余“、”RAID-1/RAID-10(2倍冗余)“、”RAID-5(1.x倍冗余)“、”RAID-0(无冗余)“以及自定义配置等选项。用户可直接选择除自定义配置以外的选项快速将物理机转换为宿主机。
&lt;/div>
&lt;p>设置默认镜像步骤如下：&lt;/p>
&lt;ol>
&lt;li>
&lt;p>当获取到物理机转换成宿主机镜像后，需要将其上传到云管平台。&lt;/p>
&lt;/li>
&lt;li>
&lt;p>通过ssh远程连接控制节点，获取宿主机镜像id。&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ climc image-show &amp;lt;image-name&amp;gt; &lt;span style="color:#8f5902;font-style:italic">#获取镜像id&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>使用climc命令在region服务配置中添加”convert_hypervisor_default_template“为宿主机镜像的id信息。&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ climc service-config --config &lt;span style="color:#000">convert_hypervisor_default_template&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>a9b67435-8c08-4063-8ea6-d885ea26aa79 region2
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>设置完成后，用户在云管平台界面上进行将物理机转换为宿主机操作时，当选择”默认配置（最高）冗余“、”RAID-1/RAID-10(2倍冗余)“、”RAID-5(1.x倍冗余)“、”RAID-0(无冗余)“时，将使用默认镜像转换为宿主机。&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h2 id="物理机转换为宿主机时如何设置宿主机双网卡绑定bonding">物理机转换为宿主机时，如何设置宿主机双网卡绑定（bonding）？&lt;/h2>
&lt;p>当在云管平台上将物理机转换为宿主机时，支持界面绑定宿主机网卡。操作步骤如下：&lt;/p>
&lt;div class="alert alert-warning" role="alert">
&lt;h4 class="alert-heading">注意&lt;/h4>
在使用网卡绑定功能时，确保物理机上只有需要绑定的两张网卡与网线连接。若物理机存在两张以上连接网线的网卡，网卡绑定结果不可控，请谨慎操作。
&lt;/div>
&lt;ol>
&lt;li>
&lt;p>在云管平台的物理机页面，单击指定物理机对应操作列 &lt;strong>&lt;em>&amp;ldquo;更多&amp;rdquo;&lt;/em>&lt;/strong> 按钮，选择下拉菜单 &lt;strong>&lt;em>&amp;ldquo;转换为宿主机&amp;rdquo;&lt;/em>&lt;/strong> 菜单项，弹出转换为宿主机对话框。&lt;/p>
&lt;/li>
&lt;li>
&lt;p>设置宿主机类型，磁盘RAID配置选择”自定义配置“后，根据需求配置其他参数，设置网络勾选”启用bonding“，单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮，即可实现将物理机转换为宿主机，将绑定宿主机的双网卡。&lt;br>
&lt;img src="../image/bonding1.png" alt="">&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h2 id="宿主机上gpu卡无法注册成功该怎么解决">宿主机上GPU卡无法注册成功，该怎么解决？&lt;/h2>
&lt;p>可能原因有以下两种：&lt;/p>
&lt;ul>
&lt;li>
&lt;p>宿主机的引导方式为UEFI模式。GPU卡注册需要在内核启动参数中添加相关配置，当宿主机为BIOS引导时，部署脚本将会自动添加，若宿主机为UEFI引导，则需要执行以下命令并进行重启操作。&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ grub2-mkconfig -o /boot/efi/EFI/centos/grub.cfg
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>BIOS未开启vt-d：检查宿主机BIOS是否开启vt-d。&lt;/p>
&lt;/li>
&lt;/ul>
&lt;div class="alert alert-primary" role="alert">
&lt;h4 class="alert-heading">说明&lt;/h4>
BIOS是否开启vt-d的检查方式的&lt;a href="https://stackoverflow.com/questions/51261999/check-if-vt-d-iommu-has-been-enabled-in-the-bios-uefi">参考链接&lt;/a>。
&lt;/div>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8f5902;font-style:italic"># 针对于Intel主机生效，AMD主机可尝试使用&amp;#34;dmesg | grep AMD-Vi&amp;#34;&lt;/span>
$ dmesg &lt;span style="color:#000;font-weight:bold">|&lt;/span> grep DMAR
&lt;/code>&lt;/pre>&lt;/div>&lt;ol>
&lt;li>若执行命令后有显示内容，且最后一行内容为D&lt;code>MAR-IR: Enabled IRQ remapping in &amp;lt;whichever&amp;gt; mode&lt;/code>，表示BIOS已开启vt-d。&lt;/li>
&lt;li>若执行命令后提示错误信息或无信息，表示BIOS未开启vt-d，需要用户在BIOS设置中启用vt-d或X2APIC。不同型号主机启用方式不同，请根据实际情况进行操作。&lt;/li>
&lt;/ol>
&lt;h2 id="托管物理机时报could-not-open-device-at-devipmi0-or-devipmi0-or-devipmidev0-no-such-file-or-directory错误该如何处理">托管物理机时，报“Could not open device at /dev/ipmi0 or /dev/ipmi/0 or /dev/ipmidev/0: No such file or directory”错误，该如何处理？&lt;/h2>
&lt;p>解决方法：需要加载ipmi相关模块。&lt;/p>
&lt;p>在控制节点上执行以下命令：&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ lsmod &lt;span style="color:#000;font-weight:bold">|&lt;/span>grep ^ipmi
$ modprobe ipmi_watchdog
$ modprobe ipmi_poweroff
$ modprobe ipmi_devintf
$ modprobe ipmi_si &lt;span style="color:#8f5902;font-style:italic"># 加载该模块如果没有不影响ipmi的使用（与系统版本有关）&lt;/span>
$ modprobe ipmi_msghandler &lt;span style="color:#8f5902;font-style:italic"># 加载该模块如果没有不影响ipmi的使用&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="导入vmware云账号时如何查看未导入到平台的vmware宿主机的ip地址">导入VMware云账号时，如何查看未导入到平台的VMware宿主机的IP地址？&lt;/h2>
&lt;p>导入VMware云账号时，需要在Cloudpods平台上为VMware宿主机添加IP子网，此时VMware宿主机才可以导入到Cloudpods平台，当不清楚宿主机IP地址时，可通过查看region操作日志的方法获取到宿主机的IP地址。&lt;/p>
&lt;p>操作步骤如下：&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8f5902;font-style:italic"># 查看region所在pod的操作日志并实时输出日志&lt;/span>
$ kubectl get pods -n onecloud &lt;span style="color:#000;font-weight:bold">|&lt;/span>grep region &lt;span style="color:#000;font-weight:bold">|&lt;/span>awk &lt;span style="color:#4e9a06">&amp;#39;{print $1}&amp;#39;&lt;/span> &lt;span style="color:#000;font-weight:bold">|&lt;/span> xargs kubectl logs -n onecloud -f
&lt;span style="color:#8f5902;font-style:italic"># 将region日志信息保存在region文件中&lt;/span>
$ kubectl get pods -n onecloud &lt;span style="color:#000;font-weight:bold">|&lt;/span>grep region &lt;span style="color:#000;font-weight:bold">|&lt;/span>awk &lt;span style="color:#4e9a06">&amp;#39;{print $1}&amp;#39;&lt;/span> &lt;span style="color:#000;font-weight:bold">|&lt;/span> xargs kubectl logs -n onecloud &amp;gt;region1.log
&lt;span style="color:#8f5902;font-style:italic"># 在日志中查看“SyncHosts for provider”字段，该条日志信息将包含宿主机的IP地址。&lt;/span>
$ cat region.log &lt;span style="color:#000;font-weight:bold">|&lt;/span> grep &lt;span style="color:#4e9a06">&amp;#39;yncHosts for provider&amp;#39;&lt;/span>
&lt;span style="color:#ce5c00;font-weight:bold">[&lt;/span>I &lt;span style="color:#0000cf;font-weight:bold">200211&lt;/span> 17:07:46 models.syncOnPremiseCloudProviderInfo&lt;span style="color:#ce5c00;font-weight:bold">(&lt;/span>cloudsync.go:1123&lt;span style="color:#ce5c00;font-weight:bold">)]&lt;/span> SyncHosts &lt;span style="color:#204a87;font-weight:bold">for&lt;/span> provider vm result: removed &lt;span style="color:#0000cf;font-weight:bold">0&lt;/span> failed &lt;span style="color:#0000cf;font-weight:bold">0&lt;/span> updated &lt;span style="color:#0000cf;font-weight:bold">0&lt;/span> failed &lt;span style="color:#0000cf;font-weight:bold">0&lt;/span> added &lt;span style="color:#0000cf;font-weight:bold">0&lt;/span> failed 1&lt;span style="color:#000;font-weight:bold">;&lt;/span>fail to find wire &lt;span style="color:#204a87;font-weight:bold">for&lt;/span> host esix65 10.127.10.178: sql: no rows in result &lt;span style="color:#204a87">set&lt;/span>
&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Docs: 云资源</title><link>https://www.cloudpods.org/zh/docs/faq/cloudresource/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://www.cloudpods.org/zh/docs/faq/cloudresource/</guid><description>
&lt;h2 id="计算资源管理具备哪些能力">计算资源管理具备哪些能力？&lt;/h2>
&lt;p>包括虚拟机和裸金属的生命周期管理，包括创建、修改、删除、启动和关闭等操作。&lt;/p>
&lt;h2 id="存储资源管理具备哪些能力">存储资源管理具备哪些能力？&lt;/h2>
&lt;p>包括虚拟磁盘的创建、挂载、卸载、扩容、删除等操作以及快照的创建、回滚、清除等操作。&lt;/p>
&lt;h2 id="镜像资源管理具备哪些能力">镜像资源管理具备哪些能力?&lt;/h2>
&lt;p>支持对镜像进行创建（从镜像市场导入和上传镜像）、修改、删除等操作，支持分布式镜像缓存和跨平台镜像兼容能力等。&lt;/p>
&lt;h2 id="新建虚拟机场景失败原因汇总">新建虚拟机场景失败原因汇总&lt;/h2>
&lt;h3 id="配额不足">配额不足&lt;/h3>
&lt;p>当错误原因提示“OutQuotaError”时，如下图报错信息。&lt;/p>
&lt;p>&lt;img src="../image/quotaerrormain.png" alt="">
&lt;img src="../image/quotaerror.png" alt="">&lt;/p>
&lt;p>该类报错为创建虚拟机所在项目的配额不足，配额用于人为的控制项目中资源的数量，可在项目详情-配额使用情况中调整资源的配额，或在全局设置中关闭配额检查。&lt;/p>
&lt;p>&lt;strong>调整配额&lt;/strong>&lt;/p>
&lt;p>&lt;img src="../image/adjustquota.png" alt="">&lt;/p>
&lt;p>&lt;strong>关闭配额检查&lt;/strong>&lt;/p>
&lt;p>&lt;img src="../image/quotacheck.png" alt="">&lt;/p>
&lt;h3 id="资源不足">资源不足&lt;/h3>
&lt;p>当错误原因提示“OutofResource”时，该类报错为资源不足与创建虚拟机。需要用户检查宿主机、网络、存储等是否有足够的空间用于创建虚拟机等。&lt;/p>
&lt;h2 id="如何修改已删除主机和云硬盘在回收站的保留时间">如何修改已删除主机和云硬盘在回收站的保留时间？&lt;/h2>
&lt;p>Cloudpods平台提供了主机和硬盘回收站的功能，当将主机和硬盘删除后，主机和硬盘将会在保留在回收站一段时间后自动删除，默认为保留3天。主机在回收站的保留时间可以修改，设置方法如下：&lt;/p>
&lt;p>通过ssh远程连接控制节点，使用climc命令修改主机和硬盘在回收站的保留时间。&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8f5902;font-style:italic"># 修改主机和硬盘的保留时间一周，参数值单位为s，604800 = 7*24*60。&lt;/span>
$ climc service-config --config &lt;span style="color:#000">pending_delete_expire_seconds&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">604800&lt;/span> region2
&lt;/code>&lt;/pre>&lt;/div>&lt;p>设置完成后等待5分钟左右生效。或删除镜像所在pod重启镜像服务。&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ kubectl get pods -n onecloud &lt;span style="color:#000;font-weight:bold">|&lt;/span>grep region
$ kubectl delete pods &amp;lt;region-pod-name&amp;gt; -n onecloud
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="如何修改已删除镜像在回收站的保留时间">如何修改已删除镜像在回收站的保留时间？&lt;/h2>
&lt;p>Cloudpods平台提供了镜像回收站功能，当镜像删除后，镜像将保留在镜像回收站中。在回收站中的镜像不会自动删除，但是可以手动设置镜像在回收站中的保留时间，设置方法如下：&lt;/p>
&lt;p>通过ssh远程连接控制节点，使用climc命令修改镜像在回收站的保留时间。&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8f5902;font-style:italic"># 修改镜像的保留时间一周，参数值单位为s，604800 = 7*24*60。&lt;/span>
$ climc service-config --config &lt;span style="color:#000">pending_delete_expire_seconds&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">604800&lt;/span> glance
&lt;/code>&lt;/pre>&lt;/div>&lt;p>设置完成后，等待5分钟左右生效。或删除镜像所在pod重启镜像服务。&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ kubectl get pods -n onecloud &lt;span style="color:#000;font-weight:bold">|&lt;/span>grep glance
$ kubectl delete pods &amp;lt;glance-pod-name&amp;gt; -n onecloud
&lt;/code>&lt;/pre>&lt;/div>&lt;p>由于Cloudpods平台上无法查看到回收站中镜像的删除时间，所以需要使用climc命令在控制节点上查看镜像自动删除的时间是否符合预期。&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ climc image-show &amp;lt;image-namge/image-id&amp;gt;
&lt;span style="color:#8f5902;font-style:italic"># image-name、image-id为回收站中的镜像名称和id&lt;/span>
Field &lt;span style="color:#000;font-weight:bold">|&lt;/span> Value
auto_delete_at &lt;span style="color:#000;font-weight:bold">|&lt;/span> 2019-08-20T09:14:47.000000Z &lt;span style="color:#8f5902;font-style:italic">#镜像自动删除时间&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="为什么不能打开镜像市场">为什么不能打开镜像市场？&lt;/h2>
&lt;p>常见原因：&lt;/p>
&lt;ol>
&lt;li>服务器时区或时间不对，导致OSS API无法正常工作。&lt;/li>
&lt;li>网络不可访问阿里云OSS（Object Storage Service，对象存储）北京。&lt;/li>
&lt;/ol>
&lt;h2 id="为什么虚拟机系统盘有最小限制">为什么虚拟机系统盘有最小限制？&lt;/h2>
&lt;p>虚拟机系统盘最小值由以下几方面确定的，若同时满足以下3点，系统盘最小值为以下设置值最大值。&lt;/p>
&lt;ol>
&lt;li>制作镜像时设置了系统镜像内分区大小，镜像制作完成后无法更改。&lt;/li>
&lt;li>系统有一个DefaultDiskSizeMB的参数，2.6以前默认是30GB，现已改为默认是10GB，这个参数可以通过配置文件修改。&lt;/li>
&lt;li>公有云对虚拟机的系统盘都有一个最小限制，例如腾讯云的系统盘最小是50GB。&lt;/li>
&lt;/ol>
&lt;h2 id="虚拟机启动失败报错qemu-system-x86_64-cannot-set-up-guest-memory-pcram-cannot-allocate-memory该怎么解决">虚拟机启动失败，报错”qemu-system-x86_64: cannot set up guest memory &amp;lsquo;pc.ram&amp;rsquo;: Cannot allocate memory“，该怎么解决？&lt;/h2>
&lt;p>该问题是由于宿主机内存不够引起的，请增加宿主机内存或关闭宿主机上的其他虚拟机。&lt;/p>
&lt;h2 id="为什么在公有云阿里云平台上创建虚拟机总是失败">为什么在公有云阿里云平台上创建虚拟机总是失败？&lt;/h2>
&lt;p>主要有以下原因：&lt;/p>
&lt;ul>
&lt;li>
&lt;p>阿里云账户余额不足，在云管平台上创建按量付费的主机时，要求阿里云账户余额大于100元。&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">SDK.ServerError
ErrorCode: InvalidAccountStatus.NotEnoughBalance
Message: Your account does not have enough balance.
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>阿里云账户没有授权OSS导入ESC镜像的权限。查看系统日志，可看到如下报错信息。对于这类新接入的阿里云账户，需要在阿里云控制台上为账户添加从OSS导入ECS镜像的角色权限，一般来讲，云管平台会通过阿里云RAM API自动设置权限，若账号无RAM API权限，则需要按下面方法手动授权：&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">SDK.ServerError ErrorCode: NoSetRoletoECSServiceAcount Message: ECS service account Have no right to access your OSS.please attach a role of access your oss to ECS service account.
&lt;/code>&lt;/pre>&lt;/div>&lt;ol>
&lt;li>登录阿里云控制台，选择“监控与管理&amp;gt;访问控制&amp;gt;角色管理”，单击 &lt;strong>&lt;em>&amp;ldquo;新建角色&amp;rdquo;&lt;/em>&lt;/strong> 按钮，弹出设置对话框。&lt;/li>
&lt;li>选择角色类型为“服务角色”、选择类型为“ESC虚拟机”、角色名称设置为AliyunECSImageImportDefaultRole；&lt;/li>
&lt;li>单击 &lt;strong>&lt;em>&amp;ldquo;创建&amp;rdquo;&lt;/em>&lt;/strong> 按钮，创建角色。&lt;/li>
&lt;li>角色创建完成后，进入创建授权策略页面。&lt;/li>
&lt;li>选择“精确授权”，输入策略名称“AliyunECSImageImportRolePolicy”，单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮保存。&lt;/li>
&lt;li>至此，为该账户设置了从OSS导入ESC镜像的权限。&lt;/li>
&lt;/ol>
&lt;/li>
&lt;li>
&lt;p>阿里云账户没有开通OSS服务。&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">oss: service returned error: &lt;span style="color:#000">StatusCode&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>403, &lt;span style="color:#000">ErrorCode&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>UserDisable, &lt;span style="color:#000">ErrorMessage&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>UserDisable
&lt;/code>&lt;/pre>&lt;/div>&lt;p>登录阿里云平台，开通OSS服务。&lt;/p>
&lt;p>&lt;img src="../image/oss.png" alt="">&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h2 id="为什么在云管平台上创建微软azure平台的虚拟机总是失败">为什么在云管平台上创建微软Azure平台的虚拟机总是失败？&lt;/h2>
&lt;p>主要是因为以下原因：&lt;/p>
&lt;ul>
&lt;li>
&lt;p>微软Azure平台套餐中包含对磁盘数量的限制，但是云管平台上的套餐信息只显示CPU和内存的信息。请在创建Azure虚拟机时按照Azure平台上的套餐对磁盘的限制情况设置Azure磁盘数量。&lt;/p>
&lt;p>&lt;img src="../image/Azurepackage.png" alt="">&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h2 id="为什么在云管平台上创建vmware虚拟机时报磁盘错误创建错误">为什么在云管平台上创建VMware虚拟机时报磁盘错误创建错误？&lt;/h2>
&lt;p>可能的原因是esxiagent无法访问ESXi宿主机的端口，需要允许esxiagent能够访问所有被管理的esxi宿主机的如下端口：&lt;/p>
&lt;ul>
&lt;li>TCP 443&lt;/li>
&lt;li>TCP 902&lt;/li>
&lt;/ul>
&lt;p>VMware平台需开放的端口列表可参考&lt;a href="https://docs.vmware.com/en/VMware-vSphere/6.5/com.vmware.vsphere.security.doc/GUID-171B99EA-15B3-4CC5-8B9A-577D8336FAA0.html">VMware官网文档&lt;/a>。&lt;/p>
&lt;h2 id="快照和镜像有什么区别">快照和镜像有什么区别？&lt;/h2>
&lt;p>两者区别如下表所示：&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>操作&lt;/th>
&lt;th>区别&lt;/th>
&lt;th>应用场景&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>快照&lt;/td>
&lt;td>快照保存了主机磁盘在某个时间点的完整状态，不占用太多空间，可以快速创建或者删除。基于快照创建的主机会保留原主机的个性化信息，是原主机的一个完整副本（克隆）。&lt;/td>
&lt;td>数据恢复&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>镜像&lt;/td>
&lt;td>镜像是经过预处理的虚拟机磁盘的副本，预处理包括用户数据清理，磁盘压缩，消除个性化信息（主机ID，密钥）等。&lt;/td>
&lt;td>应用分发&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="为什么在云管平台上创建或纳管的虚拟机中存在注入的公钥文件">为什么在云管平台上创建或纳管的虚拟机中存在注入的公钥文件？&lt;/h2>
&lt;p>&lt;strong>原因&lt;/strong>：虚拟机的公钥文件是由平台注入的，会同时注入一个全局和一个项目级别的公钥文件到虚拟机。私钥存放在控制节点，用户可以通过Climc命令查看密钥文件。&lt;/p>
&lt;pre>&lt;code># 查看注入密钥，--admin表示全局的密钥；--project表示查看项目的密钥。
$ climc sshkeypair-show --admin
$ climc sshkeypair-show --project &amp;lt;project-name&amp;gt;
&lt;/code>&lt;/pre>&lt;p>&lt;strong>应用场景&lt;/strong>：通过注入密钥文件，在云管平台上的虚拟机的Web SSH功能可以以cloudroot用户免密登录到虚拟机。后续平台的自动化运维功能也是基于该功能。&lt;/p>
&lt;h2 id="实例名称同步">实例名称同步&lt;/h2>
&lt;p>平台自3.10开始默认开启实例名称同步, 若云上的实例名称发生变化后，当云账号同步完成资源或者单独指定实例进行状态同步，实例的名称会跟随云上进行同步
可以通过以下命令进行打开或者关闭&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8f5902;font-style:italic"># 开启实例名称同步&lt;/span>
$ climc service-config --config &lt;span style="color:#000">enable_sync_name&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#204a87">true&lt;/span> region2
&lt;span style="color:#8f5902;font-style:italic"># 关闭实例名称同步&lt;/span>
$ climc service-config --config &lt;span style="color:#000">enable_sync_name&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#204a87">false&lt;/span> region2
&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Docs: 容器</title><link>https://www.cloudpods.org/zh/docs/faq/docker/</link><pubDate>Fri, 30 Aug 2019 15:18:35 +0800</pubDate><guid>https://www.cloudpods.org/zh/docs/faq/docker/</guid><description>
&lt;h2 id="容器管理包括哪些内容">容器管理包括哪些内容？&lt;/h2>
&lt;p>包括容器集群、容器服务、容器编排等方面内容。&lt;/p>
&lt;h2 id="支持哪些类型的容器平台">支持哪些类型的容器平台？&lt;/h2>
&lt;p>支持Docker，通过Kubernetes管理Docker，实现监控和生命周期管理。&lt;/p></description></item><item><title>Docs: 网络</title><link>https://www.cloudpods.org/zh/docs/faq/network/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://www.cloudpods.org/zh/docs/faq/network/</guid><description>
&lt;h2 id="网络管理包括哪些内容">网络管理包括哪些内容？&lt;/h2>
&lt;p>主要包括VPC、二层网络、IP子网、预留IP、安全组、EIP、弹性网卡、密钥、域名服务等方面内容。&lt;/p>
&lt;h2 id="产品支持哪些速率的网络接口">产品支持哪些速率的网络接口？&lt;/h2>
&lt;p>支持40G、千兆、万兆等速率的网络接口，实际生产环境建议千兆以上。&lt;/p>
&lt;h2 id="管理网络和数据网络放在一起会影响吗">管理网络和数据网络放在一起会影响吗？&lt;/h2>
&lt;p>建议将管理网络和数据网络分离，提高安全性，合理网络负载分担。如果网络资源不足，可以放在一起。&lt;/p>
&lt;h2 id="产品提供的dhcp服务和目前机房的dhcp是否会出现冲突">产品提供的DHCP服务和目前机房的DHCP是否会出现冲突？&lt;/h2>
&lt;p>Cloudpods的DHCP服务与目前机房已经配置的DHCP服务不冲突，Cloudpods的DHCP广播报文仅对纳管的计算资源生效。但Cloudpods里面的虚拟机使用的网络段不可与当前环境内已经使用的IP范围重叠，如果发生重叠，可能发生IP地址冲突。&lt;/p>
&lt;h2 id="同一个三层网络是否支持设置不同的子网掩码和网关">同一个三层网络是否支持设置不同的子网掩码和网关？&lt;/h2>
&lt;p>支持，管理员可以规划并设置多个IP子网。&lt;/p>
&lt;h2 id="若linux服务器网卡接口名称不是eth0eth1如何将网卡名称改为eth0等">若Linux服务器网卡接口名称不是eth0，eth1…，如何将网卡名称改为eth0等?&lt;/h2>
&lt;p>自CentOS 7、Ubuntu 14.04LTS之后为了让网卡名称在硬件变更（例如增加网卡或减少网卡）前后持久化显示，将使用网卡的BIOS地址命名网卡，这样网卡名称将不再为eth0、eth1…，而是显示为ens192、enp1s等名称。下面以CentOS 7为例介绍如何关闭网卡的持久化命名的功能。&lt;/p>
&lt;ol>
&lt;li>
&lt;p>修改/etc/default/grub文件，在GRUB_CMDLINE_LINUX增加“net.ifnames = 0 biosdevname = 0”的参数。&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#000">GRUB_TIMEOUT&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">5&lt;/span>
&lt;span style="color:#000">GRUB_DISTRIBUTOR&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;&lt;/span>&lt;span style="color:#204a87;font-weight:bold">$(&lt;/span>sed &lt;span style="color:#4e9a06">&amp;#39;s, release .*$,,g&amp;#39;&lt;/span> /etc/system-release&lt;span style="color:#204a87;font-weight:bold">)&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;&lt;/span>
&lt;span style="color:#000">GRUB_DEFAULT&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>saved
&lt;span style="color:#000">GRUB_DISABLE_SUBMENU&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#204a87">true&lt;/span>
&lt;span style="color:#000">GRUB_TERMINAL_OUTPUT&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;console&amp;#34;&lt;/span>
&lt;span style="color:#000">GRUB_CMDLINE_LINUX&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;crashkernel=auto rhgb quiet intel_iommu=on iommu=pt vfio_iommu_type1.allow_unsafe_interrupts=1 rdblacklist=nouveau nouveau.modeset=0 net.ifnames=0 biosdevname=0&amp;#34;&lt;/span>
&lt;span style="color:#000">GRUB_DISABLE_RECOVERY&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;true&amp;#34;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>修改完成后，执行以下命令生成启动文件。&lt;/p>
&lt;ol>
&lt;li>若服务器是BIOS启动，执行以下命令：&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ grub2-mkconfig -o /boot/grub2/grub.cfg
&lt;/code>&lt;/pre>&lt;/div>&lt;ol start="2">
&lt;li>若服务器是UEFI启动，执行以下命令：&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ grub2-mkconfig -o /boot/efi/EFI/centos/grub.cfg
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>重启系统后，查看MAC对应的网卡名称是否已修改为eth0。&lt;/p>
&lt;/li>
&lt;/ol></description></item><item><title>Docs: 认证服务</title><link>https://www.cloudpods.org/zh/docs/faq/keystone/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://www.cloudpods.org/zh/docs/faq/keystone/</guid><description>
&lt;h2 id="认证服务包含哪些内容">认证服务包含哪些内容？&lt;/h2>
&lt;p>主要包括认证源、域、组、用户、项目、角色、权限等方面内容。&lt;/p>
&lt;h2 id="如何调整域配额和项目配额">如何调整域配额和项目配额？&lt;/h2>
&lt;ul>
&lt;li>调整域配额
&lt;ol>
&lt;li>若用户是系统管理员，可直接在管理后台-系统配置-域中调整配额大小。&lt;/li>
&lt;li>若用户是域管理员，若平台启用域配额申请工单流程后，可在控制面板处申请调整域配额大小，等待工单审批通过后，域配额将自动调整。&lt;/li>
&lt;/ol>
&lt;/li>
&lt;li>调整项目配额：
&lt;ol>
&lt;li>若用户是系统管理员或域管理员，可直接在管理后台/域管理后台-系统配置-项目中调整配额大小。&lt;/li>
&lt;li>若用户是项目成员，若平台启用项目配额申请工单流程后，可在控制面板处申请调整项目配额大小，等待工单审批完成后，项目配额将自动调整。&lt;/li>
&lt;/ol>
&lt;/li>
&lt;/ul>
&lt;h2 id="能和adldap连接吗只能用api接口管理用户吗">能和AD/LDAP连接吗？只能用API接口管理用户吗？&lt;/h2>
&lt;p>支持，Cloudpods平台能够和AD/LDAP对接，目前支持对接Microsoft Active Directory、OpenLDAP和FreeIPA。&lt;/p>
&lt;p>支持同时使用API接口和Cloudpods控制台管理用户。&lt;/p></description></item><item><title>Docs: 运维监控</title><link>https://www.cloudpods.org/zh/docs/faq/monitor/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://www.cloudpods.org/zh/docs/faq/monitor/</guid><description>
&lt;h2 id="host服务问题">Host服务问题&lt;/h2>
&lt;h3 id="宿主机安装host服务完成后默认处于禁用状态需要启用后使用宿主机启用方法如下">宿主机安装Host服务完成后，默认处于禁用状态，需要启用后使用。宿主机启用方法如下：&lt;/h3>
&lt;ul>
&lt;li>
&lt;p>在云管平台的宿主机列表中启用该宿主机；&lt;/p>
&lt;/li>
&lt;li>
&lt;p>在控制节点使用climc命令启用该宿主机；&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ climc host-enable id
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="host服务为什么会变成离线">Host服务为什么会变成离线？&lt;/h3>
&lt;p>region的HostPingDetectionTask将超过3分钟未收到ping的host服务置为offline，并将宿主机上的虚拟机状态设置为unknown。&lt;/p>
&lt;h3 id="宿主机的host服务启动失败且报错fail-to-get-network-infono-networks该怎么解决">宿主机的Host服务启动失败，且报错“Fail to get network info：no networks”，该怎么解决？&lt;/h3>
&lt;p>该问题一般是没有为宿主机注册网络，需要在云管平台为宿主机创建一个IP子网或使用Climc命令在控制节点创建一个网络。&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ climc network-create bcast0 host02 10.168.222.226 10.168.222.226 &lt;span style="color:#0000cf;font-weight:bold">24&lt;/span> --gateway 10.168.222.1
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="如何解决qemu版本不匹配的问题">如何解决qemu版本不匹配的问题？&lt;/h2>
&lt;ul>
&lt;li>
&lt;p>现象：使用过程中，启动虚拟机时可能遇到类似这样的错误信息：&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">uses a qcow2 feature which is not supported by this qemu version: QCOW version &lt;span style="color:#0000cf;font-weight:bold">3&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>原因：主要原因是qcow版本不一致。原始的qcow2创建版本使用的qemu-img为较新版本，现在创建时使用的为较旧版本，旧版本不支持新版本。&lt;/p>
&lt;/li>
&lt;li>
&lt;p>解决方案：在拥有较新版本的qemu-img里面进行兼容性转换，例如执行以下命令进行转换，转换完毕后，再重新添加镜像：&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ qemu-img convert -o &lt;span style="color:#000">compat&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>0.10 -f qcow2 -O qcow2 centos6-cloud-init.qcow2 centos-st-ssh-key.qcow2
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h2 id="如何将其它kvm平台上的虚拟机迁移到系统中">如何将其它KVM平台上的虚拟机迁移到系统中？&lt;/h2>
&lt;ol>
&lt;li>通过libvirt导出虚拟机的镜像（.qcow2文件）。&lt;/li>
&lt;li>将镜像上传至一个http服务器中。&lt;/li>
&lt;li>使用Cloudpods镜像服务器导入镜像。&lt;/li>
&lt;li>通过镜像创建虚拟机。&lt;/li>
&lt;li>若原来的虚拟机挂载了云硬盘，可按照以下方式迁移：
&lt;ul>
&lt;li>与上述操作类似，需要先将数据盘生成镜像，同理导入，Cloudpods使用该镜像创建数据
云盘，再将云硬盘挂载到虚拟机即可。&lt;/li>
&lt;li>先在Cloudpods中创建一个相同大小的云硬盘，找到对应的路径，将原云盘数据直接复
制到新的路径下，最后再挂载到虚拟机上。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;h2 id="如何检查一台虚拟机或宿主机是否支持硬件虚拟化">如何检查一台虚拟机或宿主机是否支持硬件虚拟化？&lt;/h2>
&lt;p>在终端中执行egrep &amp;ldquo;vmx|svm&amp;rdquo; /proc/cpuinfo命令，如果有输出代表支持硬件虚拟化。ESXi主机和WIndows系统不支持该命令。&lt;/p>
&lt;h2 id="机房准备断电维护上电后如何自动恢复虚拟机的业务">机房准备断电维护，上电后如何自动恢复虚拟机的业务？&lt;/h2>
&lt;p>当机房需要断电维护时，Cloudpods平台无需任何配置即可实现服务器上电后可以自动恢复虚拟机业务。&lt;/p>
&lt;h2 id="在windows系统的outlook客户端接收的验证邮件或告警邮件乱码没有样式该怎么解决">在Windows系统的Outlook客户端接收的验证邮件或告警邮件乱码，没有样式，该怎么解决？&lt;/h2>
&lt;p>&lt;strong>现象&lt;/strong>&lt;/p>
&lt;p>&lt;img src="../image/emailreason.png" alt="">&lt;/p>
&lt;p>&lt;strong>原因&lt;/strong>&lt;/p>
&lt;p>该问题是由于Outlook客户端设置了“以纯文本格式读取所有标准邮件”，导致html样式的邮件被转换成了文本消息，没有了样式。&lt;/p>
&lt;p>&lt;strong>解决方法&lt;/strong>&lt;/p>
&lt;p>在“Outlook客户端-&amp;gt;文件-&amp;gt;选项-&amp;gt;信任中心-&amp;gt;信任中心设置-&amp;gt;电子邮件安全性”中取消勾选“以纯文本格式读取所有标准邮件”。&lt;/p>
&lt;p>&lt;img src="../image/emailsettingoption.png" alt="">
&lt;img src="../image/emailsecurity.png" alt="">
&lt;img src="../image/emailrtf.png" alt="">&lt;/p>
&lt;h2 id="如何查看系统中常用组件以及常用组件的日志">如何查看系统中常用组件以及常用组件的日志？&lt;/h2>
&lt;p>Cloudpods容器化部署后可通过Kubernetes相关命令查看Cloudpods平台中的系统组件以及组件日志等。&lt;/p>
&lt;h3 id="查看组件pod运行情况">查看组件pod运行情况&lt;/h3>
&lt;p>系统组件都以 k8s pod的形式运行，通过以下命令查看Cloudpods平台的系统组件以及运行情况等。&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8f5902;font-style:italic"># -n表示namespace的意思，目前我们的服务都部署在onecloud namespace下，查看所有组件的pod的运行情况&lt;/span>
$ kubectl get pods -n onecloud
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8f5902;font-style:italic"># -o wide查看pod的更多详细信息，比如运行在哪个节点上&lt;/span>
$ kubectl get pods -n onecloud -o wide
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8f5902;font-style:italic"># 查看指定pod资源的详细信息，如查看region组件的pod的详细信息&lt;/span>
$ kubectl describe pods -n onecloud default-region-759b4bff4c-hpmdd
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8f5902;font-style:italic"># 查看指定主机上运行的所有pod信息&lt;/span>
$ kubectl get pods -n onecloud -o wide --field-selector&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>spec.nodeName&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&amp;lt;host-name&amp;gt;
&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="重启服务">重启服务&lt;/h3>
&lt;p>在Kubernetes集群上，组件pods大部分通过deployment管理的，当删除pod时将会自动重建新的pod，所以重启组件服务时可以直接删除对应组件的pod。&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8f5902;font-style:italic"># 重启web服务，如删除web前端pod&lt;/span>
$ kubectl delete pods &lt;span style="color:#000">$web_pod_name&lt;/span> -n onecloud
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8f5902;font-style:italic"># 重启host服务，如删除所有host pod&lt;/span>
$ kubectl get pods -n onecloud -o wide &lt;span style="color:#000;font-weight:bold">|&lt;/span> grep default-host &lt;span style="color:#000;font-weight:bold">|&lt;/span> awk &lt;span style="color:#4e9a06">&amp;#39;{print #1}&amp;#39;&lt;/span> &lt;span style="color:#000;font-weight:bold">|&lt;/span> xargs kubectl delete pods -n onecloud
&lt;span style="color:#8f5902;font-style:italic"># 重启所有服务，服务都以default开头&lt;/span>
$ kubectl get pods -n onecloud &lt;span style="color:#000;font-weight:bold">|&lt;/span>grep default &lt;span style="color:#000;font-weight:bold">|&lt;/span> awk &lt;span style="color:#4e9a06">&amp;#39;{print $1}&amp;#39;&lt;/span> &lt;span style="color:#000;font-weight:bold">|&lt;/span> xargs kubectl delete pods -n onecloud
&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="更新服务配置并重启服务">更新服务配置并重启服务&lt;/h3>
&lt;p>Cloudpods的所有组件服务都有对应的Configmaps文件保存服务配置，当配置信息需要更改时，可通过以下步骤更新服务配置并使其生效。&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8f5902;font-style:italic"># 以region服务为例更新其configmaps配置信息&lt;/span>
$ kubectl edit configmaps default-region -n onecloud
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8f5902;font-style:italic"># 修改完成后，删除对应服务的pod即可生效&lt;/span>
$ kubectl get pods -n onecloud &lt;span style="color:#000;font-weight:bold">|&lt;/span>grep region
$ kubectl delete &lt;span style="color:#000">$region_pod_name&lt;/span> -n onecloud
&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="查看服务日志">查看服务日志&lt;/h3>
&lt;p>以region组件为例介绍如何查看region组件的日志信息。&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8f5902;font-style:italic"># 首先需要找到region服务所在pod&lt;/span>
$ kubectl get pods -n onecloud &lt;span style="color:#000;font-weight:bold">|&lt;/span>grep region
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8f5902;font-style:italic"># 查看region服务容器的日志，其中-f表示follow，即持续输出日志，类似于journalctl的 -f；--since 5m 表示查看近5分钟的日志信息。按CTRL+C退出日志输出&lt;/span>
$ kubectl logs -n onecloud &lt;span style="color:#000">$region_pod_name&lt;/span> -f --since 5m
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8f5902;font-style:italic"># 查看region容器日志，将最近5分钟的所有日志到region.log&lt;/span>
$ kubectl logs -n onecloud &lt;span style="color:#000">$region_pod_name&lt;/span> --since 5m &amp;gt; region.log
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8f5902;font-style:italic"># 若有些服务有两个容器，如host服务有名称为host和host-image的容器，此时查看容器命令时需要加&amp;#39;-c&amp;#39; 指定查看哪个容器的日志&lt;/span>
$ kubectl logs -n onecloud &lt;span style="color:#000">$host_pod_name&lt;/span> -c host-image -f
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="其它常用管理命令">其它常用管理命令&lt;/h2>
&lt;p>kubectl更多命令请参考&lt;a href="https://kubernetes.io/zh/docs/reference/kubectl/">kubectl官方文档&lt;/a>&lt;/p>
&lt;h3 id="查看平台版本信息">查看平台版本信息&lt;/h3>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8f5902;font-style:italic"># 其中onecloudcluster 可以简写成oc；default为OneCloudCluster的名称；&lt;/span>
$ kubectl get oc -n onecloud default -o go-template --template&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#4e9a06">&amp;#39;{{printf &amp;#34;%s\n&amp;#34; .spec.version}}&amp;#39;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="查看mysql信息">查看MySQL信息&lt;/h3>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8f5902;font-style:italic"># 查看MySQL的配置连接新，其中oc为onecloudcluster；default为oc的名称；grep -A 4即属于匹配后4行数据。&lt;/span>
$ kubectl get oc -n onecloud default -o yaml &lt;span style="color:#000;font-weight:bold">|&lt;/span> grep -A &lt;span style="color:#0000cf;font-weight:bold">4&lt;/span> mysql
&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="查看oc的的api对象信息">查看OC的的API对象信息&lt;/h3>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8f5902;font-style:italic"># 查看OC的运行情况&lt;/span>
$ kubectl get onecloudcluster -n onecloud
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8f5902;font-style:italic"># 以yaml文件的形式查看OC的API对象信息，该信息中包含集群的所有配置信息。&lt;/span>
$ kubeclt get oc -n onecloud -o yaml
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="部署管理工具ocadm的常用管理命令">部署管理工具ocadm的常用管理命令&lt;/h2>
&lt;p>部署管理工具ocadm类似于Kubernetes集群中的kubeadm工具。&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8f5902;font-style:italic"># 创建集群 &lt;/span>
$ ocadm cluster create
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8f5902;font-style:italic"># 查看集群认证信息&lt;/span>
$ ocadm cluster rcadmin
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8f5902;font-style:italic"># 将本地镜像源切换到阿里云镜像源&lt;/span>
$ ocadm cluster update --image-repository registry.cn-beijing.aliyuncs.com/yunionio --wait
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8f5902;font-style:italic"># 将产品升级或回滚到指定版本，当系统镜像源为阿里云镜像源的情况下才可以使用下面的命令升级&lt;/span>
$ ocadm cluster update --version &lt;span style="color:#000">$version&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8f5902;font-style:italic"># 禁用节点的host服务&lt;/span>
$ ocadm node disable-host-agent --node &lt;span style="color:#000">$node_name&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8f5902;font-style:italic"># 启用节点的host服务&lt;/span>
$ ocadm node enable-host-agent --node &lt;span style="color:#000">$node_name&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8f5902;font-style:italic"># 禁用节点的controller服务&lt;/span>
$ ocadm node disable-onecloud-controller --node &lt;span style="color:#000">$node_name&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8f5902;font-style:italic"># 启用节点的controller服务&lt;/span>
$ ocadm node enable-onecloud-controller --node &lt;span style="color:#000">$node_name&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8f5902;font-style:italic"># 禁用Baremetal服务&lt;/span>
$ ocadm baremetal disable --node &lt;span style="color:#000">$node_name&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8f5902;font-style:italic"># 如在node1主机上启用baremetal服务，并监听br0网卡。&lt;/span>
$ ocadm baremetal &lt;span style="color:#204a87">enable&lt;/span> --node node1 --listen-interface br0
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8f5902;font-style:italic"># 在First Node节点获取加入节点的token信息&lt;/span>
$ ocadm token create
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8f5902;font-style:italic"># 在First Node查看token信息&lt;/span>
$ ocadm token list
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8f5902;font-style:italic"># 切换到开源版前端，ce(community edition)为开源版前端；&lt;/span>
$ ocadm cluster update --use-ce --wait
&lt;span style="color:#8f5902;font-style:italic"># 切换到商业版前端，ee(enterprise edition)为商业版前端 &lt;/span>
$ ocadm cluster update --use-ee --wait
&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8f5902;font-style:italic"># 启用itsm组件&lt;/span>
$ ocadm component &lt;span style="color:#204a87">enable&lt;/span> itsm
&lt;span style="color:#8f5902;font-style:italic"># 禁用itsm组件&lt;/span>
$ ocadm component disable itsm
&lt;span style="color:#8f5902;font-style:italic"># 安装失败时清理环境，请谨慎使用该命令&lt;/span>
$ ocadm reset --force
&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Docs: 其他问题</title><link>https://www.cloudpods.org/zh/docs/faq/others/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://www.cloudpods.org/zh/docs/faq/others/</guid><description>
&lt;h2 id="目前支持哪些平台及哪些资源">目前支持哪些平台及哪些资源？&lt;/h2>
&lt;ol>
&lt;li>具体查看我们&lt;a href="../../function_principle/multicloud/">在线版文档&lt;/a>&lt;/li>
&lt;/ol>
&lt;h2 id="企业版和开源版有哪些区别如何安装">企业版和开源版有哪些区别？如何安装？&lt;/h2>
&lt;ol>
&lt;li>具体功能差异可查看&lt;a href="https://www.yunion.cn/comparison-info">在线版文档&lt;/a>&lt;/li>
&lt;li>开源版转化为企业版可参考&lt;a href="../../setup/ce-ee-switch/">在线版文档&lt;/a>&lt;/li>
&lt;li>安装教程具体可参考&lt;a href="../../setup/">在线版文档&lt;/a>&lt;/li>
&lt;/ol>
&lt;h2 id="开源版是否有付费技术支持">开源版是否有付费技术支持？&lt;/h2>
&lt;ol>
&lt;li>有的，支持订阅官方的技术支持，具体信息可查看&lt;a href="https://www.yunion.cn/subscription/index.html">官方网站&lt;/a>&lt;/li>
&lt;/ol>
&lt;h2 id="cloudpods安装后默认用户密码">cloudpods安装后默认用户密码？&lt;/h2>
&lt;ol>
&lt;li>默认用户名：admin、 密码admin@123&lt;/li>
&lt;/ol>
&lt;h2 id="cloudpods支持对物理机的接管吗">cloudpods支持对物理机的接管吗？&lt;/h2>
&lt;ol>
&lt;li>支持的，可以通过ipmi，或者通过物理机的SSH管理IP&lt;/li>
&lt;li>纳管物理机方法可参考&lt;a href="../../function_principle/onpremise/baremetal/create_register_redirect/">在线文档&lt;/a>&lt;/li>
&lt;li>物理机测试方法可参考&lt;a href="../../function_principle/onpremise/baremetal/testcase/">在线文档&lt;/a>&lt;/li>
&lt;/ol>
&lt;h2 id="api-有没有详细点的调用说明">API 有没有详细点的调用说明？&lt;/h2>
&lt;ol>
&lt;li>具体调用方法可参考&lt;a href="../../development/apisdk/01_api/">在线文档&lt;/a>&lt;/li>
&lt;/ol>
&lt;h2 id="cloudpods创建vm提示磁盘不足是必须要在宿主机根目录空间吗">Cloudpods创建vm提示磁盘不足，是必须要在宿主机根目录空间吗？&lt;/h2>
&lt;ol>
&lt;li>虚拟机的数据都在/opt/cloud/workspace下面，可以给/opt单独挂载一个分区不可以做软链接，因为 host 服务跑在容器里，软链接在 容器里不识别或者用mount &amp;ndash;bind方式&lt;/li>
&lt;/ol>
&lt;h2 id="集群k8s证书过期了如何更新">集群k8s证书过期了，如何更新？&lt;/h2>
&lt;ol>
&lt;li>新版本会签发98年的证书。旧版本用kubeadm alpha certs renew all 续期或者升级ocadm，使用ocadm alpha certs renew all续期98年的。&lt;/li>
&lt;li>ocadm 应该只支持 1.15 的 k8s 集群。如果是平台创建的基于虚拟机部署的 k8s 集群，是使用 kubespray 部署的，应该默认还是一年，可以参考&lt;a href="https://github.com/kubernetes-sigs/kubespray/issues/5464#issuecomment-647022647">在线文档&lt;/a>手动更新证书&lt;/li>
&lt;/ol>
&lt;h2 id="为什么部分平台无法纳管">为什么部分平台无法纳管？&lt;/h2>
&lt;ol>
&lt;li>默认我们展示稳定平台对接，具体可参考&lt;a href="../../setup/feature-config/">在线文档&lt;/a>&lt;/li>
&lt;/ol></description></item></channel></rss>