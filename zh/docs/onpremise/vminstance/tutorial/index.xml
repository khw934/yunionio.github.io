<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Cloudpods –
操作指南</title><link>https://www.cloudpods.org/zh/docs/onpremise/vminstance/tutorial/</link><description>Recent content in 操作指南 on Cloudpods</description><generator>Hugo -- gohugo.io</generator><atom:link href="https://www.cloudpods.org/zh/docs/onpremise/vminstance/tutorial/index.xml" rel="self" type="application/rss+xml"/><item><title>Docs: 新建虚拟机</title><link>https://www.cloudpods.org/zh/docs/onpremise/vminstance/tutorial/create/</link><pubDate>Fri, 19 Jul 2019 15:22:33 +0800</pubDate><guid>https://www.cloudpods.org/zh/docs/onpremise/vminstance/tutorial/create/</guid><description>
&lt;h2 id="web界面操作">Web界面操作&lt;/h2>
&lt;ol>
&lt;li>
&lt;p>在虚拟机列表页面，单击列表上方 &lt;strong>&lt;em>&amp;ldquo;新建&amp;rdquo;&lt;/em>&lt;/strong> 按钮，进入新建本地IDC虚拟机页面。&lt;/p>
&lt;/li>
&lt;li>
&lt;p>配置以下参数：&lt;/p>
&lt;ul>
&lt;li>指定项目：管理员和域管理员在新建虚拟机时需要指定虚拟机所属的项目。&lt;/li>
&lt;li>区域：选择区域和可用区。&lt;/li>
&lt;li>名称：设置虚拟机的名称。
&lt;ul>
&lt;li>当设置虚拟机数量大于1时，除第一台虚拟机名称外，其他虚拟机名称都以名称-1~N表示。&lt;/li>
&lt;li>虚拟机和裸金属共用名称空间。名称在系统中唯一。在项目中创建虚拟机报名称重复错误的原因为其他项目中已存在该名称的虚拟机或裸金属。&lt;/li>
&lt;li>名称支持有序后缀占位符#，一个#占一个位置，如名称设置为host##，虚拟机数量为2，创建的虚拟机名称为host00和host01。后续创建虚拟机名称仍设置为host##，名称将沿用之前的排序，编号依次往后。&lt;/li>
&lt;li>名称支持表达式，表达式格式为：${变量}，如${host}，则虚拟机名称显示为创建虚拟机的宿主机的名称。详细说明请参考&lt;a href="#%E4%B8%BB%E6%9C%BA%E5%90%8D%E8%A1%A8%E8%BE%BE%E5%BC%8F%E4%B8%BE%E4%BE%8B%E8%AF%B4%E6%98%8E">主机名表达式举例说明&lt;/a>。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>到期释放：设置新建虚拟机到期释放前的使用时长，超过设置的时间后虚拟机将会被删除放入回收站。默认不设置到期释放，用户可根据需要设置“1小时”、“6小时”、“1天”、“3天”、“1周”、“1月”或自定义使用时长。&lt;/li>
&lt;li>数量：设置创建虚拟机的数量。&lt;/li>
&lt;li>平台（本地IDC）：选择虚拟机所属的平台为Cloudpods&lt;/li>
&lt;li>CPU架构：目前支持x86和ARM架构。仅 Cloudpods 平台支持ARM架构，其他平台默认只支持x86架构。&lt;/li>
&lt;li>是否配置GPU：是否为虚拟机配置GPU卡，启用该项后，还需要选择具体GPU卡。&lt;/li>
&lt;li>CPU核数、内存：设置虚拟机的规格。并可以根据虚拟机规格等选择可用套餐。&lt;/li>
&lt;li>套餐：虚拟机套餐为虚拟机CPU、内存规格的组合搭配，不同套餐价格不同。其中本地IDC和私有云套餐可通过云管平台进行维护，用户创建私有云平台的虚拟机时可以选择本地IDC的套餐或私有云平台的套餐。公有云套餐信息同步对应公有云平台上信息。
&lt;div class="alert alert-warning" role="alert">
&lt;h4 class="alert-heading">注意&lt;/h4>
目前已通过套餐中的CPU架构过滤操作系统镜像。
&lt;/div>
&lt;/li>
&lt;li>操作系统：选择虚拟机的镜像，支持从以下方式获取镜像。镜像下拉列表中包括镜像名称、大小、CPU架构、分区方式、引导方式，并支持选中的镜像引导方式自动选择下面的引导方式。
&lt;ul>
&lt;li>公共镜像：对应系统镜像列表中的公共镜像，一般为系统常用镜像，由管理员维护。&lt;/li>
&lt;li>自定义镜像：对应系统镜像列表中的自定义镜像，一般是由用户上传。&lt;/li>
&lt;li>从ISO启动：对应系统镜像列表中的ISO格式的镜像。选择ISO镜像文件时，需要用户为虚拟机安装操作系统。仅Cloudpods和VMware平台支持。&lt;/li>
&lt;li>主机镜像：对应主机镜像列表中的主机镜像，仅Cloudpods平台支持。&lt;/li>
&lt;li>主机快照：对应主机快照列表中的主机快照，仅Cloudpods和VMware平台支持。
&lt;div class="alert alert-primary" role="alert">
&lt;h4 class="alert-heading">说明&lt;/h4>
通过挂载ISO安装Windows操作系统的虚拟机，安装完成后，还需要安装Virtio驱动，驱动可在镜像市场-ISO中获取。
&lt;/div>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>系统盘：根据选择的套餐情况显示并设置不同的磁盘类型以及磁盘的容量大小。公有云平台不支持设置调度标签
&lt;div class="alert alert-warning" role="alert">
&lt;h4 class="alert-heading">注意&lt;/h4>
&lt;ul>
&lt;li>当操作系统选择”从ISO启动“时，虚拟机上的磁盘类型都显示为数据盘。磁盘类型显示不影响虚拟机的正常使用。&lt;/li>
&lt;li>设置系统盘时，系统将会自动检查所选磁盘类型对应的存储容量是否满足需求。
&lt;ul>
&lt;li>当对应存储剩余容量小于100GB时，将会黄框提醒用户。此时仍可以成功创建磁盘，但是建议用户创建完成后去&lt;a href="../../../storage/block">存储-块存储&lt;/a>页面增加新存储或调整存储容量。&lt;/li>
&lt;li>当对应存储剩余容量不能满足设置的系统盘大小时，将显示红框，并提示用户去&lt;a href="../../../storage/block">存储-块存储&lt;/a>页面增加新存储或调整存储容量。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/div>
&lt;ul>
&lt;li>当不设置调度标签及调度偏好以及指定块存储时，系统将按照调度策略以及调度标签的默认偏好自动为虚拟机选择最优的存储。
&lt;ul>
&lt;li>优先检查系统中的调度策略，当有符合的调度策略，将根据调度策略中设置的调度标签及调度标签偏好选择对应存储。调度策略中的调度标签偏好会覆盖调度标签中的默认策略。&lt;/li>
&lt;li>当没有符合的调度策略后，将根据存储设备中绑定的调度标签的默认策略选择最优存储。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>当设置调度标签和调度标签偏好时，设置的调度标签偏好将覆盖调度标签上的默认策略。根据调度偏好以及调度标签选择提供系统盘的存储。
&lt;ul>
&lt;li>尽量使用（prefer）：调度时优先使用拥有这种标签的存储。&lt;/li>
&lt;li>避免使用（avoid）：调度时尽量避免拥有这种标签的存储。&lt;/li>
&lt;li>禁止使用（exclude）：调度时排除拥有这种标签的存储。&lt;/li>
&lt;li>必须使用（require）：调度时必须使用拥有这种标签的存储。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>举例说明：以本地存储为例，本地存储A绑定调度标签A，调度标签A默认策略为尽量使用。本地存储B绑定调度标签B，调度标签B默认策略为禁止使用。调度策略A为当在项目A中创建虚拟机时，选择调度标签B，调度策略偏好为必须使用。
&lt;ul>
&lt;li>当不设置调度标签时，有以下两种情况。
&lt;ul>
&lt;li>若虚拟机属于项目A，系统将优先选择本地存储B为虚拟机系统盘提供存储。&lt;/li>
&lt;li>当虚拟机不属于项目A，系统将优先选本地存储A为虚拟机系统盘提供存储。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>当设置调度标签为A，策略为禁止使用时，系统将会排除本地存储A，选择本地存储B为虚拟机系统盘提供存储。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>指定块存储：用户在管理后台视图下支持为磁盘指定块存储，并支持查看存储的使用情况等，目前仅VMware平台支持。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>数据盘：可选项，可根据需求添加多块数据盘，设置磁盘的类型及容量大小。磁盘可选类型同系统盘。仅第一块数据盘支持选择磁盘类型，后续添加的数据盘类型同第一块数据盘。
&lt;div class="alert alert-warning" role="alert">
&lt;h4 class="alert-heading">注意&lt;/h4>
添加的数据盘仅挂载到虚拟机上，不会自动执行分区操作，需要用户远程连接虚拟机后手动分区。
&lt;/div>
&lt;ul>
&lt;li>仅Cloudpods平台支持支持设置挂载点、快照建磁盘、设置调度标签。私有云如使用本地存储，也支持设置调度标签功能。
&lt;ul>
&lt;li>设置调度标签：同系统盘。&lt;/li>
&lt;li>设置挂载点：设置数据盘的文件类型（ext4、xfs、swap）、数据盘挂载的非系统目录。设置挂载点和快照建磁盘两者只能设置一个。&lt;/li>
&lt;li>快照建磁盘：根据快照创建数据盘。可在本地IDC中查看已存在的快照。设置挂载点和快照建磁盘两者只能设置一个。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>管理员账号：显示虚拟机的管理员账号&lt;/li>
&lt;li>管理员密码：设置管理员密码，在Linux系统中为root用户的密码，在Windows操作系统中为administrator用户的密码。
&lt;ul>
&lt;li>随机生成：随机生成管理员密码，用户可在虚拟机列表密码列查看复制管理员密码&lt;/li>
&lt;li>关联密钥：在关联密钥之前需要先新建密钥。关联密钥后，用户需要使用私钥远程登录虚拟机。&lt;/li>
&lt;li>保留镜像设置：管理员密码为镜像中已有的管理员密码。&lt;/li>
&lt;li>手工输入：可手动设置管理员密码。
&lt;div class="alert alert-primary" role="alert">
&lt;h4 class="alert-heading">说明&lt;/h4>
&lt;ul>
&lt;li>当选择从ISO启动时，不支持设置管理员密码，管理员密码需要在用户安装操作系统时进行设置。&lt;/li>
&lt;li>根据虚拟机所在平台不同，设置管理员密码的方式可能为以上方式的其中几种，请以界面为准。&lt;/li>
&lt;/ul>
&lt;/div>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>网络：设置虚拟机的IP地址。
&lt;div class="alert alert-warning" role="alert">
&lt;h4 class="alert-heading">注意&lt;/h4>
&lt;ul>
&lt;li>仅Cloudpods虚拟机可以选择default经典网络和VPC网络。&lt;/li>
&lt;li>只有Cloudpods平台虚拟机支持最多添加8个网络，其他平台仅支持一个网络。&lt;/li>
&lt;/ul>
&lt;/div>
&lt;ul>
&lt;li>自动调度：当选择自动调度时，将从启用自动调度的IP子网中为虚拟机分配IP地址。&lt;/li>
&lt;li>指定IP子网：选择VPC和IP子网，如需指定静态IP，可单击 &lt;strong>&lt;em>&amp;ldquo;手动配置IP&amp;rdquo;&lt;/em>&lt;/strong> 按钮，设置IP地址，单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮。&lt;/li>
&lt;li>指定调度标签：设置调度标签以及调度标签偏好。设置的调度标签偏好将会覆盖调度标签上的默认策略。根据调度标签及调度偏好选择最优的IP子网。
&lt;ul>
&lt;li>尽量使用（prefer）：调度时优先使用拥有这种标签的IP子网。&lt;/li>
&lt;li>避免使用（avoid）：调度时尽量避免拥有这种标签的IP子网。&lt;/li>
&lt;li>禁止使用（exclude）：调度时排除拥有这种标签的IP子网。&lt;/li>
&lt;li>必须使用（require）：调度时必须使用拥有这种标签的IP子网。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>举例说明：如IP子网A绑定调度标签A，默认策略为禁止使用。IP子网B绑定调度标签B，默认策略为尽量使用。调度策略A为当虚拟机属于项目A，选择调度标签A，调度标签偏好为必须使用。
&lt;ul>
&lt;li>当创建虚拟机时网络选择默认时，有以下两种情况。
&lt;ul>
&lt;li>当虚拟机属于项目A时，系统将选择IP子网A为虚拟机分配IP地址。&lt;/li>
&lt;li>当虚拟机不属于项目A时，系统将选择IP子网B为虚拟机分配IP地址。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>当创建虚拟机时网络选择指定IP子网A，系统将选择IP子网A为虚拟机分配IP地址。&lt;/li>
&lt;li>当创建虚拟机时网络选择调度标签A，且标签偏好为必须使用，则系统会从IP子网A中为虚拟机分配一个未使用的IP地址。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>标签：支持为新建的虚拟机绑定标签。支持选择已有标签和新建标签。
&lt;ul>
&lt;li>新建标签：单击列表上方 &lt;strong>&lt;em>新建&lt;/em>&lt;/strong> 按钮，设置标签键和标签值，单击 &lt;strong>&lt;em>&amp;ldquo;添加&amp;rdquo;&lt;/em>&lt;/strong> 按钮，新建标签并绑定到资源上。&lt;/li>
&lt;li>选择已有标签：单击 &lt;strong>&lt;em>&amp;ldquo;已有标签&amp;rdquo;&lt;/em>&lt;/strong> 按钮，选择标签键和值。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>&lt;strong>高级配置&lt;/strong>：默认隐藏，可根据需求进行配置。&lt;/p>
&lt;ul>
&lt;li>弹性公网IP：弹性公网IP是一种NAT IP，通过与虚拟机绑定，实现虚拟机与公网之间的通信。默认为暂不绑定，当选择“新建”时，需要配置以下参数：
&lt;ul>
&lt;li>线路类型：可根据需求创建对应线路类型的EIP。&lt;/li>
&lt;li>网络计费方式：设置弹性公网IP的计费方式，包括按流量计费和按带宽计费。
&lt;ul>
&lt;li>按流量计费：按实际传输流量收费，可限制峰值带宽避免意外流量带来的费用，当瞬间带宽超过该值时将丢包，适用于网络波动大的场合。&lt;/li>
&lt;li>按带宽计费：按传输速率计费，选择固定带宽，超过带宽时将丢包，适用于网络波动较小的场景。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>带宽：设置带宽大小。
&lt;div class="alert alert-warning" role="alert">
&lt;h4 class="alert-heading">注意&lt;/h4>
&lt;ul>
&lt;li>本地IDC平台创建VPC网络的虚拟机时支持绑定弹性公网IP，且仅支持按带宽计费；&lt;/li>
&lt;/ul>
&lt;/div>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>安全组：为虚拟机设置安全组规则，安全组是一种虚拟的包过滤防火墙，通过设置安全组规则来控制关联的虚拟机是否可以被访问，以及虚拟机可访问的外部资源等。一个虚拟机最多支持绑定5个安全组。&lt;/li>
&lt;li>调度策略：通过调度策略可以选择虚拟机所属的宿主机或云账号。
&lt;ul>
&lt;li>默认：系统将根据调度策略以及调度标签为虚拟机选择最优的宿主机。
&lt;ul>
&lt;li>优先检查系统中的调度策略，如有符合的调度策略，将根据调度策略中的调度标签及调度标签偏好选择最优的宿主机。调度策略中的调度标签偏好会覆盖调度标签中的默认策略。&lt;/li>
&lt;li>当没有符合的调度策略，系统将根据宿主机绑定的调度标签的默认策略来选择最优的宿主机。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>指定宿主机：虚拟机将在指定的宿主机上创建。&lt;/li>
&lt;li>指定调度标签：设置调度标签以及调度标签的偏好。设置的调度标签偏好将会覆盖调度标签的默认策略。根据调度标签及调度标签偏好选择对应的宿主机。
&lt;ul>
&lt;li>尽量使用（prefer）：调度时优先使用拥有这种标签的宿主机。&lt;/li>
&lt;li>避免使用（avoid）：调度时尽量避免拥有这种标签的宿主机。&lt;/li>
&lt;li>禁止使用（exclude）：调度时排除拥有这种标签的宿主机。&lt;/li>
&lt;li>必须使用（require）：调度时必须使用拥有这种标签的宿主机。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>举例说明：如宿主机A绑定调度标签A，调度标签A的策略为禁止使用。宿主机B绑定调度标签B，调度标签B的策略为尽量使用。调度策略A为当在项目A中创建虚拟机时，选择调度标签A，调度策略偏好为必须使用。
&lt;ul>
&lt;li>当创建虚拟机时调度策略选择默认时，有以下两种情况。
&lt;ul>
&lt;li>当虚拟机属于项目A时，系统将选择在宿主机A上创建虚拟机。&lt;/li>
&lt;li>当虚拟机不属于项目A时，系统将选择宿主机B上创建虚拟机。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>当选择调度标签A，且设置调度标签偏好为必须使用时，系统将选择在宿主机A上创建虚拟机。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>引导方式：包括BIOS和UEFI模式，仅Cloudpods平台支持，且ARM架构仅支持UEFI模式。&lt;/li>
&lt;li>高可用：仅Cloudpods平台支持且要求虚拟机所在域或共享给虚拟机所在域使用的宿主机不低于2台，通过为虚拟机创建备份机来实现高可用，虚拟机与备份机之间定时同步数据，当虚拟机故障时，业务将切换到备份机上正常使用。可以快速恢复业务，减少因为虚拟机故障造成的业务宕机时间。当启用高可用功能时，需要指定备份机的宿主机。&lt;/li>
&lt;li>反亲和组：选择是否勾选反亲和组，若勾选，则需要选择反亲和组，新创建的虚拟机需要根据反亲和组内的调度规则选择宿主机等，若不满足调度规则，则可能创建失败，仅Cloudpods平台支持。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>设置完成后，用户可单击 &lt;strong>&lt;em>新建&lt;/em>&lt;/strong> 按钮，创建虚拟机。&lt;/p>
&lt;/li>
&lt;li>
&lt;p>若启用了工单，则需要填入申请原因，单击 &lt;strong>&lt;em>&amp;ldquo;提交工单&amp;rdquo;&lt;/em>&lt;/strong> 按钮，提交创建虚拟机的工单，等待审批通过后才会开始创建虚拟机。&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h2 id="climc命令行操作">Climc命令行操作&lt;/h2>
&lt;p>&lt;code>climc server-create&lt;/code> 命令提供创建云主机的操作。 Cloudpods 可以同时管理多个私有云和公有云，不同供应商有各自的认证方式，在创建云主机之前需要做一些不同的准备工作。&lt;/p>
&lt;p>创建机器命令为 &lt;code>server-create&lt;/code>，可以使用 &lt;code>climc help server-create&lt;/code> 查看创建 server 的所有参数，常用的参数如下：&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th style="text-align:center">参数名称&lt;/th>
&lt;th style="text-align:center">类型&lt;/th>
&lt;th style="text-align:center">作用&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td style="text-align:center">&amp;ndash;ncpu&lt;/td>
&lt;td style="text-align:center">int&lt;/td>
&lt;td style="text-align:center">虚拟机 cpu 个数&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:center">&amp;ndash;disk&lt;/td>
&lt;td style="text-align:center">[]string&lt;/td>
&lt;td style="text-align:center">指定创建的系统盘镜像，指定多次表示虚拟机创建多块磁盘&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:center">&amp;ndash;net&lt;/td>
&lt;td style="text-align:center">[]string&lt;/td>
&lt;td style="text-align:center">指定虚拟机使用的网络，指定多次将在虚拟机里面添加多个网卡&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:center">&amp;ndash;allow-delete&lt;/td>
&lt;td style="text-align:center">bool&lt;/td>
&lt;td style="text-align:center">允许删除虚拟机&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:center">&amp;ndash;auto-start&lt;/td>
&lt;td style="text-align:center">bool&lt;/td>
&lt;td style="text-align:center">创建完自动启动&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:center">&amp;ndash;password&lt;/td>
&lt;td style="text-align:center">string&lt;/td>
&lt;td style="text-align:center">设置虚拟机密码&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:center">&amp;ndash;tenant&lt;/td>
&lt;td style="text-align:center">string&lt;/td>
&lt;td style="text-align:center">创建到指定的项目&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:center">&amp;ndash;prefer-region&lt;/td>
&lt;td style="text-align:center">string&lt;/td>
&lt;td style="text-align:center">创建到指定的 region&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:center">&amp;ndash;prefer-zone&lt;/td>
&lt;td style="text-align:center">string&lt;/td>
&lt;td style="text-align:center">创建到指定的 zone&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td style="text-align:center">&amp;ndash;prefer-host&lt;/td>
&lt;td style="text-align:center">string&lt;/td>
&lt;td style="text-align:center">创建到指定的 host&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;div class="alert alert-warning" role="alert">
&lt;h4 class="alert-heading">注意&lt;/h4>
&lt;ol>
&lt;li>名称、内存或者套餐类型在创建主机时必须使用;&lt;/li>
&lt;li>系统盘的镜像通过 &lt;code>image-list&lt;/code> 或者 &lt;code>cached-image-list&lt;/code>，公有云的镜像列表通过 &lt;code>cached-image-list&lt;/code> 接口查询，参考: &lt;a href="../../../image/tutorial/query/">查询镜像&lt;/a>;&lt;/li>
&lt;/ol>
&lt;/div>
&lt;p>下面以举例的方式创建机器：&lt;/p>
&lt;p>待创建规格:&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>名称&lt;/th>
&lt;th>平台&lt;/th>
&lt;th>套餐&lt;/th>
&lt;th>内存&lt;/th>
&lt;th>cpu&lt;/th>
&lt;th>系统盘&lt;/th>
&lt;th>网络&lt;/th>
&lt;th>其他&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>vm1&lt;/td>
&lt;td>kvm&lt;/td>
&lt;td>-&lt;/td>
&lt;td>4g&lt;/td>
&lt;td>4&lt;/td>
&lt;td>centos7.qcow2 60g&lt;/td>
&lt;td>net1&lt;/td>
&lt;td>2块数据盘， 一块100g ext4 挂载到 /opt，另外一块 50g xfs 挂载到 /data; 自动启动&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>vm2&lt;/td>
&lt;td>esxi&lt;/td>
&lt;td>-&lt;/td>
&lt;td>2g&lt;/td>
&lt;td>2&lt;/td>
&lt;td>ubuntu18.04.qcow2 100g&lt;/td>
&lt;td>net2&lt;/td>
&lt;td>允许删除&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>vm3&lt;/td>
&lt;td>opnstack&lt;/td>
&lt;td>t2.nano&lt;/td>
&lt;td>-&lt;/td>
&lt;td>-&lt;/td>
&lt;td>centos6.qcow2&lt;/td>
&lt;td>net3&lt;/td>
&lt;td>-&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8f5902;font-style:italic"># 创建 kvm vm1&lt;/span>
$ climc server-create --hypervisor kvm --disk centos7.qcow2:60g --disk 100g:ext4:/opt --disk 50g:xfs:/data --ncpu &lt;span style="color:#0000cf;font-weight:bold">4&lt;/span> --net net1 --auto-start vm1 4g
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="主机名表达式举例说明">主机名表达式举例说明&lt;/h2>
&lt;p>主机（包括虚拟机和裸金属）名称支持表达式，表达式格式为：${变量名}，变量名需要小写。如${host}，则虚拟机名称显示为创建虚拟机的宿主机的名称；${region}-${zone}，则显示为区域名-可用区名称等。&lt;/p>
&lt;p>支持的变量名如下：&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>变量名&lt;/th>
&lt;th>举例&lt;/th>
&lt;th>说明&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>brand&lt;/td>
&lt;td>aliyun&lt;/td>
&lt;td>品牌&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>charge_type&lt;/td>
&lt;td>postpaid&lt;/td>
&lt;td>计费方式&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>cloud_env&lt;/td>
&lt;td>onpremise/public/private&lt;/td>
&lt;td>用于区分本地IDC、私有云和公有云平台&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>cloudregion_id&lt;/td>
&lt;td>default&lt;/td>
&lt;td>区域id&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>cpu&lt;/td>
&lt;td>1&lt;/td>
&lt;td>CPU数量&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>host&lt;/td>
&lt;td>gobuild&lt;/td>
&lt;td>主机名&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>host_id&lt;/td>
&lt;td>16f49f8a-88cc-4715-8870-f78130196fa9&lt;/td>
&lt;td>主机id&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>ip_addr&lt;/td>
&lt;td>192.168.1.1&lt;/td>
&lt;td>IP地址&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>mem&lt;/td>
&lt;td>1024&lt;/td>
&lt;td>内存&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>os_distribution&lt;/td>
&lt;td>操作系统&lt;/td>
&lt;td>CentOS&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>os_type&lt;/td>
&lt;td>Linux&lt;/td>
&lt;td>操作系统类型&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>os_version&lt;/td>
&lt;td>6.9&lt;/td>
&lt;td>操作系统版本&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>owner_tenant&lt;/td>
&lt;td>system&lt;/td>
&lt;td>项目&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>owner_tenant_id&lt;/td>
&lt;td>d56f5c37e36a42b782d7f32b19497c4c&lt;/td>
&lt;td>项目id&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>provider&lt;/td>
&lt;td>OpenStack&lt;/td>
&lt;td>提供方&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>region&lt;/td>
&lt;td>Default&lt;/td>
&lt;td>区域&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>region_id&lt;/td>
&lt;td>kvm&lt;/td>
&lt;td>虚拟化方式&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>res_name&lt;/td>
&lt;td>server&lt;/td>
&lt;td>资源类别&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>template_id&lt;/td>
&lt;td>5199f56b-01c2-425c-8e29-0179d283e4a3&lt;/td>
&lt;td>模板id&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>zone&lt;/td>
&lt;td>zone1&lt;/td>
&lt;td>可用区&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>zone_id&lt;/td>
&lt;td>00f3f3c6-1d16-4053-81f1-4cb092f418f5&lt;/td>
&lt;td>可用区id&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table></description></item><item><title>Docs: 登录虚拟机</title><link>https://www.cloudpods.org/zh/docs/onpremise/vminstance/tutorial/connect/</link><pubDate>Fri, 19 Jul 2019 17:38:36 +0800</pubDate><guid>https://www.cloudpods.org/zh/docs/onpremise/vminstance/tutorial/connect/</guid><description>
&lt;p>创建好虚拟机后，登录的方式大概分为以下几种：&lt;/p>
&lt;ul>
&lt;li>ssh: linux 通用，要求虚拟机网络可达;&lt;/li>
&lt;li>rdp: windows 远程桌面，要求虚拟机网络可达；可通过RDP对应的客户端连接Windows操作系统的虚拟机。&lt;/li>
&lt;li>vnc: vnc 链接，对虚拟机网络没有要求，只要能链接云平台 vnc proxy 即可;&lt;/li>
&lt;/ul>
&lt;h2 id="web界面操作">Web界面操作&lt;/h2>
&lt;p>该功能用于通过过VNC远程终端或Web SSH远程连接到虚拟机。
&lt;div class="alert alert-warning" role="alert">
&lt;h4 class="alert-heading">注意&lt;/h4>
&lt;ul>
&lt;li>Windows操作系统的虚拟机只支持通过VNC远程终端；&lt;/li>
&lt;li>在Cloudpods平台经典网络的虚拟机可以直接使用Web SSH和VNC远程终端；Cloudpods平台VPC网络的虚拟机可以直接使用Web SSH和VNC远程终端，也可以绑定EIP后使用EIP的Web SSH。请注意，未绑定EIP的VPC网络的虚拟机只能通过平台的Web SSH连接，无法使用SSH工具进行连接，如需使用SSH工具连接虚拟机，请为虚拟机绑定EIP。&lt;/li>
&lt;li>VNC长时间连接黑屏后，按空格键会恢复显示。&lt;/li>
&lt;/ul>
&lt;/div>
&lt;/p>
&lt;ol>
&lt;li>在虚拟机页面，单击虚拟机右侧操作列操作列 &lt;strong>&lt;em>&amp;ldquo;远程终端&amp;rdquo;&lt;/em>&lt;/strong> 按钮，选择 &lt;strong>&lt;em>&amp;ldquo;VNC远程终端&amp;rdquo;&lt;/em>&lt;/strong> 菜单项，新建Web Console名称的浏览器标签页。
&lt;ul>
&lt;li>发送远程命令：单击 &lt;strong>&lt;em>&amp;ldquo;发送远程命令&amp;rdquo;&lt;/em>&lt;/strong> 按钮，选择下拉菜单 &lt;strong>&lt;em>&amp;ldquo;Ctrl-Alt-F1~F6&amp;rdquo;&lt;/em>&lt;/strong> 菜单项，向虚拟机控制台发送具体的命令。&lt;/li>
&lt;li>Ctrl-Alt-Delete：单击\ &lt;strong>&lt;em>Ctrl-Alt-Delete&lt;/em>&lt;/strong> 按钮，若虚拟机为Windows系统，则向虚拟机控制台发送Ctrl-Alt-Delete命令，若虚拟机为Linux系统，则将弹出重启服务器提示，单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮后将重启虚拟机。&lt;/li>
&lt;li>发送文字：单击 &lt;strong>&lt;em>发送文字&lt;/em>&lt;/strong> 按钮，在弹出的发送文字对话框中输入需要发送的内容，单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮，向虚拟机控制台发送文字，如发送内容为登录密码，在发送文字后，需要键入回车键确认登录。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>单击 &lt;strong>&lt;em>&amp;ldquo;远程终端&amp;rdquo;&lt;/em>&lt;/strong> 按钮，选择 &lt;strong>&lt;em>&amp;ldquo;SSH IP地址&amp;rdquo;&lt;/em>&lt;/strong> 菜单项，与虚拟机建立web SSH连接。&lt;/li>
&lt;li>单击 &lt;strong>&lt;em>远程终端&lt;/em>&lt;/strong> 按钮，选择 &lt;strong>&lt;em>&amp;ldquo;SSH IP地址:任意端口&amp;rdquo;&lt;/em>&lt;/strong> 菜单项，在弹出的对话框中设置端口号，单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮，与虚拟机建立web SSH连接。&lt;/li>
&lt;/ol>
&lt;h2 id="climc命令行操作">Climc命令行操作&lt;/h2>
&lt;p>针对以上的链接方式，我们提供以下接口链接云虚拟机：&lt;/p>
&lt;h3 id="vnc-连接">vnc 连接&lt;/h3>
&lt;p>&lt;code>climc webconsole-server&lt;/code> 命令提供通过 vnc 的方式链接虚拟机，该方式对裸金属服务器不可用。&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ climc webconsole-server &amp;lt;server_id&amp;gt;
&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="ssh-连接">ssh 连接&lt;/h3>
&lt;p>查询 server 的 ip&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8f5902;font-style:italic"># 可通过 server-list --search --details 的方式找到虚拟机的 ip&lt;/span>
$ climc server-list --search &amp;lt;server_name&amp;gt; --details
&lt;span style="color:#8f5902;font-style:italic"># 或者通过 server-show &amp;lt;server_id&amp;gt; 的方式得到 ip&lt;/span>
$ climc server-show &amp;lt;server_name&amp;gt; &lt;span style="color:#000;font-weight:bold">|&lt;/span> grep ip
&lt;span style="color:#000;font-weight:bold">|&lt;/span> ips &lt;span style="color:#000;font-weight:bold">|&lt;/span> 10.168.222.226 &lt;span style="color:#000;font-weight:bold">|&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>查询 server 的登录信息&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ climc server-logininfo &amp;lt;server_name&amp;gt;
+----------+-----------------------------+
&lt;span style="color:#000;font-weight:bold">|&lt;/span> Field &lt;span style="color:#000;font-weight:bold">|&lt;/span> Value &lt;span style="color:#000;font-weight:bold">|&lt;/span>
+----------+-----------------------------+
&lt;span style="color:#000;font-weight:bold">|&lt;/span> password &lt;span style="color:#000;font-weight:bold">|&lt;/span> @2aWXB6AmCbV &lt;span style="color:#000;font-weight:bold">|&lt;/span>
&lt;span style="color:#000;font-weight:bold">|&lt;/span> updated &lt;span style="color:#000;font-weight:bold">|&lt;/span> 2019-07-03T10:00:20.801716Z &lt;span style="color:#000;font-weight:bold">|&lt;/span>
&lt;span style="color:#000;font-weight:bold">|&lt;/span> username &lt;span style="color:#000;font-weight:bold">|&lt;/span> root &lt;span style="color:#000;font-weight:bold">|&lt;/span>
+----------+-----------------------------+
&lt;/code>&lt;/pre>&lt;/div>&lt;p>ssh 登录&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ ssh root@10.168.222.226
&lt;/code>&lt;/pre>&lt;/div>&lt;p>通过 webconsole 登录&lt;/p>
&lt;pre>&lt;code>$ climc webconsole-ssh 10.168.222.226
https://console.yunion.cn/web-console?access_token=y7bjpBwtvJHLHpwOUMzNVvsYiAgY1vskIuVwB-aINfH4mm8MsZqwxKSfHqm2pCvY6O8bBA%3D%3D&amp;amp;api_server=https%3A%2F%2Foffice.yunion.io&amp;amp;protocol=tty
&lt;/code>&lt;/pre>&lt;p>在浏览器打开 webconsole 放回的 url ，就会到对应虚拟机的登录界面&lt;/p>
&lt;p>&lt;img src="../../images/webssh.png" alt="">&lt;/p></description></item><item><title>Docs: 虚拟机生命周期管理</title><link>https://www.cloudpods.org/zh/docs/onpremise/vminstance/tutorial/lifecycle/</link><pubDate>Fri, 19 Jul 2019 17:38:36 +0800</pubDate><guid>https://www.cloudpods.org/zh/docs/onpremise/vminstance/tutorial/lifecycle/</guid><description>
&lt;h2 id="web界面操作">Web界面操作&lt;/h2>
&lt;h3 id="开机">开机&lt;/h3>
&lt;p>该功能用于将处于关机状态的虚拟机开机。批量开机操作支持选择不同平台上“关机”状态的虚拟机。&lt;/p>
&lt;p>&lt;strong>单个虚拟机开机&lt;/strong>&lt;/p>
&lt;p>虚拟机把同步状态按钮归类到实例状态中1. 在虚拟机页面，单击“关机”状态的虚拟机右侧操作列 &lt;strong>&lt;em>&amp;ldquo;更多&amp;rdquo;&lt;/em>&lt;/strong> 按钮，选择下拉菜单 &lt;strong>&lt;em>&amp;ldquo;实例状态-开机&amp;rdquo;&lt;/em>&lt;/strong> 菜单项，启动虚拟机。&lt;/p>
&lt;p>&lt;strong>批量开机&lt;/strong>&lt;/p>
&lt;ol>
&lt;li>在虚拟机列表中选择一个或多个“关机”状态的虚拟机，单击列表上方 &lt;strong>&lt;em>&amp;ldquo;开机&amp;rdquo;&lt;/em>&lt;/strong> 按钮，批量启动多个虚拟机。&lt;/li>
&lt;/ol>
&lt;h3 id="关机">关机&lt;/h3>
&lt;p>该功能用于将处于运行中状态的虚拟机关机。批量关机操作支持选择不同平台上“运行中”状态的虚拟机。&lt;/p>
&lt;div class="alert alert-warning" role="alert">
&lt;h4 class="alert-heading">注意&lt;/h4>
&lt;p>目前仅阿里云、腾讯云按量付费的虚拟机支持关机不收费。&lt;/p>
&lt;ul>
&lt;li>关机后，将释放CPU、内存，并停止对CPU、内存的计费，所关联硬盘、镜像、公网带宽(如需计费)依然计费&lt;/li>
&lt;li>关机后，实例的 CPU 、内存将不再保留，所以再次启动实例时可能会失败。此时，您可以尝试再次启动，或者换一个时间再次启动&lt;/li>
&lt;li>关机后，普通公网 IP 将被释放不可找回，建议您先转换为弹性公网 IP 后再进行关机操作&lt;/li>
&lt;li>关机后，弹性公网 IP 将被保留，不会被释放，关机期间也不收取费用&lt;/li>
&lt;li>关机期间实例较多操作（如调整配置、重装系统等）可能无法支持，如需操作请开机后进行&lt;/li>
&lt;li>部分不支持关机不收费的实例，关机后继续正常收费&lt;/li>
&lt;/ul>
&lt;/div>
&lt;p>&lt;strong>单个虚拟机关机&lt;/strong>&lt;/p>
&lt;ol>
&lt;li>在虚拟机页面，单击“运行中”状态的虚拟机右侧操作列 &lt;strong>&lt;em>&amp;ldquo;更多&amp;rdquo;&lt;/em>&lt;/strong> 按钮，选择下拉菜单 &lt;strong>&lt;em>&amp;ldquo;实例状态-关机&amp;rdquo;&lt;/em>&lt;/strong> 菜单项，弹出操作确认对话框。&lt;/li>
&lt;li>当虚拟机是阿里云或腾讯云平台上按量付费的虚拟机时，可以选择勾选“关机不收费”。&lt;/li>
&lt;li>单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮，完成操作。&lt;/li>
&lt;/ol>
&lt;p>&lt;strong>批量关机&lt;/strong>&lt;/p>
&lt;ol>
&lt;li>在虚拟机列表中选择一个或多个“运行中”状态的虚拟机，单击列表上方 &lt;strong>&lt;em>&amp;ldquo;关机&amp;rdquo;&lt;/em>&lt;/strong> 按钮，弹出操作确认对话框。&lt;/li>
&lt;li>当被选择的虚拟机是阿里云或腾讯云平台上按量付费的虚拟机时，可以选择勾选“关机不收费”。&lt;/li>
&lt;li>单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮，完成操作。&lt;/li>
&lt;/ol>
&lt;h3 id="重启">重启&lt;/h3>
&lt;p>该功能用于将处于运行中状态的虚拟机重启，重启过程中VNC连接会中断。批量重启操作支持选择不同平台上“运行中”状态的虚拟机。&lt;/p>
&lt;p>&lt;strong>单个虚拟机重启&lt;/strong>&lt;/p>
&lt;ol>
&lt;li>在虚拟机页面，单击“运行中”状态的虚拟机右侧操作列 &lt;strong>&lt;em>&amp;ldquo;更多&amp;rdquo;&lt;/em>&lt;/strong> 按钮，选择下拉菜单 &lt;strong>&lt;em>&amp;ldquo;实例状态-重启&amp;rdquo;&lt;/em>&lt;/strong> 菜单项，弹出操作确认对话框。&lt;/li>
&lt;li>选择是否勾选强制重启，单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮。&lt;/li>
&lt;/ol>
&lt;p>&lt;strong>批量重启&lt;/strong>&lt;/p>
&lt;ol>
&lt;li>在虚拟机列表中选择一个或多个“运行中”状态的虚拟机，单击列表上方 &lt;strong>&lt;em>&amp;ldquo;重启&amp;rdquo;&lt;/em>&lt;/strong> 按钮，弹出操作确认对话框。&lt;/li>
&lt;li>选择是否勾选强制重启，单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮。&lt;/li>
&lt;/ol>
&lt;div class="alert alert-warning" role="alert">
&lt;h4 class="alert-heading">注意&lt;/h4>
若勾选“强制重启”，虚拟机中未保存数据将会丢失。
&lt;/div>
&lt;h3 id="重置">重置&lt;/h3>
&lt;p>该功能用于将运行中状态的虚拟机重启，重启过程中VNC连接不会中断。仅支持Cloudpods平台上的虚拟机。&lt;/p>
&lt;ol>
&lt;li>在虚拟机页面，单击“运行中”状态的虚拟机右侧操作列 &lt;strong>&lt;em>&amp;ldquo;更多&amp;rdquo;&lt;/em>&lt;/strong> 按钮，选择下拉菜单 &lt;strong>&lt;em>&amp;ldquo;实例状态-重置&amp;rdquo;&lt;/em>&lt;/strong> 菜单项，弹出操作确认对话框。&lt;/li>
&lt;li>单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮，完成操作。&lt;/li>
&lt;/ol>
&lt;h3 id="挂起">挂起&lt;/h3>
&lt;p>该功能用于将运行中状态的虚拟机进入休眠状态，挂起状态下虚拟机会保存当前状态，服务将处于暂停状态而不会结束，可通过恢复功能快速恢复状态。&lt;/p>
&lt;p>目前仅VMware虚拟机支持挂起/恢复操作。&lt;/p>
&lt;p>&lt;strong>单个虚拟机挂起&lt;/strong>&lt;/p>
&lt;ol>
&lt;li>在虚拟机页面，单击“运行中”状态的虚拟机右侧操作列 &lt;strong>&lt;em>&amp;ldquo;更多&amp;rdquo;&lt;/em>&lt;/strong> 按钮，选择下拉菜单 &lt;strong>&lt;em>&amp;ldquo;实例状态-挂起&amp;rdquo;&lt;/em>&lt;/strong> 菜单项，弹出操作确认对话框。&lt;/li>
&lt;li>单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮，完成操作。&lt;/li>
&lt;/ol>
&lt;p>&lt;strong>批量挂起&lt;/strong>&lt;/p>
&lt;ol>
&lt;li>在虚拟机列表中选择一个或多个“运行中”状态的虚拟机，单击列表上方 &lt;strong>&lt;em>&amp;ldquo;批量操作&amp;rdquo;&lt;/em>&lt;/strong> 按钮，选择下拉菜单 &lt;strong>&lt;em>&amp;ldquo;挂起&amp;rdquo;&lt;/em>&lt;/strong> 菜单项，弹出操作确认对话框。&lt;/li>
&lt;li>单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮，完成操作。&lt;/li>
&lt;/ol>
&lt;h3 id="恢复">恢复&lt;/h3>
&lt;p>该功能用于将挂起状态的虚拟机恢复成运行状态。&lt;/p>
&lt;p>目前仅VMware虚拟机支持挂起/恢复操作。&lt;/p>
&lt;p>&lt;strong>单个虚拟机恢复&lt;/strong>&lt;/p>
&lt;ol>
&lt;li>在虚拟机页面，单击“挂起”状态的虚拟机右侧操作列 &lt;strong>&lt;em>&amp;ldquo;更多&amp;rdquo;&lt;/em>&lt;/strong> 按钮，选择下拉菜单 &lt;strong>&lt;em>&amp;ldquo;实例状态-恢复&amp;rdquo;&lt;/em>&lt;/strong> 菜单项，弹出操作确认对话框。&lt;/li>
&lt;li>单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮，完成操作。&lt;/li>
&lt;/ol>
&lt;p>&lt;strong>批量恢复&lt;/strong>&lt;/p>
&lt;ol>
&lt;li>在虚拟机列表中选择一个或多个“运行中”状态的虚拟机，单击列表上方 &lt;strong>&lt;em>&amp;ldquo;批量操作&amp;rdquo;&lt;/em>&lt;/strong> 按钮，选择下拉菜单 &lt;strong>&lt;em>&amp;ldquo;恢复&amp;rdquo;&lt;/em>&lt;/strong> 菜单项，弹出操作确认对话框。&lt;/li>
&lt;li>单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮，完成操作。&lt;/li>
&lt;/ol>
&lt;h3 id="同步状态">同步状态&lt;/h3>
&lt;p>当虚拟机被恶意破坏或经非法暴力操作，导致服务状态异常（如系统死机），需要管理员后台修复，同步虚拟机环境状态，提供系统级服务修复措施。或者在资源超配情况下，同步运行状态。批量同步状态操作支持选择不同平台上的虚拟机。&lt;/p>
&lt;p>&lt;strong>单个同步状态&lt;/strong>&lt;/p>
&lt;ol>
&lt;li>在虚拟机页面，单击虚拟机右侧操作列 &lt;strong>&lt;em>&amp;ldquo;更多&amp;rdquo;&lt;/em>&lt;/strong> 按钮，选择下拉菜单 &lt;strong>&lt;em>&amp;ldquo;实例状态-同步状态&amp;rdquo;&lt;/em>&lt;/strong> 菜单项，同步虚拟机状态。&lt;/li>
&lt;/ol>
&lt;p>&lt;strong>批量同步状态&lt;/strong>&lt;/p>
&lt;ol>
&lt;li>在虚拟机列表中选择一个或多个虚拟机，单击列表上方 &lt;strong>&lt;em>&amp;ldquo;批量操作&amp;rdquo;&lt;/em>&lt;/strong> 按钮，选择下拉菜单 &lt;strong>&lt;em>&amp;ldquo;同步状态&amp;rdquo;&lt;/em>&lt;/strong> 菜单项，同步虚拟机状态。&lt;/li>
&lt;/ol>
&lt;h2 id="climc命令行操作">Climc命令行操作&lt;/h2>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8f5902;font-style:italic"># 开机&lt;/span>
$ climc server-start &amp;lt;server_id&amp;gt;
&lt;span style="color:#8f5902;font-style:italic"># 关机&lt;/span>
$ climc server-stop &amp;lt;server_id&amp;gt;
&lt;span style="color:#8f5902;font-style:italic"># 强制关机&lt;/span>
$ climc server-stop --is-force &amp;lt;server_id&amp;gt;
&lt;span style="color:#8f5902;font-style:italic"># 重启&lt;/span>
$ climc server-restart &amp;lt;server_id&amp;gt;
&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Docs: 虚拟机实例设置</title><link>https://www.cloudpods.org/zh/docs/onpremise/vminstance/tutorial/setting/</link><pubDate>Fri, 19 Jul 2019 17:38:36 +0800</pubDate><guid>https://www.cloudpods.org/zh/docs/onpremise/vminstance/tutorial/setting/</guid><description>
&lt;h2 id="web界面操作">Web界面操作&lt;/h2>
&lt;h3 id="修改属性">修改属性&lt;/h3>
&lt;p>该功能用于修改虚拟机的启动介质、引导方式等。批量修改属性操作支持选择不同平台上的虚拟机。&lt;/p>
&lt;p>&lt;strong>单个虚拟机修改属性&lt;/strong>&lt;/p>
&lt;ol>
&lt;li>在虚拟机页面，单击虚拟机右侧操作列 &lt;strong>&lt;em>&amp;ldquo;更多&amp;rdquo;&lt;/em>&lt;/strong> 按钮，选择下拉菜单 &lt;strong>&lt;em>&amp;ldquo;实例设置-修改属性&amp;rdquo;&lt;/em>&lt;/strong> 菜单项，弹出修改属性对话框。&lt;/li>
&lt;li>修改虚拟机是否启用删除保护，禁用删除保护后，可删除虚拟机。启用删除保护后，无法删除虚拟机。&lt;/li>
&lt;li>修改虚拟机的启动介质，选择从硬盘、光驱、网络启动虚拟机。
&lt;ul>
&lt;li>如挂载ISO后，可选择从光驱启动虚拟机，并进行安装操作系统的操作。&lt;/li>
&lt;li>如系统盘已有操作系统，可选择通过硬盘启动虚拟机等。&lt;/li>
&lt;li>如设备需要通过网络从远端服务器下载镜像启动，则需要选择通过网络启动虚拟机。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>修改虚拟机的引导方式，目前仅Cloudpods平台上虚拟机支持修改，且ARM架构只支持UEFI引导方式。&lt;/li>
&lt;li>单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮，完成操作。&lt;/li>
&lt;/ol>
&lt;p>&lt;strong>批量修改属性&lt;/strong>&lt;/p>
&lt;ol>
&lt;li>在虚拟机列表中选择一个或多个虚拟机，单击 &lt;strong>&lt;em>&amp;ldquo;批量操作&amp;rdquo;&lt;/em>&lt;/strong> 按钮，选择下拉菜单 &lt;strong>&lt;em>&amp;ldquo;修改属性&amp;rdquo;&lt;/em>&lt;/strong> 菜单项，弹出修改属性对话框。&lt;/li>
&lt;li>修改虚拟机的启动介质，选择从硬盘、光驱、网络启动虚拟机。
&lt;ul>
&lt;li>如挂载ISO后，可选择从光驱启动虚拟机，并进行安装操作系统的操作。&lt;/li>
&lt;li>如系统盘已有操作系统，可选择通过硬盘启动虚拟机等。&lt;/li>
&lt;li>如设备需要通过网络从远端服务器下载镜像启动，则需要选择通过网络启动虚拟机。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>修改虚拟机的引导方式，目前仅Cloudpods平台上虚拟机支持修改，且ARM架构只支持UEFI引导方式。&lt;/li>
&lt;li>单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮，完成操作。&lt;/li>
&lt;/ol>
&lt;h3 id="重装系统">重装系统&lt;/h3>
&lt;p>该功能用于为虚拟机更换系统。&lt;/p>
&lt;ol>
&lt;li>
&lt;p>在虚拟机页面，单击虚拟机右侧操作列 &lt;strong>&lt;em>&amp;ldquo;更多&amp;rdquo;&lt;/em>&lt;/strong> 按钮，选择下拉菜单 &lt;strong>&lt;em>&amp;ldquo;实例设置-重装系统&amp;rdquo;&lt;/em>&lt;/strong> 菜单项，弹出重装系统对话框。&lt;/p>
&lt;/li>
&lt;li>
&lt;p>选择系统镜像，可分别从公共镜像或自定义镜像中选择同操作系统的镜像。&lt;/p>
&lt;/li>
&lt;li>
&lt;p>设置管理员密码，在Linux系统中为root用户的密码，在Windows操作系统中为administrator用户的密码。&lt;/p>
&lt;ul>
&lt;li>随机生成：随机生成管理员密码，用户可在虚拟机列表密码列查看复制管理员密码。&lt;/li>
&lt;li>关联密钥：在关联密钥之前需要先新建密钥。关联密钥后，用户需要使用私钥远程登录虚拟机。&lt;/li>
&lt;li>保留镜像设置：管理员密码为镜像中已有的管理员密码。&lt;/li>
&lt;li>手工输入：可手动设置管理员密码。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;div class="alert alert-primary" role="alert">
&lt;h4 class="alert-heading">说明&lt;/h4>
根据虚拟机所在平台不同，设置管理员密码的方式可能为以上方式的其中几种，请以界面为准。
&lt;/div>
&lt;ol start="4">
&lt;li>默认勾选“重装系统后自动启动”，可根据需要取消勾选，单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮，完成操作。&lt;/li>
&lt;/ol>
&lt;h3 id="调整配置">调整配置&lt;/h3>
&lt;p>该功能用于修改虚拟机的硬件配置，包括CPU、内存以及硬盘大小等，支持批量操作。&lt;/p>
&lt;div class="alert alert-warning" role="alert">
&lt;h4 class="alert-heading">注意&lt;/h4>
&lt;ul>
&lt;li>在Cloudpods平台虚拟机运行状态下CPU和内存大小只允许往上调整；&lt;/li>
&lt;li>ZStack在虚拟机开机状态下不允许调整CPU和内存大小，只支持增加数据盘。&lt;/li>
&lt;li>阿里云的虚拟机在绑定EIP之后不允许调整虚拟机配置。&lt;/li>
&lt;li>除阿里云、腾讯云、华为云之外的平台包年包月的虚拟机不支持调整配置。&lt;/li>
&lt;li>批量调整配置时，仅允许选择同一个平台上的虚拟机。&lt;/li>
&lt;/ul>
&lt;/div>
&lt;p>&lt;strong>单个虚拟机调整配置&lt;/strong>&lt;/p>
&lt;ol>
&lt;li>在虚拟机页面，单击虚拟机右侧操作列 &lt;strong>&lt;em>&amp;ldquo;更多&amp;rdquo;&lt;/em>&lt;/strong> 按钮，选择下拉菜单 &lt;strong>&lt;em>&amp;ldquo;实例设置-调整配置&amp;rdquo;&lt;/em>&lt;/strong> 菜单项，弹出调整配置对话框。&lt;/li>
&lt;li>调整虚拟机的CPU核数、内存以及数据盘，也可根据需求添加新磁盘，若虚拟机在&amp;quot;关机&amp;quot;状态下可勾选“调整配置后自动启动”，单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮。&lt;/li>
&lt;li>若开启了工单，则还需要填入申请原因，单击 &lt;strong>&lt;em>&amp;ldquo;提交工单&amp;rdquo;&lt;/em>&lt;/strong> 按钮，提交调整配置工单，等待审批通过后才会成功调整配置。&lt;/li>
&lt;/ol>
&lt;p>&lt;strong>批量调整配置&lt;/strong>&lt;/p>
&lt;ol>
&lt;li>在虚拟机列表中选择一个或多个同一个平台的虚拟机，单击列表上方 &lt;strong>&lt;em>&amp;ldquo;批量操作&amp;rdquo;&lt;/em>&lt;/strong> 按钮，选择下拉菜单 &lt;strong>&lt;em>&amp;ldquo;调整配置&amp;rdquo;&lt;/em>&lt;/strong> 菜单项，弹出调整配置对话框。&lt;/li>
&lt;li>调整虚拟机的CPU核数、内存，若虚拟机在&amp;quot;关机&amp;quot;状态下可勾选“调整配置后自动启动”，单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮。&lt;/li>
&lt;li>若开启了工单，则还需要填入申请原因，单击 &lt;strong>&lt;em>&amp;ldquo;提交工单&amp;rdquo;&lt;/em>&lt;/strong> 按钮，提交调整配置工单，等待审批通过后才会成功调整配置。&lt;/li>
&lt;/ol>
&lt;h3 id="更改项目">更改项目&lt;/h3>
&lt;p>项目是资源的拥有者，当虚拟机属于某项目后，项目中的所有成员都有权限使用该虚拟机。可根据具体使用需求更改虚拟机所属的项目。&lt;/p>
&lt;p>&lt;strong>单个虚拟机更改项目&lt;/strong>&lt;/p>
&lt;ol>
&lt;li>在虚拟机页面，单击虚拟机右侧操作列 &lt;strong>&lt;em>&amp;ldquo;更多&amp;rdquo;&lt;/em>&lt;/strong> 按钮，选择下拉菜单 &lt;strong>&lt;em>&amp;ldquo;实例设置-更改项目&amp;rdquo;&lt;/em>&lt;/strong> 菜单项，弹出更改项目对话框。&lt;/li>
&lt;li>选择域和域下的项目后，单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮，完成操作。&lt;/li>
&lt;/ol>
&lt;p>&lt;strong>批量更改项目&lt;/strong>&lt;/p>
&lt;p>批量更改项目要求虚拟机属于同一个域。&lt;/p>
&lt;ol>
&lt;li>在虚拟机列表中选择一个或多个虚拟机，单击列表上方 &lt;strong>&lt;em>&amp;ldquo;批量操作&amp;rdquo;&lt;/em>&lt;/strong> 按钮，选择下拉菜单 &lt;strong>&lt;em>&amp;ldquo;更改项目&amp;rdquo;&lt;/em>&lt;/strong> 菜单项，弹出更改项目对话框。&lt;/li>
&lt;li>选择域和域下的项目后，单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮，完成操作。&lt;/li>
&lt;/ol>
&lt;h3 id="创建快照">创建快照&lt;/h3>
&lt;p>快照是一种数据备份方式，可以在指定时间点对虚拟机的系统盘、数据盘或虚拟机整体创建一个完全可用拷贝，便于虚拟机故障后快速回退到创建快照时的虚拟机状态。&lt;/p>
&lt;div class="alert alert-warning" role="alert">
&lt;h4 class="alert-heading">注意&lt;/h4>
&lt;ul>
&lt;li>目前UCloud、天翼云平台暂不支持创建快照操作；VMware平台虚拟机仅支持创建主机快照。私有云平台仅支持本地硬盘创建硬盘快照。Cloudpods平台同时支持创建硬盘快照和主机快照。&lt;/li>
&lt;li>状态异常的硬盘不支持创建硬盘快照。&lt;/li>
&lt;li>主机快照占的快照配额数等于主机上的硬盘数，即若主机上有2块硬盘，为该主机创建主机快照所站的快照配额为2。&lt;/li>
&lt;/ul>
&lt;/div>
&lt;ol>
&lt;li>在虚拟机页面，单击虚拟机右侧操作列 &lt;strong>&lt;em>&amp;ldquo;更多&amp;rdquo;&lt;/em>&lt;/strong> 按钮，选择下拉菜单 &lt;strong>&lt;em>&amp;ldquo;实例设置-创建快照&amp;rdquo;&lt;/em>&lt;/strong> 菜单项，弹出新建快照对话框。&lt;/li>
&lt;li>选择快照类别。
&lt;ul>
&lt;li>当选择快照类别为“创建硬盘快照”，选择需要备份的磁盘，设置快照名称，单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮，创建硬盘快照。&lt;/li>
&lt;li>当选择快照类别为“创建主机快照”，设置快照名称，单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮，创建主机快照。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;h3 id="创建相同配置">创建相同配置&lt;/h3>
&lt;p>该功能用于创建相同配置的虚拟机。&lt;/p>
&lt;div class="alert alert-warning" role="alert">
&lt;h4 class="alert-heading">注意&lt;/h4>
&lt;ul>
&lt;li>VMware、OpenStack、ZStack、DStack平台上虚拟机不支持该操作。&lt;/li>
&lt;/ul>
&lt;/div>
&lt;ol>
&lt;li>在虚拟机页面，单击虚拟机右侧操作列 &lt;strong>&lt;em>&amp;ldquo;更多&amp;rdquo;&lt;/em>&lt;/strong> 按钮，选择下拉菜单 &lt;strong>&lt;em>&amp;ldquo;实例设置-创建相同配置&amp;rdquo;&lt;/em>&lt;/strong> 菜单项，弹出创建相同配置对话框。&lt;/li>
&lt;li>输入名称，设置数量，单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮。如创建多个虚拟机，第1个创建的虚拟机名称为设置的名称，第2~N个创建的虚拟机名称为名称- 1~N-1。&lt;/li>
&lt;/ol>
&lt;h3 id="设置磁盘速度">设置磁盘速度&lt;/h3>
&lt;p>该功能用于限制磁盘的IOPS，其中IOPS是指单位时间内系统能处理的I/O请求数量，I/O请求通常为读或写数据操作请求。仅Cloudpods平台上运行状态的虚拟机支持该操作。&lt;/p>
&lt;ol>
&lt;li>在虚拟机页面，单击虚拟机右侧操作列 &lt;strong>&lt;em>&amp;ldquo;更多&amp;rdquo;&lt;/em>&lt;/strong> 按钮，选择下拉菜单 &lt;strong>&lt;em>&amp;ldquo;实例设置-设置磁盘速度&amp;rdquo;&lt;/em>&lt;/strong> 菜单项，弹出设置磁盘速度对话框。&lt;/li>
&lt;li>勾选是否限速，若勾选，设置磁盘最大IOPS，单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮。&lt;/li>
&lt;/ol>
&lt;h3 id="到期释放">到期释放&lt;/h3>
&lt;p>到期释放即设置虚拟机的使用时长，当超过设置期限时，虚拟机将会被自动删除，存放到回收站。&lt;/p>
&lt;div class="alert alert-warning" role="alert">
&lt;h4 class="alert-heading">注意&lt;/h4>
&lt;ul>
&lt;li>公有云仅按量付费的虚拟机支持到期释放功能。&lt;/li>
&lt;li>公有云虚拟机放入回收站后仍然收费，如虚拟机不再使用，请在回收站进行清除。&lt;/li>
&lt;/ul>
&lt;/div>
&lt;ol>
&lt;li>在虚拟机页面，单击虚拟机右侧操作列 &lt;strong>&lt;em>&amp;ldquo;更多&amp;rdquo;&lt;/em>&lt;/strong> 按钮，选择下拉菜单 &lt;strong>&lt;em>&amp;ldquo;实例设置-到期释放&amp;rdquo;&lt;/em>&lt;/strong> 菜单项，弹出到期释放对话框。&lt;/li>
&lt;li>选择是否勾选到期释放，勾选后设置虚拟机的释放时间，单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮。
&lt;ul>
&lt;li>单击释放时间输入框，显示日历等内容，支持直接在释放时间输入框中输入日期和时间，格式为yyyy-mm-dd hh:mm:ss，单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮。&lt;/li>
&lt;li>在日历框中选择日期，单击 &lt;strong>&lt;em>选择时间&lt;/em>&lt;/strong> 按钮，将跳转到设置时间界面，选择时间后，单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮。&lt;/li>
&lt;li>支持快速选择“1小时”、“2小时”、“3小时”、 “6小时”、 “1天”、“2天”、 “1周”按钮，释放时间将设置为对应时间范围内的时间，单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>设置完成后，在计费方式列显示虚拟机还有多久时间释放等信息。&lt;/li>
&lt;li>若不再需要到期释放功能，可在虚拟机释放之前，在弹出的到期释放对话框中取消勾选到期释放，单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮。&lt;/li>
&lt;/ol>
&lt;h3 id="主机克隆">主机克隆&lt;/h3>
&lt;p>该功能用于根据虚拟机的规格信息克隆出与当前虚拟机系统、配置相同的虚拟机。仅Cloudpods平台上的运行和关机状态的虚拟机支持主机克隆功能。&lt;/p>
&lt;p>当前主机克隆实现原理是基于主机快照创建新的虚拟机，主机克隆过程中会产生主机快照，并占用快照配额，需要用户及时删除无用快照，若当前用户项目不存在快照配额，则将无法使用主机克隆功能。&lt;/p>
&lt;p>&lt;strong>单个克隆&lt;/strong>&lt;/p>
&lt;ol>
&lt;li>在虚拟机页面，单击虚拟机右侧操作列 &lt;strong>&lt;em>&amp;ldquo;更多&amp;rdquo;&lt;/em>&lt;/strong> 按钮，选择下拉菜单 &lt;strong>&lt;em>&amp;ldquo;实例设置-主机克隆&amp;rdquo;&lt;/em>&lt;/strong> 菜单项，弹出主机克隆对话框。&lt;/li>
&lt;li>设置名称、数量、克隆方式。
&lt;ul>
&lt;li>新主机快照克隆：当选择“新主机快照克隆”时，建议勾选“克隆完成后删除本次克隆生成的主机快照”，减少无用主机快照，释放快照配额等，单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮，虚拟机在会创建主机快照并创建与当前虚拟机配置完全相同的虚拟机。&lt;/li>
&lt;li>已有主机快照克隆：当选择“已有主机快照克隆”时，需要勾选该虚拟机已创建的主机快照，单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮。使用已有的主机快照克隆的虚拟机与创建快照时刻的虚拟机配置和状态相同，与当前虚拟机状态可能不相同。若用户不需要使用已有主机快照，也可以在该页面删除主机快照，增加快照配额。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;p>&lt;strong>批量克隆&lt;/strong>&lt;/p>
&lt;ol>
&lt;li>在虚拟机列表中选择两个及以上虚拟机，单击列表上方**_&amp;ldquo;批量操作&amp;rdquo;_** 按钮，选择下拉菜单 **_&amp;ldquo;实例设置-主机克隆&amp;rdquo;_** 菜单项，弹出主机克隆对话框。&lt;/li>
&lt;li>单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮，批量克隆虚拟机。&lt;/li>
&lt;/ol></description></item><item><title>Docs: 虚拟机密码密钥</title><link>https://www.cloudpods.org/zh/docs/onpremise/vminstance/tutorial/keypair/</link><pubDate>Fri, 19 Jul 2019 17:38:36 +0800</pubDate><guid>https://www.cloudpods.org/zh/docs/onpremise/vminstance/tutorial/keypair/</guid><description>
&lt;h2 id="web界面操作">Web界面操作&lt;/h2>
&lt;h3 id="重置密码">重置密码&lt;/h3>
&lt;p>该功能用于更新虚拟机上的管理员用户的密码，管理员密码在Linux系统下为root用户的密码、Windows操作系统下为administrator用户的密码。&lt;/p>
&lt;div class="alert alert-warning" role="alert">
&lt;h4 class="alert-heading">注意&lt;/h4>
&lt;ul>
&lt;li>AWS平台的虚拟机不支持重置密码；&lt;/li>
&lt;li>OpenStack、ZStack、DStack、Azure、UCloud平台的虚拟机在运行状态下支持重置密码操作；&lt;/li>
&lt;li>在Cloudpods、VMware、阿里云、华为云、腾讯云、Google、天翼云平台的虚拟机在关机状态下支持重置密码操作；&lt;/li>
&lt;li>绑定密钥的虚拟机无法进行重置密码操作。&lt;/li>
&lt;li>通过ISO启动方式创建的Cloudpods平台虚拟机不支持重置密码操作。&lt;/li>
&lt;/ul>
&lt;/div>
&lt;p>&lt;strong>单个虚拟机重置密码&lt;/strong>&lt;/p>
&lt;ol>
&lt;li>在虚拟机页面，单击虚拟机右侧操作列 &lt;strong>&lt;em>&amp;ldquo;更多&amp;rdquo;&lt;/em>&lt;/strong> 按钮，选择 &lt;strong>&lt;em>&amp;ldquo;密码密钥-重置密码&amp;rdquo;&lt;/em>&lt;/strong> 菜单项，弹出重置密码对话框。&lt;/li>
&lt;li>设置管理员密码。
&lt;ul>
&lt;li>随机生成：随机生成管理员密码，用户可在虚拟机列表密码列查看复制管理员密码。&lt;/li>
&lt;li>手工输入：可手动设置管理员密码。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>默认勾选“重置密码后自动启动”，可根据需要取消勾选，单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮，完成操作。&lt;/li>
&lt;/ol>
&lt;p>&lt;strong>批量重置密码&lt;/strong>&lt;/p>
&lt;p>批量重置密码选择的虚拟机需要属于同一平台。&lt;/p>
&lt;ol>
&lt;li>在虚拟机列表中选择一个或多个同一平台的虚拟机，单击列表上方 &lt;strong>&lt;em>&amp;ldquo;批量操作&amp;rdquo;&lt;/em>&lt;/strong> 按钮，选择下拉菜单 &lt;strong>&lt;em>&amp;ldquo;密码密钥-重置密码&amp;rdquo;&lt;/em>&lt;/strong> 菜单项，弹出重置密码对话框。&lt;/li>
&lt;li>设置管理员密码。
&lt;ul>
&lt;li>随机生成：随机生成管理员密码，用户可在虚拟机列表密码列查看复制管理员密码。&lt;/li>
&lt;li>手工输入：可手动设置管理员密码。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>默认勾选“重置密码后自动启动”，可根据需要取消勾选，单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮，完成操作。&lt;/li>
&lt;/ol>
&lt;div class="alert alert-warning" role="alert">
&lt;h4 class="alert-heading">注意&lt;/h4>
若华为云平台的虚拟机重置密码不生效，原因是虚拟机上未安装一键式重置密码插件，请按照&lt;a href="https://support.huaweicloud.com/usermanual-ecs/zh-cn_topic_0068095385.html">安装方法&lt;/a>安装插件。用户如需在华为云平台使用自定义镜像时，需要在自定义镜像中安装一键式重置密码插件。
&lt;/div>
&lt;h3 id="绑定密钥">绑定密钥&lt;/h3>
&lt;p>该功能用于为虚拟机绑定密钥，密钥绑定后用户需要使用私钥登录虚拟机，或通过私钥在云管平台上获取虚拟机密码。在绑定密钥之前请创建密钥。一个虚拟机只支持绑定一个密钥，当绑定密钥后，用户在虚拟机列表的密码列无法直接看到密码信息，需要输入私钥内容获取密码。&lt;/p>
&lt;div class="alert alert-warning" role="alert">
&lt;h4 class="alert-heading">注意&lt;/h4>
&lt;ul>
&lt;li>AWS和华为云、天翼云平台的虚拟机不支持绑定密钥。&lt;/li>
&lt;li>ZStack、DStack、Azure平台的虚拟机支持在运行状态绑定密钥。&lt;/li>
&lt;li>其他平台的虚拟机需要在关机状态下绑定密钥。&lt;/li>
&lt;li>通过ISO启动方式创建的Cloudpods平台虚拟机不支持绑定密钥操作。&lt;/li>
&lt;li>OpenStack平台仅新建虚拟机时支持绑定密钥，已创建的虚拟机不支持绑定密钥。&lt;/li>
&lt;/ul>
&lt;/div>
&lt;ol>
&lt;li>在虚拟机页面，单击虚拟机右侧操作列 &lt;strong>&lt;em>&amp;ldquo;更多&amp;rdquo;&lt;/em>&lt;/strong> 按钮，选择 &lt;strong>&lt;em>&amp;ldquo;密码密钥-绑定密钥&amp;rdquo;&lt;/em>&lt;/strong> 菜单项，弹出绑定密钥对话框。&lt;/li>
&lt;li>选择密钥对，默认勾选“绑定密钥后自动启动”，可根据需要取消勾选，单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮，绑定密钥的虚拟机需要使用SSH密钥对登录。&lt;/li>
&lt;/ol>
&lt;h3 id="解绑密钥">解绑密钥&lt;/h3>
&lt;p>该功能用于将虚拟机与密钥解除绑定。&lt;/p>
&lt;div class="alert alert-warning" role="alert">
&lt;h4 class="alert-heading">注意&lt;/h4>
OpenStack平台虚拟机解绑密钥后重置密码可能会报错，请手动重置密码。
&lt;/div>
&lt;ol>
&lt;li>在虚拟机页面，单击虚拟机右侧操作列 &lt;strong>&lt;em>&amp;ldquo;更多&amp;rdquo;&lt;/em>&lt;/strong> 按钮，选择 &lt;strong>&lt;em>&amp;ldquo;密码密钥-解绑密钥&amp;rdquo;&lt;/em>&lt;/strong> 菜单项，弹出绑定密钥对话框。&lt;/li>
&lt;li>默认勾选“绑定密钥后自动启动”，可根据需要取消勾选，单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮，完成操作。&lt;/li>
&lt;/ol>
&lt;h2 id="climc命令行操作">Climc命令行操作&lt;/h2>
&lt;h3 id="重装密码">重装密码&lt;/h3>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ climc server-deploy --reset-password --password &amp;lt;your_password&amp;gt; &amp;lt;server_id&amp;gt;
&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Docs: 虚拟机镜像操作</title><link>https://www.cloudpods.org/zh/docs/onpremise/vminstance/tutorial/image/</link><pubDate>Fri, 19 Jul 2019 17:38:36 +0800</pubDate><guid>https://www.cloudpods.org/zh/docs/onpremise/vminstance/tutorial/image/</guid><description>
&lt;h2 id="web界面操作">Web界面操作&lt;/h2>
&lt;h3 id="保存镜像">保存镜像&lt;/h3>
&lt;p>将关机状态的虚拟机保存为qcow2格式的镜像文件保存在镜像列表，保存的镜像默认为自定义镜像。目前只支持Cloudpods平台和VMware平台。&lt;/p>
&lt;ol>
&lt;li>​单击Cloudpods平台和VMware平台“关机”状态的虚拟机右侧操作列 &lt;strong>&lt;em>&amp;ldquo;更多&amp;rdquo;&lt;/em>&lt;/strong> 按钮，选择下拉菜单 &lt;strong>&lt;em>&amp;ldquo;镜像-保存镜像&amp;rdquo;&lt;/em>&lt;/strong> 菜单项，弹出保存镜像对话框。&lt;/li>
&lt;li>选择镜像类别、输入镜像名称，选择是否勾选“保存镜像后自动启动”，单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮，若勾选保存镜像后自动启动，则当虚拟机保存镜像文件后，虚拟机将启动。
&lt;ul>
&lt;li>创建系统镜像：仅将虚拟机的系统盘保存为系统镜像，该镜像只占一个镜像配额。&lt;/li>
&lt;li>创建主机镜像：选择该项后，将虚拟机的系统盘和数据盘保存为主机镜像，主机镜像占的镜像配额等于虚拟机的硬盘数量。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;h3 id="挂载iso">挂载ISO&lt;/h3>
&lt;p>该功能用于为虚拟机的虚拟光驱挂载ISO镜像，仅Cloudpods平台上的虚拟机支持挂载ISO操作。如需使用ISO文件安装操作系统，请在挂载ISO镜像后，在修改属性中将启动介质设置为光驱。&lt;/p>
&lt;div class="alert alert-warning" role="alert">
&lt;h4 class="alert-heading">注意&lt;/h4>
通过挂载ISO安装Windows操作系统的虚拟机，安装完成后，还需要安装Virtio驱动，驱动可在镜像市场-ISO中获取。
&lt;/div>
&lt;ol>
&lt;li>在虚拟机页面，单击虚拟机右侧操作列 &lt;strong>&lt;em>&amp;ldquo;更多&amp;rdquo;&lt;/em>&lt;/strong> 按钮，选择下拉菜单 &lt;strong>&lt;em>&amp;ldquo;镜像-挂载ISO&amp;rdquo;&lt;/em>&lt;/strong> 菜单项，弹出挂载ISO对话框。&lt;/li>
&lt;li>选择ISO镜像，若列表中没有ISO镜像，请先在系统镜像列表中上传ISO镜像或导入镜像市场中的ISO镜像。&lt;/li>
&lt;li>单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮，完成挂载ISO操作。&lt;/li>
&lt;/ol>
&lt;h3 id="卸载iso">卸载ISO&lt;/h3>
&lt;p>该功能用于卸载虚拟机的虚拟光驱上挂载的ISO镜像。仅Cloudpods平台上的虚拟机支持卸载ISO操作。&lt;/p>
&lt;ol>
&lt;li>在虚拟机页面，单击虚拟机右侧操作列 &lt;strong>&lt;em>&amp;ldquo;更多&amp;rdquo;&lt;/em>&lt;/strong> 按钮，选择下拉菜单 &lt;strong>&lt;em>&amp;ldquo;镜像-卸载ISO&amp;rdquo;&lt;/em>&lt;/strong> 菜单项，弹出操作确认对话框。&lt;/li>
&lt;li>单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮，完成卸载ISO操作。&lt;/li>
&lt;/ol></description></item><item><title>Docs: 虚拟机网络管理</title><link>https://www.cloudpods.org/zh/docs/onpremise/vminstance/tutorial/network/</link><pubDate>Fri, 19 Jul 2019 17:38:36 +0800</pubDate><guid>https://www.cloudpods.org/zh/docs/onpremise/vminstance/tutorial/network/</guid><description>
&lt;h2 id="web界面操作">Web界面操作&lt;/h2>
&lt;h3 id="关联安全组">关联安全组&lt;/h3>
&lt;p>安全组是一种虚拟的包过滤防火墙，通过设置安全组规则来控制关联的虚拟机是否可以被访问，以及虚拟机可访问的外部资源等。在为虚拟机绑定安全组之前请先在网络-安全组页面创建安全组规则。批量关联安全组操作支持选择不同平台上的虚拟机。&lt;/p>
&lt;p>&lt;strong>单个虚拟机关联安全组&lt;/strong>&lt;/p>
&lt;ol>
&lt;li>在虚拟机页面，单击虚拟机右侧操作列 &lt;strong>&lt;em>&amp;ldquo;更多&amp;rdquo;&lt;/em>&lt;/strong> 按钮，选择下拉菜单 &lt;strong>&lt;em>&amp;ldquo;网络安全-关联安全组&amp;rdquo;&lt;/em>&lt;/strong> 菜单项，弹出关联安全组对话框。&lt;/li>
&lt;li>在关联安全组对话框中支持关联或取消关联安全组。
&lt;ul>
&lt;li>关联安全组：选择要绑定的安全组，最多支持5个。如没有符合需求的安全组，可单击“新建安全组”超链接，在弹出的新建安全组页面配置相关参数，单击 “确定” 按钮，创建安全组。&lt;/li>
&lt;li>取消关联安全组：取消选择安全组，至少保留一个安全组。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮，完成操作。&lt;/li>
&lt;/ol>
&lt;p>&lt;strong>批量关联安全组&lt;/strong>&lt;/p>
&lt;ol>
&lt;li>在虚拟机列表中选择一个或多个虚拟机，单击 &lt;strong>&lt;em>&amp;ldquo;批量操作&amp;rdquo;&lt;/em>&lt;/strong> 按钮，选择下拉菜单 &lt;strong>&lt;em>&amp;ldquo;网络安全-关联安全组&amp;rdquo;&lt;/em>&lt;/strong> 菜单项，弹出关联安全组对话框。&lt;/li>
&lt;li>在关联安全组对话框中支持关联或取消关联安全组。
&lt;ul>
&lt;li>关联安全组：选择要绑定的安全组，最多支持5个。如没有符合需求的安全组，可单击“新建安全组”超链接，在弹出的新建安全组页面配置相关参数，单击 “确定” 按钮，创建安全组。&lt;/li>
&lt;li>取消关联安全组：取消选择安全组，至少保留一个安全组。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮，完成操作。&lt;/li>
&lt;/ol>
&lt;h3 id="绑定弹性公网ip">绑定弹性公网IP&lt;/h3>
&lt;p>弹性公网IP是一种NAT IP，通过与虚拟机绑定，实现虚拟机与公网之间的通信。&lt;/p>
&lt;div class="alert alert-warning" role="alert">
&lt;h4 class="alert-heading">注意&lt;/h4>
&lt;ul>
&lt;li>目前ZStack、OpenStack平台的虚拟机在绑定弹性公网IP时不支持创建弹性公网IP，且不支持绑定属于同一IP子网的弹性公网IP；&lt;/li>
&lt;li>VMware平台的虚拟机不支持绑定弹性公网IP。&lt;/li>
&lt;li>仅Cloudpods平台VPC网络的虚拟机支持绑定弹性公网IP。&lt;/li>
&lt;/ul>
&lt;/div>
&lt;ol>
&lt;li>在虚拟机页面，单击虚拟机右侧操作列 &lt;strong>&lt;em>&amp;ldquo;更多&amp;rdquo;&lt;/em>&lt;/strong> 按钮，选择下拉菜单 &lt;strong>&lt;em>&amp;ldquo;网络安全-绑定弹性公网IP&amp;rdquo;&lt;/em>&lt;/strong> 菜单项，弹出绑定弹性公网IP对话框。&lt;/li>
&lt;li>配置以下参数
&lt;ul>
&lt;li>若绑定方式选择“新建”弹性公网IP，
&lt;ul>
&lt;li>当选择Cloudpods平台时配置以下参数：
&lt;ul>
&lt;li>线路类型：可根据需求创建对应线路类型的EIP。&lt;/li>
&lt;li>网络计费方式：设置弹性公网IP的计费方式，包括按流量计费和按带宽计费。
&lt;ul>
&lt;li>按流量计费：按实际传输流量收费，可限制峰值带宽避免意外流量带来的费用，当瞬间带宽超过该值时将丢包，适用于网络波动大的场合。&lt;/li>
&lt;li>按带宽计费：按传输速率计费，选择固定带宽，超过带宽时将丢包，适用于网络波动较小的场景。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>带宽：设置带宽大小。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>当选择公有云平台时配置以下参数：
&lt;ul>
&lt;li>网络计费方式：设置弹性公网IP的计费方式，包括按流量计费和按带宽计费。
&lt;ul>
&lt;li>按流量计费：按实际传输流量收费，可限制峰值带宽避免意外流量带来的费用，当瞬间带宽超过该值时将丢包，适用于网络波动大的场合。&lt;/li>
&lt;li>按带宽计费：按传输速率计费，选择固定带宽，超过带宽时将丢包，适用于网络波动较小的场景。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>带宽：设置带宽大小。
&lt;div class="alert alert-warning" role="alert">
&lt;h4 class="alert-heading">注意&lt;/h4>
&lt;pre>&lt;code> 腾讯云和Azure不支持按固定带宽计费。
&lt;/code>&lt;/pre>
&lt;/div>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>若绑定方式选择“绑定已有”，请确保在弹性公网IP页面已存在对应平台的弹性公网IP，选择弹性公网IP。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮。&lt;/li>
&lt;/ol>
&lt;h3 id="解绑弹性公网ip">解绑弹性公网IP&lt;/h3>
&lt;p>该功能用于解除虚拟机与弹性公网IP的绑定关系，释放弹性公网IP资源，释放后的弹性公网IP可以被其他虚拟机使用。&lt;/p>
&lt;ol>
&lt;li>在虚拟机页面，单击虚拟机右侧操作列 &lt;strong>&lt;em>&amp;ldquo;更多&amp;rdquo;&lt;/em>&lt;/strong> 按钮，选择下拉菜单 &lt;strong>&lt;em>&amp;ldquo;网络安全-解绑弹性公网IP&amp;rdquo;&lt;/em>&lt;/strong> 菜单项，弹出解绑弹性公网IP对话框。&lt;/li>
&lt;li>单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮，完成操作。&lt;/li>
&lt;/ol>
&lt;h3 id="设置源目标检查">设置源/目标检查&lt;/h3>
&lt;p>源/目标检查即检查虚拟机接收或发送的流量的源/目标地址是否为虚拟机。启用检查时，当源/目标地址不是虚拟机时，则丢弃不处理；当虚拟机作为NAT、路由器、防火墙等使用时必须禁用源/目标检查。&lt;/p>
&lt;p>仅Cloudpods平台的虚拟机支持设置源/目标检查且默认启用源/目标检查。&lt;/p>
&lt;ol>
&lt;li>在虚拟机页面，单击虚拟机右侧操作列 &lt;strong>&lt;em>&amp;ldquo;更多&amp;rdquo;&lt;/em>&lt;/strong> 按钮，选择下拉菜单 &lt;strong>&lt;em>&amp;ldquo;网络安全-设置源/目标检查&amp;rdquo;&lt;/em>&lt;/strong> 菜单项，弹出设置源/目标检查对话框。&lt;/li>
&lt;li>选择开启或关闭源/目标检查，单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮，完成操作。&lt;/li>
&lt;/ol>
&lt;h3 id="补ip">补IP&lt;/h3>
&lt;p>当VMware虚拟机由于一些原因（如关机状态同步、未安装agent等）未同步到IP地址时，虚拟机列表的IP地址字段显示为&amp;quot;-&amp;quot;，此时支持为VMware虚拟机补IP。补充的IP地址必须与虚拟机的实际IP一致。&lt;/p>
&lt;ol>
&lt;li>在虚拟机列表中，当VMware平台虚拟机IP地址列为空时，单击IP地址列的 &lt;strong>&lt;em>&amp;ldquo;可补IP&amp;rdquo;&lt;/em>&lt;/strong> 按钮，弹出补充IP对话框。&lt;/li>
&lt;li>设置IP地址，单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮。&lt;/li>
&lt;/ol>
&lt;h3 id="虚拟机网卡管理">虚拟机网卡管理&lt;/h3>
&lt;p>该功能用于查看虚拟机的网卡信息，并支持针对网卡进行管理操作。&lt;/p>
&lt;h4 id="添加网卡">添加网卡&lt;/h4>
&lt;p>该功能用于为虚拟机添加网卡，最多可添加8个网卡，目前仅Cloudpods平台的虚拟机支持添加网卡功能。&lt;/p>
&lt;ol>
&lt;li>在虚拟机页面，单击虚拟机名称项，进入虚拟机详情页面。&lt;/li>
&lt;li>单击“网络”页签，进入网络页面。&lt;/li>
&lt;li>单击网卡列表上方 &lt;strong>&lt;em>&amp;ldquo;添加网卡&amp;rdquo;&lt;/em>&lt;/strong> 按钮，弹出添加网卡对话框。&lt;/li>
&lt;li>设置VPC和IP子网，如需指定静态IP，可单击 &lt;strong>&lt;em>&amp;ldquo;手动配置IP&amp;rdquo;&lt;/em>&lt;/strong> 按钮，设置IP地址，单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮。&lt;/li>
&lt;/ol>
&lt;h4 id="修改带宽">修改带宽&lt;/h4>
&lt;p>该功能用于修改网卡的带宽限制。目前仅支持Cloudpods平台、VMware平台、ZStack平台、OpenStack平台。&lt;/p>
&lt;ol>
&lt;li>在虚拟机页面，单击虚拟机名称项，进入虚拟机详情页面。&lt;/li>
&lt;li>单击“网络”页签，进入网络页面。&lt;/li>
&lt;li>单击网卡右侧操作列 &lt;strong>&lt;em>&amp;ldquo;修改带宽&amp;rdquo;&lt;/em>&lt;/strong> 按钮，弹出修改带宽对话框。&lt;/li>
&lt;li>设置带宽，0表示无限制，取值范围为0~10000的整数。单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮。&lt;/li>
&lt;li>若开启了调整配置的工单，则还需要填入申请原因，单击 &lt;strong>&lt;em>&amp;ldquo;提交工单&amp;rdquo;&lt;/em>&lt;/strong> 按钮，提交修改带宽工单，等待审批通过后才会成功修改带宽。&lt;/li>
&lt;/ol>
&lt;h4 id="更换ip">更换IP&lt;/h4>
&lt;p>该功能用于修改虚拟机的IP地址，支持在IP子网中动态分配IP地址或手动指定IP子网内的IP地址。目前仅支持Cloudpods平台、VMware平台。&lt;/p>
&lt;ol>
&lt;li>在虚拟机页面，单击虚拟机名称项，进入虚拟机详情页面。&lt;/li>
&lt;li>单击“网络”页签，进入网络页面。&lt;/li>
&lt;li>单击网卡右侧操作列 &lt;strong>&lt;em>&amp;ldquo;更换IP&amp;rdquo;&lt;/em>&lt;/strong> 按钮，弹出更换IP对话框。&lt;/li>
&lt;li>选择IP子网，如需指定静态IP，可单击 &lt;strong>&lt;em>&amp;ldquo;手动配置IP&amp;rdquo;&lt;/em>&lt;/strong> 按钮，设置IP地址，单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮。&lt;/li>
&lt;/ol>
&lt;h4 id="卸载网卡">卸载网卡&lt;/h4>
&lt;p>该功能用于卸载虚拟机上的网卡，卸载时需要按照顺序卸载，只允许卸载最后一块网络，即序号最大的网卡支持卸载，所有网卡均可以被卸载。目前仅支持Cloudpods平台。&lt;/p>
&lt;ol>
&lt;li>在虚拟机页面，单击虚拟机名称项，进入虚拟机详情页面。&lt;/li>
&lt;li>单击“网络”页签，进入网络页面。&lt;/li>
&lt;li>单击最后一块网卡右侧操作列 &lt;strong>&lt;em>&amp;ldquo;卸载&amp;rdquo;&lt;/em>&lt;/strong> 按钮，弹出卸载网卡对话框。&lt;/li>
&lt;li>单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮，完成操作。&lt;/li>
&lt;/ol></description></item><item><title>Docs: 虚拟机监控</title><link>https://www.cloudpods.org/zh/docs/onpremise/vminstance/tutorial/monitor/</link><pubDate>Fri, 19 Jul 2019 17:38:36 +0800</pubDate><guid>https://www.cloudpods.org/zh/docs/onpremise/vminstance/tutorial/monitor/</guid><description>
&lt;p>平台支持两种监控宿主机上虚拟机的信息，一是通过宿主机获取虚拟机的监控信息，该方式获取的监控数据误差较大，二是为虚拟机安装Agent，像虚拟机内存使用率、磁盘使用率指标无法直接通过宿主机获取，需要&lt;a href="../../../../monitor_ops/monitor/tutorial/installagent">安装监控Agent&lt;/a>。&lt;/p>
&lt;p>目前虚拟机监控指标分为两类。&lt;/p>
&lt;ul>
&lt;li>基础监控，即支持通过宿主机获取虚拟机的监控信息。监控指标包括CPU使用率、内存使用率、网络入流量、网络出流量、磁盘读速率、磁盘写速率&lt;/li>
&lt;li>Agent监控，即为虚拟机安装Agent后获取的监控信息。监控指标包括CPU使用率、内存使用率、网络入流量、网络出流量、磁盘使用率、磁盘读速率、磁盘写速率&lt;/li>
&lt;/ul>
&lt;p>虚拟机监控查询时间支持查看近1小时、近1天、近1周、近1月、近3月、近6月的性能监控信息，支持设置时间粒度，时间粒度大小与查看的时长有关。&lt;/p></description></item><item><title>Docs: 删除</title><link>https://www.cloudpods.org/zh/docs/onpremise/vminstance/tutorial/delete/</link><pubDate>Fri, 19 Jul 2019 17:32:09 +0800</pubDate><guid>https://www.cloudpods.org/zh/docs/onpremise/vminstance/tutorial/delete/</guid><description>
&lt;h2 id="web界面操作">Web界面操作&lt;/h2>
&lt;h3 id="设置删除保护">设置删除保护&lt;/h3>
&lt;p>该功能用于设置虚拟机的删除保护。当虚拟机启用删除保护后，虚拟机无法被删除；当虚拟机禁用删除保护后，虚拟机才可以被删除。&lt;/p>
&lt;p>&lt;strong>单个虚拟机设置删除保护&lt;/strong>&lt;/p>
&lt;ol>
&lt;li>禁用删除保护：
&lt;ul>
&lt;li>单击虚拟机名称右侧带有&lt;img src="../../../images/computing/delprotect1.png" alt="">图标时，单击虚拟机右侧操作列 &lt;strong>&lt;em>&amp;ldquo;更多&amp;rdquo;&lt;/em>&lt;/strong> 按钮，选择下拉菜单 &lt;strong>&lt;em>&amp;ldquo;删除-设置删除保护&amp;rdquo;&lt;/em>&lt;/strong> 菜单项，弹出设置删除保护对话框。&lt;/li>
&lt;li>选择&amp;quot;禁用&amp;quot;删除保护，单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>启用删除保护：
&lt;ul>
&lt;li>当虚拟机名称右侧不带&lt;img src="../../../images/computing/delprotect1.png" alt="">图标时，单击虚拟机右侧操作列 &lt;strong>&lt;em>&amp;ldquo;更多&amp;rdquo;&lt;/em>&lt;/strong> 按钮，选择下拉菜单 &lt;strong>&lt;em>&amp;ldquo;删除-设置删除保护&amp;rdquo;&lt;/em>&lt;/strong> 菜单项，弹出设置删除保护对话框。&lt;/li>
&lt;li>选择&amp;quot;启用&amp;quot;删除保护，单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;p>&lt;strong>批量设置删除保护&lt;/strong>&lt;/p>
&lt;p>批量设置删除保护操作支持选择不同平台的虚拟机。&lt;/p>
&lt;ol>
&lt;li>禁用删除保护：
&lt;ul>
&lt;li>在虚拟机列表中选择一个或多个虚拟机，单击列表上方 &lt;strong>&lt;em>&amp;ldquo;批量操作&amp;rdquo;&lt;/em>&lt;/strong> 按钮，选择下拉菜单 &lt;strong>&lt;em>&amp;ldquo;设置删除保护&amp;rdquo;&lt;/em>&lt;/strong> 菜单项，弹出设置删除保护对话框。&lt;/li>
&lt;li>选择&amp;quot;禁用&amp;quot;删除保护，单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮，批量为虚拟机禁用删除保护。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>启用删除保护：
&lt;ul>
&lt;li>在虚拟机列表中选择一个或多个虚拟机，单击列表上方 &lt;strong>&lt;em>&amp;ldquo;批量操作&amp;rdquo;&lt;/em>&lt;/strong> 按钮，选择下拉菜单 &lt;strong>&lt;em>&amp;ldquo;设置删除保护&amp;rdquo;&lt;/em>&lt;/strong> 菜单项，弹出设置删除保护对话框。&lt;/li>
&lt;li>选择&amp;quot;启用&amp;quot;删除保护，单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮，批量为虚拟机启用删除保护。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;h3 id="删除">删除&lt;/h3>
&lt;p>该功能用于删除虚拟机，当虚拟机名称项右侧有&lt;img src="../../../images/computing/delprotect1.png" alt="">图标，表示该虚拟机启用了删除保护，无法删除虚拟机。如需要删除虚拟机，则需要先禁用删除保护再删除虚拟机。若&lt;/p>
&lt;p>批量删除虚拟机操作支持选择不同平台的虚拟机。&lt;/p>
&lt;div class="alert alert-warning" role="alert">
&lt;h4 class="alert-heading">注意&lt;/h4>
&lt;ul>
&lt;li>若虚拟机所在的宿主机状态异常，即使禁用删除保护也无法删除虚拟机。&lt;/li>
&lt;li>若宿主机已经下线无法恢复时，需要管理员在控制节点使用climc的server-purge命令删除虚拟机记录。&lt;a href="../../../../faq/heterresource/">可参考FAQ手册中的如何清理一台已经下线的宿主机上面的虚拟机的记录？&lt;/a>&lt;/li>
&lt;/ul>
&lt;/div>
&lt;h4 id="删除虚拟机">删除虚拟机&lt;/h4>
&lt;div class="alert alert-warning" role="alert">
&lt;h4 class="alert-heading">注意&lt;/h4>
&lt;ul>
&lt;li>阿里云、腾讯云、华为云、AWS、Azure、Google、Zstack、Dstack、OpenStack、Cloudpods等平台支持删除虚拟机时同时删除快照、后挂载的数据盘、EIP；&lt;/li>
&lt;li>华为云删除虚拟机时必须勾选删除快照。&lt;/li>
&lt;li>Cloudpods平台删除虚拟机时，若磁盘时ceph盘则必须同时删除快照。若磁盘是本地磁盘，则必须勾选同时删除后挂载的数据盘。&lt;/li>
&lt;/ul>
&lt;/div>
&lt;ol>
&lt;li>在虚拟机页面，单击虚拟机右侧操作列 &lt;strong>&lt;em>&amp;ldquo;更多&amp;rdquo;&lt;/em>&lt;/strong> 按钮，选择下拉菜单 &lt;strong>&lt;em>&amp;ldquo;删除-删除&amp;rdquo;&lt;/em>&lt;/strong> 菜单项，弹出操作确认对话框。&lt;/li>
&lt;li>支持勾选“同时删除快照”、“同时删除后挂载的数据盘”、“同时删除EIP”等。&lt;/li>
&lt;li>单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮，完成操作。&lt;/li>
&lt;li>若开启了工单，则还需要填入申请原因，单击 &lt;strong>&lt;em>&amp;ldquo;提交工单&amp;rdquo;&lt;/em>&lt;/strong> 按钮，提交删除主机工单，等待审批通过后才会成功删除虚拟机。&lt;/li>
&lt;/ol>
&lt;h4 id="批量删除虚拟机">批量删除虚拟机&lt;/h4>
&lt;div class="alert alert-warning" role="alert">
&lt;h4 class="alert-heading">注意&lt;/h4>
&lt;ul>
&lt;li>阿里云、腾讯云、华为云、AWS、Azure、Google、Zstack、Dstack、OpenStack、Cloudpods等平台支持删除虚拟机时同时删除快照、后挂载的数据盘、EIP；&lt;/li>
&lt;li>华为云删除虚拟机时必须勾选删除快照。&lt;/li>
&lt;li>Cloudpods平台删除虚拟机时，若磁盘时ceph盘则必须同时删除快照。若磁盘是本地磁盘，则必须勾选同时删除后挂载的数据盘。&lt;/li>
&lt;/ul>
&lt;/div>
&lt;ol>
&lt;li>在虚拟机列表中选择一个或多个虚拟机，单击列表上方 &lt;strong>&lt;em>&amp;ldquo;批量操作&amp;rdquo;&lt;/em>&lt;/strong> 按钮，选择下拉菜单 &lt;strong>&lt;em>&amp;ldquo;删除&amp;rdquo;&lt;/em>&lt;/strong> 菜单项，弹出操作确认对话框。&lt;/li>
&lt;li>支持勾选“同时删除快照”、“同时删除后挂载的数据盘”、“同时删除EIP”等。&lt;/li>
&lt;li>单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮，完成操作。&lt;/li>
&lt;li>若开启了工单，则还需要填入申请原因，单击 &lt;strong>&lt;em>&amp;ldquo;提交工单&amp;rdquo;&lt;/em>&lt;/strong> 按钮，提交删除主机工单，等待审批通过后才会成功删除虚拟机。&lt;/li>
&lt;/ol>
&lt;h2 id="climc命令行操作">Climc命令行操作&lt;/h2>
&lt;h3 id="删除-1">删除&lt;/h3>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8f5902;font-style:italic"># 删除至回收站&lt;/span>
$ climc server-delete &amp;lt;server_id&amp;gt;
&lt;span style="color:#8f5902;font-style:italic"># 彻底删除&lt;/span>
$ climc server-delete -f &amp;lt;server_id&amp;gt;
&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Docs: 主备机</title><link>https://www.cloudpods.org/zh/docs/onpremise/vminstance/tutorial/backup/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://www.cloudpods.org/zh/docs/onpremise/vminstance/tutorial/backup/</guid><description>
&lt;p>Cloudpods平台上的基于本地存储创建的虚拟机支持高可用功能，通过为虚拟机创建备份机来实现高可用，虚拟机与备份机之间互为主备且数据保持实时同步，当主虚拟机故障时，将会自动切换到备份机，快速恢复业务，减少因为虚拟机故障造成的业务宕机时间，同时将会再次为虚拟机创建可用的备份机，使其一直保持高可用的状态。&lt;/p>
&lt;div class="alert alert-warning" role="alert">
&lt;h4 class="alert-heading">注意&lt;/h4>
当创建备份机失败或切换备份机失败时，支持手动重试。
&lt;/div>
&lt;h2 id="web界面操作">Web界面操作&lt;/h2>
&lt;h3 id="添加备份机">添加备份机&lt;/h3>
&lt;p>该功能用于为使用本地存储的虚拟机在其它宿主机上创建备份机，创建的备份机与虚拟机配置相同，互为主备，实时保持数据同步等。虚拟机列表中只显示主虚拟机的信息，不显示备份机信息。&lt;/p>
&lt;div class="alert alert-warning" role="alert">
&lt;h4 class="alert-heading">注意&lt;/h4>
&lt;ul>
&lt;li>虚拟机和备份机不可以位于同一宿主机。&lt;/li>
&lt;li>虚拟机添加备份机之后不支持调整配置、创建快照、迁移功能。&lt;/li>
&lt;li>已经创建快照的虚拟机，添加备份机且切换到备份机后，原有快照不可用。&lt;/li>
&lt;/ul>
&lt;/div>
&lt;ol>
&lt;li>在虚拟机页面，单击虚拟机右侧操作列 &lt;strong>&lt;em>&amp;ldquo;更多&amp;rdquo;&lt;/em>&lt;/strong> 按钮，选择下拉菜单 &lt;strong>&lt;em>&amp;ldquo;高可用-添加备份机&amp;rdquo;&lt;/em>&lt;/strong> 菜单项，弹出添加备份机对话框。&lt;/li>
&lt;li>选择备份机的宿主机，单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮。&lt;/li>
&lt;li>虚拟机名称右侧将出现&lt;img src="../../../images/computing/HA.png" alt="">的图标。&lt;/li>
&lt;/ol>
&lt;h3 id="删除备份机">删除备份机&lt;/h3>
&lt;p>该功能用于删除虚拟机的备份机。&lt;/p>
&lt;ol>
&lt;li>单击名称侧带有&lt;img src="../../../images/computing/HA.png" alt="">图标的虚拟机的 &lt;strong>&lt;em>&amp;ldquo;更多&amp;rdquo;&lt;/em>&lt;/strong> 按钮，选择下拉菜单 &lt;strong>&lt;em>&amp;ldquo;高可用-删除备份机&amp;rdquo;&lt;/em>&lt;/strong> 菜单项，弹出添加备份机对话框。&lt;/li>
&lt;li>若备份机所在宿主机离线，可勾选“强制清除备份机记录”。&lt;/li>
&lt;li>单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮，删除备份机。&lt;/li>
&lt;/ol></description></item><item><title>Docs: 迁移相关</title><link>https://www.cloudpods.org/zh/docs/onpremise/vminstance/tutorial/migrate/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://www.cloudpods.org/zh/docs/onpremise/vminstance/tutorial/migrate/</guid><description>
&lt;h2 id="介绍">介绍&lt;/h2>
&lt;p>目前迁移功能主要用于 Cloudpods 内置私有云的虚拟机上，该功能用于将虚拟机迁移到其他宿主机上面。当未指定宿主机时，系统将自动选择宿主机。&lt;/p>
&lt;p>迁移的方式分为“冷迁移”和“热迁移”，区别如下：&lt;/p>
&lt;ul>
&lt;li>冷迁移：在虚拟机&lt;strong>关机的状态&lt;/strong>下，将虚拟机磁盘从源宿主机拷贝到目标宿主机。&lt;/li>
&lt;li>热迁移：在虚拟机&lt;strong>运行的状态&lt;/strong>下，将虚拟机的磁盘以及内存状态同步到目标宿主机，当两边数据同步后，再将虚拟机切换到目标宿主机。&lt;/li>
&lt;/ul>
&lt;p>热迁移和冷迁移比起来，能够在不关机，保证业务运行的情况下，将虚拟机从一台宿主机迁移到另一台宿主机。&lt;/p>
&lt;p>但热迁移默认要求目标宿主机和源宿主机的 CPU microcode 一致，可以通过以下命令查看 CPU 的 microcode：&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ cat /proc/cpuinfo &lt;span style="color:#000;font-weight:bold">|&lt;/span> grep microcode &lt;span style="color:#000;font-weight:bold">|&lt;/span> uniq
microcode : 0xca
&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="web界面操作">Web界面操作&lt;/h2>
&lt;h3 id="迁移">迁移&lt;/h3>
&lt;p>该功能用于将虚拟机迁移到其他宿主机上面。当未指定宿主机时，系统将自动选择宿主机。&lt;/p>
&lt;div class="alert alert-warning" role="alert">
&lt;h4 class="alert-heading">注意&lt;/h4>
&lt;ul>
&lt;li>高可用的虚拟机不支持迁移。&lt;/li>
&lt;li>挂载了GPU设备或光驱设备的虚拟机不支持迁移。&lt;/li>
&lt;/ul>
&lt;/div>
&lt;p>&lt;strong>单个虚拟机迁移&lt;/strong>&lt;/p>
&lt;ol>
&lt;li>在虚拟机页面，单击虚拟机右侧操作列 &lt;strong>&lt;em>&amp;ldquo;更多&amp;rdquo;&lt;/em>&lt;/strong> 按钮，选择下拉菜单 &lt;strong>&lt;em>&amp;ldquo;高可用-迁移&amp;rdquo;&lt;/em>&lt;/strong> 菜单项，弹出迁移对话框。&lt;/li>
&lt;li>配置以下参数：
&lt;ul>
&lt;li>强制迁移：若宿主机宕机，且虚拟机使用共享存储，可勾选“强制迁移”。&lt;/li>
&lt;li>跳过CPU检查：虚拟机迁移时，要求目的宿主机与虚拟机所在宿主机的CPU型号和微码相同，若宿主机CPU型号不一致仍想继续迁移，可开启跳过CPU检查，系统将会尽力而为的进行惹迁移，但是迁移完成后，可能会存在虚拟机在目标宿主机上无法正常运行的情况。&lt;/li>
&lt;li>宿主机：选择目标宿主机，也可留空，留空将由系统自动选择宿主机。平台会预先调度过滤出符合迁移条件的宿主机，如没有满足条件的宿主机，请检查在同一二层网络的宿主机上是否有可用的CPU、内存、存储，以及CPU型号和微码是否一样，若不一样，可先跳过CPU检查后尝试迁移等。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮，将虚拟机迁移到其他宿主机上面。&lt;/li>
&lt;/ol>
&lt;p>&lt;strong>批量迁移&lt;/strong>&lt;/p>
&lt;p>可以选择在不同宿主机的虚拟机迁移到同一个宿主机上。&lt;/p>
&lt;ol>
&lt;li>在虚拟机列表中选择一个或多个虚拟机，单击列表上方 &lt;strong>&lt;em>&amp;ldquo;批量操作&amp;rdquo;&lt;/em>&lt;/strong> 按钮，选择下拉菜单 &lt;strong>&lt;em>&amp;ldquo;迁移&amp;rdquo;&lt;/em>&lt;/strong> 菜单项项，弹出迁移对话框。&lt;/li>
&lt;li>配置以下参数：
&lt;ul>
&lt;li>强制迁移：若宿主机宕机，且虚拟机使用共享存储，可勾选“强制迁移”。&lt;/li>
&lt;li>跳过CPU检查：虚拟机迁移时，要求目的宿主机与虚拟机所在宿主机的CPU型号和微码相同，若宿主机CPU型号不一致仍想继续迁移，可开启跳过CPU检查，系统将会尽力而为的进行惹迁移，但是迁移完成后，可能会存在虚拟机在目标宿主机上无法正常运行的情况。&lt;/li>
&lt;li>宿主机：选择目标宿主机，也可留空，留空将由系统自动选择宿主机。平台会预先调度过滤出符合迁移条件的宿主机，如没有满足条件的宿主机，请检查在同一二层网络的宿主机上是否有可用的CPU、内存、存储，以及CPU型号和微码是否一样，若不一样，可先跳过CPU检查后尝试迁移等。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮，将虚拟机迁移到其他宿主机上面。&lt;/li>
&lt;/ol>
&lt;h2 id="climc">Climc&lt;/h2>
&lt;h3 id="冷迁移">冷迁移&lt;/h3>
&lt;p>虚拟机在关机状态下，可以执行冷迁移操作。&lt;/p>
&lt;h4 id="查看冷迁移帮助信息">查看冷迁移帮助信息&lt;/h4>
&lt;p>冷迁移的命令为 &lt;code>climc server-migrate&lt;/code>，通过下面的命令可以查看参数的说明和帮助信息：&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ climc &lt;span style="color:#204a87">help&lt;/span> server-migrate
Usage: climc server-migrate &lt;span style="color:#ce5c00;font-weight:bold">[&lt;/span>--auto-start&lt;span style="color:#ce5c00;font-weight:bold">]&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">[&lt;/span>--rescue-mode&lt;span style="color:#ce5c00;font-weight:bold">]&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">[&lt;/span>--prefer-host PREFER_HOST&lt;span style="color:#ce5c00;font-weight:bold">]&lt;/span> &amp;lt;ID&amp;gt;
Migrate server
Positional arguments:
&amp;lt;ID&amp;gt;
ID of server
Optional arguments:
&lt;span style="color:#ce5c00;font-weight:bold">[&lt;/span>--auto-start&lt;span style="color:#ce5c00;font-weight:bold">]&lt;/span>
Server auto start after migrate
&lt;span style="color:#ce5c00;font-weight:bold">[&lt;/span>--rescue-mode&lt;span style="color:#ce5c00;font-weight:bold">]&lt;/span>
Migrate server in rescue mode, all disks must reside on shared storage
&lt;span style="color:#ce5c00;font-weight:bold">[&lt;/span>--prefer-host PREFER_HOST&lt;span style="color:#ce5c00;font-weight:bold">]&lt;/span>
Server migration prefer host id or name
&lt;/code>&lt;/pre>&lt;/div>&lt;h4 id="冷迁移举例">冷迁移举例&lt;/h4>
&lt;ul>
&lt;li>对已经关机的虚拟机 vm1 进行迁移&lt;/li>
&lt;/ul>
&lt;pre>&lt;code># 先查看虚拟机的信息
$ climc server-list --search vm1 --details
# 执行随机迁移
$ climc server-migrate vm1
# 迁移过程中虚拟机会处于 migrating 的状态
$ climc server-list --search vm1
# 迁移完成后虚拟机状态变为 ready，并且可以发现宿主机信息也发生了变化
$ climc server-list --search vm1 --details
&lt;/code>&lt;/pre>&lt;ul>
&lt;li>迁移到指定宿主机&lt;/li>
&lt;/ul>
&lt;pre>&lt;code># 先列出平台的 kvm 宿主机
$ climc host-list --hypervisor kvm
# 然后指定宿主机名称或者 id 迁移
$ climc server-migrate --prefer-host xxx vm1
&lt;/code>&lt;/pre>&lt;ul>
&lt;li>迁移后自动启动虚拟机&lt;/li>
&lt;/ul>
&lt;pre>&lt;code>$ climc server-migrate --auto-start vm1
$ climc server-migrate --auto-start --prefer-host xxx vm1
&lt;/code>&lt;/pre>&lt;ul>
&lt;li>rescue mode 迁移：当宿主机完全宕机，虚拟机所有的磁盘都使用共享存储（ceph 等分布式块存储）的情况下，可以通过 rescue mode 把元数据迁移到另外的宿主机，然后启动&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ climc server-migrate --rescue-mode &lt;span style="color:#4e9a06">\
&lt;/span>&lt;span style="color:#4e9a06">&lt;/span> --auto-start &lt;span style="color:#4e9a06">\
&lt;/span>&lt;span style="color:#4e9a06">&lt;/span> --prefer-host &lt;span style="color:#000">$host_name&lt;/span> &lt;span style="color:#4e9a06">\
&lt;/span>&lt;span style="color:#4e9a06">&lt;/span> &lt;span style="color:#000">$vm_name&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="热迁移">热迁移&lt;/h3>
&lt;p>虚拟机在运行状态进行的迁移叫做热迁移，热迁移的速度会比冷迁移慢，因为设计磁盘和内存等状态的同步，但好处是在不关机的状态下进行迁移，基本上对虚拟机上运行的业务没有影响。&lt;/p>
&lt;h4 id="查看热迁移帮助信息">查看热迁移帮助信息&lt;/h4>
&lt;p>热迁移的命令为 &lt;code>climc server-live-migrate&lt;/code>，通过下面的命令查看帮助信息：&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ climc &lt;span style="color:#204a87">help&lt;/span> server-live-migrate
Usage: climc server-live-migrate &lt;span style="color:#ce5c00;font-weight:bold">[&lt;/span>--skip-cpu-check&lt;span style="color:#ce5c00;font-weight:bold">]&lt;/span> &lt;span style="color:#ce5c00;font-weight:bold">[&lt;/span>--prefer-host PREFER_HOST&lt;span style="color:#ce5c00;font-weight:bold">]&lt;/span> &amp;lt;ID&amp;gt;
Live-Migrate server
Positional arguments:
&amp;lt;ID&amp;gt;
ID of server
Optional arguments:
&lt;span style="color:#ce5c00;font-weight:bold">[&lt;/span>--skip-cpu-check&lt;span style="color:#ce5c00;font-weight:bold">]&lt;/span>
Skip check CPU mode of the target host
&lt;span style="color:#ce5c00;font-weight:bold">[&lt;/span>--prefer-host PREFER_HOST&lt;span style="color:#ce5c00;font-weight:bold">]&lt;/span>
Server migration prefer host id or name
&lt;/code>&lt;/pre>&lt;/div>&lt;h4 id="热迁移举例">热迁移举例&lt;/h4>
&lt;ul>
&lt;li>对虚拟机 vm1 进行热迁移，目标宿主机随机选择&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ climc server-live-migrate vm1
&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>热迁移默认要求目标宿主机和虚拟机当前所在的宿主机 CPU microcode 一致， 如果不一致该宿主机则会被调度器过滤掉，如果环境里面实在没有 CPU 一致的目标宿主机，可以使用 &lt;code>--skip-cpu-check&lt;/code> 绕过 CPU microcode 的检查&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ climc server-live-migrate --skip-cpu-check vm1
&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>指定 vm1 热迁移到目标宿主机 host1 ，并且绕过 CPU microcode 检查&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ climc server-live-migrate &lt;span style="color:#4e9a06">\
&lt;/span>&lt;span style="color:#4e9a06">&lt;/span> --prefer-host host1 &lt;span style="color:#4e9a06">\
&lt;/span>&lt;span style="color:#4e9a06">&lt;/span> --skip-cpu-check &lt;span style="color:#4e9a06">\
&lt;/span>&lt;span style="color:#4e9a06">&lt;/span> vm1
&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Docs: GPU相关</title><link>https://www.cloudpods.org/zh/docs/onpremise/vminstance/tutorial/gpu/</link><pubDate>Fri, 19 Jul 2019 18:32:40 +0800</pubDate><guid>https://www.cloudpods.org/zh/docs/onpremise/vminstance/tutorial/gpu/</guid><description>
&lt;p>目前仅支持 Cloudpods kvm 虚拟机使用 GPU，使用的 PCI Passthrough 的方式将宿主机上的 Nvidia/AMD GPU 透传给虚拟机使用。&lt;/p>
&lt;h2 id="web界面操作">Web界面操作&lt;/h2>
&lt;h3 id="设置gpu卡">设置GPU卡&lt;/h3>
&lt;p>该功能用于设置为虚拟机绑定或解绑GPU卡，绑定GPU卡之前请确保虚拟机所在宿主机上存在GPU透传设备。当虚拟机用于高性能计算、图形显示等用途时，建议绑定GPU卡。&lt;/p>
&lt;div class="alert alert-warning" role="alert">
&lt;h4 class="alert-heading">注意&lt;/h4>
&lt;ul>
&lt;li>仅Cloudpods平台支持绑定、解绑GPU卡功能。&lt;/li>
&lt;li>当宿主机上存在空闲的GPU设备时，宿主机上的虚拟机才可以绑定GPU卡。&lt;/li>
&lt;li>虚拟机关机状态才可以绑定、解绑GPU卡。&lt;/li>
&lt;li>批量绑定GPU卡操作仅支持关联同种型号的GPU卡，批量解绑会取消所有已关联的GPU卡。&lt;/li>
&lt;li>目前仅管理员支持设置GPU功能。&lt;/li>
&lt;/ul>
&lt;/div>
&lt;p>&lt;strong>单个虚拟机设置GPU卡&lt;/strong>&lt;/p>
&lt;ol>
&lt;li>在虚拟机页面，单击虚拟机右侧操作列 &lt;strong>&lt;em>&amp;ldquo;更多&amp;rdquo;&lt;/em>&lt;/strong> 按钮，选择下拉菜单 &lt;strong>&lt;em>&amp;ldquo;实例设置-设置GPU卡&amp;rdquo;&lt;/em>&lt;/strong> 菜单项，弹出设置GPU卡对话框。&lt;/li>
&lt;li>设置GPU卡页面支持绑定和解绑GPU卡。
&lt;ul>
&lt;li>绑定GPU卡：勾选是否绑定，并选择GPU卡，支持选择为虚拟机绑定多个GPU卡，默认勾选设置成功后自动启动，即绑定GPU卡后自动启动虚拟机，单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮。&lt;/li>
&lt;li>解绑GPU卡：取消勾选是否绑定，取消后，则解绑虚拟机上的所有GPU卡，默认勾选设置成功后自动启动，即解绑GPU卡后自动启动虚拟机，单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;p>&lt;strong>批量为虚拟机设置GPU卡&lt;/strong>&lt;/p>
&lt;ol>
&lt;li>在虚拟机列表中选择一个或多个Cloudpods平台上关机状态的虚拟机，单击列表上方 &lt;strong>&lt;em>&amp;ldquo;批量操作&amp;rdquo;&lt;/em>&lt;/strong> 按钮，选择下拉菜单 &lt;strong>&lt;em>&amp;ldquo;设置GPU卡&amp;rdquo;&lt;/em>&lt;/strong> 菜单项，弹出设置GPU卡对话框。&lt;/li>
&lt;li>设置GPU卡页面支持批量绑定和解绑GPU卡。
&lt;ul>
&lt;li>绑定GPU卡：设置GPU卡选择“关联GPU卡”，选择GPU卡型号，设置每台虚拟机上绑定的GPU卡数量，默认勾选批量绑定GPU后自动启动，即绑定GPU卡后自动启动虚拟机，单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮。&lt;/li>
&lt;li>解绑GPU卡：设置GPU卡选择“解绑GPU卡”，默认勾选批量解绑成功后自动启动，即解绑GPU卡后自动启动虚拟机，单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮，批量解绑GPU卡。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;h2 id="climc">Climc&lt;/h2>
&lt;h3 id="创建-gpu-云主机">创建 GPU 云主机&lt;/h3>
&lt;ul>
&lt;li>查询 gpu 列表&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ climc isolated-device-list --gpu
+--------------------------------------+----------+---------------------+---------+------------------+--------------------------------------+
&lt;span style="color:#000;font-weight:bold">|&lt;/span> ID &lt;span style="color:#000;font-weight:bold">|&lt;/span> Dev_type &lt;span style="color:#000;font-weight:bold">|&lt;/span> Model &lt;span style="color:#000;font-weight:bold">|&lt;/span> Addr &lt;span style="color:#000;font-weight:bold">|&lt;/span> Vendor_device_id &lt;span style="color:#000;font-weight:bold">|&lt;/span> Host_id &lt;span style="color:#000;font-weight:bold">|&lt;/span>
+--------------------------------------+----------+---------------------+---------+------------------+--------------------------------------+
&lt;span style="color:#000;font-weight:bold">|&lt;/span> 273f4f72-06b6-49aa-8456-4beceec44997 &lt;span style="color:#000;font-weight:bold">|&lt;/span> GPU-HPC &lt;span style="color:#000;font-weight:bold">|&lt;/span> GeForce GTX &lt;span style="color:#0000cf;font-weight:bold">1050&lt;/span> Ti &lt;span style="color:#000;font-weight:bold">|&lt;/span> 41:00.0 &lt;span style="color:#000;font-weight:bold">|&lt;/span> 10de:1c82 &lt;span style="color:#000;font-weight:bold">|&lt;/span> 3bce9607-2597-469f-8d9b-977345456739 &lt;span style="color:#000;font-weight:bold">|&lt;/span>
&lt;span style="color:#000;font-weight:bold">|&lt;/span> a77333e9-08d9-45c6-87eb-a7d8d902c5f5 &lt;span style="color:#000;font-weight:bold">|&lt;/span> GPU-HPC &lt;span style="color:#000;font-weight:bold">|&lt;/span> Quadro FX &lt;span style="color:#0000cf;font-weight:bold">580&lt;/span> &lt;span style="color:#000;font-weight:bold">|&lt;/span> 05:00.0 &lt;span style="color:#000;font-weight:bold">|&lt;/span> 10de:0659 &lt;span style="color:#000;font-weight:bold">|&lt;/span> 3bce9607-2597-469f-8d9b-977345456739 &lt;span style="color:#000;font-weight:bold">|&lt;/span>
+--------------------------------------+----------+---------------------+---------+------------------+--------------------------------------+
&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>创建 server&lt;/li>
&lt;/ul>
&lt;p>server-create 中的 &lt;code>--isolated-device&lt;/code> 参数指定透传的设备到云主机，可以重复使用多次，透传多个 gpu 到云主机，但要求透传到同一云主机的 gpu 必须在同一宿主机。其余创建参数和创建普通云主机是一样的。&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ climc server-create --hypervisor kvm --isolated-device 273f4f72-06b6-49aa-8456-4beceec44997 ...
&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="查询-gpu-云主机">查询 GPU 云主机&lt;/h3>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ climc server-list --gpu
&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="关联-gpu">关联 GPU&lt;/h3>
&lt;p>如果云主机所在的宿主机有可用的 gpu，在主机关机的情况下，可以通过 &lt;code>server-attach-isolated-device&lt;/code> 命令将 gpu 和云主机关联起来，下次主机启动后就可以使用该 gpu 。&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ climc server-attach-isolated-device &amp;lt;server_id&amp;gt; &amp;lt;device_id&amp;gt;
&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="卸载-gpu">卸载 GPU&lt;/h3>
&lt;p>如果云主机关联了 gpu，可以通过 &lt;code>server-detach-isolated-device&lt;/code> 卸载主机的某一 gpu。&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ climc server-detach-isolated-device &amp;lt;server_id&amp;gt; &amp;lt;device_id&amp;gt;
&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>Docs: 反亲和组</title><link>https://www.cloudpods.org/zh/docs/onpremise/vminstance/tutorial/instancegroup/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://www.cloudpods.org/zh/docs/onpremise/vminstance/tutorial/instancegroup/</guid><description>
&lt;p>反亲和组是针对反亲和组中虚拟机的简单调度策略，根据反亲和组中的策略将属于反亲和组中新创建的虚拟机分布在不同宿主机上，从而实现业务的高可用。一般用于某个系统中要求系统中的各个节点部署在不同宿主机上的场景。&lt;/p>
&lt;h2 id="web界面操作">Web界面操作&lt;/h2>
&lt;h3 id="创建反亲和组">创建反亲和组&lt;/h3>
&lt;p>该功能用于创建反亲和组。&lt;/p>
&lt;div class="alert alert-primary" role="alert">
&lt;h4 class="alert-heading">说明&lt;/h4>
&lt;ul>
&lt;li>用户在管理后台创建的反亲和组所属项目为default域的system项目。&lt;/li>
&lt;li>用户在项目中创建反亲和组时，反亲和组所属项目为用户所在项目。&lt;/li>
&lt;/ul>
&lt;/div>
&lt;ol>
&lt;li>在反亲和组页面，单击列表上方 &lt;strong>&lt;em>&amp;ldquo;新建&amp;rdquo;&lt;/em>&lt;/strong> 按钮，弹出创建反亲和组对话框。&lt;/li>
&lt;li>设置以下参数：
&lt;ul>
&lt;li>指定项目：选择反亲和组的所属项目。&lt;/li>
&lt;li>名称：反亲和组的名称。&lt;/li>
&lt;li>策略：包括强制和非强制。
&lt;ul>
&lt;li>强制即强制要求属于同一反亲和组的虚拟机必须按照粒度分布在不同宿主机。不当宿主机上的虚拟机数量超过粒度后创建新虚拟机会失败。&lt;/li>
&lt;li>非强制即尽可能的将属于同一反亲和组的虚拟机按照粒度分布在不同宿主机，当宿主机上的虚拟机数量超过粒度后也可以创建。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>粒度：反亲和组内虚拟机可以在同一宿主机存在的数量。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮，创建反亲和组。&lt;/li>
&lt;/ol>
&lt;h3 id="加入反亲和组">加入反亲和组&lt;/h3>
&lt;p>该功能用于将虚拟机加入反亲和组。仅Cloudpods平台的虚拟机支持加入反亲和组功能。&lt;/p>
&lt;ol>
&lt;li>在虚拟机页面，单击虚拟机右侧操作列 &lt;strong>&lt;em>&amp;ldquo;更多&amp;rdquo;&lt;/em>&lt;/strong> 按钮，选择下拉菜单 &lt;strong>&lt;em>&amp;ldquo;实例设置-加入反亲和组&amp;rdquo;&lt;/em>&lt;/strong> 菜单项，弹出加入反亲和组对话框。&lt;/li>
&lt;li>选择反亲和组（仅显示与虚拟机同项目的反亲和组），单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮。&lt;/li>
&lt;/ol>
&lt;h3 id="关联虚拟机">关联虚拟机&lt;/h3>
&lt;p>该功能支持将已创建的虚拟机加入反亲和组，仅支持选择与反亲和组处于同一项目的虚拟机。已创建的虚拟机加入反亲和组后所属宿主机不会改变。当反亲和组处于禁用状态时不支持绑定主机操作。&lt;/p>
&lt;ol>
&lt;li>在反亲和组页面，单击反亲和组右侧操作列 &lt;strong>&lt;em>&amp;ldquo;关联虚拟机&amp;rdquo;&lt;/em>&lt;/strong> 按钮，弹出绑定主机对话框。&lt;/li>
&lt;li>选择需要绑定的虚拟机，单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮。&lt;/li>
&lt;/ol>
&lt;h3 id="启用">启用&lt;/h3>
&lt;p>该功能用于启用&amp;quot;禁用&amp;quot;状态的反亲和组。只有反亲和组处于&amp;quot;启用&amp;quot;状态才可以被用户选择使用。&lt;/p>
&lt;ol>
&lt;li>单击&amp;quot;禁用&amp;quot;状态的反亲和组右侧操作列 &lt;strong>&lt;em>&amp;ldquo;启用&amp;rdquo;&lt;/em>&lt;/strong> 按钮，弹出操作确认对话框。&lt;/li>
&lt;li>单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮，启用反亲和组。&lt;/li>
&lt;/ol>
&lt;h3 id="禁用">禁用&lt;/h3>
&lt;p>该功能用于禁用&amp;quot;启用&amp;quot;状态的反亲和组。&lt;/p>
&lt;ol>
&lt;li>单击&amp;quot;启用&amp;quot;状态的反亲和组右侧操作列 &lt;strong>&lt;em>&amp;ldquo;禁用&amp;rdquo;&lt;/em>&lt;/strong> 按钮，弹出操作确认对话框。&lt;/li>
&lt;li>单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮，禁用反亲和组。&lt;/li>
&lt;/ol>
&lt;h3 id="删除反亲和组">删除反亲和组&lt;/h3>
&lt;p>该功能用于删除反亲和组，当绑定主机数量为0时才可以删除反亲和组。&lt;/p>
&lt;p>&lt;strong>单个删除&lt;/strong>&lt;/p>
&lt;ol>
&lt;li>在反亲和组页面，单击反亲和组操作列 &lt;strong>&lt;em>&amp;ldquo;更多&amp;rdquo;&lt;/em>&lt;/strong> 按钮，选择下拉菜单 &lt;strong>&lt;em>&amp;ldquo;删除&amp;rdquo;&lt;/em>&lt;/strong> 菜单项，弹出操作确认对话框。&lt;/li>
&lt;li>单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮，完成操作。&lt;/li>
&lt;/ol>
&lt;p>&lt;strong>批量删除&lt;/strong>&lt;/p>
&lt;ol>
&lt;li>在反亲和组列表中勾选一个或多个反亲和组，单击列表上方 &lt;strong>&lt;em>&amp;ldquo;删除&amp;rdquo;&lt;/em>&lt;/strong> 按钮，弹出操作确认对话框。&lt;/li>
&lt;li>单击 &lt;strong>&lt;em>&amp;ldquo;确定&amp;rdquo;&lt;/em>&lt;/strong> 按钮，完成操作。&lt;/li>
&lt;/ol></description></item><item><title>Docs: USB相关</title><link>https://www.cloudpods.org/zh/docs/onpremise/vminstance/tutorial/usb/</link><pubDate>Fri, 19 Jul 2019 18:32:40 +0800</pubDate><guid>https://www.cloudpods.org/zh/docs/onpremise/vminstance/tutorial/usb/</guid><description>
&lt;p>Cloudpods KVM虚拟机并未正式支持USB透传，但是可以通过虚拟机的extra参数，将USB透传的qemu命令参数传递给qemu，从而也能从某种程度上实现将宿主机挂载的指定USB设备透传给在该宿主机上运行的虚拟机的目的，目前，只能通过climc命令行工具来更新虚拟机的extra参数。&lt;/p>
&lt;p>第一步，在宿主机上运行 lsusb -t 命令找到USB设备在宿主机的设备ID。&lt;/p>
&lt;p>如果是USB 2.0的设备，执行 lsusb -t 有如下输出：&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">/: Bus 03.Port 1: Dev 1, &lt;span style="color:#000">Class&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>root_hub, &lt;span style="color:#000">Driver&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>xhci_hcd/14p, 480M
&lt;span style="color:#000;font-weight:bold">|&lt;/span>__ Port 10: Dev 8, If 0, &lt;span style="color:#000">Class&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>Human Interface Device, &lt;span style="color:#000">Driver&lt;/span>&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>usbhid, 12M
&lt;/code>&lt;/pre>&lt;/div>&lt;p>则透传USB的qemu参数为：&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">-device usb-host,hostbus&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>3,hostport&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">10&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>如果是USB 3.0的设备，执行 lsusb -t 有如下输出:&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">/: Bus &lt;span style="color:#0000cf;font-weight:bold">03&lt;/span>
&lt;span style="color:#000;font-weight:bold">|&lt;/span>__ Port 2: some stuff
&lt;span style="color:#000;font-weight:bold">|&lt;/span>__ Port 1: some stuff
&lt;/code>&lt;/pre>&lt;/div>&lt;p>则透传USB的qemu参数为：&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">-device usb-host,hostbus&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>3,hostport&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>2.1
&lt;/code>&lt;/pre>&lt;/div>&lt;p>第二步，执行climc命令，更新目标虚拟机的extra参数&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">climc server-add-extra-options &amp;lt;sid&amp;gt; &lt;span style="color:#4e9a06">&amp;#39;device&amp;#39;&lt;/span> &lt;span style="color:#4e9a06">&amp;#39;usb-host,hostbus=3,hostport=2.1&amp;#39;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>该命令执行后，将会给qemu虚拟机的命令行参数增加如下额外参数：&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">-device usb-host,hostbus&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>3,hostport&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>2.1
&lt;/code>&lt;/pre>&lt;/div>&lt;p>第三步：重启虚拟机&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">climc server-restart &amp;lt;sid&amp;gt;
&lt;/code>&lt;/pre>&lt;/div>&lt;p>如果希望虚拟机不再透传该USB设备，则执行&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">climc server-remove-extra-options &amp;lt;sid&amp;gt; &lt;span style="color:#4e9a06">&amp;#39;device&amp;#39;&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>然后，再restart该虚拟机。&lt;/p></description></item><item><title>Docs: 性能测试</title><link>https://www.cloudpods.org/zh/docs/onpremise/vminstance/tutorial/perf-test/</link><pubDate>Fri, 19 Jul 2019 17:38:36 +0800</pubDate><guid>https://www.cloudpods.org/zh/docs/onpremise/vminstance/tutorial/perf-test/</guid><description>
&lt;h3 id="cpu和内存性能测试">CPU和内存性能测试&lt;/h3>
&lt;h4 id="测试环境">测试环境&lt;/h4>
&lt;p>操作系统: CentOS 7
云平台版本: &amp;gt;= v3.7.7
宿主机: Dell PowerEdge R730xd
- CPU: Intel(R) Xeon(R) CPU E5-2678 v3 @ 2.50GHz
- 内存: DDR4 2133 MHz 256GB (16GB x 16)
- 磁盘: 机械盘 20TB PERC H730P Mini (RAID 10)
- 网卡: 10000Mb/s&lt;/p>
&lt;h4 id="安装测试软件">安装测试软件&lt;/h4>
&lt;p>测试工具:&lt;/p>
&lt;ul>
&lt;li>UnixBench: 测试虚拟机CPU性能&lt;/li>
&lt;li>mbw: 测试内存性能&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8f5902;font-style:italic"># 安装 UnixBench&lt;/span>
$ yum install -y git gcc autoconf gcc-c++ &lt;span style="color:#204a87">time&lt;/span> perl-Time-HiRes
$ git clone https://github.com/kdlucas/byte-unixbench.git
&lt;span style="color:#8f5902;font-style:italic"># 安装 mbw&lt;/span>
$ git clone https://github.com/raas/mbw.git &lt;span style="color:#ce5c00;font-weight:bold">&amp;amp;&amp;amp;&lt;/span> &lt;span style="color:#204a87">cd&lt;/span> mbw
$ make &lt;span style="color:#ce5c00;font-weight:bold">&amp;amp;&amp;amp;&lt;/span> ./mbw &lt;span style="color:#0000cf;font-weight:bold">512&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h4 id="cpu-测试">CPU 测试&lt;/h4>
&lt;p>测试命令:&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">$ &lt;span style="color:#204a87">cd&lt;/span> byte-unixbench/UnixBench
$ ./Run -c &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> whetstone-double dhry2reg fsdisk
&lt;/code>&lt;/pre>&lt;/div>&lt;p>结论:&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>指标&lt;/th>
&lt;th>物理机&lt;/th>
&lt;th>虚拟机&lt;/th>
&lt;th>虚拟化开销（物理机-虚拟机/ 物理机）&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>Dhrystone&lt;/td>
&lt;td>34839728.4 lps&lt;/td>
&lt;td>33964545.0 lps&lt;/td>
&lt;td>2.5%&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Double-Precision Whetstone&lt;/td>
&lt;td>4368.3 MWIPS&lt;/td>
&lt;td>4244.3 MWIPS&lt;/td>
&lt;td>2.8%&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>File Copy&lt;/td>
&lt;td>1825548.4 KBps&lt;/td>
&lt;td>1788048.3 KBps&lt;/td>
&lt;td>2.1%&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h4 id="内存测试">内存测试&lt;/h4>
&lt;p>结论:&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>指标&lt;/th>
&lt;th>物理机&lt;/th>
&lt;th>虚拟机&lt;/th>
&lt;th>虚拟化开销（物理机-虚拟机/物理机）&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>MEMCPY AVG&lt;/td>
&lt;td>7578.348 MiB/s&lt;/td>
&lt;td>6254.520 MiB/s&lt;/td>
&lt;td>1.7%&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h3 id="本地存储io测试">本地存储IO测试&lt;/h3>
&lt;h4 id="测试方法">测试方法&lt;/h4>
&lt;p>采用fio，分别用如下场景和命令测试：&lt;/p>
&lt;ul>
&lt;li>4KB随机读&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">fio --name&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>random-read --ioengine&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>posixaio --rw&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>randread --bs&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>4k --size&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>4g --numjobs&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> --iodepth&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">16&lt;/span> --runtime&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">60&lt;/span> --time_based --direct&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>4KB随机写&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">fio --name&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>random-write --ioengine&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>posixaio --rw&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>randwrite --bs&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>4k --size&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>4g --numjobs&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> --iodepth&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">16&lt;/span> --runtime&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">60&lt;/span> --time_based --direct&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> --end_fsync&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>4K顺序读&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">fio --name&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>random-read --ioengine&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>posixaio --rw&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#204a87">read&lt;/span> --bs&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>4k --size&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>4g --numjobs&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> --iodepth&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">16&lt;/span> --runtime&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">60&lt;/span> --time_based --direct&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>4K顺序写&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">fio --name&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>random-write --ioengine&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>posixaio --rw&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>write --bs&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>4k --size&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>4g --numjobs&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> --iodepth&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">16&lt;/span> --runtime&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">60&lt;/span> --time_based --direct&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> --end_fsync&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>1MB顺序读&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">fio --name&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>seq-read --ioengine&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>posixaio --rw&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#204a87">read&lt;/span> --bs&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>1m --size&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>16g --numjobs&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> --iodepth&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> --runtime&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">60&lt;/span> --time_based --direct&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;ul>
&lt;li>1MB顺序写&lt;/li>
&lt;/ul>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">fio --name&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>seq-write --ioengine&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>posixaio --rw&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>write --bs&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>1m --size&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>16g --numjobs&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> --iodepth&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> --runtime&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">60&lt;/span> --time_based --direct&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> --end_fsync&lt;span style="color:#ce5c00;font-weight:bold">=&lt;/span>&lt;span style="color:#0000cf;font-weight:bold">1&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;h4 id="测试环境-1">测试环境&lt;/h4>
&lt;ul>
&lt;li>
&lt;p>物理机&lt;/p>
&lt;p>OS: CentOS Linux release 7.9.2009 (Core)
内核：3.10.0-1062.4.3.el7.yn20191203.x86_64
CPU: Intel(R) Xeon(R) CPU E5-2678 v3 @ 2.50GHz
内存：256G
RAID控制器：Broadcom / LSI MegaRAID SAS-3 3108
RAID Level: RAID10&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Linxu 虚拟机&lt;/p>
&lt;p>OS: CentOS Linux release 7.6.1810 (Core)
内核：3.10.0-957.12.1.el7.x86_64
配置：4核CPU4G内存30G系统盘100G数据盘&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Windows 虚拟机&lt;/p>
&lt;p>OS: Windows Server 2008 R2 Datacenter 6.1
配置：4核CPU4G内存40G系统盘100G数据盘&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h4 id="测试结果">测试结果&lt;/h4>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>场景&lt;/th>
&lt;th style="text-align:right">4KB&lt;/th>
&lt;th style="text-align:left">随机读&lt;/th>
&lt;th style="text-align:right">4KB&lt;/th>
&lt;th style="text-align:left">随机写&lt;/th>
&lt;th style="text-align:right">4KB&lt;/th>
&lt;th style="text-align:left">顺序读&lt;/th>
&lt;th style="text-align:right">4KB&lt;/th>
&lt;th style="text-align:left">顺序写&lt;/th>
&lt;th style="text-align:right">1MB&lt;/th>
&lt;th style="text-align:left">顺序读&lt;/th>
&lt;th style="text-align:right">1MB&lt;/th>
&lt;th style="text-align:left">顺序写&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>&lt;/td>
&lt;td style="text-align:right">IOPS&lt;/td>
&lt;td style="text-align:left">Throughput&lt;/td>
&lt;td style="text-align:right">IOPS&lt;/td>
&lt;td style="text-align:left">Throughput&lt;/td>
&lt;td style="text-align:right">IOPS&lt;/td>
&lt;td style="text-align:left">Throughput&lt;/td>
&lt;td style="text-align:right">IOPS&lt;/td>
&lt;td style="text-align:left">Throughput&lt;/td>
&lt;td style="text-align:right">IOPS&lt;/td>
&lt;td style="text-align:left">Throughput&lt;/td>
&lt;td style="text-align:right">IOPS&lt;/td>
&lt;td style="text-align:left">Throughput&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>物理机&lt;/td>
&lt;td style="text-align:right">195&lt;/td>
&lt;td style="text-align:left">782KiB/s&lt;/td>
&lt;td style="text-align:right">7349&lt;/td>
&lt;td style="text-align:left">28.7MiB/s&lt;/td>
&lt;td style="text-align:right">22.1k&lt;/td>
&lt;td style="text-align:left">86.3MiB/s&lt;/td>
&lt;td style="text-align:right">24.5k&lt;/td>
&lt;td style="text-align:left">95.8MiB/s&lt;/td>
&lt;td style="text-align:right">1055&lt;/td>
&lt;td style="text-align:left">1056MiB/s&lt;/td>
&lt;td style="text-align:right">1117&lt;/td>
&lt;td style="text-align:left">1118MiB/s&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;/td>
&lt;td style="text-align:right">(100%)&lt;/td>
&lt;td style="text-align:left">(100%)&lt;/td>
&lt;td style="text-align:right">(100%)&lt;/td>
&lt;td style="text-align:left">(100%)&lt;/td>
&lt;td style="text-align:right">(100%)&lt;/td>
&lt;td style="text-align:left">(100%)&lt;/td>
&lt;td style="text-align:right">(100%)&lt;/td>
&lt;td style="text-align:left">(100%)&lt;/td>
&lt;td style="text-align:right">(100%)&lt;/td>
&lt;td style="text-align:left">(100%)&lt;/td>
&lt;td style="text-align:right">(100%)&lt;/td>
&lt;td style="text-align:left">(100%)&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Linux 虚拟机&lt;/td>
&lt;td style="text-align:right">245&lt;/td>
&lt;td style="text-align:left">981KiB/s&lt;/td>
&lt;td style="text-align:right">6096&lt;/td>
&lt;td style="text-align:left">23.8MiB/s&lt;/td>
&lt;td style="text-align:right">9458&lt;/td>
&lt;td style="text-align:left">36.9MiB/s&lt;/td>
&lt;td style="text-align:right">6278&lt;/td>
&lt;td style="text-align:left">24.5MiB/s&lt;/td>
&lt;td style="text-align:right">979&lt;/td>
&lt;td style="text-align:left">980MiB/s&lt;/td>
&lt;td style="text-align:right">1058&lt;/td>
&lt;td style="text-align:left">1059MiB/s&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>(cache=none)&lt;/td>
&lt;td style="text-align:right">(126%)&lt;/td>
&lt;td style="text-align:left">(125%)&lt;/td>
&lt;td style="text-align:right">(83%)&lt;/td>
&lt;td style="text-align:left">(83%)&lt;/td>
&lt;td style="text-align:right">(43%)&lt;/td>
&lt;td style="text-align:left">(43%)&lt;/td>
&lt;td style="text-align:right">(26%)&lt;/td>
&lt;td style="text-align:left">(26%)&lt;/td>
&lt;td style="text-align:right">(93%)&lt;/td>
&lt;td style="text-align:left">(93%)&lt;/td>
&lt;td style="text-align:right">(95%)&lt;/td>
&lt;td style="text-align:left">(95%)&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Linux 虚拟机&lt;/td>
&lt;td style="text-align:right">243&lt;/td>
&lt;td style="text-align:left">973KiB/s&lt;/td>
&lt;td style="text-align:right">7483&lt;/td>
&lt;td style="text-align:left">29.2MiB/s&lt;/td>
&lt;td style="text-align:right">11.5k&lt;/td>
&lt;td style="text-align:left">44.9MiB/s&lt;/td>
&lt;td style="text-align:right">7271&lt;/td>
&lt;td style="text-align:left">28.4MiB/s&lt;/td>
&lt;td style="text-align:right">958&lt;/td>
&lt;td style="text-align:left">959MiB/s&lt;/td>
&lt;td style="text-align:right">1052&lt;/td>
&lt;td style="text-align:left">1052MiB/s&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>(cache=none,queues=4)&lt;/td>
&lt;td style="text-align:right">(125%)&lt;/td>
&lt;td style="text-align:left">(124%)&lt;/td>
&lt;td style="text-align:right">(102%)&lt;/td>
&lt;td style="text-align:left">(102%)&lt;/td>
&lt;td style="text-align:right">(52%)&lt;/td>
&lt;td style="text-align:left">(52%)&lt;/td>
&lt;td style="text-align:right">(30%)&lt;/td>
&lt;td style="text-align:left">(30%)&lt;/td>
&lt;td style="text-align:right">(91%)&lt;/td>
&lt;td style="text-align:left">(91%)&lt;/td>
&lt;td style="text-align:right">(94%)&lt;/td>
&lt;td style="text-align:left">(94%)&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Linux 虚拟机&lt;/td>
&lt;td style="text-align:right">13.0k&lt;/td>
&lt;td style="text-align:left">54.5MiB/s&lt;/td>
&lt;td style="text-align:right">8360&lt;/td>
&lt;td style="text-align:left">32.7MiB/s&lt;/td>
&lt;td style="text-align:right">13.1k&lt;/td>
&lt;td style="text-align:left">51.3MiB/s&lt;/td>
&lt;td style="text-align:right">8976&lt;/td>
&lt;td style="text-align:left">35.1MiB/s&lt;/td>
&lt;td style="text-align:right">2550&lt;/td>
&lt;td style="text-align:left">2551MiB/s&lt;/td>
&lt;td style="text-align:right">1045&lt;/td>
&lt;td style="text-align:left">1046MiB/s&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>(cache=writeback)&lt;/td>
&lt;td style="text-align:right">(6667%)&lt;/td>
&lt;td style="text-align:left">(6969%)&lt;/td>
&lt;td style="text-align:right">(114%)&lt;/td>
&lt;td style="text-align:left">(114%)&lt;/td>
&lt;td style="text-align:right">(59%)&lt;/td>
&lt;td style="text-align:left">(59%)&lt;/td>
&lt;td style="text-align:right">(37%)&lt;/td>
&lt;td style="text-align:left">(37%)&lt;/td>
&lt;td style="text-align:right">(242%)&lt;/td>
&lt;td style="text-align:left">(242%)&lt;/td>
&lt;td style="text-align:right">(94%)&lt;/td>
&lt;td style="text-align:left">(94%)&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Linux 虚拟机&lt;/td>
&lt;td style="text-align:right">28.7k&lt;/td>
&lt;td style="text-align:left">112MiB/s&lt;/td>
&lt;td style="text-align:right">12.2k&lt;/td>
&lt;td style="text-align:left">47.5MiB/s&lt;/td>
&lt;td style="text-align:right">29.6k&lt;/td>
&lt;td style="text-align:left">116MiB/s&lt;/td>
&lt;td style="text-align:right">11.2k&lt;/td>
&lt;td style="text-align:left">43.8MiB/s&lt;/td>
&lt;td style="text-align:right">2931&lt;/td>
&lt;td style="text-align:left">2932MiB/s&lt;/td>
&lt;td style="text-align:right">1220&lt;/td>
&lt;td style="text-align:left">1220MiB/s&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>(cache=writeback,queues=4)&lt;/td>
&lt;td style="text-align:right">(14718%)&lt;/td>
&lt;td style="text-align:left">(14322%)&lt;/td>
&lt;td style="text-align:right">(166%)&lt;/td>
&lt;td style="text-align:left">(166%)&lt;/td>
&lt;td style="text-align:right">(134%)&lt;/td>
&lt;td style="text-align:left">(134%)&lt;/td>
&lt;td style="text-align:right">(46%)&lt;/td>
&lt;td style="text-align:left">(46%)&lt;/td>
&lt;td style="text-align:right">(278%)&lt;/td>
&lt;td style="text-align:left">(278%)&lt;/td>
&lt;td style="text-align:right">(109%)&lt;/td>
&lt;td style="text-align:left">(109%)&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Windows 虚拟机&lt;/td>
&lt;td style="text-align:right">2811&lt;/td>
&lt;td style="text-align:left">11.0MiB/s&lt;/td>
&lt;td style="text-align:right">6002&lt;/td>
&lt;td style="text-align:left">23.4MiB/s&lt;/td>
&lt;td style="text-align:right">11.8k&lt;/td>
&lt;td style="text-align:left">46.1MiB/s&lt;/td>
&lt;td style="text-align:right">4289&lt;/td>
&lt;td style="text-align:left">16.8MiB/s&lt;/td>
&lt;td style="text-align:right">1009&lt;/td>
&lt;td style="text-align:left">1009MiB/s&lt;/td>
&lt;td style="text-align:right">685&lt;/td>
&lt;td style="text-align:left">686MiB/s&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>(cache=none)&lt;/td>
&lt;td style="text-align:right">(1441%)&lt;/td>
&lt;td style="text-align:left">(1407%)&lt;/td>
&lt;td style="text-align:right">(82%)&lt;/td>
&lt;td style="text-align:left">(82%)&lt;/td>
&lt;td style="text-align:right">(53%)&lt;/td>
&lt;td style="text-align:left">(53%)&lt;/td>
&lt;td style="text-align:right">(18%)&lt;/td>
&lt;td style="text-align:left">(18%)&lt;/td>
&lt;td style="text-align:right">(96%)&lt;/td>
&lt;td style="text-align:left">(96%)&lt;/td>
&lt;td style="text-align:right">(61%)&lt;/td>
&lt;td style="text-align:left">(61%)&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Windows 虚拟机&lt;/td>
&lt;td style="text-align:right">2794&lt;/td>
&lt;td style="text-align:left">10.9MiB/s&lt;/td>
&lt;td style="text-align:right">7448&lt;/td>
&lt;td style="text-align:left">29.1MiB/s&lt;/td>
&lt;td style="text-align:right">21.1k&lt;/td>
&lt;td style="text-align:left">82.6MiB/s&lt;/td>
&lt;td style="text-align:right">25.5k&lt;/td>
&lt;td style="text-align:left">99.7MiB/s&lt;/td>
&lt;td style="text-align:right">930&lt;/td>
&lt;td style="text-align:left">930MiB/s&lt;/td>
&lt;td style="text-align:right">1013&lt;/td>
&lt;td style="text-align:left">1014MiB/s&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>(cache=none,queues=4)&lt;/td>
&lt;td style="text-align:right">(1432%)&lt;/td>
&lt;td style="text-align:left">(1394%)&lt;/td>
&lt;td style="text-align:right">(101%)&lt;/td>
&lt;td style="text-align:left">(101%)&lt;/td>
&lt;td style="text-align:right">(95%)&lt;/td>
&lt;td style="text-align:left">(96%)&lt;/td>
&lt;td style="text-align:right">(104%)&lt;/td>
&lt;td style="text-align:left">(104%)&lt;/td>
&lt;td style="text-align:right">(88%)&lt;/td>
&lt;td style="text-align:left">(88%)&lt;/td>
&lt;td style="text-align:right">(91%)&lt;/td>
&lt;td style="text-align:left">(91%)&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Windows 虚拟机&lt;/td>
&lt;td style="text-align:right">2483&lt;/td>
&lt;td style="text-align:left">9935KiB/s&lt;/td>
&lt;td style="text-align:right">7430&lt;/td>
&lt;td style="text-align:left">29.0MiB/s&lt;/td>
&lt;td style="text-align:right">10.9k&lt;/td>
&lt;td style="text-align:left">42.8MiB/s&lt;/td>
&lt;td style="text-align:right">13.6k&lt;/td>
&lt;td style="text-align:left">53.0MiB/s&lt;/td>
&lt;td style="text-align:right">1993&lt;/td>
&lt;td style="text-align:left">1994MiB/s&lt;/td>
&lt;td style="text-align:right">920&lt;/td>
&lt;td style="text-align:left">920MiB/s&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>(cache=writeback)&lt;/td>
&lt;td style="text-align:right">(1273%)&lt;/td>
&lt;td style="text-align:left">(1270%)&lt;/td>
&lt;td style="text-align:right">(101%)&lt;/td>
&lt;td style="text-align:left">(101%)&lt;/td>
&lt;td style="text-align:right">(49%)&lt;/td>
&lt;td style="text-align:left">(50%)&lt;/td>
&lt;td style="text-align:right">(56%)&lt;/td>
&lt;td style="text-align:left">(55%)&lt;/td>
&lt;td style="text-align:right">(189%)&lt;/td>
&lt;td style="text-align:left">(189%)&lt;/td>
&lt;td style="text-align:right">(82%)&lt;/td>
&lt;td style="text-align:left">(82%)&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Windows 虚拟机&lt;/td>
&lt;td style="text-align:right">4520&lt;/td>
&lt;td style="text-align:left">17.7MiB/s&lt;/td>
&lt;td style="text-align:right">18.8k&lt;/td>
&lt;td style="text-align:left">73.6MiB/s&lt;/td>
&lt;td style="text-align:right">23.3k&lt;/td>
&lt;td style="text-align:left">90.8MiB/s&lt;/td>
&lt;td style="text-align:right">21.8k&lt;/td>
&lt;td style="text-align:left">85.1MiB/s&lt;/td>
&lt;td style="text-align:right">2628&lt;/td>
&lt;td style="text-align:left">2628MiB/s&lt;/td>
&lt;td style="text-align:right">1191&lt;/td>
&lt;td style="text-align:left">1192MiB/s&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>(cache=writeback,queues=4)&lt;/td>
&lt;td style="text-align:right">(2317%)&lt;/td>
&lt;td style="text-align:left">(2263%)&lt;/td>
&lt;td style="text-align:right">(2558%)&lt;/td>
&lt;td style="text-align:left">(2564%)&lt;/td>
&lt;td style="text-align:right">(105%)&lt;/td>
&lt;td style="text-align:left">(105%)&lt;/td>
&lt;td style="text-align:right">(89%)&lt;/td>
&lt;td style="text-align:left">(89%)&lt;/td>
&lt;td style="text-align:right">(249%)&lt;/td>
&lt;td style="text-align:left">(249%)&lt;/td>
&lt;td style="text-align:right">(106%)&lt;/td>
&lt;td style="text-align:left">(106%)&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h4 id="测试结论">测试结论&lt;/h4>
&lt;ol>
&lt;li>和物理机相比，在4KB随机读写，1MB顺序读写方面，有10%左右的虚拟化开销。可以认为虚拟机性能和物理机相当。由于缓存的作用，虚拟机性能在某些场景甚至超过物理机。&lt;/li>
&lt;li>开启writeback和多队列之后，写性能有明显加速&lt;/li>
&lt;li>在4KB顺序读写性能方面，虚拟机仅有物理机的一半性能。这是因为磁盘采用thin provision方式，虚拟机内的顺序读写转换到物理机其实是随机读写。为了改善虚拟机4KB顺序读写性能，需要将虚拟磁盘文件进行预分配。这样虚拟机内的顺序读写在物理机也是顺序读写。&lt;/li>
&lt;/ol>
&lt;h3 id="共享存储cephio性能测试">共享存储(ceph)IO性能测试&lt;/h3>
&lt;h4 id="测试环境-2">测试环境&lt;/h4>
&lt;p>1、宿主机配置：&lt;/p>
&lt;pre>&lt;code>OS: CentOS Linux release 7.9.2009 (Core)
内核：3.10.0-1062.4.3.el7.yn20191203.x86_64
CPU: Intel(R) Xeon(R) CPU E5-2678 v3 @ 2.50GHz
内存：256GB
&lt;/code>&lt;/pre>
&lt;p>2、虚拟机配置：&lt;/p>
&lt;pre>&lt;code>OS: CentOS Linux release 7.6.1810 (Core)
内核：3.10.0-957.12.1.el7.x86_64
配置：4核CPU4G内存30G系统盘100G数据盘
&lt;/code>&lt;/pre>
&lt;p>3、Ceph存储配置&lt;/p>
&lt;pre>&lt;code>网卡：2x10G双光口存储网 + 2x10G双光口接入网
磁盘：全闪SSD
&lt;/code>&lt;/pre>
&lt;h4 id="测试数据">测试数据&lt;/h4>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>场景&lt;/th>
&lt;th style="text-align:right">4KB&lt;/th>
&lt;th style="text-align:left">随机读&lt;/th>
&lt;th style="text-align:right">4KB&lt;/th>
&lt;th style="text-align:left">随机写&lt;/th>
&lt;th style="text-align:right">4KB&lt;/th>
&lt;th style="text-align:left">顺序读&lt;/th>
&lt;th style="text-align:right">4KB&lt;/th>
&lt;th style="text-align:left">顺序写&lt;/th>
&lt;th style="text-align:right">1MB&lt;/th>
&lt;th style="text-align:left">顺序读&lt;/th>
&lt;th style="text-align:right">1MB&lt;/th>
&lt;th style="text-align:left">顺序写&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>&lt;/td>
&lt;td style="text-align:right">IOPS&lt;/td>
&lt;td style="text-align:left">Throughput&lt;/td>
&lt;td style="text-align:right">IOPS&lt;/td>
&lt;td style="text-align:left">Throughput&lt;/td>
&lt;td style="text-align:right">IOPS&lt;/td>
&lt;td style="text-align:left">Throughput&lt;/td>
&lt;td style="text-align:right">IOPS&lt;/td>
&lt;td style="text-align:left">Throughput&lt;/td>
&lt;td style="text-align:right">IOPS&lt;/td>
&lt;td style="text-align:left">Throughput&lt;/td>
&lt;td style="text-align:right">IOPS&lt;/td>
&lt;td style="text-align:left">Throughput&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>cache=none&lt;/td>
&lt;td style="text-align:right">1054&lt;/td>
&lt;td style="text-align:left">4217KiB/s&lt;/td>
&lt;td style="text-align:right">405&lt;/td>
&lt;td style="text-align:left">1622KiB/s&lt;/td>
&lt;td style="text-align:right">1864&lt;/td>
&lt;td style="text-align:left">7456KiB/s&lt;/td>
&lt;td style="text-align:right">552&lt;/td>
&lt;td style="text-align:left">2209KiB/s&lt;/td>
&lt;td style="text-align:right">159&lt;/td>
&lt;td style="text-align:left">159MiB/s&lt;/td>
&lt;td style="text-align:right">163&lt;/td>
&lt;td style="text-align:left">164MiB/s&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>cache=none,queues=4&lt;/td>
&lt;td style="text-align:right">1152&lt;/td>
&lt;td style="text-align:left">4608KiB/s&lt;/td>
&lt;td style="text-align:right">441&lt;/td>
&lt;td style="text-align:left">1767KiB/s&lt;/td>
&lt;td style="text-align:right">2066&lt;/td>
&lt;td style="text-align:left">8265KiB/s&lt;/td>
&lt;td style="text-align:right">368&lt;/td>
&lt;td style="text-align:left">1472KiB/s&lt;/td>
&lt;td style="text-align:right">168&lt;/td>
&lt;td style="text-align:left">169MiB/s&lt;/td>
&lt;td style="text-align:right">168&lt;/td>
&lt;td style="text-align:left">168MiB/s&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>cache=writeback&lt;/td>
&lt;td style="text-align:right">978&lt;/td>
&lt;td style="text-align:left">3913KiB/s&lt;/td>
&lt;td style="text-align:right">9425&lt;/td>
&lt;td style="text-align:left">36.8MiB/s&lt;/td>
&lt;td style="text-align:right">1623&lt;/td>
&lt;td style="text-align:left">6494KiB/s&lt;/td>
&lt;td style="text-align:right">10.7k&lt;/td>
&lt;td style="text-align:left">41.7MiB/s&lt;/td>
&lt;td style="text-align:right">149&lt;/td>
&lt;td style="text-align:left">149MiB/s&lt;/td>
&lt;td style="text-align:right">474&lt;/td>
&lt;td style="text-align:left">474MiB/s&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>cache=writeback,queues=4&lt;/td>
&lt;td style="text-align:right">1071&lt;/td>
&lt;td style="text-align:left">4284KiB/s&lt;/td>
&lt;td style="text-align:right">12.6k&lt;/td>
&lt;td style="text-align:left">49.3MiB/s&lt;/td>
&lt;td style="text-align:right">1711&lt;/td>
&lt;td style="text-align:left">6848KiB/s&lt;/td>
&lt;td style="text-align:right">15.1k&lt;/td>
&lt;td style="text-align:left">59.1MiB/s&lt;/td>
&lt;td style="text-align:right">161&lt;/td>
&lt;td style="text-align:left">161MiB/s&lt;/td>
&lt;td style="text-align:right">475&lt;/td>
&lt;td style="text-align:left">475MiB/s&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h4 id="测试结论-1">测试结论&lt;/h4>
&lt;ol>
&lt;li>开启writeback和多队列能够明显提升写性能&lt;/li>
&lt;li>读性能比较难优化，可以调高虚拟机内的 read ahead 缓存（blockdev &amp;ndash;setra /dev/sda）&lt;/li>
&lt;li>Ceph并未把网络打满，也未能用满SSD的性能，性能瓶颈感觉还是在软件层面&lt;/li>
&lt;/ol>
&lt;h3 id="网络测试">网络测试&lt;/h3>
&lt;h4 id="测试条件">测试条件&lt;/h4>
&lt;ol>
&lt;li>
&lt;p>默认情况下虚拟机有流量限制，需要在前端或者用命令行工具 &lt;code>climc server-change-bandwidth&lt;/code> 把带宽改为 0 ，表示取消限速。&lt;/p>
&lt;/li>
&lt;li>
&lt;p>默认情况下，VPC虚拟机的EIP也有带宽限制（默认30Mbps），也需要在前端，或者用climc修改限制为0，表示取消限制。&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h4 id="测试方法-1">测试方法:&lt;/h4>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">&lt;span style="color:#8f5902;font-style:italic"># 找一台机器运行 iperf server 模式，假设 ip 是 10.127.100.3&lt;/span>
$ iperf3 -s --bind 10.127.100.3
&lt;span style="color:#8f5902;font-style:italic"># 在另外一台机器作为 iperf client 模式连接 server&lt;/span>
$ iperf3 -c 10.127.100.3 -t &lt;span style="color:#0000cf;font-weight:bold">30&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>以上重复执行三次，取最好的一次。&lt;/p>
&lt;h4 id="经典网络性能测试">经典网络性能测试&lt;/h4>
&lt;h5 id="环境">环境&lt;/h5>
&lt;p>1、宿主机配置：&lt;/p>
&lt;pre>&lt;code>OS: CentOS Linux release 7.9.2009 (Core)
内核：3.10.0-1062.4.3.el7.yn20191203.x86_64
CPU: Intel(R) Xeon(R) CPU E5-2678 v3 @ 2.50GHz
内存：256GB
&lt;/code>&lt;/pre>
&lt;p>2、虚拟机配置：&lt;/p>
&lt;pre>&lt;code>OS: CentOS Linux release 7.6.1810 (Core)
内核：3.10.0-957.12.1.el7.x86_64
配置：2核CPU 2G内存 30G系统盘
&lt;/code>&lt;/pre>
&lt;h5 id="结论">结论&lt;/h5>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>源 \ 目的&lt;/th>
&lt;th>物理机&lt;/th>
&lt;th>虚拟机&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>物理机&lt;/td>
&lt;td>8.35 Gbps (100%)&lt;/td>
&lt;td>8.40 Gbps (101%)&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>虚拟机&lt;/td>
&lt;td>8.41 Gbps (101%)&lt;/td>
&lt;td>8.33 Gbps (99.7%)&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>说明：饱和流量测试，网路虚拟化开销很低（1%量级）。&lt;/p>
&lt;h4 id="vpc网络性能测试">VPC网络性能测试&lt;/h4>
&lt;h5 id="测试环境-3">测试环境&lt;/h5>
&lt;p>1、宿主机配置：&lt;/p>
&lt;pre>&lt;code>OS: CentOS Linux release 7.7.1908 (Core)
内核：5.4.130-1.yn20210710.el7.x86_64
CPU: Intel(R) Xeon(R) Gold 5218R CPU @ 2.10GHz
内存：256GB
&lt;/code>&lt;/pre>
&lt;p>2、虚拟机配置：&lt;/p>
&lt;pre>&lt;code>OS: CentOS Linux release 7.8.2003
内核：3.10.0-1127.el7.x86_64
配置：2核CPU 2G内存 30G系统盘
&lt;/code>&lt;/pre>
&lt;h5 id="结论-1">结论&lt;/h5>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>场景&lt;/th>
&lt;th>物理机到物理机&lt;/th>
&lt;th>虚拟机到虚拟机&lt;/th>
&lt;th>虚拟机EIP到虚拟机EIP&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>性能 (Gbps)&lt;/td>
&lt;td>9.19 (100%)&lt;/td>
&lt;td>8.96 (97%)&lt;/td>
&lt;td>5.83 (63%)&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>说明：饱和流量情况下，网络虚拟化开销很低（3%量级）。由于转换路径较长，EIP的性能要差很多（36%损耗）。&lt;/p></description></item><item><title>Docs: 调试QEMU参数</title><link>https://www.cloudpods.org/zh/docs/onpremise/vminstance/tutorial/customize/</link><pubDate>Fri, 19 Jul 2019 18:32:40 +0800</pubDate><guid>https://www.cloudpods.org/zh/docs/onpremise/vminstance/tutorial/customize/</guid><description>
&lt;p>本文介绍如何调试 Cloudpods KVM虚拟机的配置参数。&lt;/p>
&lt;h2 id="hahahugoshortcode-s1-hbhb-kvm虚拟机的配置存储位置一般在宿主机的-optcloudworkspaceservers-下该位置可以修改-etcyunionhostconf-的-servers_path">Cloudpods KVM虚拟机的配置存储位置一般在宿主机的 /opt/cloud/workspace/servers 下，该位置可以修改 /etc/yunion/host.conf 的 servers_path&lt;/h2>
&lt;p>在 servers 目录下，每个虚拟机ID的目录存储了该虚拟机相关的配置文件，主要的文件有：&lt;/p>
&lt;div class="highlight">&lt;pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-bash" data-lang="bash">-rw-r--r-- &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> root root &lt;span style="color:#0000cf;font-weight:bold">3114&lt;/span> May &lt;span style="color:#0000cf;font-weight:bold">17&lt;/span> 10:53 desc
-rwx------ &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> root root &lt;span style="color:#0000cf;font-weight:bold">344&lt;/span> Jun &lt;span style="color:#0000cf;font-weight:bold">22&lt;/span> 10:07 &lt;span style="color:#204a87;font-weight:bold">if&lt;/span>-down-br0-vnet222-252.sh
-rwx------ &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> root root &lt;span style="color:#0000cf;font-weight:bold">1074&lt;/span> Jun &lt;span style="color:#0000cf;font-weight:bold">22&lt;/span> 10:07 &lt;span style="color:#204a87;font-weight:bold">if&lt;/span>-up-br0-vnet222-252.sh
-rw-r--r-- &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> root root &lt;span style="color:#0000cf;font-weight:bold">2810&lt;/span> Jun &lt;span style="color:#0000cf;font-weight:bold">22&lt;/span> 10:07 startvm
-rw-r--r-- &lt;span style="color:#0000cf;font-weight:bold">1&lt;/span> root root &lt;span style="color:#0000cf;font-weight:bold">661&lt;/span> Jun &lt;span style="color:#0000cf;font-weight:bold">22&lt;/span> 10:07 stopvm
&lt;/code>&lt;/pre>&lt;/div>&lt;p>其中，startvm 为启动虚拟机的脚本文件，包含了该虚拟机启动的所有命令行参数，可以修改该文件的qemu启动参数来实现调试qemu启动参数的目的。&lt;/p>
&lt;p>一般步骤为：&lt;/p>
&lt;ol>
&lt;li>
&lt;p>停止虚拟机&lt;/p>
&lt;/li>
&lt;li>
&lt;p>修改该虚拟机的startvm脚本参数&lt;/p>
&lt;/li>
&lt;li>
&lt;p>以root身份启动虚拟机：sh startvm&lt;/p>
&lt;/li>
&lt;li>
&lt;p>在前端，对虚拟机执行“同步状态”的操作&lt;/p>
&lt;/li>
&lt;li>
&lt;p>同步状态后，前端显示该虚拟机为运行状态，即可查看该虚拟机的vnc终端，以及进行其他控制操作&lt;/p>
&lt;/li>
&lt;/ol></description></item></channel></rss>